<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: lib/filter.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('filter_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">lib/filter.c</div>  </div>
</div>
<div class="contents">
<a href="filter_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Route filtering function.</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (C) 1998, 1999 Kunihiro Ishiguro</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This file is part of GNU Zebra.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * GNU Zebra is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License as published</span>
<a name="l00008"></a>00008 <span class="comment"> * by the Free Software Foundation; either version 2, or (at your</span>
<a name="l00009"></a>00009 <span class="comment"> * option) any later version.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * GNU Zebra is distributed in the hope that it will be useful, but</span>
<a name="l00012"></a>00012 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00014"></a>00014 <span class="comment"> * General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * along with GNU Zebra; see the file COPYING.  If not, write to the</span>
<a name="l00018"></a>00018 <span class="comment"> * Free Software Foundation, Inc., 59 Temple Place - Suite 330,</span>
<a name="l00019"></a>00019 <span class="comment"> * Boston, MA 02111-1307, USA.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="zebra_8h.html">zebra.h</a>&gt;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="prefix_8h.html">prefix.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="filter_8h.html">filter.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="memory_8h.html">memory.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="command_8h.html">command.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="sockunion_8h.html">sockunion.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="buffer_8h.html">buffer.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">log.h</a>&quot;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="structfilter__cisco.html">00032</a> <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a>
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034   <span class="comment">/* Cisco access-list */</span>
<a name="l00035"></a><a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">00035</a>   <span class="keywordtype">int</span> <a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>;
<a name="l00036"></a><a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">00036</a>   <span class="keyword">struct </span>in_addr <a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>;
<a name="l00037"></a><a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">00037</a>   <span class="keyword">struct </span>in_addr <a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>;
<a name="l00038"></a><a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">00038</a>   <span class="keyword">struct </span>in_addr <a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>;
<a name="l00039"></a><a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">00039</a>   <span class="keyword">struct </span>in_addr <a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>;
<a name="l00040"></a>00040 };
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="structfilter__zebra.html">00042</a> <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a>
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   <span class="comment">/* If this filter is &quot;exact&quot; match then this flag is set. */</span>
<a name="l00045"></a><a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">00045</a>   <span class="keywordtype">int</span> <a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a>;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <span class="comment">/* Prefix information. */</span>
<a name="l00048"></a><a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">00048</a>   <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> <a class="code" href="structprefix.html">prefix</a>;
<a name="l00049"></a>00049 };
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="comment">/* Filter element of access list */</span>
<a name="l00052"></a><a class="code" href="structfilter.html">00052</a> <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a>
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054   <span class="comment">/* For doubly linked list. */</span>
<a name="l00055"></a><a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">00055</a>   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>;
<a name="l00056"></a><a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">00056</a>   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a>;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="comment">/* Filter type information. */</span>
<a name="l00059"></a><a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">00059</a>   <span class="keyword">enum</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72">filter_type</a> <a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061   <span class="comment">/* Cisco access-list */</span>
<a name="l00062"></a><a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">00062</a>   <span class="keywordtype">int</span> <a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064   <span class="keyword">union</span>
<a name="l00065"></a>00065     {
<a name="l00066"></a><a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">00066</a>       <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> <a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l00067"></a><a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">00067</a>       <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> <a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l00068"></a>00068     } <a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>;
<a name="l00069"></a>00069 };
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/* List of access_list. */</span>
<a name="l00072"></a><a class="code" href="structaccess__list__list.html">00072</a> <span class="keyword">struct </span><a class="code" href="structaccess__list__list.html">access_list_list</a>
<a name="l00073"></a>00073 {
<a name="l00074"></a><a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">00074</a>   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>;
<a name="l00075"></a><a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">00075</a>   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a>;
<a name="l00076"></a>00076 };
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/* Master structure of access_list. */</span>
<a name="l00079"></a><a class="code" href="structaccess__master.html">00079</a> <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a>
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081   <span class="comment">/* List of access_list which name is number. */</span>
<a name="l00082"></a><a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">00082</a>   <span class="keyword">struct </span><a class="code" href="structaccess__list__list.html">access_list_list</a> <a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="comment">/* List of access_list which name is string. */</span>
<a name="l00085"></a><a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">00085</a>   <span class="keyword">struct </span><a class="code" href="structaccess__list__list.html">access_list_list</a> <a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="comment">/* Hook function which is executed when new access_list is added. */</span>
<a name="l00088"></a><a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">00088</a>   void (*<a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">add_hook</a>) (<span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="comment">/* Hook function which is executed when access_list is deleted. */</span>
<a name="l00091"></a><a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">00091</a>   void (*<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>) (<span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *);
<a name="l00092"></a>00092 };
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">/* Static structure for IPv4 access_list&#39;s master. */</span>
<a name="l00095"></a><a class="code" href="filter_8c.html#aa823fef87f929cde5b15658bc55ab536">00095</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> <a class="code" href="filter_8c.html#aa823fef87f929cde5b15658bc55ab536">access_master_ipv4</a> = 
<a name="l00096"></a>00096 { 
<a name="l00097"></a>00097   {<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l00098"></a>00098   {<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l00099"></a>00099   <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00100"></a>00100   <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00101"></a>00101 };
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span><span class="comment">/* Static structure for IPv6 access_list&#39;s master. */</span>
<a name="l00105"></a>00105 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> access_master_ipv6 = 
<a name="l00106"></a>00106 { 
<a name="l00107"></a>00107   {<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l00108"></a>00108   {<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>},
<a name="l00109"></a>00109   <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00110"></a>00110   <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00111"></a>00111 };
<a name="l00112"></a>00112 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *
<a name="l00115"></a><a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">00115</a> <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (<a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>)
<a name="l00118"></a>00118     <span class="keywordflow">return</span> &amp;<a class="code" href="filter_8c.html#aa823fef87f929cde5b15658bc55ab536">access_master_ipv4</a>;
<a name="l00119"></a>00119 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (afi == <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>)
<a name="l00121"></a>00121     <span class="keywordflow">return</span> &amp;access_master_ipv6;
<a name="l00122"></a>00122 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00123"></a>00123   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="comment">/* Allocate new filter structure. */</span>
<a name="l00127"></a>00127 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *
<a name="l00128"></a><a class="code" href="filter_8c.html#a86498922c0a46bc05abf665b86235ee2">00128</a> <a class="code" href="filter_8c.html#a86498922c0a46bc05abf665b86235ee2">filter_new</a> (<span class="keywordtype">void</span>)
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130   <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *) <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba5eb0d2f41abda0c72e98547d58cf446b">MTYPE_ACCESS_FILTER</a>,
<a name="l00131"></a>00131                     <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a>));
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00135"></a><a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">00135</a> <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137   <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba5eb0d2f41abda0c72e98547d58cf446b">MTYPE_ACCESS_FILTER</a>, filter);
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">/* Return string of filter_type. */</span>
<a name="l00141"></a>00141 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00142"></a><a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">00142</a> <a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">filter_type_str</a> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144   <span class="keywordflow">switch</span> (filter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>)
<a name="l00145"></a>00145     {
<a name="l00146"></a>00146     <span class="keywordflow">case</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a68ef3d4c373520eb5b085236bf4eeef8">FILTER_PERMIT</a>:
<a name="l00147"></a>00147       <span class="keywordflow">return</span> <span class="stringliteral">&quot;permit&quot;</span>;
<a name="l00148"></a>00148       <span class="keywordflow">break</span>;
<a name="l00149"></a>00149     <span class="keywordflow">case</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a>:
<a name="l00150"></a>00150       <span class="keywordflow">return</span> <span class="stringliteral">&quot;deny&quot;</span>;
<a name="l00151"></a>00151       <span class="keywordflow">break</span>;
<a name="l00152"></a>00152     <span class="keywordflow">case</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72ab6cae9cebcbe7af1eb12adc0ee1b5af2">FILTER_DYNAMIC</a>:
<a name="l00153"></a>00153       <span class="keywordflow">return</span> <span class="stringliteral">&quot;dynamic&quot;</span>;
<a name="l00154"></a>00154       <span class="keywordflow">break</span>;
<a name="l00155"></a>00155     <span class="keywordflow">default</span>:
<a name="l00156"></a>00156       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00157"></a>00157       <span class="keywordflow">break</span>;
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">/* If filter match to the prefix then return 1. */</span>
<a name="l00162"></a>00162 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00163"></a><a class="code" href="filter_8c.html#a2531a4c58cd3d379feef16ecf0a2c258">00163</a> <a class="code" href="filter_8c.html#a2531a4c58cd3d379feef16ecf0a2c258">filter_match_cisco</a> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *mfilter, <span class="keyword">struct</span> <a class="code" href="structprefix.html">prefix</a> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>)
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00166"></a>00166   <span class="keyword">struct </span>in_addr mask;
<a name="l00167"></a>00167   u_int32_t check_addr;
<a name="l00168"></a>00168   u_int32_t check_mask;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l00171"></a>00171   check_addr = p-&gt;u.<a class="code" href="structprefix.html#ab37b8922554b41b7dc2417d8f37e7829">prefix4</a>.s_addr &amp; ~filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>)
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <a class="code" href="prefix_8c.html#ac618f277d6ed0ebc56781ec26e508157">masklen2ip</a> (p-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a>, &amp;mask);
<a name="l00176"></a>00176       check_mask = mask.s_addr &amp; ~filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>.s_addr;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (&amp;check_addr, &amp;filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>.s_addr, 4) == 0
<a name="l00179"></a>00179           &amp;&amp; <a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (&amp;check_mask, &amp;filter-&gt;<a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>.s_addr, 4) == 0)
<a name="l00180"></a>00180     <span class="keywordflow">return</span> 1;
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (&amp;check_addr, &amp;filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>.s_addr, 4) == 0)
<a name="l00183"></a>00183     <span class="keywordflow">return</span> 1;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="keywordflow">return</span> 0;
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">/* If filter match to the prefix then return 1. */</span>
<a name="l00189"></a>00189 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00190"></a><a class="code" href="filter_8c.html#a88f7da77072cccaf34adc4222cbc6467">00190</a> <a class="code" href="filter_8c.html#a88f7da77072cccaf34adc4222cbc6467">filter_match_zebra</a> (<span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *mfilter, <span class="keyword">struct</span> <a class="code" href="structprefix.html">prefix</a> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>)
<a name="l00191"></a>00191 {
<a name="l00192"></a>00192   <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196   <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>.<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a> == p-&gt;<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a>)
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a>)
<a name="l00199"></a>00199     {
<a name="l00200"></a>00200       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>.<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> == p-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a>)
<a name="l00201"></a>00201         <span class="keywordflow">return</span> <a class="code" href="prefix_8c.html#a8c5d68665a4b036a361330bee254318e">prefix_match</a> (&amp;filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>, p);
<a name="l00202"></a>00202       <span class="keywordflow">else</span>
<a name="l00203"></a>00203         <span class="keywordflow">return</span> 0;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205       <span class="keywordflow">else</span>
<a name="l00206"></a>00206     <span class="keywordflow">return</span> <a class="code" href="prefix_8c.html#a8c5d68665a4b036a361330bee254318e">prefix_match</a> (&amp;filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>, p);
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208   <span class="keywordflow">else</span>
<a name="l00209"></a>00209     <span class="keywordflow">return</span> 0;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">/* Allocate new access list structure. */</span>
<a name="l00213"></a>00213 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *
<a name="l00214"></a><a class="code" href="filter_8c.html#aa043cb5949a564b1b13b721935a2640e">00214</a> <a class="code" href="filter_8c.html#aa043cb5949a564b1b13b721935a2640e">access_list_new</a> (<span class="keywordtype">void</span>)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216   <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *) <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba746342607a49b5135e1c816ef460210e">MTYPE_ACCESS_LIST</a>,
<a name="l00217"></a>00217                      <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a>));
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="comment">/* Free allocated access_list. */</span>
<a name="l00221"></a>00221 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00222"></a><a class="code" href="filter_8c.html#a3d4945c16ba75cac9b08ffd2b256b9c9">00222</a> <a class="code" href="filter_8c.html#a3d4945c16ba75cac9b08ffd2b256b9c9">access_list_free</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access)
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224   <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba746342607a49b5135e1c816ef460210e">MTYPE_ACCESS_LIST</a>, access);
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">/* Delete access_list from access_master and free it. */</span>
<a name="l00228"></a>00228 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00229"></a><a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">00229</a> <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00232"></a>00232   <span class="keyword">struct </span>filter *<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>;
<a name="l00233"></a>00233   <span class="keyword">struct </span><a class="code" href="structaccess__list__list.html">access_list_list</a> *<a class="code" href="structlist.html">list</a>;
<a name="l00234"></a>00234   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   <span class="keywordflow">for</span> (filter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; filter; filter = next)
<a name="l00237"></a>00237     {
<a name="l00238"></a>00238       next = filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>;
<a name="l00239"></a>00239       <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (filter);
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   master = access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a257fe99fdbd57dbc3c435e0511d6d982">type</a> == <a class="code" href="bgp__filter_8c.html#a6982912c972612efe3b323b45874790fa9451453940e66143ded5e3dbd6d67438">ACCESS_TYPE_NUMBER</a>)
<a name="l00245"></a>00245     list = &amp;master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>;
<a name="l00246"></a>00246   <span class="keywordflow">else</span>
<a name="l00247"></a>00247     list = &amp;master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l00250"></a>00250     access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a> = access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>;
<a name="l00251"></a>00251   <span class="keywordflow">else</span>
<a name="l00252"></a>00252     list-&gt;<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> = access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>)
<a name="l00255"></a>00255     access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a> = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l00256"></a>00256   <span class="keywordflow">else</span>
<a name="l00257"></a>00257     list-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>)
<a name="l00260"></a>00260     <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba38a97064b09af81435f12663507fd4fa">MTYPE_ACCESS_LIST_STR</a>, access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l00263"></a>00263     <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba563963518edb70d4cd7492b06f48106e">MTYPE_TMP</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   <a class="code" href="filter_8c.html#a3d4945c16ba75cac9b08ffd2b256b9c9">access_list_free</a> (access);
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">/* Insert new access list to list of access_list.  Each acceess_list</span>
<a name="l00269"></a>00269 <span class="comment">   is sorted by the name. */</span>
<a name="l00270"></a>00270 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *
<a name="l00271"></a><a class="code" href="filter_8c.html#a49bc3b5a60f329093e73c26235e6003e">00271</a> <a class="code" href="filter_8c.html#a49bc3b5a60f329093e73c26235e6003e">access_list_insert</a> (<a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="memory_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00272"></a>00272 {
<a name="l00273"></a>00273   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
<a name="l00274"></a>00274   <span class="keywordtype">long</span> number;
<a name="l00275"></a>00275   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l00276"></a>00276   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *point;
<a name="l00277"></a>00277   <span class="keyword">struct </span><a class="code" href="structaccess__list__list.html">access_list_list</a> *alist;
<a name="l00278"></a>00278   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (afi);
<a name="l00281"></a>00281   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00282"></a>00282     <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284   <span class="comment">/* Allocate new access_list and copy given name. */</span>
<a name="l00285"></a>00285   access = <a class="code" href="filter_8c.html#aa043cb5949a564b1b13b721935a2640e">access_list_new</a> ();
<a name="l00286"></a>00286   access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a> = <a class="code" href="memory_8h.html#aa7c561b5824edc16351f22b8df155c0e">XSTRDUP</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba38a97064b09af81435f12663507fd4fa">MTYPE_ACCESS_LIST_STR</a>, name);
<a name="l00287"></a>00287   access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a> = <a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289   <span class="comment">/* If name is made by all digit character.  We treat it as</span>
<a name="l00290"></a>00290 <span class="comment">     number. */</span>
<a name="l00291"></a>00291   <span class="keywordflow">for</span> (number = 0, i = 0; i &lt; strlen (name); i++)
<a name="l00292"></a>00292     {
<a name="l00293"></a>00293       <span class="keywordflow">if</span> (isdigit ((<span class="keywordtype">int</span>) name[i]))
<a name="l00294"></a>00294     number = (number * 10) + (name[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>] - <span class="charliteral">&#39;0&#39;</span>);
<a name="l00295"></a>00295       <span class="keywordflow">else</span>
<a name="l00296"></a>00296     <span class="keywordflow">break</span>;
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="comment">/* In case of name is all digit character */</span>
<a name="l00300"></a>00300   <span class="keywordflow">if</span> (i == strlen (name))
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302       access-&gt;<a class="code" href="structaccess__list.html#a257fe99fdbd57dbc3c435e0511d6d982">type</a> = <a class="code" href="bgp__filter_8c.html#a6982912c972612efe3b323b45874790fa9451453940e66143ded5e3dbd6d67438">ACCESS_TYPE_NUMBER</a>;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304       <span class="comment">/* Set access_list to number list. */</span>
<a name="l00305"></a>00305       alist = &amp;master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307       <span class="keywordflow">for</span> (point = alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; point; point = point-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l00308"></a>00308     <span class="keywordflow">if</span> (atol (point-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>) &gt;= number)
<a name="l00309"></a>00309       <span class="keywordflow">break</span>;
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311   <span class="keywordflow">else</span>
<a name="l00312"></a>00312     {
<a name="l00313"></a>00313       access-&gt;<a class="code" href="structaccess__list.html#a257fe99fdbd57dbc3c435e0511d6d982">type</a> = <a class="code" href="bgp__filter_8c.html#a6982912c972612efe3b323b45874790fa855fbb3aeb2894321fe9c8cd50ea9649">ACCESS_TYPE_STRING</a>;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315       <span class="comment">/* Set access_list to string list. */</span>
<a name="l00316"></a>00316       alist = &amp;master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>;
<a name="l00317"></a>00317   
<a name="l00318"></a>00318       <span class="comment">/* Set point to insertion point. */</span>
<a name="l00319"></a>00319       <span class="keywordflow">for</span> (point = alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; point; point = point-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l00320"></a>00320     <span class="keywordflow">if</span> (strcmp (point-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, name) &gt;= 0)
<a name="l00321"></a>00321       <span class="keywordflow">break</span>;
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324   <span class="comment">/* In case of this is the first element of master. */</span>
<a name="l00325"></a>00325   <span class="keywordflow">if</span> (alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00326"></a>00326     {
<a name="l00327"></a>00327       alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> = alist-&gt;<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> = access;
<a name="l00328"></a>00328       <span class="keywordflow">return</span> access;
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331   <span class="comment">/* In case of insertion is made at the tail of access_list. */</span>
<a name="l00332"></a>00332   <span class="keywordflow">if</span> (point == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334       access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a> = alist-&gt;<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a>;
<a name="l00335"></a>00335       alist-&gt;<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a>-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a> = access;
<a name="l00336"></a>00336       alist-&gt;<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> = access;
<a name="l00337"></a>00337       <span class="keywordflow">return</span> access;
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340   <span class="comment">/* In case of insertion is made at the head of access_list. */</span>
<a name="l00341"></a>00341   <span class="keywordflow">if</span> (point == alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>)
<a name="l00342"></a>00342     {
<a name="l00343"></a>00343       access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a> = alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>;
<a name="l00344"></a>00344       alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a> = access;
<a name="l00345"></a>00345       alist-&gt;<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> = access;
<a name="l00346"></a>00346       <span class="keywordflow">return</span> access;
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   <span class="comment">/* Insertion is made at middle of the access_list. */</span>
<a name="l00350"></a>00350   access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a> = point;
<a name="l00351"></a>00351   access-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a> = point-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353   <span class="keywordflow">if</span> (point-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>)
<a name="l00354"></a>00354     point-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a>-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a> = access;
<a name="l00355"></a>00355   point-&gt;<a class="code" href="structaccess__list.html#a985b2601f1921598c5d9613eea40f8e7">prev</a> = access;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357   <span class="keywordflow">return</span> access;
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="comment">/* Lookup access_list from list of access_list by name. */</span>
<a name="l00361"></a>00361 <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *
<a name="l00362"></a><a class="code" href="filter_8h.html#a161c25c66a35e168d6e182017295baeb">00362</a> <a class="code" href="filter_8c.html#a8cb65cd01015f6673c632cb5b8714b3e">access_list_lookup</a> (<a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="memory_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00363"></a>00363 {
<a name="l00364"></a>00364   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l00365"></a>00365   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="keywordflow">if</span> (name == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00368"></a>00368     <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (afi);
<a name="l00371"></a>00371   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00372"></a>00372     <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l00375"></a>00375     <span class="keywordflow">if</span> (strcmp (access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, name) == 0)
<a name="l00376"></a>00376       <span class="keywordflow">return</span> access;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l00379"></a>00379     <span class="keywordflow">if</span> (strcmp (access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, name) == 0)
<a name="l00380"></a>00380       <span class="keywordflow">return</span> access;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00383"></a>00383 }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 <span class="comment">/* Get access list from list of access_list.  If there isn&#39;t matched</span>
<a name="l00386"></a>00386 <span class="comment">   access_list create new one and return it. */</span>
<a name="l00387"></a>00387 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *
<a name="l00388"></a><a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">00388</a> <a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">access_list_get</a> (<a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="memory_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392   access = <a class="code" href="filter_8c.html#a8cb65cd01015f6673c632cb5b8714b3e">access_list_lookup</a> (afi, name);
<a name="l00393"></a>00393   <span class="keywordflow">if</span> (access == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00394"></a>00394     access = <a class="code" href="filter_8c.html#a49bc3b5a60f329093e73c26235e6003e">access_list_insert</a> (afi, name);
<a name="l00395"></a>00395   <span class="keywordflow">return</span> access;
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="comment">/* Apply access list to object (which should be struct prefix *). */</span>
<a name="l00399"></a>00399 <span class="keyword">enum</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72">filter_type</a>
<a name="l00400"></a><a class="code" href="filter_8h.html#a25a0db68fc9132687e2dc27c7164252d">00400</a> <a class="code" href="filter_8c.html#a5565f487c65e2bf0308c7fd529f121a0">access_list_apply</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access, <span class="keywordtype">void</span> *<span class="keywordtype">object</span>)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00403"></a>00403   <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405   p = (<span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> *) <span class="keywordtype">object</span>;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="keywordflow">if</span> (access == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00408"></a>00408     <span class="keywordflow">return</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a>;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="keywordflow">for</span> (filter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; filter; filter = filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l00411"></a>00411     {
<a name="l00412"></a>00412       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>)
<a name="l00413"></a>00413     {
<a name="l00414"></a>00414       <span class="keywordflow">if</span> (<a class="code" href="filter_8c.html#a2531a4c58cd3d379feef16ecf0a2c258">filter_match_cisco</a> (filter, p))
<a name="l00415"></a>00415         <span class="keywordflow">return</span> filter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>;
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417       <span class="keywordflow">else</span>
<a name="l00418"></a>00418     {
<a name="l00419"></a>00419       <span class="keywordflow">if</span> (<a class="code" href="filter_8c.html#a88f7da77072cccaf34adc4222cbc6467">filter_match_zebra</a> (filter, p))
<a name="l00420"></a>00420         <span class="keywordflow">return</span> filter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>;
<a name="l00421"></a>00421     }
<a name="l00422"></a>00422     }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <span class="keywordflow">return</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a>;
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427 <span class="comment">/* Add hook function. */</span>
<a name="l00428"></a>00428 <span class="keywordtype">void</span>
<a name="l00429"></a><a class="code" href="filter_8c.html#afc932e79e55881b9a1c1e700ec1e0cb4">00429</a> <a class="code" href="filter_8c.html#afc932e79e55881b9a1c1e700ec1e0cb4">access_list_add_hook</a> (<span class="keywordtype">void</span> (*<a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>) (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access))
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431   access_master_ipv4.<a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">add_hook</a> = <a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>;
<a name="l00432"></a>00432 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00433"></a>00433 <span class="preprocessor"></span>  access_master_ipv6.<a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">add_hook</a> = <a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>;
<a name="l00434"></a>00434 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="comment">/* Delete hook function. */</span>
<a name="l00438"></a>00438 <span class="keywordtype">void</span>
<a name="l00439"></a><a class="code" href="filter_8c.html#a7696ba96f8b2cf3a96dbfb2e161d6752">00439</a> <a class="code" href="filter_8c.html#a7696ba96f8b2cf3a96dbfb2e161d6752">access_list_delete_hook</a> (<span class="keywordtype">void</span> (*<a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>) (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access))
<a name="l00440"></a>00440 {
<a name="l00441"></a>00441   access_master_ipv4.<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a> = <a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>;
<a name="l00442"></a>00442 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00443"></a>00443 <span class="preprocessor"></span>  access_master_ipv6.<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a> = <a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>;
<a name="l00444"></a>00444 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">/* Add new filter to the end of specified access_list. */</span>
<a name="l00448"></a>00448 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00449"></a><a class="code" href="filter_8c.html#ade4acc9c0cd3ec2bd60194707bba6db5">00449</a> <a class="code" href="filter_8c.html#ade4acc9c0cd3ec2bd60194707bba6db5">access_list_filter_add</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>)
<a name="l00450"></a>00450 {
<a name="l00451"></a>00451   filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00452"></a>00452   filter-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a> = access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a>;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a>)
<a name="l00455"></a>00455     access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a>-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a> = filter;
<a name="l00456"></a>00456   <span class="keywordflow">else</span>
<a name="l00457"></a>00457     access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a> = filter;
<a name="l00458"></a>00458   access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a> = filter;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <span class="comment">/* Run hook function. */</span>
<a name="l00461"></a>00461   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>-&gt;<a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">add_hook</a>)
<a name="l00462"></a>00462     (*access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>-&gt;<a class="code" href="structaccess__master.html#a951a3357de564a73fa28b39f56f53a41">add_hook</a>) (access);
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">/* If access_list has no filter then return 1. */</span>
<a name="l00466"></a>00466 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00467"></a><a class="code" href="filter_8c.html#adfa6240de2422f1bb111d30225ec378a">00467</a> <a class="code" href="filter_8c.html#adfa6240de2422f1bb111d30225ec378a">access_list_empty</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access)
<a name="l00468"></a>00468 {
<a name="l00469"></a>00469   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00470"></a>00470     <span class="keywordflow">return</span> 1;
<a name="l00471"></a>00471   <span class="keywordflow">else</span>
<a name="l00472"></a>00472     <span class="keywordflow">return</span> 0;
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="comment">/* Delete filter from specified access_list.  If there is hook</span>
<a name="l00476"></a>00476 <span class="comment">   function execute it. */</span>
<a name="l00477"></a>00477 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00478"></a><a class="code" href="filter_8c.html#af4459176a49833a61a4c1a065b19e846">00478</a> <a class="code" href="filter_8c.html#af4459176a49833a61a4c1a065b19e846">access_list_filter_delete</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *<a class="code" href="structfilter.html">filter</a>)
<a name="l00479"></a>00479 {
<a name="l00480"></a>00480   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   master = access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l00485"></a>00485     filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a> = filter-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a>;
<a name="l00486"></a>00486   <span class="keywordflow">else</span>
<a name="l00487"></a>00487     access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a> = filter-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a>;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a>)
<a name="l00490"></a>00490     filter-&gt;<a class="code" href="structfilter.html#a6ae212392ba11628c6a51bbcaf92e82d">prev</a>-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a> = filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>;
<a name="l00491"></a>00491   <span class="keywordflow">else</span>
<a name="l00492"></a>00492     access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a> = filter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (filter);
<a name="l00495"></a>00495 
<a name="l00496"></a>00496   <span class="comment">/* If access_list becomes empty delete it from access_master. */</span>
<a name="l00497"></a>00497   <span class="keywordflow">if</span> (<a class="code" href="filter_8c.html#adfa6240de2422f1bb111d30225ec378a">access_list_empty</a> (access))
<a name="l00498"></a>00498     <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <span class="comment">/* Run hook function. */</span>
<a name="l00501"></a>00501   <span class="keywordflow">if</span> (master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>)
<a name="l00502"></a>00502     (*master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>) (access);
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 <span class="comment">/*</span>
<a name="l00506"></a>00506 <span class="comment">  deny    Specify packets to reject</span>
<a name="l00507"></a>00507 <span class="comment">  permit  Specify packets to forward</span>
<a name="l00508"></a>00508 <span class="comment">  dynamic ?</span>
<a name="l00509"></a>00509 <span class="comment">*/</span>
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="comment">/*</span>
<a name="l00512"></a>00512 <span class="comment">  Hostname or A.B.C.D  Address to match</span>
<a name="l00513"></a>00513 <span class="comment">  any                  Any source host</span>
<a name="l00514"></a>00514 <span class="comment">  host                 A single host address</span>
<a name="l00515"></a>00515 <span class="comment">*/</span>
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *
<a name="l00518"></a><a class="code" href="filter_8c.html#a28818469b9a725703694b6a1f58dd44d">00518</a> <a class="code" href="filter_8c.html#a28818469b9a725703694b6a1f58dd44d">filter_lookup_cisco</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *mnew)
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *mfilter;
<a name="l00521"></a>00521   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00522"></a>00522   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *<span class="keyword">new</span>;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524   <span class="keyword">new</span> = &amp;mnew-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526   <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l00527"></a>00527     {
<a name="l00528"></a>00528       filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>)
<a name="l00531"></a>00531     {
<a name="l00532"></a>00532       <span class="keywordflow">if</span> (mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> == mnew-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>
<a name="l00533"></a>00533           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>.s_addr == new-&gt;addr.s_addr
<a name="l00534"></a>00534           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == new-&gt;addr_mask.s_addr
<a name="l00535"></a>00535           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>.s_addr == new-&gt;mask.s_addr
<a name="l00536"></a>00536           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>.s_addr == new-&gt;mask_mask.s_addr)
<a name="l00537"></a>00537         <span class="keywordflow">return</span> mfilter;
<a name="l00538"></a>00538     }
<a name="l00539"></a>00539       <span class="keywordflow">else</span>
<a name="l00540"></a>00540     {
<a name="l00541"></a>00541       <span class="keywordflow">if</span> (mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> == mnew-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>
<a name="l00542"></a>00542           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>.s_addr == new-&gt;addr.s_addr
<a name="l00543"></a>00543           &amp;&amp; filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == new-&gt;addr_mask.s_addr)
<a name="l00544"></a>00544         <span class="keywordflow">return</span> mfilter;
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *
<a name="l00552"></a><a class="code" href="filter_8c.html#a61ce39bf3b3708c66d720afabd9dc3f8">00552</a> <a class="code" href="filter_8c.html#a61ce39bf3b3708c66d720afabd9dc3f8">filter_lookup_zebra</a> (<span class="keyword">struct</span> <a class="code" href="structaccess__list.html">access_list</a> *access, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *mnew)
<a name="l00553"></a>00553 {
<a name="l00554"></a>00554   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *mfilter;
<a name="l00555"></a>00555   <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00556"></a>00556   <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> *<span class="keyword">new</span>;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558   <span class="keyword">new</span> = &amp;mnew-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560   <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l00561"></a>00561     {
<a name="l00562"></a>00562       filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a> == new-&gt;exact
<a name="l00565"></a>00565       &amp;&amp; mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> == mnew-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a>
<a name="l00566"></a>00566       &amp;&amp; <a class="code" href="prefix_8c.html#ac3645297b5669182b5052aa7689712af">prefix_same</a> (&amp;filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>, &amp;new-&gt;<a class="code" href="structprefix.html#af508982a05429729278c96708bd9e337">prefix</a>))
<a name="l00567"></a>00567     <span class="keywordflow">return</span> mfilter;
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00570"></a>00570 }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00573"></a><a class="code" href="filter_8c.html#aec7ba906737503fed83711aeef13fab2">00573</a> <a class="code" href="filter_8c.html#aec7ba906737503fed83711aeef13fab2">vty_access_list_remark_unset</a> (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>, <a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="memory_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00574"></a>00574 {
<a name="l00575"></a>00575   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   access = <a class="code" href="filter_8c.html#a8cb65cd01015f6673c632cb5b8714b3e">access_list_lookup</a> (afi, name);
<a name="l00578"></a>00578   <span class="keywordflow">if</span> (! access)
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%% access-list %s doesn&#39;t exist%s&quot;</span>, name,
<a name="l00581"></a>00581            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00582"></a>00582       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l00586"></a>00586     {
<a name="l00587"></a>00587       <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba563963518edb70d4cd7492b06f48106e">MTYPE_TMP</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>);
<a name="l00588"></a>00588       access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; access-&gt;<a class="code" href="structaccess__list.html#a0dbbbeea53724cb69480bbc8a27375bb">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00592"></a>00592     <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00598"></a><a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">00598</a> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *name_str, <span class="keyword">const</span> <span class="keywordtype">char</span> *type_str,
<a name="l00599"></a>00599           <span class="keyword">const</span> <span class="keywordtype">char</span> *addr_str, <span class="keyword">const</span> <span class="keywordtype">char</span> *addr_mask_str,
<a name="l00600"></a>00600           <span class="keyword">const</span> <span class="keywordtype">char</span> *mask_str, <span class="keyword">const</span> <span class="keywordtype">char</span> *mask_mask_str,
<a name="l00601"></a>00601           <span class="keywordtype">int</span> extended, <span class="keywordtype">int</span> <span class="keyword">set</span>)
<a name="l00602"></a>00602 {
<a name="l00603"></a>00603   <span class="keywordtype">int</span> ret;
<a name="l00604"></a>00604   <span class="keyword">enum</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72">filter_type</a> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
<a name="l00605"></a>00605   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *mfilter;
<a name="l00606"></a>00606   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l00607"></a>00607   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l00608"></a>00608   <span class="keyword">struct </span>in_addr addr;
<a name="l00609"></a>00609   <span class="keyword">struct </span>in_addr addr_mask;
<a name="l00610"></a>00610   <span class="keyword">struct </span>in_addr mask;
<a name="l00611"></a>00611   <span class="keyword">struct </span>in_addr mask_mask;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   <span class="comment">/* Check of filter type. */</span>
<a name="l00614"></a>00614   <span class="keywordflow">if</span> (strncmp (type_str, <span class="stringliteral">&quot;p&quot;</span>, 1) == 0)
<a name="l00615"></a>00615     type = <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a68ef3d4c373520eb5b085236bf4eeef8">FILTER_PERMIT</a>;
<a name="l00616"></a>00616   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp (type_str, <span class="stringliteral">&quot;d&quot;</span>, 1) == 0)
<a name="l00617"></a>00617     type = <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a>;
<a name="l00618"></a>00618   <span class="keywordflow">else</span>
<a name="l00619"></a>00619     {
<a name="l00620"></a>00620       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%% filter type must be permit or deny%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00621"></a>00621       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624   ret = <a class="code" href="sockunion_8c.html#a4203367afaacee3fa5cc1626b2ef63c0">inet_aton</a> (addr_str, &amp;addr);
<a name="l00625"></a>00625   <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l00626"></a>00626     {
<a name="l00627"></a>00627       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%%Inconsistent address and mask%s&quot;</span>,
<a name="l00628"></a>00628            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00629"></a>00629       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631 
<a name="l00632"></a>00632   ret = <a class="code" href="sockunion_8c.html#a4203367afaacee3fa5cc1626b2ef63c0">inet_aton</a> (addr_mask_str, &amp;addr_mask);
<a name="l00633"></a>00633   <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l00634"></a>00634     {
<a name="l00635"></a>00635       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%%Inconsistent address and mask%s&quot;</span>,
<a name="l00636"></a>00636            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00637"></a>00637       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640   <span class="keywordflow">if</span> (extended)
<a name="l00641"></a>00641     {
<a name="l00642"></a>00642       ret = <a class="code" href="sockunion_8c.html#a4203367afaacee3fa5cc1626b2ef63c0">inet_aton</a> (mask_str, &amp;mask);
<a name="l00643"></a>00643       <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%%Inconsistent address and mask%s&quot;</span>,
<a name="l00646"></a>00646            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00647"></a>00647       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650       ret = <a class="code" href="sockunion_8c.html#a4203367afaacee3fa5cc1626b2ef63c0">inet_aton</a> (mask_mask_str, &amp;mask_mask);
<a name="l00651"></a>00651       <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l00652"></a>00652     {
<a name="l00653"></a>00653       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%%Inconsistent address and mask%s&quot;</span>,
<a name="l00654"></a>00654            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00655"></a>00655       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   mfilter = <a class="code" href="filter_8c.html#a86498922c0a46bc05abf665b86235ee2">filter_new</a>();
<a name="l00660"></a>00660   mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> = <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
<a name="l00661"></a>00661   mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a> = 1;
<a name="l00662"></a>00662   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l00663"></a>00663   filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a> = extended;
<a name="l00664"></a>00664   filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>.s_addr = addr.s_addr &amp; ~addr_mask.s_addr;
<a name="l00665"></a>00665   filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr = addr_mask.s_addr;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667   <span class="keywordflow">if</span> (extended)
<a name="l00668"></a>00668     {
<a name="l00669"></a>00669       filter-&gt;<a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>.s_addr = mask.s_addr &amp; ~mask_mask.s_addr;
<a name="l00670"></a>00670       filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>.s_addr = mask_mask.s_addr;
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="comment">/* Install new filter to the access_list. */</span>
<a name="l00674"></a>00674   access = <a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">access_list_get</a> (<a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, name_str);
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   <span class="keywordflow">if</span> (<span class="keyword">set</span>)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678       <span class="keywordflow">if</span> (<a class="code" href="filter_8c.html#a28818469b9a725703694b6a1f58dd44d">filter_lookup_cisco</a> (access, mfilter))
<a name="l00679"></a>00679     <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (mfilter);
<a name="l00680"></a>00680       <span class="keywordflow">else</span>
<a name="l00681"></a>00681     <a class="code" href="filter_8c.html#ade4acc9c0cd3ec2bd60194707bba6db5">access_list_filter_add</a> (access, mfilter);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683   <span class="keywordflow">else</span>
<a name="l00684"></a>00684     {
<a name="l00685"></a>00685       <span class="keyword">struct </span>filter *delete_filter;
<a name="l00686"></a>00686 
<a name="l00687"></a>00687       delete_filter = <a class="code" href="filter_8c.html#a28818469b9a725703694b6a1f58dd44d">filter_lookup_cisco</a> (access, mfilter);
<a name="l00688"></a>00688       <span class="keywordflow">if</span> (delete_filter)
<a name="l00689"></a>00689     <a class="code" href="filter_8c.html#af4459176a49833a61a4c1a065b19e846">access_list_filter_delete</a> (access, delete_filter);
<a name="l00690"></a>00690 
<a name="l00691"></a>00691       <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (mfilter);
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l00695"></a>00695 }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 <span class="comment">/* Standard access-list */</span>
<a name="l00698"></a><a class="code" href="filter_8c.html#afc94d8d549d329efc043eb0d8d237a6f">00698</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_standard,
<a name="l00699"></a>00699        access_list_standard_cmd,
<a name="l00700"></a>00700        <span class="stringliteral">&quot;access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) A.B.C.D A.B.C.D&quot;</span>,
<a name="l00701"></a>00701        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00702"></a>00702        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00703"></a>00703        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00704"></a>00704        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00705"></a>00705        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00706"></a>00706        <span class="stringliteral">&quot;Address to match\n&quot;</span>
<a name="l00707"></a>00707        <span class="stringliteral">&quot;Wildcard bits\n&quot;</span>)
<a name="l00708"></a>00708 {
<a name="l00709"></a>00709   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], argv[3],
<a name="l00710"></a>00710                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="filter_8c.html#aa5fbfc90ddaaf6669348e13895489930">00713</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_standard_nomask,
<a name="l00714"></a>00714        access_list_standard_nomask_cmd,
<a name="l00715"></a>00715        <span class="stringliteral">&quot;access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) A.B.C.D&quot;</span>,
<a name="l00716"></a>00716        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00717"></a>00717        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00718"></a>00718        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00719"></a>00719        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00720"></a>00720        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00721"></a>00721        <span class="stringliteral">&quot;Address to match\n&quot;</span>)
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00724"></a>00724                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);
<a name="l00725"></a>00725 }
<a name="l00726"></a>00726 
<a name="l00727"></a><a class="code" href="filter_8c.html#a654d5eb9be4cb11135448991357635e1">00727</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_standard_host,
<a name="l00728"></a>00728        access_list_standard_host_cmd,
<a name="l00729"></a>00729        <span class="stringliteral">&quot;access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) host A.B.C.D&quot;</span>,
<a name="l00730"></a>00730        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00731"></a>00731        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00732"></a>00732        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00733"></a>00733        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00734"></a>00734        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00735"></a>00735        <span class="stringliteral">&quot;A single host address\n&quot;</span>
<a name="l00736"></a>00736        <span class="stringliteral">&quot;Address to match\n&quot;</span>)
<a name="l00737"></a>00737 {
<a name="l00738"></a>00738   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00739"></a>00739                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a><a class="code" href="filter_8c.html#a15dbc44a8fe828819337bc3a6e052641">00742</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_standard_any,
<a name="l00743"></a>00743        access_list_standard_any_cmd,
<a name="l00744"></a>00744        <span class="stringliteral">&quot;access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) any&quot;</span>,
<a name="l00745"></a>00745        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00746"></a>00746        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00747"></a>00747        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00748"></a>00748        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00749"></a>00749        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00750"></a>00750        <span class="stringliteral">&quot;Any source host\n&quot;</span>)
<a name="l00751"></a>00751 {
<a name="l00752"></a>00752   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00753"></a>00753                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a><a class="code" href="filter_8c.html#a573d609d99e801c9847fa931bfe72cb4">00756</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_standard,
<a name="l00757"></a>00757        no_access_list_standard_cmd,
<a name="l00758"></a>00758        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) A.B.C.D A.B.C.D&quot;</span>,
<a name="l00759"></a>00759        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l00760"></a>00760        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00761"></a>00761        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00762"></a>00762        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00763"></a>00763        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00764"></a>00764        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00765"></a>00765        <span class="stringliteral">&quot;Address to match\n&quot;</span>
<a name="l00766"></a>00766        <span class="stringliteral">&quot;Wildcard bits\n&quot;</span>)
<a name="l00767"></a>00767 {
<a name="l00768"></a>00768   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], argv[3],
<a name="l00769"></a>00769                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00772"></a><a class="code" href="filter_8c.html#a4dd39f6af2cfa43340268dd6bdf9a822">00772</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_standard_nomask,
<a name="l00773"></a>00773        no_access_list_standard_nomask_cmd,
<a name="l00774"></a>00774        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) A.B.C.D&quot;</span>,
<a name="l00775"></a>00775        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l00776"></a>00776        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00777"></a>00777        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00778"></a>00778        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00779"></a>00779        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00780"></a>00780        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00781"></a>00781        <span class="stringliteral">&quot;Address to match\n&quot;</span>)
<a name="l00782"></a>00782 {
<a name="l00783"></a>00783   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00784"></a>00784                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a><a class="code" href="filter_8c.html#a1ab32f861acbc4e4d2eec52385b6771c">00787</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_standard_host,
<a name="l00788"></a>00788        no_access_list_standard_host_cmd,
<a name="l00789"></a>00789        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) host A.B.C.D&quot;</span>,
<a name="l00790"></a>00790        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l00791"></a>00791        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00792"></a>00792        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00793"></a>00793        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00794"></a>00794        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00795"></a>00795        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00796"></a>00796        <span class="stringliteral">&quot;A single host address\n&quot;</span>
<a name="l00797"></a>00797        <span class="stringliteral">&quot;Address to match\n&quot;</span>)
<a name="l00798"></a>00798 {
<a name="l00799"></a>00799   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00800"></a>00800                <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);
<a name="l00801"></a>00801 }
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="filter_8c.html#a09b6264490ec4058316f0278a354db51">00803</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_standard_any,
<a name="l00804"></a>00804        no_access_list_standard_any_cmd,
<a name="l00805"></a>00805        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;1300-1999&gt;) (deny|permit) any&quot;</span>,
<a name="l00806"></a>00806        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l00807"></a>00807        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00808"></a>00808        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l00809"></a>00809        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l00810"></a>00810        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00811"></a>00811        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00812"></a>00812        <span class="stringliteral">&quot;Any source host\n&quot;</span>)
<a name="l00813"></a>00813 {
<a name="l00814"></a>00814   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00815"></a>00815                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);
<a name="l00816"></a>00816 }
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 <span class="comment">/* Extended access-list */</span>
<a name="l00819"></a><a class="code" href="filter_8c.html#a33927efd0d7af7c8fd22455d2e035d9c">00819</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended,
<a name="l00820"></a>00820        access_list_extended_cmd,
<a name="l00821"></a>00821        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D A.B.C.D A.B.C.D&quot;</span>,
<a name="l00822"></a>00822        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00823"></a>00823        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00824"></a>00824        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00825"></a>00825        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00826"></a>00826        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00827"></a>00827        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00828"></a>00828        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00829"></a>00829        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l00830"></a>00830        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l00831"></a>00831        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00834"></a>00834                argv[3], argv[4], argv[5], 1 ,1);
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="filter_8c.html#a9bc692e951a246382f52af81e958c6ed">00837</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_mask_any,
<a name="l00838"></a>00838        access_list_extended_mask_any_cmd,
<a name="l00839"></a>00839        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D any&quot;</span>,
<a name="l00840"></a>00840        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00841"></a>00841        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00842"></a>00842        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00843"></a>00843        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00844"></a>00844        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00845"></a>00845        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00846"></a>00846        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00847"></a>00847        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l00848"></a>00848        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00851"></a>00851                argv[3], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00852"></a>00852                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 1);
<a name="l00853"></a>00853 }
<a name="l00854"></a>00854 
<a name="l00855"></a><a class="code" href="filter_8c.html#a399b4c707e761b9087f4530acd33c78c">00855</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_any_mask,
<a name="l00856"></a>00856        access_list_extended_any_mask_cmd,
<a name="l00857"></a>00857        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any A.B.C.D A.B.C.D&quot;</span>,
<a name="l00858"></a>00858        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00859"></a>00859        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00860"></a>00860        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00861"></a>00861        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00862"></a>00862        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00863"></a>00863        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00864"></a>00864        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l00865"></a>00865        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l00866"></a>00866        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l00867"></a>00867 {
<a name="l00868"></a>00868   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00869"></a>00869                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, argv[2],
<a name="l00870"></a>00870                argv[3], 1, 1);
<a name="l00871"></a>00871 }
<a name="l00872"></a>00872 
<a name="l00873"></a><a class="code" href="filter_8c.html#ae7fe0835357c8cefd7f1a76cb0b310e4">00873</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_any_any,
<a name="l00874"></a>00874        access_list_extended_any_any_cmd,
<a name="l00875"></a>00875        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any any&quot;</span>,
<a name="l00876"></a>00876        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00877"></a>00877        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00878"></a>00878        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00879"></a>00879        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00880"></a>00880        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00881"></a>00881        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00882"></a>00882        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l00883"></a>00883        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l00884"></a>00884 {
<a name="l00885"></a>00885   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00886"></a>00886                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00887"></a>00887                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 1);
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a><a class="code" href="filter_8c.html#a426a7bfe8da45ebfbc592cb696cbf572">00890</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_mask_host,
<a name="l00891"></a>00891        access_list_extended_mask_host_cmd,
<a name="l00892"></a>00892        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D host A.B.C.D&quot;</span>,
<a name="l00893"></a>00893        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00894"></a>00894        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00895"></a>00895        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00896"></a>00896        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00897"></a>00897        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00898"></a>00898        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00899"></a>00899        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00900"></a>00900        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l00901"></a>00901        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l00902"></a>00902        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l00903"></a>00903 {
<a name="l00904"></a>00904   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00905"></a>00905                argv[3], argv[4],
<a name="l00906"></a>00906                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 1);
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="filter_8c.html#ac9d115f20dd666b3c578f2af2896f7bb">00909</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_host_mask,
<a name="l00910"></a>00910        access_list_extended_host_mask_cmd,
<a name="l00911"></a>00911        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D A.B.C.D A.B.C.D&quot;</span>,
<a name="l00912"></a>00912        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00913"></a>00913        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00914"></a>00914        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00915"></a>00915        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00916"></a>00916        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00917"></a>00917        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00918"></a>00918        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l00919"></a>00919        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00920"></a>00920        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l00921"></a>00921        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l00922"></a>00922 {
<a name="l00923"></a>00923   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00924"></a>00924                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, argv[3],
<a name="l00925"></a>00925                argv[4], 1, 1);
<a name="l00926"></a>00926 }
<a name="l00927"></a>00927 
<a name="l00928"></a><a class="code" href="filter_8c.html#a44a1a6b5496b1beb31d0b6a71515406e">00928</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_host_host,
<a name="l00929"></a>00929        access_list_extended_host_host_cmd,
<a name="l00930"></a>00930        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D host A.B.C.D&quot;</span>,
<a name="l00931"></a>00931        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00932"></a>00932        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00933"></a>00933        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00934"></a>00934        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00935"></a>00935        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00936"></a>00936        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00937"></a>00937        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l00938"></a>00938        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00939"></a>00939        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l00940"></a>00940        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l00941"></a>00941 {
<a name="l00942"></a>00942   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00943"></a>00943                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, argv[3],
<a name="l00944"></a>00944                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 1);
<a name="l00945"></a>00945 }
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="filter_8c.html#a4f5cdd19aa355f5887ed8be4b8f2b16b">00947</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_any_host,
<a name="l00948"></a>00948        access_list_extended_any_host_cmd,
<a name="l00949"></a>00949        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any host A.B.C.D&quot;</span>,
<a name="l00950"></a>00950        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00951"></a>00951        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00952"></a>00952        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00953"></a>00953        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00954"></a>00954        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00955"></a>00955        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00956"></a>00956        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l00957"></a>00957        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l00958"></a>00958        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00961"></a>00961                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, argv[2],
<a name="l00962"></a>00962                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 1);
<a name="l00963"></a>00963 }
<a name="l00964"></a>00964 
<a name="l00965"></a><a class="code" href="filter_8c.html#a853282dbcff2f16886b620fe439af65a">00965</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_extended_host_any,
<a name="l00966"></a>00966        access_list_extended_host_any_cmd,
<a name="l00967"></a>00967        <span class="stringliteral">&quot;access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D any&quot;</span>,
<a name="l00968"></a>00968        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00969"></a>00969        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00970"></a>00970        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00971"></a>00971        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00972"></a>00972        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00973"></a>00973        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00974"></a>00974        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l00975"></a>00975        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00976"></a>00976        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00979"></a>00979                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l00980"></a>00980                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 1);
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a><a class="code" href="filter_8c.html#a39fec9ae7cff5d977863625c20bc3dca">00983</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended,
<a name="l00984"></a>00984        no_access_list_extended_cmd,
<a name="l00985"></a>00985        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D A.B.C.D A.B.C.D&quot;</span>,
<a name="l00986"></a>00986        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l00987"></a>00987        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l00988"></a>00988        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l00989"></a>00989        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l00990"></a>00990        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l00991"></a>00991        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l00992"></a>00992        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l00993"></a>00993        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l00994"></a>00994        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l00995"></a>00995        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l00996"></a>00996        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l00997"></a>00997 {
<a name="l00998"></a>00998   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l00999"></a>00999                argv[3], argv[4], argv[5], 1, 0);
<a name="l01000"></a>01000 }
<a name="l01001"></a>01001 
<a name="l01002"></a><a class="code" href="filter_8c.html#ac0c3191fd50df9a1d03ebe6b85fdcfcc">01002</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_mask_any,
<a name="l01003"></a>01003        no_access_list_extended_mask_any_cmd,
<a name="l01004"></a>01004        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D any&quot;</span>,
<a name="l01005"></a>01005        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01006"></a>01006        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01007"></a>01007        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01008"></a>01008        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01009"></a>01009        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01010"></a>01010        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01011"></a>01011        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01012"></a>01012        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l01013"></a>01013        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l01014"></a>01014        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l01017"></a>01017                argv[3], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01018"></a>01018                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 0);
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a><a class="code" href="filter_8c.html#a4ded6a1f7e48a88ebba3cb8883070b4c">01021</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_any_mask,
<a name="l01022"></a>01022        no_access_list_extended_any_mask_cmd,
<a name="l01023"></a>01023        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any A.B.C.D A.B.C.D&quot;</span>,
<a name="l01024"></a>01024        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01025"></a>01025        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01026"></a>01026        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01027"></a>01027        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01028"></a>01028        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01029"></a>01029        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01030"></a>01030        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01031"></a>01031        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l01032"></a>01032        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l01033"></a>01033        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01036"></a>01036                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, argv[2],
<a name="l01037"></a>01037                argv[3], 1, 0);
<a name="l01038"></a>01038 }
<a name="l01039"></a>01039 
<a name="l01040"></a><a class="code" href="filter_8c.html#a5df92ee99327f85e07e15d8656154263">01040</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_any_any,
<a name="l01041"></a>01041        no_access_list_extended_any_any_cmd,
<a name="l01042"></a>01042        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any any&quot;</span>,
<a name="l01043"></a>01043        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01044"></a>01044        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01045"></a>01045        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01046"></a>01046        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01047"></a>01047        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01048"></a>01048        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01049"></a>01049        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01050"></a>01050        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l01051"></a>01051        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l01052"></a>01052 {
<a name="l01053"></a>01053   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01054"></a>01054                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01055"></a>01055                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 0);
<a name="l01056"></a>01056 }
<a name="l01057"></a>01057 
<a name="l01058"></a><a class="code" href="filter_8c.html#a3aee18152db82dc37c3b9174f6c1acbc">01058</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_mask_host,
<a name="l01059"></a>01059        no_access_list_extended_mask_host_cmd,
<a name="l01060"></a>01060        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip A.B.C.D A.B.C.D host A.B.C.D&quot;</span>,
<a name="l01061"></a>01061        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01062"></a>01062        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01063"></a>01063        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01064"></a>01064        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01065"></a>01065        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01066"></a>01066        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01067"></a>01067        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01068"></a>01068        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l01069"></a>01069        <span class="stringliteral">&quot;Source wildcard bits\n&quot;</span>
<a name="l01070"></a>01070        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l01071"></a>01071        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l01072"></a>01072 {
<a name="l01073"></a>01073   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l01074"></a>01074                argv[3], argv[4],
<a name="l01075"></a>01075                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 0);
<a name="l01076"></a>01076 }
<a name="l01077"></a>01077 
<a name="l01078"></a><a class="code" href="filter_8c.html#a6f643fb5cdf65762168c03d55b15b53e">01078</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_host_mask,
<a name="l01079"></a>01079        no_access_list_extended_host_mask_cmd,
<a name="l01080"></a>01080        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D A.B.C.D A.B.C.D&quot;</span>,
<a name="l01081"></a>01081        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01082"></a>01082        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01083"></a>01083        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01084"></a>01084        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01085"></a>01085        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01086"></a>01086        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01087"></a>01087        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01088"></a>01088        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l01089"></a>01089        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l01090"></a>01090        <span class="stringliteral">&quot;Destination address\n&quot;</span>
<a name="l01091"></a>01091        <span class="stringliteral">&quot;Destination Wildcard bits\n&quot;</span>)
<a name="l01092"></a>01092 {
<a name="l01093"></a>01093   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l01094"></a>01094                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, argv[3],
<a name="l01095"></a>01095                argv[4], 1, 0);
<a name="l01096"></a>01096 }
<a name="l01097"></a>01097 
<a name="l01098"></a><a class="code" href="filter_8c.html#a9d72b7c213775f3b0cd13e06fd401c5d">01098</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_host_host,
<a name="l01099"></a>01099        no_access_list_extended_host_host_cmd,
<a name="l01100"></a>01100        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D host A.B.C.D&quot;</span>,
<a name="l01101"></a>01101        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01102"></a>01102        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01103"></a>01103        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01104"></a>01104        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01105"></a>01105        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01106"></a>01106        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01107"></a>01107        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01108"></a>01108        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l01109"></a>01109        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l01110"></a>01110        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l01111"></a>01111        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l01112"></a>01112 {
<a name="l01113"></a>01113   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l01114"></a>01114                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, argv[3],
<a name="l01115"></a>01115                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 0);
<a name="l01116"></a>01116 }
<a name="l01117"></a>01117 
<a name="l01118"></a><a class="code" href="filter_8c.html#a325d9e37a11ec5d28d6b7e4450bd6505">01118</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_any_host,
<a name="l01119"></a>01119        no_access_list_extended_any_host_cmd,
<a name="l01120"></a>01120        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip any host A.B.C.D&quot;</span>,
<a name="l01121"></a>01121        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01122"></a>01122        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01123"></a>01123        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01124"></a>01124        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01125"></a>01125        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01126"></a>01126        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01127"></a>01127        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01128"></a>01128        <span class="stringliteral">&quot;Any source host\n&quot;</span>
<a name="l01129"></a>01129        <span class="stringliteral">&quot;A single destination host\n&quot;</span>
<a name="l01130"></a>01130        <span class="stringliteral">&quot;Destination address\n&quot;</span>)
<a name="l01131"></a>01131 {
<a name="l01132"></a>01132   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01133"></a>01133                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, argv[2],
<a name="l01134"></a>01134                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 1, 0);
<a name="l01135"></a>01135 }
<a name="l01136"></a>01136 
<a name="l01137"></a><a class="code" href="filter_8c.html#ae952b7ab0d1a73ea2d4e8de575c06626">01137</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_extended_host_any,
<a name="l01138"></a>01138        no_access_list_extended_host_any_cmd,
<a name="l01139"></a>01139        <span class="stringliteral">&quot;no access-list (&lt;100-199&gt;|&lt;2000-2699&gt;) (deny|permit) ip host A.B.C.D any&quot;</span>,
<a name="l01140"></a>01140        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01141"></a>01141        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01142"></a>01142        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01143"></a>01143        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01144"></a>01144        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01145"></a>01145        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01146"></a>01146        <span class="stringliteral">&quot;Any Internet Protocol\n&quot;</span>
<a name="l01147"></a>01147        <span class="stringliteral">&quot;A single source host\n&quot;</span>
<a name="l01148"></a>01148        <span class="stringliteral">&quot;Source address\n&quot;</span>
<a name="l01149"></a>01149        <span class="stringliteral">&quot;Any destination host\n&quot;</span>)
<a name="l01150"></a>01150 {
<a name="l01151"></a>01151   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#abe4546a41fdce3480818f6ef4b112a2d">filter_set_cisco</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], argv[2],
<a name="l01152"></a>01152                <span class="stringliteral">&quot;0.0.0.0&quot;</span>, <span class="stringliteral">&quot;0.0.0.0&quot;</span>,
<a name="l01153"></a>01153                <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 1, 0);
<a name="l01154"></a>01154 }
<a name="l01155"></a>01155 
<a name="l01156"></a>01156 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01157"></a><a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">01157</a> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *name_str, <span class="keyword">const</span> <span class="keywordtype">char</span> *type_str,
<a name="l01158"></a>01158           <a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_str, <span class="keywordtype">int</span> exact, <span class="keywordtype">int</span> <span class="keyword">set</span>)
<a name="l01159"></a>01159 {
<a name="l01160"></a>01160   <span class="keywordtype">int</span> ret;
<a name="l01161"></a>01161   <span class="keyword">enum</span> <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72">filter_type</a> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
<a name="l01162"></a>01162   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *mfilter;
<a name="l01163"></a>01163   <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l01164"></a>01164   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01165"></a>01165   <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> p;
<a name="l01166"></a>01166 
<a name="l01167"></a>01167   <span class="comment">/* Check of filter type. */</span>
<a name="l01168"></a>01168   <span class="keywordflow">if</span> (strncmp (type_str, <span class="stringliteral">&quot;p&quot;</span>, 1) == 0)
<a name="l01169"></a>01169     type = <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a68ef3d4c373520eb5b085236bf4eeef8">FILTER_PERMIT</a>;
<a name="l01170"></a>01170   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp (type_str, <span class="stringliteral">&quot;d&quot;</span>, 1) == 0)
<a name="l01171"></a>01171     type = <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a>;
<a name="l01172"></a>01172   <span class="keywordflow">else</span>
<a name="l01173"></a>01173     {
<a name="l01174"></a>01174       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;filter type must be [permit|deny]%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01175"></a>01175       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01176"></a>01176     }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178   <span class="comment">/* Check string format of prefix and prefixlen. */</span>
<a name="l01179"></a>01179   <span class="keywordflow">if</span> (afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>)
<a name="l01180"></a>01180     {
<a name="l01181"></a>01181       ret = <a class="code" href="prefix_8c.html#aae422250092661b36915d1769df957f7">str2prefix_ipv4</a> (prefix_str, (<span class="keyword">struct</span> <a class="code" href="structprefix__ipv4.html">prefix_ipv4</a> *)&amp;p);
<a name="l01182"></a>01182       <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l01183"></a>01183     {
<a name="l01184"></a>01184       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;IP address prefix/prefixlen is malformed%s&quot;</span>,
<a name="l01185"></a>01185            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01186"></a>01186       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01187"></a>01187     }
<a name="l01188"></a>01188     }
<a name="l01189"></a>01189 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l01190"></a>01190 <span class="preprocessor"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (afi == <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>)
<a name="l01191"></a>01191     {
<a name="l01192"></a>01192       ret = str2prefix_ipv6 (prefix_str, (<span class="keyword">struct</span> prefix_ipv6 *) &amp;p);
<a name="l01193"></a>01193       <span class="keywordflow">if</span> (ret &lt;= 0)
<a name="l01194"></a>01194     {
<a name="l01195"></a>01195       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;IPv6 address prefix/prefixlen is malformed%s&quot;</span>,
<a name="l01196"></a>01196            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01197"></a>01197            <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01198"></a>01198     }
<a name="l01199"></a>01199     }
<a name="l01200"></a>01200 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l01201"></a>01201   <span class="keywordflow">else</span>
<a name="l01202"></a>01202     <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01203"></a>01203 
<a name="l01204"></a>01204   mfilter = <a class="code" href="filter_8c.html#a86498922c0a46bc05abf665b86235ee2">filter_new</a> ();
<a name="l01205"></a>01205   mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> = <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
<a name="l01206"></a>01206   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l01207"></a>01207   <a class="code" href="prefix_8c.html#abaad44d47b408d45484fdd729ab501b2">prefix_copy</a> (&amp;filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>, &amp;p);
<a name="l01208"></a>01208 
<a name="l01209"></a>01209   <span class="comment">/* &quot;exact-match&quot; */</span>
<a name="l01210"></a>01210   <span class="keywordflow">if</span> (exact)
<a name="l01211"></a>01211     filter-&gt;<a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a> = 1;
<a name="l01212"></a>01212 
<a name="l01213"></a>01213   <span class="comment">/* Install new filter to the access_list. */</span>
<a name="l01214"></a>01214   access = <a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">access_list_get</a> (afi, name_str);
<a name="l01215"></a>01215 
<a name="l01216"></a>01216   <span class="keywordflow">if</span> (<span class="keyword">set</span>)
<a name="l01217"></a>01217     {
<a name="l01218"></a>01218       <span class="keywordflow">if</span> (<a class="code" href="filter_8c.html#a61ce39bf3b3708c66d720afabd9dc3f8">filter_lookup_zebra</a> (access, mfilter))
<a name="l01219"></a>01219     <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (mfilter);
<a name="l01220"></a>01220       <span class="keywordflow">else</span>
<a name="l01221"></a>01221     <a class="code" href="filter_8c.html#ade4acc9c0cd3ec2bd60194707bba6db5">access_list_filter_add</a> (access, mfilter);
<a name="l01222"></a>01222     }
<a name="l01223"></a>01223   <span class="keywordflow">else</span>
<a name="l01224"></a>01224     {
<a name="l01225"></a>01225       <span class="keyword">struct </span>filter *delete_filter;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227       delete_filter = <a class="code" href="filter_8c.html#a61ce39bf3b3708c66d720afabd9dc3f8">filter_lookup_zebra</a> (access, mfilter);
<a name="l01228"></a>01228       <span class="keywordflow">if</span> (delete_filter)
<a name="l01229"></a>01229         <a class="code" href="filter_8c.html#af4459176a49833a61a4c1a065b19e846">access_list_filter_delete</a> (access, delete_filter);
<a name="l01230"></a>01230 
<a name="l01231"></a>01231       <a class="code" href="filter_8c.html#a17589ad1b9b97bda847749a84e2c5803">filter_free</a> (mfilter);
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01235"></a>01235 }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <span class="comment">/* Zebra access-list */</span>
<a name="l01238"></a><a class="code" href="filter_8c.html#a7372657ad9f65178f1c0524e5f507ac7">01238</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (<a class="code" href="structaccess__list.html">access_list</a>,
<a name="l01239"></a>01239        access_list_cmd,
<a name="l01240"></a>01240        <span class="stringliteral">&quot;access-list WORD (deny|permit) A.B.C.D/M&quot;</span>,
<a name="l01241"></a>01241        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01242"></a>01242        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01243"></a>01243        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01244"></a>01244        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01245"></a>01245        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>)
<a name="l01246"></a>01246 {
<a name="l01247"></a>01247   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[2], 0, 1);
<a name="l01248"></a>01248 }
<a name="l01249"></a>01249 
<a name="l01250"></a><a class="code" href="filter_8c.html#a6f95a054dbff3cbdc7667f99b3caecd7">01250</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_exact,
<a name="l01251"></a>01251        access_list_exact_cmd,
<a name="l01252"></a>01252        <span class="stringliteral">&quot;access-list WORD (deny|permit) A.B.C.D/M exact-match&quot;</span>,
<a name="l01253"></a>01253        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01254"></a>01254        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01255"></a>01255        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01256"></a>01256        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01257"></a>01257        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>
<a name="l01258"></a>01258        <span class="stringliteral">&quot;Exact match of the prefixes\n&quot;</span>)
<a name="l01259"></a>01259 {
<a name="l01260"></a>01260   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[2], 1, 1);
<a name="l01261"></a>01261 }
<a name="l01262"></a>01262 
<a name="l01263"></a><a class="code" href="filter_8c.html#a4e6c8a715ff53a41fbf1e5f2073c5dc9">01263</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_any,
<a name="l01264"></a>01264        access_list_any_cmd,
<a name="l01265"></a>01265        <span class="stringliteral">&quot;access-list WORD (deny|permit) any&quot;</span>,
<a name="l01266"></a>01266        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01267"></a>01267        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01268"></a>01268        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01269"></a>01269        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01270"></a>01270        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>)
<a name="l01271"></a>01271 {
<a name="l01272"></a>01272   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, <span class="stringliteral">&quot;0.0.0.0/0&quot;</span>, 0, 1);
<a name="l01273"></a>01273 }
<a name="l01274"></a>01274 
<a name="l01275"></a><a class="code" href="filter_8c.html#ab008fa306bfbfcde5e52b57ec9c4acb1">01275</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list,
<a name="l01276"></a>01276        no_access_list_cmd,
<a name="l01277"></a>01277        <span class="stringliteral">&quot;no access-list WORD (deny|permit) A.B.C.D/M&quot;</span>,
<a name="l01278"></a>01278        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01279"></a>01279        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01280"></a>01280        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01281"></a>01281        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01282"></a>01282        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01283"></a>01283        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>)
<a name="l01284"></a>01284 {
<a name="l01285"></a>01285   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[2], 0, 0);
<a name="l01286"></a>01286 }
<a name="l01287"></a>01287 
<a name="l01288"></a><a class="code" href="filter_8c.html#a1bed0e9875c14b2ceeb2e57d343c0bb6">01288</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_exact,
<a name="l01289"></a>01289        no_access_list_exact_cmd,
<a name="l01290"></a>01290        <span class="stringliteral">&quot;no access-list WORD (deny|permit) A.B.C.D/M exact-match&quot;</span>,
<a name="l01291"></a>01291        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01292"></a>01292        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01293"></a>01293        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01294"></a>01294        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01295"></a>01295        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01296"></a>01296        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>
<a name="l01297"></a>01297        <span class="stringliteral">&quot;Exact match of the prefixes\n&quot;</span>)
<a name="l01298"></a>01298 {
<a name="l01299"></a>01299   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[2], 1, 0);
<a name="l01300"></a>01300 }
<a name="l01301"></a>01301 
<a name="l01302"></a><a class="code" href="filter_8c.html#a2545341b9a834a2e44782e9f08c9cd7a">01302</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_any,
<a name="l01303"></a>01303        no_access_list_any_cmd,
<a name="l01304"></a>01304        <span class="stringliteral">&quot;no access-list WORD (deny|permit) any&quot;</span>,
<a name="l01305"></a>01305        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01306"></a>01306        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01307"></a>01307        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>
<a name="l01308"></a>01308        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01309"></a>01309        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01310"></a>01310        <span class="stringliteral">&quot;Prefix to match. e.g. 10.0.0.0/8\n&quot;</span>)
<a name="l01311"></a>01311 {
<a name="l01312"></a>01312   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, <span class="stringliteral">&quot;0.0.0.0/0&quot;</span>, 0, 0);
<a name="l01313"></a>01313 }
<a name="l01314"></a>01314 
<a name="l01315"></a><a class="code" href="filter_8c.html#a002d1c7ff1e7dcae88eab81314ac6b70">01315</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_all,
<a name="l01316"></a>01316        no_access_list_all_cmd,
<a name="l01317"></a>01317        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;100-199&gt;|&lt;1300-1999&gt;|&lt;2000-2699&gt;|WORD)&quot;</span>,
<a name="l01318"></a>01318        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01319"></a>01319        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01320"></a>01320        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l01321"></a>01321        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01322"></a>01322        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l01323"></a>01323        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01324"></a>01324        <span class="stringliteral">&quot;IP zebra access-list name\n&quot;</span>)
<a name="l01325"></a>01325 {
<a name="l01326"></a>01326   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01327"></a>01327   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01328"></a>01328 
<a name="l01329"></a>01329   <span class="comment">/* Looking up access_list. */</span>
<a name="l01330"></a>01330   access = <a class="code" href="filter_8c.html#a8cb65cd01015f6673c632cb5b8714b3e">access_list_lookup</a> (<a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[0]);
<a name="l01331"></a>01331   <span class="keywordflow">if</span> (access == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01332"></a>01332     {
<a name="l01333"></a>01333       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;%% access-list %s doesn&#39;t exist%s&quot;</span>, argv[0],
<a name="l01334"></a>01334            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01335"></a>01335       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01336"></a>01336     }
<a name="l01337"></a>01337 
<a name="l01338"></a>01338   master = access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>;
<a name="l01339"></a>01339 
<a name="l01340"></a>01340   <span class="comment">/* Delete all filter from access-list. */</span>
<a name="l01341"></a>01341   <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01342"></a>01342 
<a name="l01343"></a>01343   <span class="comment">/* Run hook function. */</span>
<a name="l01344"></a>01344   <span class="keywordflow">if</span> (master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>)
<a name="l01345"></a>01345     (*master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>) (access);
<a name="l01346"></a>01346  
<a name="l01347"></a>01347   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01348"></a>01348 }
<a name="l01349"></a>01349 
<a name="l01350"></a><a class="code" href="filter_8c.html#ac212f50b89c63037d1acaee0f0c1ac7e">01350</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (access_list_remark,
<a name="l01351"></a>01351        access_list_remark_cmd,
<a name="l01352"></a>01352        <span class="stringliteral">&quot;access-list (&lt;1-99&gt;|&lt;100-199&gt;|&lt;1300-1999&gt;|&lt;2000-2699&gt;|WORD) remark .LINE&quot;</span>,
<a name="l01353"></a>01353        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01354"></a>01354        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l01355"></a>01355        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01356"></a>01356        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l01357"></a>01357        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01358"></a>01358        <span class="stringliteral">&quot;IP zebra access-list\n&quot;</span>
<a name="l01359"></a>01359        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>
<a name="l01360"></a>01360        <span class="stringliteral">&quot;Comment up to 100 characters\n&quot;</span>)
<a name="l01361"></a>01361 {
<a name="l01362"></a>01362   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01363"></a>01363 
<a name="l01364"></a>01364   access = <a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">access_list_get</a> (<a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[0]);
<a name="l01365"></a>01365 
<a name="l01366"></a>01366   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l01367"></a>01367     {
<a name="l01368"></a>01368       <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba563963518edb70d4cd7492b06f48106e">MTYPE_TMP</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>);
<a name="l01369"></a>01369       access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01370"></a>01370     }
<a name="l01371"></a>01371   access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> = <a class="code" href="command_8c.html#a262c4f7766ffb060fe8b5012d58367a2">argv_concat</a>(argv, argc, 1);
<a name="l01372"></a>01372 
<a name="l01373"></a>01373   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01374"></a>01374 }
<a name="l01375"></a>01375 
<a name="l01376"></a><a class="code" href="filter_8c.html#ab374ee3db7632a69e0af0a5dac90d656">01376</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_access_list_remark,
<a name="l01377"></a>01377        no_access_list_remark_cmd,
<a name="l01378"></a>01378        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;100-199&gt;|&lt;1300-1999&gt;|&lt;2000-2699&gt;|WORD) remark&quot;</span>,
<a name="l01379"></a>01379        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01380"></a>01380        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01381"></a>01381        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l01382"></a>01382        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01383"></a>01383        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l01384"></a>01384        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01385"></a>01385        <span class="stringliteral">&quot;IP zebra access-list\n&quot;</span>
<a name="l01386"></a>01386        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>)
<a name="l01387"></a>01387 {
<a name="l01388"></a>01388   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#aec7ba906737503fed83711aeef13fab2">vty_access_list_remark_unset</a> (<a class="code" href="structvty.html">vty</a>, <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>, argv[0]);
<a name="l01389"></a>01389 }
<a name="l01390"></a>01390     
<a name="l01391"></a><a class="code" href="filter_8c.html#a86a0971f769b72802971659830eb6708">01391</a> <a class="code" href="command_8h.html#a7a8f1df2b731617ea7ada9ba5cbdb704">ALIAS</a> (no_access_list_remark,
<a name="l01392"></a>01392        no_access_list_remark_arg_cmd,
<a name="l01393"></a>01393        <span class="stringliteral">&quot;no access-list (&lt;1-99&gt;|&lt;100-199&gt;|&lt;1300-1999&gt;|&lt;2000-2699&gt;|WORD) remark .LINE&quot;</span>,
<a name="l01394"></a>01394        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01395"></a>01395        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01396"></a>01396        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l01397"></a>01397        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01398"></a>01398        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l01399"></a>01399        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01400"></a>01400        <span class="stringliteral">&quot;IP zebra access-list\n&quot;</span>
<a name="l01401"></a>01401        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>
<a name="l01402"></a>01402        <span class="stringliteral">&quot;Comment up to 100 characters\n&quot;</span>)
<a name="l01403"></a>01403 
<a name="l01404"></a>01404 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l01405"></a>01405 <span class="preprocessor"></span><a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (ipv6_access_list,
<a name="l01406"></a>01406        ipv6_access_list_cmd,
<a name="l01407"></a>01407        <span class="stringliteral">&quot;ipv6 access-list WORD (deny|permit) X:X::X:X/M&quot;</span>,
<a name="l01408"></a>01408        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01409"></a>01409        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01410"></a>01410        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01411"></a>01411        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01412"></a>01412        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01413"></a>01413        <span class="stringliteral">&quot;Prefix to match. e.g. 3ffe:506::/32\n&quot;</span>)
<a name="l01414"></a>01414 {
<a name="l01415"></a>01415   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[2], 0, 1);
<a name="l01416"></a>01416 }
<a name="l01417"></a>01417 
<a name="l01418"></a>01418 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (ipv6_access_list_exact,
<a name="l01419"></a>01419        ipv6_access_list_exact_cmd,
<a name="l01420"></a>01420        <span class="stringliteral">&quot;ipv6 access-list WORD (deny|permit) X:X::X:X/M exact-match&quot;</span>,
<a name="l01421"></a>01421        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01422"></a>01422        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01423"></a>01423        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01424"></a>01424        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01425"></a>01425        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01426"></a>01426        <span class="stringliteral">&quot;Prefix to match. e.g. 3ffe:506::/32\n&quot;</span>
<a name="l01427"></a>01427        <span class="stringliteral">&quot;Exact match of the prefixes\n&quot;</span>)
<a name="l01428"></a>01428 {
<a name="l01429"></a>01429   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[2], 1, 1);
<a name="l01430"></a>01430 }
<a name="l01431"></a>01431 
<a name="l01432"></a>01432 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (ipv6_access_list_any,
<a name="l01433"></a>01433        ipv6_access_list_any_cmd,
<a name="l01434"></a>01434        <span class="stringliteral">&quot;ipv6 access-list WORD (deny|permit) any&quot;</span>,
<a name="l01435"></a>01435        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01436"></a>01436        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01437"></a>01437        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01438"></a>01438        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01439"></a>01439        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01440"></a>01440        <span class="stringliteral">&quot;Any prefixi to match\n&quot;</span>)
<a name="l01441"></a>01441 {
<a name="l01442"></a>01442   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, <span class="stringliteral">&quot;::/0&quot;</span>, 0, 1);
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a>01445 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_ipv6_access_list,
<a name="l01446"></a>01446        no_ipv6_access_list_cmd,
<a name="l01447"></a>01447        <span class="stringliteral">&quot;no ipv6 access-list WORD (deny|permit) X:X::X:X/M&quot;</span>,
<a name="l01448"></a>01448        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01449"></a>01449        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01450"></a>01450        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01451"></a>01451        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01452"></a>01452        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01453"></a>01453        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01454"></a>01454        <span class="stringliteral">&quot;Prefix to match. e.g. 3ffe:506::/32\n&quot;</span>)
<a name="l01455"></a>01455 {
<a name="l01456"></a>01456   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[2], 0, 0);
<a name="l01457"></a>01457 }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_ipv6_access_list_exact,
<a name="l01460"></a>01460        no_ipv6_access_list_exact_cmd,
<a name="l01461"></a>01461        <span class="stringliteral">&quot;no ipv6 access-list WORD (deny|permit) X:X::X:X/M exact-match&quot;</span>,
<a name="l01462"></a>01462        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01463"></a>01463        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01464"></a>01464        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01465"></a>01465        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01466"></a>01466        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01467"></a>01467        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01468"></a>01468        <span class="stringliteral">&quot;Prefix to match. e.g. 3ffe:506::/32\n&quot;</span>
<a name="l01469"></a>01469        <span class="stringliteral">&quot;Exact match of the prefixes\n&quot;</span>)
<a name="l01470"></a>01470 {
<a name="l01471"></a>01471   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[2], 1, 0);
<a name="l01472"></a>01472 }
<a name="l01473"></a>01473 
<a name="l01474"></a>01474 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_ipv6_access_list_any,
<a name="l01475"></a>01475        no_ipv6_access_list_any_cmd,
<a name="l01476"></a>01476        <span class="stringliteral">&quot;no ipv6 access-list WORD (deny|permit) any&quot;</span>,
<a name="l01477"></a>01477        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01478"></a>01478        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01479"></a>01479        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01480"></a>01480        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01481"></a>01481        <span class="stringliteral">&quot;Specify packets to reject\n&quot;</span>
<a name="l01482"></a>01482        <span class="stringliteral">&quot;Specify packets to forward\n&quot;</span>
<a name="l01483"></a>01483        <span class="stringliteral">&quot;Any prefixi to match\n&quot;</span>)
<a name="l01484"></a>01484 {
<a name="l01485"></a>01485   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ad7b8c6be87dbfb731b8d5165c8ce0da5">filter_set_zebra</a> (<a class="code" href="structvty.html">vty</a>, argv[0], argv[1], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, <span class="stringliteral">&quot;::/0&quot;</span>, 0, 0);
<a name="l01486"></a>01486 }
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 
<a name="l01489"></a>01489 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_ipv6_access_list_all,
<a name="l01490"></a>01490        no_ipv6_access_list_all_cmd,
<a name="l01491"></a>01491        <span class="stringliteral">&quot;no ipv6 access-list WORD&quot;</span>,
<a name="l01492"></a>01492        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01493"></a>01493        <a class="code" href="command_8h.html#a97fa3de206286c30e3efe26747c25352">IPV6_STR</a>
<a name="l01494"></a>01494        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01495"></a>01495        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>)
<a name="l01496"></a>01496 {
<a name="l01497"></a>01497   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01498"></a>01498   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01499"></a>01499 
<a name="l01500"></a>01500   <span class="comment">/* Looking up access_list. */</span>
<a name="l01501"></a>01501   access = <a class="code" href="filter_8c.html#a8cb65cd01015f6673c632cb5b8714b3e">access_list_lookup</a> (<a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[0]);
<a name="l01502"></a>01502   <span class="keywordflow">if</span> (access == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01503"></a>01503     {
<a name="l01504"></a>01504       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;%% access-list %s doesn&#39;t exist%s&quot;</span>, argv[0],
<a name="l01505"></a>01505            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01506"></a>01506       <span class="keywordflow">return</span> <a class="code" href="command_8h.html#a92dc6dc30d8ef3651eb9d47a6083b025">CMD_WARNING</a>;
<a name="l01507"></a>01507     }
<a name="l01508"></a>01508 
<a name="l01509"></a>01509   master = access-&gt;<a class="code" href="structaccess__list.html#a097c66a6700318269dfe49cab099934c">master</a>;
<a name="l01510"></a>01510 
<a name="l01511"></a>01511   <span class="comment">/* Delete all filter from access-list. */</span>
<a name="l01512"></a>01512   <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01513"></a>01513 
<a name="l01514"></a>01514   <span class="comment">/* Run hook function. */</span>
<a name="l01515"></a>01515   <span class="keywordflow">if</span> (master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>)
<a name="l01516"></a>01516     (*master-&gt;<a class="code" href="structaccess__master.html#aadaf541c306e30cdc57e0c6ac72db545">delete_hook</a>) (access);
<a name="l01517"></a>01517 
<a name="l01518"></a>01518   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01519"></a>01519 }
<a name="l01520"></a>01520 
<a name="l01521"></a>01521 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (ipv6_access_list_remark,
<a name="l01522"></a>01522        ipv6_access_list_remark_cmd,
<a name="l01523"></a>01523        <span class="stringliteral">&quot;ipv6 access-list WORD remark .LINE&quot;</span>,
<a name="l01524"></a>01524        IPV6_STR
<a name="l01525"></a>01525        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01526"></a>01526        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01527"></a>01527        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>
<a name="l01528"></a>01528        <span class="stringliteral">&quot;Comment up to 100 characters\n&quot;</span>)
<a name="l01529"></a>01529 {
<a name="l01530"></a>01530   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532   access = <a class="code" href="filter_8c.html#a7ddf25823cc7d6023f857198994f9baf">access_list_get</a> (<a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[0]);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534   <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l01535"></a>01535     {
<a name="l01536"></a>01536       <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba563963518edb70d4cd7492b06f48106e">MTYPE_TMP</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>);
<a name="l01537"></a>01537       access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01538"></a>01538     }
<a name="l01539"></a>01539   access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a> = <a class="code" href="command_8c.html#a262c4f7766ffb060fe8b5012d58367a2">argv_concat</a>(argv, argc, 1);
<a name="l01540"></a>01540 
<a name="l01541"></a>01541   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01542"></a>01542 }
<a name="l01543"></a>01543 
<a name="l01544"></a>01544 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (no_ipv6_access_list_remark,
<a name="l01545"></a>01545        no_ipv6_access_list_remark_cmd,
<a name="l01546"></a>01546        <span class="stringliteral">&quot;no ipv6 access-list WORD remark&quot;</span>,
<a name="l01547"></a>01547        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01548"></a>01548        IPV6_STR
<a name="l01549"></a>01549        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01550"></a>01550        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01551"></a>01551        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>)
<a name="l01552"></a>01552 {
<a name="l01553"></a>01553   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#aec7ba906737503fed83711aeef13fab2">vty_access_list_remark_unset</a> (<a class="code" href="structvty.html">vty</a>, <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>, argv[0]);
<a name="l01554"></a>01554 }
<a name="l01555"></a>01555     
<a name="l01556"></a>01556 <a class="code" href="command_8h.html#a7a8f1df2b731617ea7ada9ba5cbdb704">ALIAS</a> (no_ipv6_access_list_remark,
<a name="l01557"></a>01557        no_ipv6_access_list_remark_arg_cmd,
<a name="l01558"></a>01558        <span class="stringliteral">&quot;no ipv6 access-list WORD remark .LINE&quot;</span>,
<a name="l01559"></a>01559        <a class="code" href="command_8h.html#a5b14384572729c1d1b3755d1bea1f17d">NO_STR</a>
<a name="l01560"></a>01560        IPV6_STR
<a name="l01561"></a>01561        <span class="stringliteral">&quot;Add an access list entry\n&quot;</span>
<a name="l01562"></a>01562        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>
<a name="l01563"></a>01563        <span class="stringliteral">&quot;Access list entry comment\n&quot;</span>
<a name="l01564"></a>01564        <span class="stringliteral">&quot;Comment up to 100 characters\n&quot;</span>)
<a name="l01565"></a>01565 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 <span class="keywordtype">void</span> <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *);
<a name="l01568"></a>01568 <span class="keywordtype">void</span> <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *, <span class="keyword">struct</span> <a class="code" href="structfilter.html">filter</a> *);
<a name="l01569"></a>01569 
<a name="l01570"></a>01570 <span class="comment">/* show access-list command. */</span>
<a name="l01571"></a>01571 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01572"></a>01572 filter_show (<span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="memory_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi)
<a name="l01573"></a>01573 {
<a name="l01574"></a>01574   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01575"></a>01575   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01576"></a>01576   <span class="keyword">struct </span><a class="code" href="structfilter.html">filter</a> *mfilter;
<a name="l01577"></a>01577   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *<a class="code" href="structfilter.html">filter</a>;
<a name="l01578"></a>01578   <span class="keywordtype">int</span> write = 0;
<a name="l01579"></a>01579 
<a name="l01580"></a>01580   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (afi);
<a name="l01581"></a>01581   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01582"></a>01582     <span class="keywordflow">return</span> 0;
<a name="l01583"></a>01583 
<a name="l01584"></a>01584   <span class="comment">/* Print the name of the protocol */</span>
<a name="l01585"></a>01585   <span class="keywordflow">if</span> (<a class="code" href="log_8c.html#a69cba84b9cc9c438ad5f5b1379b702b5">zlog_default</a>)
<a name="l01586"></a>01586       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s:%s&quot;</span>,
<a name="l01587"></a>01587       <a class="code" href="log_8c.html#a104618d1dc8bb7b6b5c36f8969f2a49e">zlog_proto_names</a>[<a class="code" href="log_8c.html#a69cba84b9cc9c438ad5f5b1379b702b5">zlog_default</a>-&gt;<a class="code" href="structzlog.html#acafcb64affec5374e8e4d61fded92812">protocol</a>], <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01588"></a>01588 
<a name="l01589"></a>01589   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l01590"></a>01590     {
<a name="l01591"></a>01591       <span class="keywordflow">if</span> (name &amp;&amp; strcmp (access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, name) != 0)
<a name="l01592"></a>01592     <span class="keywordflow">continue</span>;
<a name="l01593"></a>01593 
<a name="l01594"></a>01594       write = 1;
<a name="l01595"></a>01595 
<a name="l01596"></a>01596       <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l01597"></a>01597     {
<a name="l01598"></a>01598       filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l01599"></a>01599 
<a name="l01600"></a>01600       <span class="keywordflow">if</span> (write)
<a name="l01601"></a>01601         {
<a name="l01602"></a>01602           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s IP%s access list %s%s&quot;</span>,
<a name="l01603"></a>01603                mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a> ? 
<a name="l01604"></a>01604                (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a> ? <span class="stringliteral">&quot;Extended&quot;</span> : <span class="stringliteral">&quot;Standard&quot;</span>) : <span class="stringliteral">&quot;Zebra&quot;</span>,
<a name="l01605"></a>01605                afi == <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a> ? <span class="stringliteral">&quot;v6&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,
<a name="l01606"></a>01606                access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01607"></a>01607           write = 0;
<a name="l01608"></a>01608         }
<a name="l01609"></a>01609 
<a name="l01610"></a>01610       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;    %s%s&quot;</span>, <a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">filter_type_str</a> (mfilter),
<a name="l01611"></a>01611            mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> == <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a> ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l01612"></a>01612 
<a name="l01613"></a>01613       <span class="keywordflow">if</span> (! mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>)
<a name="l01614"></a>01614         <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (vty, mfilter);
<a name="l01615"></a>01615       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>)
<a name="l01616"></a>01616         <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (vty, mfilter);
<a name="l01617"></a>01617       <span class="keywordflow">else</span>
<a name="l01618"></a>01618         {
<a name="l01619"></a>01619           <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == 0xffffffff)
<a name="l01620"></a>01620         <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01621"></a>01621           <span class="keywordflow">else</span>
<a name="l01622"></a>01622         {
<a name="l01623"></a>01623           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>));
<a name="l01624"></a>01624           <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr != 0)
<a name="l01625"></a>01625             <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, wildcard bits %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>));
<a name="l01626"></a>01626           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01627"></a>01627         }
<a name="l01628"></a>01628         }
<a name="l01629"></a>01629     }
<a name="l01630"></a>01630     }
<a name="l01631"></a>01631 
<a name="l01632"></a>01632   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l01633"></a>01633     {
<a name="l01634"></a>01634       <span class="keywordflow">if</span> (name &amp;&amp; strcmp (access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, name) != 0)
<a name="l01635"></a>01635     <span class="keywordflow">continue</span>;
<a name="l01636"></a>01636 
<a name="l01637"></a>01637       write = 1;
<a name="l01638"></a>01638 
<a name="l01639"></a>01639       <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l01640"></a>01640     {
<a name="l01641"></a>01641       filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643       <span class="keywordflow">if</span> (write)
<a name="l01644"></a>01644         {
<a name="l01645"></a>01645           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s IP%s access list %s%s&quot;</span>,
<a name="l01646"></a>01646                mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a> ? 
<a name="l01647"></a>01647                (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a> ? <span class="stringliteral">&quot;Extended&quot;</span> : <span class="stringliteral">&quot;Standard&quot;</span>) : <span class="stringliteral">&quot;Zebra&quot;</span>,
<a name="l01648"></a>01648                afi == <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a> ? <span class="stringliteral">&quot;v6&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,
<a name="l01649"></a>01649                access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01650"></a>01650           write = 0;
<a name="l01651"></a>01651         }
<a name="l01652"></a>01652 
<a name="l01653"></a>01653       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;    %s%s&quot;</span>, <a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">filter_type_str</a> (mfilter),
<a name="l01654"></a>01654            mfilter-&gt;<a class="code" href="structfilter.html#a1a2a7bfd0bbd05883b01edbda9750b67">type</a> == <a class="code" href="filter_8h.html#ab3b7281956317556f846daaebf75de72a898abadf6cc2f9d27780782f09d3a3e3">FILTER_DENY</a> ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l01655"></a>01655 
<a name="l01656"></a>01656       <span class="keywordflow">if</span> (! mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>)
<a name="l01657"></a>01657         <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (vty, mfilter);
<a name="l01658"></a>01658       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>)
<a name="l01659"></a>01659         <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (vty, mfilter);
<a name="l01660"></a>01660       <span class="keywordflow">else</span>
<a name="l01661"></a>01661         {
<a name="l01662"></a>01662           <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == 0xffffffff)
<a name="l01663"></a>01663         <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01664"></a>01664           <span class="keywordflow">else</span>
<a name="l01665"></a>01665         {
<a name="l01666"></a>01666           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>));
<a name="l01667"></a>01667           <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr != 0)
<a name="l01668"></a>01668             <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, wildcard bits %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>));
<a name="l01669"></a>01669           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01670"></a>01670         }
<a name="l01671"></a>01671         }
<a name="l01672"></a>01672     }
<a name="l01673"></a>01673     }
<a name="l01674"></a>01674   <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
<a name="l01675"></a>01675 }
<a name="l01676"></a>01676 
<a name="l01677"></a><a class="code" href="filter_8c.html#a0901681ba41ca301941433237f30c3ad">01677</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (show_ip_access_list,
<a name="l01678"></a>01678        show_ip_access_list_cmd,
<a name="l01679"></a>01679        <span class="stringliteral">&quot;show ip access-list&quot;</span>,
<a name="l01680"></a>01680        <a class="code" href="command_8h.html#aa19b6d5257cb6f7622eb6b3da8966b32">SHOW_STR</a>
<a name="l01681"></a>01681        <a class="code" href="command_8h.html#af45438f811eb6711be47ea2555b12f75">IP_STR</a>
<a name="l01682"></a>01682        <span class="stringliteral">&quot;List IP access lists\n&quot;</span>)
<a name="l01683"></a>01683 {
<a name="l01684"></a>01684   <span class="keywordflow">return</span> filter_show (vty, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>);
<a name="l01685"></a>01685 }
<a name="l01686"></a>01686 
<a name="l01687"></a><a class="code" href="filter_8c.html#ad6fd2f456160278e35f3d5d4550c2495">01687</a> <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (show_ip_access_list_name,
<a name="l01688"></a>01688        show_ip_access_list_name_cmd,
<a name="l01689"></a>01689        <span class="stringliteral">&quot;show ip access-list (&lt;1-99&gt;|&lt;100-199&gt;|&lt;1300-1999&gt;|&lt;2000-2699&gt;|WORD)&quot;</span>,
<a name="l01690"></a>01690        <a class="code" href="command_8h.html#aa19b6d5257cb6f7622eb6b3da8966b32">SHOW_STR</a>
<a name="l01691"></a>01691        <a class="code" href="command_8h.html#af45438f811eb6711be47ea2555b12f75">IP_STR</a>
<a name="l01692"></a>01692        <span class="stringliteral">&quot;List IP access lists\n&quot;</span>
<a name="l01693"></a>01693        <span class="stringliteral">&quot;IP standard access list\n&quot;</span>
<a name="l01694"></a>01694        <span class="stringliteral">&quot;IP extended access list\n&quot;</span>
<a name="l01695"></a>01695        <span class="stringliteral">&quot;IP standard access list (expanded range)\n&quot;</span>
<a name="l01696"></a>01696        <span class="stringliteral">&quot;IP extended access list (expanded range)\n&quot;</span>
<a name="l01697"></a>01697        <span class="stringliteral">&quot;IP zebra access-list\n&quot;</span>)
<a name="l01698"></a>01698 {
<a name="l01699"></a>01699   <span class="keywordflow">return</span> filter_show (vty, argv[0], <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>);
<a name="l01700"></a>01700 }
<a name="l01701"></a>01701 
<a name="l01702"></a>01702 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l01703"></a>01703 <span class="preprocessor"></span><a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (show_ipv6_access_list,
<a name="l01704"></a>01704        show_ipv6_access_list_cmd,
<a name="l01705"></a>01705        <span class="stringliteral">&quot;show ipv6 access-list&quot;</span>,
<a name="l01706"></a>01706        <a class="code" href="command_8h.html#aa19b6d5257cb6f7622eb6b3da8966b32">SHOW_STR</a>
<a name="l01707"></a>01707        IPV6_STR
<a name="l01708"></a>01708        <span class="stringliteral">&quot;List IPv6 access lists\n&quot;</span>)
<a name="l01709"></a>01709 {
<a name="l01710"></a>01710   <span class="keywordflow">return</span> filter_show (vty, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>);
<a name="l01711"></a>01711 }
<a name="l01712"></a>01712 
<a name="l01713"></a>01713 <a class="code" href="command_8h.html#acc29190d35966eddbcfeceed3aab6d25">DEFUN</a> (show_ipv6_access_list_name,
<a name="l01714"></a>01714        show_ipv6_access_list_name_cmd,
<a name="l01715"></a>01715        <span class="stringliteral">&quot;show ipv6 access-list WORD&quot;</span>,
<a name="l01716"></a>01716        <a class="code" href="command_8h.html#aa19b6d5257cb6f7622eb6b3da8966b32">SHOW_STR</a>
<a name="l01717"></a>01717        IPV6_STR
<a name="l01718"></a>01718        <span class="stringliteral">&quot;List IPv6 access lists\n&quot;</span>
<a name="l01719"></a>01719        <span class="stringliteral">&quot;IPv6 zebra access-list\n&quot;</span>)
<a name="l01720"></a>01720 {
<a name="l01721"></a>01721   <span class="keywordflow">return</span> filter_show (vty, argv[0], <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>);
<a name="l01722"></a>01722 }
<a name="l01723"></a>01723 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l01724"></a>01724 
<a name="l01725"></a>01725 <span class="keywordtype">void</span>
<a name="l01726"></a><a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">01726</a> <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (<span class="keyword">struct</span> vty *vty, <span class="keyword">struct</span> filter *mfilter)
<a name="l01727"></a>01727 {
<a name="l01728"></a>01728   <span class="keyword">struct </span><a class="code" href="structfilter__cisco.html">filter_cisco</a> *filter;
<a name="l01729"></a>01729 
<a name="l01730"></a>01730   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a5f71c8c67ba477120f13c988bcecd1a8">cfilter</a>;
<a name="l01731"></a>01731 
<a name="l01732"></a>01732   <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a668af83775e2152f7169da2ea3d2ee0a">extended</a>)
<a name="l01733"></a>01733     {
<a name="l01734"></a>01734       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; ip&quot;</span>);
<a name="l01735"></a>01735       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == 0xffffffff)
<a name="l01736"></a>01736     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any&quot;</span>);
<a name="l01737"></a>01737       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == 0)
<a name="l01738"></a>01738     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; host %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>));
<a name="l01739"></a>01739       <span class="keywordflow">else</span>
<a name="l01740"></a>01740     {
<a name="l01741"></a>01741       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>));
<a name="l01742"></a>01742       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>));
<a name="l01743"></a>01743         }
<a name="l01744"></a>01744 
<a name="l01745"></a>01745       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>.s_addr == 0xffffffff)
<a name="l01746"></a>01746     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any&quot;</span>);
<a name="l01747"></a>01747       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>.s_addr == 0)
<a name="l01748"></a>01748     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; host %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>));
<a name="l01749"></a>01749       <span class="keywordflow">else</span>
<a name="l01750"></a>01750     {
<a name="l01751"></a>01751       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a1297af9a59e64f9ec93bac02b9648413">mask</a>));
<a name="l01752"></a>01752       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#aa64fd4f8e3faccb5bd348e2778debaa0">mask_mask</a>));
<a name="l01753"></a>01753     }
<a name="l01754"></a>01754       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01755"></a>01755     }
<a name="l01756"></a>01756   <span class="keywordflow">else</span>
<a name="l01757"></a>01757     {
<a name="l01758"></a>01758       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr == 0xffffffff)
<a name="l01759"></a>01759     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01760"></a>01760       <span class="keywordflow">else</span>
<a name="l01761"></a>01761     {
<a name="l01762"></a>01762       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#ab819f3bbd3ca1580123396ec3d815ac7">addr</a>));
<a name="l01763"></a>01763       <span class="keywordflow">if</span> (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>.s_addr != 0)
<a name="l01764"></a>01764         <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s&quot;</span>, inet_ntoa (filter-&gt;<a class="code" href="structfilter__cisco.html#a5add82550f2b6f237f07aef289fee491">addr_mask</a>));
<a name="l01765"></a>01765       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01766"></a>01766     }
<a name="l01767"></a>01767     }
<a name="l01768"></a>01768 }
<a name="l01769"></a>01769 
<a name="l01770"></a>01770 <span class="keywordtype">void</span>
<a name="l01771"></a><a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">01771</a> <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (<span class="keyword">struct</span> vty *vty, <span class="keyword">struct</span> filter *mfilter)
<a name="l01772"></a>01772 {
<a name="l01773"></a>01773   <span class="keyword">struct </span><a class="code" href="structfilter__zebra.html">filter_zebra</a> *filter;
<a name="l01774"></a>01774   <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
<a name="l01775"></a>01775   <span class="keywordtype">char</span> buf[BUFSIZ];
<a name="l01776"></a>01776 
<a name="l01777"></a>01777   filter = &amp;mfilter-&gt;<a class="code" href="structfilter.html#a3572443caf2974180ebe0ad22389ecd7">u</a>.<a class="code" href="structfilter.html#a585cfafea8b552e6d173a6f324bea12a">zfilter</a>;
<a name="l01778"></a>01778   p = &amp;filter-&gt;<a class="code" href="structfilter__zebra.html#a16aafdd7534995fe26f1037008046210">prefix</a>;
<a name="l01779"></a>01779 
<a name="l01780"></a>01780   <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> == 0 &amp;&amp; ! filter-&gt;<a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a>)
<a name="l01781"></a>01781     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; any&quot;</span>);
<a name="l01782"></a>01782   <span class="keywordflow">else</span>
<a name="l01783"></a>01783     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; %s/%d%s&quot;</span>,
<a name="l01784"></a>01784          <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (p-&gt;<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a>, &amp;p-&gt;u.<a class="code" href="structprefix.html#af508982a05429729278c96708bd9e337">prefix</a>, buf, BUFSIZ),
<a name="l01785"></a>01785          p-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a>,
<a name="l01786"></a>01786          filter-&gt;<a class="code" href="structfilter__zebra.html#a68081ae3bb2eb785d9488004f7f86dec">exact</a> ? <span class="stringliteral">&quot; exact-match&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l01787"></a>01787 
<a name="l01788"></a>01788   <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01789"></a>01789 }
<a name="l01790"></a>01790 
<a name="l01791"></a>01791 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01792"></a><a class="code" href="filter_8c.html#a18fd2d1f0aaad4de6ac5de49a16a6b09">01792</a> <a class="code" href="filter_8c.html#a18fd2d1f0aaad4de6ac5de49a16a6b09">config_write_access</a> (<span class="keyword">struct</span> vty *vty, <a class="code" href="zebra_8h.html#a0a34f9bd6bbc49876614d274005c6ff1">afi_t</a> afi)
<a name="l01793"></a>01793 {
<a name="l01794"></a>01794   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01795"></a>01795   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01796"></a>01796   <span class="keyword">struct </span>filter *mfilter;
<a name="l01797"></a>01797   <span class="keywordtype">int</span> write = 0;
<a name="l01798"></a>01798 
<a name="l01799"></a>01799   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (afi);
<a name="l01800"></a>01800   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01801"></a>01801     <span class="keywordflow">return</span> 0;
<a name="l01802"></a>01802 
<a name="l01803"></a>01803   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l01804"></a>01804     {
<a name="l01805"></a>01805       <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l01806"></a>01806     {
<a name="l01807"></a>01807       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%saccess-list %s remark %s%s&quot;</span>,
<a name="l01808"></a>01808            afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>,
<a name="l01809"></a>01809            access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>,
<a name="l01810"></a>01810            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01811"></a>01811       write++;
<a name="l01812"></a>01812     }
<a name="l01813"></a>01813 
<a name="l01814"></a>01814       <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l01815"></a>01815     {
<a name="l01816"></a>01816       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%saccess-list %s %s&quot;</span>,
<a name="l01817"></a>01817          afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>,
<a name="l01818"></a>01818          access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>,
<a name="l01819"></a>01819          <a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">filter_type_str</a> (mfilter));
<a name="l01820"></a>01820 
<a name="l01821"></a>01821       <span class="keywordflow">if</span> (mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>)
<a name="l01822"></a>01822         <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (vty, mfilter);
<a name="l01823"></a>01823       <span class="keywordflow">else</span>
<a name="l01824"></a>01824         <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (vty, mfilter);
<a name="l01825"></a>01825 
<a name="l01826"></a>01826       write++;
<a name="l01827"></a>01827     }
<a name="l01828"></a>01828     }
<a name="l01829"></a>01829 
<a name="l01830"></a>01830   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>)
<a name="l01831"></a>01831     {
<a name="l01832"></a>01832       <span class="keywordflow">if</span> (access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>)
<a name="l01833"></a>01833     {
<a name="l01834"></a>01834       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%saccess-list %s remark %s%s&quot;</span>,
<a name="l01835"></a>01835            afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>,
<a name="l01836"></a>01836            access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>, access-&gt;<a class="code" href="structaccess__list.html#a84e300ce307439146f5df4b25309f38c">remark</a>,
<a name="l01837"></a>01837            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l01838"></a>01838       write++;
<a name="l01839"></a>01839     }
<a name="l01840"></a>01840 
<a name="l01841"></a>01841       <span class="keywordflow">for</span> (mfilter = access-&gt;<a class="code" href="structaccess__list.html#a3f8db341e7189319dc7f180b730d7587">head</a>; mfilter; mfilter = mfilter-&gt;<a class="code" href="structfilter.html#a6b598f761947f18559c9dc5bad1bbbf8">next</a>)
<a name="l01842"></a>01842     {
<a name="l01843"></a>01843       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%saccess-list %s %s&quot;</span>,
<a name="l01844"></a>01844          afi == <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>,
<a name="l01845"></a>01845          access-&gt;<a class="code" href="structaccess__list.html#afdafa2fa941dc9afe1ad8471420c655a">name</a>,
<a name="l01846"></a>01846          <a class="code" href="filter_8c.html#a540a9ee491c248730fcea803c3022af8">filter_type_str</a> (mfilter));
<a name="l01847"></a>01847 
<a name="l01848"></a>01848       <span class="keywordflow">if</span> (mfilter-&gt;<a class="code" href="structfilter.html#a09a3cec17a427722862c8c093bf8839b">cisco</a>)
<a name="l01849"></a>01849         <a class="code" href="filter_8c.html#a4548d132de45b303dae5ab7118c57e34">config_write_access_cisco</a> (vty, mfilter);
<a name="l01850"></a>01850       <span class="keywordflow">else</span>
<a name="l01851"></a>01851         <a class="code" href="filter_8c.html#ac5de4e795a57ba3927f80e612da857a8">config_write_access_zebra</a> (vty, mfilter);
<a name="l01852"></a>01852 
<a name="l01853"></a>01853       write++;
<a name="l01854"></a>01854     }
<a name="l01855"></a>01855     }
<a name="l01856"></a>01856   <span class="keywordflow">return</span> write;
<a name="l01857"></a>01857 }
<a name="l01858"></a>01858 
<a name="l01859"></a>01859 <span class="comment">/* Access-list node. */</span>
<a name="l01860"></a><a class="code" href="filter_8c.html#a3770982685424573d2660fcddd138c96">01860</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__node.html">cmd_node</a> <a class="code" href="filter_8c.html#a3770982685424573d2660fcddd138c96">access_node</a> =
<a name="l01861"></a>01861 {
<a name="l01862"></a>01862   <a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682ae806fc228c2ba88d9b33ab3ae68019aa">ACCESS_NODE</a>,
<a name="l01863"></a>01863   <span class="stringliteral">&quot;&quot;</span>,               <span class="comment">/* Access list has no interface. */</span>
<a name="l01864"></a>01864   1
<a name="l01865"></a>01865 };
<a name="l01866"></a>01866 
<a name="l01867"></a>01867 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01868"></a><a class="code" href="filter_8c.html#a6529145575c93886d758fca6aed01a5b">01868</a> <a class="code" href="filter_8c.html#a6529145575c93886d758fca6aed01a5b">config_write_access_ipv4</a> (<span class="keyword">struct</span> vty *vty)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#a18fd2d1f0aaad4de6ac5de49a16a6b09">config_write_access</a> (vty, <a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>);
<a name="l01871"></a>01871 }
<a name="l01872"></a>01872 
<a name="l01873"></a>01873 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01874"></a><a class="code" href="filter_8c.html#aaeb88e6fa664e0e29a69d3f43f16f2a1">01874</a> <a class="code" href="filter_8c.html#aaeb88e6fa664e0e29a69d3f43f16f2a1">access_list_reset_ipv4</a> (<span class="keywordtype">void</span>)
<a name="l01875"></a>01875 {
<a name="l01876"></a>01876   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01877"></a>01877   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01878"></a>01878   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01879"></a>01879 
<a name="l01880"></a>01880   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (<a class="code" href="zebra_8h.html#a192fcc8cbfb7b9d03c6562c48941a4bd">AFI_IP</a>);
<a name="l01881"></a>01881   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01882"></a>01882     <span class="keywordflow">return</span>;
<a name="l01883"></a>01883 
<a name="l01884"></a>01884   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = next)
<a name="l01885"></a>01885     {
<a name="l01886"></a>01886       next = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01887"></a>01887       <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01888"></a>01888     }
<a name="l01889"></a>01889   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = next)
<a name="l01890"></a>01890     {
<a name="l01891"></a>01891       next = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01892"></a>01892       <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01893"></a>01893     }
<a name="l01894"></a>01894 
<a name="l01895"></a>01895   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01896"></a>01896   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01897"></a>01897 
<a name="l01898"></a>01898   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01899"></a>01899   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01900"></a>01900 }
<a name="l01901"></a>01901 
<a name="l01902"></a>01902 <span class="comment">/* Install vty related command. */</span>
<a name="l01903"></a>01903 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01904"></a><a class="code" href="filter_8c.html#a026bdc670aa295160aca2deac5f74704">01904</a> <a class="code" href="filter_8c.html#a026bdc670aa295160aca2deac5f74704">access_list_init_ipv4</a> (<span class="keywordtype">void</span>)
<a name="l01905"></a>01905 {
<a name="l01906"></a>01906   <a class="code" href="command_8c.html#a7ee8a7c258e1e5a6e3ff6173dd1658e3">install_node</a> (&amp;access_node, <a class="code" href="filter_8c.html#a6529145575c93886d758fca6aed01a5b">config_write_access_ipv4</a>);
<a name="l01907"></a>01907 
<a name="l01908"></a>01908   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;show_ip_access_list_cmd);
<a name="l01909"></a>01909   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;show_ip_access_list_name_cmd);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911   <span class="comment">/* Zebra access-list */</span>
<a name="l01912"></a>01912   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_cmd);
<a name="l01913"></a>01913   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_exact_cmd);
<a name="l01914"></a>01914   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_any_cmd);
<a name="l01915"></a>01915   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_cmd);
<a name="l01916"></a>01916   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_exact_cmd);
<a name="l01917"></a>01917   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_any_cmd);
<a name="l01918"></a>01918 
<a name="l01919"></a>01919   <span class="comment">/* Standard access-list */</span>
<a name="l01920"></a>01920   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_standard_cmd);
<a name="l01921"></a>01921   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_standard_nomask_cmd);
<a name="l01922"></a>01922   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_standard_host_cmd);
<a name="l01923"></a>01923   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_standard_any_cmd);
<a name="l01924"></a>01924   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_standard_cmd);
<a name="l01925"></a>01925   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_standard_nomask_cmd);
<a name="l01926"></a>01926   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_standard_host_cmd);
<a name="l01927"></a>01927   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_standard_any_cmd);
<a name="l01928"></a>01928 
<a name="l01929"></a>01929   <span class="comment">/* Extended access-list */</span>
<a name="l01930"></a>01930   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_cmd);
<a name="l01931"></a>01931   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_any_mask_cmd);
<a name="l01932"></a>01932   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_mask_any_cmd);
<a name="l01933"></a>01933   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_any_any_cmd);
<a name="l01934"></a>01934   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_host_mask_cmd);
<a name="l01935"></a>01935   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_mask_host_cmd);
<a name="l01936"></a>01936   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_host_host_cmd);
<a name="l01937"></a>01937   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_any_host_cmd);
<a name="l01938"></a>01938   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_extended_host_any_cmd);
<a name="l01939"></a>01939   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_cmd);
<a name="l01940"></a>01940   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_any_mask_cmd);
<a name="l01941"></a>01941   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_mask_any_cmd);
<a name="l01942"></a>01942   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_any_any_cmd);
<a name="l01943"></a>01943   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_host_mask_cmd);
<a name="l01944"></a>01944   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_mask_host_cmd);
<a name="l01945"></a>01945   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_host_host_cmd);
<a name="l01946"></a>01946   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_any_host_cmd);
<a name="l01947"></a>01947   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_extended_host_any_cmd);
<a name="l01948"></a>01948 
<a name="l01949"></a>01949   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;access_list_remark_cmd);
<a name="l01950"></a>01950   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_all_cmd);
<a name="l01951"></a>01951   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_remark_cmd);
<a name="l01952"></a>01952   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_access_list_remark_arg_cmd);
<a name="l01953"></a>01953 }
<a name="l01954"></a>01954 
<a name="l01955"></a>01955 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l01956"></a>01956 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__node.html">cmd_node</a> access_ipv6_node =
<a name="l01957"></a>01957 {
<a name="l01958"></a>01958   <a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682ac108432039855372bd806df6259a21d1">ACCESS_IPV6_NODE</a>,
<a name="l01959"></a>01959   <span class="stringliteral">&quot;&quot;</span>,
<a name="l01960"></a>01960   1
<a name="l01961"></a>01961 };
<a name="l01962"></a>01962 
<a name="l01963"></a>01963 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01964"></a>01964 config_write_access_ipv6 (<span class="keyword">struct</span> vty *vty)
<a name="l01965"></a>01965 {
<a name="l01966"></a>01966   <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#a18fd2d1f0aaad4de6ac5de49a16a6b09">config_write_access</a> (vty, <a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>);
<a name="l01967"></a>01967 }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01970"></a>01970 access_list_reset_ipv6 (<span class="keywordtype">void</span>)
<a name="l01971"></a>01971 {
<a name="l01972"></a>01972   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *access;
<a name="l01973"></a>01973   <span class="keyword">struct </span><a class="code" href="structaccess__list.html">access_list</a> *<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01974"></a>01974   <span class="keyword">struct </span><a class="code" href="structaccess__master.html">access_master</a> *<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>;
<a name="l01975"></a>01975 
<a name="l01976"></a>01976   master = <a class="code" href="filter_8c.html#a783e818472098d14c1bea0ae62af1272">access_master_get</a> (<a class="code" href="zebra_8h.html#ad10f30457e426e1d269466d3b6603c3c">AFI_IP6</a>);
<a name="l01977"></a>01977   <span class="keywordflow">if</span> (master == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01978"></a>01978     <span class="keywordflow">return</span>;
<a name="l01979"></a>01979 
<a name="l01980"></a>01980   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = next)
<a name="l01981"></a>01981     {
<a name="l01982"></a>01982       next = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01983"></a>01983       <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01984"></a>01984     }
<a name="l01985"></a>01985   <span class="keywordflow">for</span> (access = master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a>; access; access = next)
<a name="l01986"></a>01986     {
<a name="l01987"></a>01987       next = access-&gt;<a class="code" href="structaccess__list.html#ad0307d7295507859b9e3e52d89229723">next</a>;
<a name="l01988"></a>01988       <a class="code" href="filter_8c.html#acb05784c3aa474958bb576fbdfc818e0">access_list_delete</a> (access);
<a name="l01989"></a>01989     }
<a name="l01990"></a>01990 
<a name="l01991"></a>01991   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01992"></a>01992   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#ae4c1927a2c39950f844d6aa5d05745f6">num</a>.<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01993"></a>01993 
<a name="l01994"></a>01994   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a67b1d1c527b5daa634a0fdb133b9dcf9">head</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01995"></a>01995   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (master-&gt;<a class="code" href="structaccess__master.html#a07124b2756da0c8ee76d360e7d21a07f">str</a>.<a class="code" href="structaccess__list__list.html#a82ce0a3a280918be1040a29a63a506ff">tail</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01996"></a>01996 }
<a name="l01997"></a>01997 
<a name="l01998"></a>01998 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01999"></a>01999 access_list_init_ipv6 (<span class="keywordtype">void</span>)
<a name="l02000"></a>02000 {
<a name="l02001"></a>02001   <a class="code" href="command_8c.html#a7ee8a7c258e1e5a6e3ff6173dd1658e3">install_node</a> (&amp;access_ipv6_node, config_write_access_ipv6);
<a name="l02002"></a>02002 
<a name="l02003"></a>02003   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;show_ipv6_access_list_cmd);
<a name="l02004"></a>02004   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;show_ipv6_access_list_name_cmd);
<a name="l02005"></a>02005 
<a name="l02006"></a>02006   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;ipv6_access_list_cmd);
<a name="l02007"></a>02007   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;ipv6_access_list_exact_cmd);
<a name="l02008"></a>02008   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;ipv6_access_list_any_cmd);
<a name="l02009"></a>02009   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_exact_cmd);
<a name="l02010"></a>02010   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_cmd);
<a name="l02011"></a>02011   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_any_cmd);
<a name="l02012"></a>02012 
<a name="l02013"></a>02013   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_all_cmd);
<a name="l02014"></a>02014   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;ipv6_access_list_remark_cmd);
<a name="l02015"></a>02015   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_remark_cmd);
<a name="l02016"></a>02016   <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_ipv6_access_list_remark_arg_cmd);
<a name="l02017"></a>02017 }
<a name="l02018"></a>02018 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l02019"></a>02019 
<a name="l02020"></a>02020 <span class="keywordtype">void</span>
<a name="l02021"></a><a class="code" href="filter_8h.html#a744f172986c4226ca20eeaf8a77974ba">02021</a> <a class="code" href="filter_8c.html#a7794dbb70ed7bbd7a248853d572fa38c">access_list_init</a> ()
<a name="l02022"></a>02022 {
<a name="l02023"></a>02023   <a class="code" href="filter_8c.html#a026bdc670aa295160aca2deac5f74704">access_list_init_ipv4</a> ();
<a name="l02024"></a>02024 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l02025"></a>02025 <span class="preprocessor"></span>  access_list_init_ipv6();
<a name="l02026"></a>02026 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l02027"></a>02027 }
<a name="l02028"></a>02028 
<a name="l02029"></a>02029 <span class="keywordtype">void</span>
<a name="l02030"></a><a class="code" href="filter_8h.html#a3bf01f63f19904d7664ab995f3e3ea8b">02030</a> <a class="code" href="filter_8c.html#a6d46b3b0526d8e0e8dbed60d7f6a695d">access_list_reset</a> ()
<a name="l02031"></a>02031 {
<a name="l02032"></a>02032   <a class="code" href="filter_8c.html#aaeb88e6fa664e0e29a69d3f43f16f2a1">access_list_reset_ipv4</a> ();
<a name="l02033"></a>02033 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l02034"></a>02034 <span class="preprocessor"></span>  access_list_reset_ipv6();
<a name="l02035"></a>02035 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l02036"></a>02036 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="filter_8c.html">filter.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:05 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
