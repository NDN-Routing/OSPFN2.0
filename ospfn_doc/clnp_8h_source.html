<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: isisd/include-netbsd/clnp.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('clnp_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">isisd/include-netbsd/clnp.h</div>  </div>
</div>
<div class="contents">
<a href="clnp_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  $NetBSD: clnp.h,v 1.13 2001/08/20 12:00:54 wiz Exp $    */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*-</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (c) 1991, 1993, 1994</span>
<a name="l00005"></a>00005 <span class="comment"> *  The Regents of the University of California.  All rights reserved.</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00008"></a>00008 <span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="l00009"></a>00009 <span class="comment"> * are met:</span>
<a name="l00010"></a>00010 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="l00011"></a>00011 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="l00012"></a>00012 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="l00013"></a>00013 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
<a name="l00014"></a>00014 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment"> * 3. All advertising materials mentioning features or use of this software</span>
<a name="l00016"></a>00016 <span class="comment"> *    must display the following acknowledgement:</span>
<a name="l00017"></a>00017 <span class="comment"> *  This product includes software developed by the University of</span>
<a name="l00018"></a>00018 <span class="comment"> *  California, Berkeley and its contributors.</span>
<a name="l00019"></a>00019 <span class="comment"> * 4. Neither the name of the University nor the names of its contributors</span>
<a name="l00020"></a>00020 <span class="comment"> *    may be used to endorse or promote products derived from this software</span>
<a name="l00021"></a>00021 <span class="comment"> *    without specific prior written permission.</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS&#39;&#39; AND</span>
<a name="l00024"></a>00024 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="l00025"></a>00025 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<a name="l00026"></a>00026 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE</span>
<a name="l00027"></a>00027 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00028"></a>00028 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
<a name="l00029"></a>00029 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<a name="l00030"></a>00030 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
<a name="l00031"></a>00031 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
<a name="l00032"></a>00032 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
<a name="l00033"></a>00033 <span class="comment"> * SUCH DAMAGE.</span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment"> *  @(#)clnp.h  8.2 (Berkeley) 4/16/94</span>
<a name="l00036"></a>00036 <span class="comment"> */</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">/***********************************************************</span>
<a name="l00039"></a>00039 <span class="comment">        Copyright IBM Corporation 1987</span>
<a name="l00040"></a>00040 <span class="comment"></span>
<a name="l00041"></a>00041 <span class="comment">                      All Rights Reserved</span>
<a name="l00042"></a>00042 <span class="comment"></span>
<a name="l00043"></a>00043 <span class="comment">Permission to use, copy, modify, and distribute this software and its</span>
<a name="l00044"></a>00044 <span class="comment">documentation for any purpose and without fee is hereby granted,</span>
<a name="l00045"></a>00045 <span class="comment">provided that the above copyright notice appear in all copies and that</span>
<a name="l00046"></a>00046 <span class="comment">both that copyright notice and this permission notice appear in</span>
<a name="l00047"></a>00047 <span class="comment">supporting documentation, and that the name of IBM not be</span>
<a name="l00048"></a>00048 <span class="comment">used in advertising or publicity pertaining to distribution of the</span>
<a name="l00049"></a>00049 <span class="comment">software without specific, written prior permission.</span>
<a name="l00050"></a>00050 <span class="comment"></span>
<a name="l00051"></a>00051 <span class="comment">IBM DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING</span>
<a name="l00052"></a>00052 <span class="comment">ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL</span>
<a name="l00053"></a>00053 <span class="comment">IBM BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR</span>
<a name="l00054"></a>00054 <span class="comment">ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,</span>
<a name="l00055"></a>00055 <span class="comment">WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,</span>
<a name="l00056"></a>00056 <span class="comment">ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS</span>
<a name="l00057"></a>00057 <span class="comment">SOFTWARE.</span>
<a name="l00058"></a>00058 <span class="comment"></span>
<a name="l00059"></a>00059 <span class="comment">******************************************************************/</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">/*</span>
<a name="l00062"></a>00062 <span class="comment"> * ARGO Project, Computer Sciences Dept., University of Wisconsin - Madison</span>
<a name="l00063"></a>00063 <span class="comment"> */</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/* should be config option but cpp breaks with too many #defines */</span>
<a name="l00066"></a><a class="code" href="clnp_8h.html#aa1ec415f2563e225e37ef65de0352979">00066</a> <span class="preprocessor">#define DECBIT</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">/*</span>
<a name="l00069"></a>00069 <span class="comment"> *  Return true if the mbuf is a cluster mbuf</span>
<a name="l00070"></a>00070 <span class="comment"> */</span>
<a name="l00071"></a><a class="code" href="clnp_8h.html#a0d6e0ed3630b742040145c80e1a6c314">00071</a> <span class="preprocessor">#define IS_CLUSTER(m)   ((m)-&gt;m_flags &amp; M_EXT)</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>
<a name="l00073"></a>00073 <span class="comment">/*</span>
<a name="l00074"></a>00074 <span class="comment"> *  Move the halfword into the two characters</span>
<a name="l00075"></a>00075 <span class="comment"> */</span>
<a name="l00076"></a><a class="code" href="clnp_8h.html#a1ef903fc8015c88991a7af2a63165fed">00076</a> <span class="preprocessor">#define HTOC(msb, lsb, hword)\</span>
<a name="l00077"></a>00077 <span class="preprocessor">    (msb) = (u_char)((hword) &gt;&gt; 8);\</span>
<a name="l00078"></a>00078 <span class="preprocessor">    (lsb) = (u_char)((hword) &amp; 0xff)</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00080"></a>00080 <span class="comment"> *  Move the two charcters into the halfword</span>
<a name="l00081"></a>00081 <span class="comment"> */</span>
<a name="l00082"></a><a class="code" href="clnp_8h.html#afca3b60025d99f6285022ec985c01be6">00082</a> <span class="preprocessor">#define CTOH(msb, lsb, hword)\</span>
<a name="l00083"></a>00083 <span class="preprocessor">    (hword) = ((msb) &lt;&lt; 8) | (lsb)</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span>
<a name="l00085"></a>00085 <span class="comment">/*</span>
<a name="l00086"></a>00086 <span class="comment"> *  Return true if the checksum has been set - ie. the checksum is</span>
<a name="l00087"></a>00087 <span class="comment"> *  not zero</span>
<a name="l00088"></a>00088 <span class="comment"> */</span>
<a name="l00089"></a><a class="code" href="clnp_8h.html#a4ae56d674ebeaf7f382a41277bc6c7ba">00089</a> <span class="preprocessor">#define CKSUM_REQUIRED(clnp)\</span>
<a name="l00090"></a>00090 <span class="preprocessor">    (((clnp)-&gt;cnf_cksum_msb != 0) || ((clnp)-&gt;cnf_cksum_lsb != 0))</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a>00092 <span class="comment">/*</span>
<a name="l00093"></a>00093 <span class="comment"> *  Fixed part of clnp header</span>
<a name="l00094"></a>00094 <span class="comment"> */</span>
<a name="l00095"></a><a class="code" href="structclnp__fixed.html">00095</a> <span class="keyword">struct </span><a class="code" href="structclnp__fixed.html">clnp_fixed</a> {
<a name="l00096"></a><a class="code" href="structclnp__fixed.html#a52e546ee309edbc3ce37076708997fcd">00096</a>     u_char          <a class="code" href="structclnp__fixed.html#a52e546ee309edbc3ce37076708997fcd">cnf_proto_id</a>;   <span class="comment">/* network layer protocol identifier */</span>
<a name="l00097"></a><a class="code" href="structclnp__fixed.html#a1b067ce1eeff020de7793c3a52e870d4">00097</a>     u_char          <a class="code" href="structclnp__fixed.html#a1b067ce1eeff020de7793c3a52e870d4">cnf_hdr_len</a>;    <span class="comment">/* length indicator (octets) */</span>
<a name="l00098"></a><a class="code" href="structclnp__fixed.html#af5b09060a20de1cfdadc5d66ac567ce5">00098</a>     u_char          <a class="code" href="structclnp__fixed.html#af5b09060a20de1cfdadc5d66ac567ce5">cnf_vers</a>;   <span class="comment">/* version/protocol identifier</span>
<a name="l00099"></a>00099 <span class="comment">                     * extension */</span>
<a name="l00100"></a><a class="code" href="structclnp__fixed.html#a43f0dc14615d525fcf8652482d9d20c3">00100</a>     u_char          <a class="code" href="structclnp__fixed.html#a43f0dc14615d525fcf8652482d9d20c3">cnf_ttl</a>;<span class="comment">/* lifetime (500 milliseconds) */</span>
<a name="l00101"></a><a class="code" href="structclnp__fixed.html#ad99908533a9efd7b4ea07cc736a236ae">00101</a>     u_char          <a class="code" href="structclnp__fixed.html#ad99908533a9efd7b4ea07cc736a236ae">cnf_type</a>;   <span class="comment">/* type code */</span>
<a name="l00102"></a>00102     <span class="comment">/* Includes err_ok, more_segs, and seg_ok */</span>
<a name="l00103"></a><a class="code" href="structclnp__fixed.html#a333a9dbb37da381e56482a1734518c7d">00103</a>     u_char          <a class="code" href="structclnp__fixed.html#a333a9dbb37da381e56482a1734518c7d">cnf_seglen_msb</a>; <span class="comment">/* pdu segment length (octets) high</span>
<a name="l00104"></a>00104 <span class="comment">                     * byte */</span>
<a name="l00105"></a><a class="code" href="structclnp__fixed.html#a79bfcde3890c27fd74a14cfcca9a7582">00105</a>     u_char          <a class="code" href="structclnp__fixed.html#a79bfcde3890c27fd74a14cfcca9a7582">cnf_seglen_lsb</a>; <span class="comment">/* pdu segment length (octets) low</span>
<a name="l00106"></a>00106 <span class="comment">                     * byte */</span>
<a name="l00107"></a><a class="code" href="structclnp__fixed.html#ad84b4f6b66e32ad0a3df87d8f6d44723">00107</a>     u_char          <a class="code" href="structclnp__fixed.html#ad84b4f6b66e32ad0a3df87d8f6d44723">cnf_cksum_msb</a>;  <span class="comment">/* checksum high byte */</span>
<a name="l00108"></a><a class="code" href="structclnp__fixed.html#a9e6718ec400b96f600f76baf31751512">00108</a>     u_char          <a class="code" href="structclnp__fixed.html#a9e6718ec400b96f600f76baf31751512">cnf_cksum_lsb</a>;  <span class="comment">/* checksum low byte */</span>
<a name="l00109"></a>00109 } <a class="code" href="zebra_8h.html#a9d373a9b65ff25b2db84c07394e1c212">__attribute__</a>((packed));
<a name="l00110"></a><a class="code" href="clnp_8h.html#a76028be464e3e2ed66a6fa4a0fbd5b2e">00110</a> <span class="preprocessor">#define CNF_TYPE    0x1f</span>
<a name="l00111"></a><a class="code" href="clnp_8h.html#a0cddfbe125ff1cda090004acb9039763">00111</a> <span class="preprocessor"></span><span class="preprocessor">#define CNF_ERR_OK  0x20</span>
<a name="l00112"></a><a class="code" href="clnp_8h.html#ace6c8794229f3870d89246efbd986a2f">00112</a> <span class="preprocessor"></span><span class="preprocessor">#define CNF_MORE_SEGS   0x40</span>
<a name="l00113"></a><a class="code" href="clnp_8h.html#a24fb0edc878a87ff30f8d622a0fd3e39">00113</a> <span class="preprocessor"></span><span class="preprocessor">#define CNF_SEG_OK  0x80</span>
<a name="l00114"></a><a class="code" href="clnp_8h.html#a87e30398c5b653b855b1fe62f4b70f3a">00114</a> <span class="preprocessor"></span>
<a name="l00115"></a><a class="code" href="clnp_8h.html#ac4e7a3e46360796af381741c840abef2">00115</a> <span class="preprocessor">#define CLNP_CKSUM_OFF  0x07    </span><span class="comment">/* offset of checksum */</span>
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="clnp_8h.html#a16cd98aea604428af5104644559685e7">00117</a> <span class="preprocessor">#define clnl_fixed  clnp_fixed</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>
<a name="l00119"></a><a class="code" href="clnp_8h.html#a263eafce761803f15a309ed78be56623">00119</a> <span class="comment">/*</span>
<a name="l00120"></a>00120 <span class="comment"> *  Segmentation part of clnp header</span>
<a name="l00121"></a><a class="code" href="clnp_8h.html#a28a8c590286fae4c6219cd30223dcae0">00121</a> <span class="comment"> */</span>
<a name="l00122"></a><a class="code" href="clnp_8h.html#a4b3d08f267e64ed09811f55dd28be246">00122</a> <span class="keyword">struct </span><a class="code" href="structclnp__segment.html">clnp_segment</a> {
<a name="l00123"></a><a class="code" href="structclnp__segment.html#a9f6900e08575646bfdade02250ebdac1">00123</a>     u_short         <a class="code" href="structclnp__segment.html#a9f6900e08575646bfdade02250ebdac1">cng_id</a>; <span class="comment">/* data unit identifier */</span>
<a name="l00124"></a><a class="code" href="structclnp__segment.html#aef2c3a2b1cc6164ce5e77790495b8d87">00124</a>     u_short         <a class="code" href="structclnp__segment.html#aef2c3a2b1cc6164ce5e77790495b8d87">cng_off</a>;<span class="comment">/* segment offset */</span>
<a name="l00125"></a><a class="code" href="structclnp__segment.html#aaf826c7a9c6c84e78d9ec2cd10d3b521">00125</a>     u_short         <a class="code" href="structclnp__segment.html#aaf826c7a9c6c84e78d9ec2cd10d3b521">cng_tot_len</a>;    <span class="comment">/* total length */</span>
<a name="l00126"></a>00126 };
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/*</span>
<a name="l00129"></a>00129 <span class="comment"> *  Clnp fragment reassembly structures:</span>
<a name="l00130"></a>00130 <span class="comment"> *</span>
<a name="l00131"></a>00131 <span class="comment"> *  All packets undergoing reassembly are linked together in</span>
<a name="l00132"></a>00132 <span class="comment"> *  clnp_fragl structures. Each clnp_fragl structure contains a</span>
<a name="l00133"></a>00133 <span class="comment"> *  pointer to the original clnp packet header, as well as a</span>
<a name="l00134"></a>00134 <span class="comment"> *  list of packet fragments. Each packet fragment</span>
<a name="l00135"></a>00135 <span class="comment"> *  is headed by a clnp_frag structure. This structure contains the</span>
<a name="l00136"></a>00136 <span class="comment"> *  offset of the first and last byte of the fragment, as well as</span>
<a name="l00137"></a>00137 <span class="comment"> *  a pointer to the data (an mbuf chain) of the fragment.</span>
<a name="l00138"></a>00138 <span class="comment"> */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">/*</span>
<a name="l00141"></a>00141 <span class="comment"> *  NOTE:</span>
<a name="l00142"></a>00142 <span class="comment"> *      The clnp_frag structure is stored in an mbuf immedately</span>
<a name="l00143"></a>00143 <span class="comment"> *      preceding the fragment data. Since there are words in</span>
<a name="l00144"></a>00144 <span class="comment"> *      this struct, it must be word aligned.</span>
<a name="l00145"></a>00145 <span class="comment"> *</span>
<a name="l00146"></a>00146 <span class="comment"> *  NOTE:</span>
<a name="l00147"></a>00147 <span class="comment"> *      All the fragment code assumes that the entire clnp header is</span>
<a name="l00148"></a>00148 <span class="comment"> *      contained in the first mbuf.</span>
<a name="l00149"></a>00149 <span class="comment"> */</span>
<a name="l00150"></a><a class="code" href="structclnp__frag.html">00150</a> <span class="keyword">struct </span><a class="code" href="structclnp__frag.html">clnp_frag</a> {
<a name="l00151"></a><a class="code" href="structclnp__frag.html#ac1a8719c98b178adabaf1003440466d6">00151</a>     u_int           <a class="code" href="structclnp__frag.html#ac1a8719c98b178adabaf1003440466d6">cfr_first</a>;  <span class="comment">/* offset of first byte of this frag */</span>
<a name="l00152"></a><a class="code" href="structclnp__frag.html#adc1c1a8dbd03f1462f56bff7c7ab1805">00152</a>     u_int           <a class="code" href="structclnp__frag.html#adc1c1a8dbd03f1462f56bff7c7ab1805">cfr_last</a>;   <span class="comment">/* offset of last byte of this frag */</span>
<a name="l00153"></a><a class="code" href="structclnp__frag.html#ace490e07bc0ab60677fd19e92f254be3">00153</a>     u_int           <a class="code" href="structclnp__frag.html#ace490e07bc0ab60677fd19e92f254be3">cfr_bytes</a>;  <span class="comment">/* bytes to shave to get to data */</span>
<a name="l00154"></a><a class="code" href="structclnp__frag.html#a6137152edbde99e243cd6c8a7285587a">00154</a>     <span class="keyword">struct </span>mbuf    *<a class="code" href="structclnp__frag.html#a6137152edbde99e243cd6c8a7285587a">cfr_data</a>;   <span class="comment">/* ptr to data for this frag */</span>
<a name="l00155"></a><a class="code" href="structclnp__frag.html#a8078e28728575f093f414267e62ce9f5">00155</a>     <span class="keyword">struct </span><a class="code" href="structclnp__frag.html">clnp_frag</a> *<a class="code" href="structclnp__frag.html#a8078e28728575f093f414267e62ce9f5">cfr_next</a>; <span class="comment">/* next fragment in list */</span>
<a name="l00156"></a>00156 };
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="structclnp__fragl.html">00158</a> <span class="keyword">struct </span><a class="code" href="structclnp__fragl.html">clnp_fragl</a> {
<a name="l00159"></a><a class="code" href="structclnp__fragl.html#a3831a9101c5a5c60784bf83a8657c944">00159</a>     <span class="keyword">struct </span><a class="code" href="structiso__addr.html">iso_addr</a> <a class="code" href="structclnp__fragl.html#a3831a9101c5a5c60784bf83a8657c944">cfl_src</a>;<span class="comment">/* source of the pkt */</span>
<a name="l00160"></a><a class="code" href="structclnp__fragl.html#a7557ddf869f675d9728a37a79119c2cc">00160</a>     <span class="keyword">struct </span><a class="code" href="structiso__addr.html">iso_addr</a> <a class="code" href="structclnp__fragl.html#a7557ddf869f675d9728a37a79119c2cc">cfl_dst</a>;<span class="comment">/* destination of the pkt */</span>
<a name="l00161"></a><a class="code" href="structclnp__fragl.html#ae5cb19a9e10ec9b67fdbca81c99052d9">00161</a>     u_short         <a class="code" href="structclnp__fragl.html#ae5cb19a9e10ec9b67fdbca81c99052d9">cfl_id</a>; <span class="comment">/* id of the pkt */</span>
<a name="l00162"></a><a class="code" href="structclnp__fragl.html#a199179c71e53082b64dc548af90fbab5">00162</a>     u_char          <a class="code" href="structclnp__fragl.html#a199179c71e53082b64dc548af90fbab5">cfl_ttl</a>;<span class="comment">/* current ttl of pkt */</span>
<a name="l00163"></a><a class="code" href="structclnp__fragl.html#afe952b4831143409b8fe6db1e47934fc">00163</a>     u_short         <a class="code" href="structclnp__fragl.html#afe952b4831143409b8fe6db1e47934fc">cfl_last</a>;   <span class="comment">/* offset of last byte of packet */</span>
<a name="l00164"></a><a class="code" href="structclnp__fragl.html#a352d234b2d62b24b4948a80eea4d8c91">00164</a>     <span class="keyword">struct </span>mbuf    *<a class="code" href="structclnp__fragl.html#a352d234b2d62b24b4948a80eea4d8c91">cfl_orighdr</a>;    <span class="comment">/* ptr to original header */</span>
<a name="l00165"></a><a class="code" href="structclnp__fragl.html#a31be3f31bce5c5fbaf866a76d39194b8">00165</a>     <span class="keyword">struct </span><a class="code" href="structclnp__frag.html">clnp_frag</a> *<a class="code" href="structclnp__fragl.html#a31be3f31bce5c5fbaf866a76d39194b8">cfl_frags</a>;    <span class="comment">/* linked list of fragments for pkt */</span>
<a name="l00166"></a><a class="code" href="structclnp__fragl.html#a9bbeda6a04fb85347814d52eabd336c2">00166</a>     <span class="keyword">struct </span><a class="code" href="structclnp__fragl.html">clnp_fragl</a> *<a class="code" href="structclnp__fragl.html#a9bbeda6a04fb85347814d52eabd336c2">cfl_next</a>;    <span class="comment">/* next pkt being reassembled */</span>
<a name="l00167"></a>00167 };
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="comment">/*</span>
<a name="l00170"></a>00170 <span class="comment"> *  The following structure is used to index into an options section</span>
<a name="l00171"></a>00171 <span class="comment"> *  of a clnp datagram. These values can be used without worry that</span>
<a name="l00172"></a>00172 <span class="comment"> *  offset or length fields are invalid or too big, etc. That is,</span>
<a name="l00173"></a>00173 <span class="comment"> *  the consistancy of the options will be guaranteed before this</span>
<a name="l00174"></a>00174 <span class="comment"> *  structure is filled in. Any pointer (field ending in p) is</span>
<a name="l00175"></a>00175 <span class="comment"> *  actually the offset from the beginning of the mbuf the option</span>
<a name="l00176"></a>00176 <span class="comment"> *  is contained in.  A value of NULL for any pointer</span>
<a name="l00177"></a>00177 <span class="comment"> *  means that the option is not present. The length any option</span>
<a name="l00178"></a>00178 <span class="comment"> *  does not include the option code or option length fields.</span>
<a name="l00179"></a>00179 <span class="comment"> */</span>
<a name="l00180"></a><a class="code" href="structclnp__optidx.html">00180</a> <span class="keyword">struct </span><a class="code" href="structclnp__optidx.html">clnp_optidx</a> {
<a name="l00181"></a><a class="code" href="structclnp__optidx.html#a4e99d5b9c9fbb46257ce10903dbfd185">00181</a>     u_short         <a class="code" href="structclnp__optidx.html#a4e99d5b9c9fbb46257ce10903dbfd185">cni_securep</a>;    <span class="comment">/* ptr to start of security option */</span>
<a name="l00182"></a><a class="code" href="structclnp__optidx.html#a413dcda251daeee3f141b1f2eccb04f2">00182</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#a413dcda251daeee3f141b1f2eccb04f2">cni_secure_len</a>; <span class="comment">/* length of entire security option */</span>
<a name="l00183"></a>00183 
<a name="l00184"></a><a class="code" href="structclnp__optidx.html#ae8bd552a1bfdb19b89b4110d55127f49">00184</a>     u_short         <a class="code" href="structclnp__optidx.html#ae8bd552a1bfdb19b89b4110d55127f49">cni_srcrt_s</a>;    <span class="comment">/* offset of start of src rt option */</span>
<a name="l00185"></a><a class="code" href="structclnp__optidx.html#ac4076c6cfa71113f700cf1dd437a349b">00185</a>     u_short         <a class="code" href="structclnp__optidx.html#ac4076c6cfa71113f700cf1dd437a349b">cni_srcrt_len</a>;  <span class="comment">/* length of entire src rt option */</span>
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="structclnp__optidx.html#a1c686c5f57d5ea555cfdcf18b3a999f0">00187</a>     u_short         <a class="code" href="structclnp__optidx.html#a1c686c5f57d5ea555cfdcf18b3a999f0">cni_recrtp</a>; <span class="comment">/* ptr to beginning of recrt option */</span>
<a name="l00188"></a><a class="code" href="structclnp__optidx.html#a3a6b29b6eb388f934efb93fbe3a7e2aa">00188</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#a3a6b29b6eb388f934efb93fbe3a7e2aa">cni_recrt_len</a>;  <span class="comment">/* length of entire recrt option */</span>
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="structclnp__optidx.html#a038ff19c4f67a85182efeda50b445b2e">00190</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#a038ff19c4f67a85182efeda50b445b2e">cni_priorp</a>; <span class="comment">/* ptr to priority option */</span>
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="structclnp__optidx.html#aeebb74f3aea02a3ef5f4829e128ef52d">00192</a>     u_short         <a class="code" href="structclnp__optidx.html#aeebb74f3aea02a3ef5f4829e128ef52d">cni_qos_formatp</a>;    <span class="comment">/* ptr to format of qos</span>
<a name="l00193"></a>00193 <span class="comment">                         * option */</span>
<a name="l00194"></a><a class="code" href="structclnp__optidx.html#af5463301972cafa6d072309a914cb5b8">00194</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#af5463301972cafa6d072309a914cb5b8">cni_qos_len</a>;    <span class="comment">/* length of entire qos option */</span>
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="structclnp__optidx.html#a2d2b8ac17572126f8ded6d58c50d678f">00196</a>     u_char          <a class="code" href="structclnp__optidx.html#a2d2b8ac17572126f8ded6d58c50d678f">cni_er_reason</a>;  <span class="comment">/* reason from ER pdu option */</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="comment">/* ESIS options */</span>
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="structclnp__optidx.html#a4ac90ddeef53b67b1a8d4dc19705264f">00200</a>     u_short         <a class="code" href="structclnp__optidx.html#a4ac90ddeef53b67b1a8d4dc19705264f">cni_esct</a>;   <span class="comment">/* value from ISH ESCT option */</span>
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="structclnp__optidx.html#a79e2f74237c5543899900713aec82de0">00202</a>     u_short         <a class="code" href="structclnp__optidx.html#a79e2f74237c5543899900713aec82de0">cni_netmaskp</a>;   <span class="comment">/* ptr to beginning of netmask option */</span>
<a name="l00203"></a><a class="code" href="structclnp__optidx.html#a11808644e58c218718d256b671eb7235">00203</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#a11808644e58c218718d256b671eb7235">cni_netmask_len</a>;    <span class="comment">/* length of entire netmask</span>
<a name="l00204"></a>00204 <span class="comment">                         * option */</span>
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="structclnp__optidx.html#a923268649f243421647bc54ed8176185">00206</a>     u_short         <a class="code" href="structclnp__optidx.html#a923268649f243421647bc54ed8176185">cni_snpamaskp</a>;  <span class="comment">/* ptr to start of snpamask option */</span>
<a name="l00207"></a><a class="code" href="structclnp__optidx.html#a09e47141295e3edf035823d76f501524">00207</a>     <span class="keywordtype">char</span>            <a class="code" href="structclnp__optidx.html#a09e47141295e3edf035823d76f501524">cni_snpamask_len</a>;   <span class="comment">/* length of entire snpamask</span>
<a name="l00208"></a>00208 <span class="comment">                         * option */</span>
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 };
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="clnp_8h.html#a8aa84cf5a80643d887ae3432644e9ea2">00212</a> <span class="preprocessor">#define ER_INVALREAS    0xff    </span><span class="comment">/* code for invalid ER pdu discard reason */</span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="comment">/* given an mbuf and addr of option, return offset from data of mbuf */</span>
<a name="l00215"></a><a class="code" href="clnp_8h.html#acb5b391e1dfb5626b8c9fc75543f7200">00215</a> <span class="preprocessor">#define CLNP_OPTTOOFF(m, opt) ((u_short) (opt - mtod(m, caddr_t)))</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>
<a name="l00217"></a>00217 <span class="comment">/* given an mbuf and offset of option, return address of option */</span>
<a name="l00218"></a><a class="code" href="clnp_8h.html#a7a8e92190debb4e81a1d0d4ed1f5a449">00218</a> <span class="preprocessor">#define CLNP_OFFTOOPT(m, off) ((caddr_t) (mtod(m, caddr_t) + off))</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00220"></a>00220 <span class="comment">/* return true iff src route is valid */</span>
<a name="l00221"></a><a class="code" href="clnp_8h.html#af46d3b71c8f46568a48accb8cf0bed23">00221</a> <span class="preprocessor">#define CLNPSRCRT_VALID(oidx) ((oidx) &amp;&amp; (oidx-&gt;cni_srcrt_s))</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>
<a name="l00223"></a>00223 <span class="comment">/* return the offset field of the src rt */</span>
<a name="l00224"></a><a class="code" href="clnp_8h.html#ab6ac557ab15227f1da18023dfa35e14e">00224</a> <span class="preprocessor">#define CLNPSRCRT_OFF(oidx, options)\</span>
<a name="l00225"></a>00225 <span class="preprocessor">    (*((u_char *)(CLNP_OFFTOOPT(options, oidx-&gt;cni_srcrt_s) + 1)))</span>
<a name="l00226"></a>00226 <span class="preprocessor"></span>
<a name="l00227"></a>00227 <span class="comment">/* return the type field of the src rt */</span>
<a name="l00228"></a><a class="code" href="clnp_8h.html#a7acd84c497e2ab2c82fb930cc4fd1c24">00228</a> <span class="preprocessor">#define CLNPSRCRT_TYPE(oidx, options)\</span>
<a name="l00229"></a>00229 <span class="preprocessor">    ((u_char)(*(CLNP_OFFTOOPT(options, oidx-&gt;cni_srcrt_s))))</span>
<a name="l00230"></a>00230 <span class="preprocessor"></span>
<a name="l00231"></a>00231 <span class="comment">/* return the length of the current address */</span>
<a name="l00232"></a><a class="code" href="clnp_8h.html#a37933861db19529ebb61c482484c8a78">00232</a> <span class="preprocessor">#define CLNPSRCRT_CLEN(oidx, options)\</span>
<a name="l00233"></a>00233 <span class="preprocessor">    ((u_char)(*(CLNP_OFFTOOPT(options, oidx-&gt;cni_srcrt_s) + CLNPSRCRT_OFF(oidx, options) - 1)))</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span>
<a name="l00235"></a>00235 <span class="comment">/* return the address of the current address */</span>
<a name="l00236"></a><a class="code" href="clnp_8h.html#a3b4acd00333dc05000eb390cedfd1350">00236</a> <span class="preprocessor">#define CLNPSRCRT_CADDR(oidx, options)\</span>
<a name="l00237"></a>00237 <span class="preprocessor">    ((caddr_t)(CLNP_OFFTOOPT(options, oidx-&gt;cni_srcrt_s) + CLNPSRCRT_OFF(oidx, options)))</span>
<a name="l00238"></a>00238 <span class="preprocessor"></span>
<a name="l00239"></a>00239 <span class="comment">/*</span>
<a name="l00240"></a>00240 <span class="comment"> * return true if the src route has run out of routes this is true if the</span>
<a name="l00241"></a>00241 <span class="comment"> * offset of next route is greater than the end of the rt</span>
<a name="l00242"></a>00242 <span class="comment"> */</span>
<a name="l00243"></a><a class="code" href="clnp_8h.html#a82173eeb014f3178f024e242568fca1e">00243</a> <span class="preprocessor">#define CLNPSRCRT_TERM(oidx, options)\</span>
<a name="l00244"></a>00244 <span class="preprocessor">    (CLNPSRCRT_OFF(oidx, options) &gt; oidx-&gt;cni_srcrt_len)</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span>
<a name="l00246"></a>00246 <span class="comment">/*</span>
<a name="l00247"></a>00247 <span class="comment"> *  Options a user can set/get</span>
<a name="l00248"></a>00248 <span class="comment"> */</span>
<a name="l00249"></a><a class="code" href="clnp_8h.html#aaa2970c388cea1de5e1c79dd8799d399">00249</a> <span class="preprocessor">#define CLNPOPT_FLAGS   0x01    </span><span class="comment">/* flags: seg permitted, no er xmit, etc  */</span>
<a name="l00250"></a><a class="code" href="clnp_8h.html#a51662e99fa8fb30e9651040197ed0a96">00250</a> <span class="preprocessor">#define CLNPOPT_OPTS    0x02    </span><span class="comment">/* datagram options */</span>
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="comment">/*</span>
<a name="l00253"></a>00253 <span class="comment"> *  Values for particular datagram options</span>
<a name="l00254"></a>00254 <span class="comment"> */</span>
<a name="l00255"></a><a class="code" href="clnp_8h.html#ac45749a03379eb9f0b395e191d545097">00255</a> <span class="preprocessor">#define CLNPOVAL_PAD        0xcc    </span><span class="comment">/* padding */</span>
<a name="l00256"></a><a class="code" href="clnp_8h.html#af32290bf4b21a597fb6b6d0d9fe3598a">00256</a> <span class="preprocessor">#define CLNPOVAL_SECURE     0xc5    </span><span class="comment">/* security */</span>
<a name="l00257"></a><a class="code" href="clnp_8h.html#aa28a78ecd0d0a6be91d2343adb22fec0">00257</a> <span class="preprocessor">#define CLNPOVAL_SRCRT      0xc8    </span><span class="comment">/* source routing */</span>
<a name="l00258"></a><a class="code" href="clnp_8h.html#a45bd293fd8aca04314ac0605044889ae">00258</a> <span class="preprocessor">#define CLNPOVAL_RECRT      0xcb    </span><span class="comment">/* record route */</span>
<a name="l00259"></a><a class="code" href="clnp_8h.html#ae10a7825121bc591701452e31190378e">00259</a> <span class="preprocessor">#define CLNPOVAL_QOS        0xc3    </span><span class="comment">/* quality of service */</span>
<a name="l00260"></a><a class="code" href="clnp_8h.html#ae3fd29879202831bf68235bf96a0fdff">00260</a> <span class="preprocessor">#define CLNPOVAL_PRIOR      0xcd    </span><span class="comment">/* priority */</span>
<a name="l00261"></a><a class="code" href="clnp_8h.html#a1ed31bb9cc7b6b7bd29e81e3cff4c11e">00261</a> <span class="preprocessor">#define CLNPOVAL_ERREAS     0xc1    </span><span class="comment">/* ER PDU ONLY: reason for discard */</span>
<a name="l00262"></a>00262 
<a name="l00263"></a><a class="code" href="clnp_8h.html#a59f48dcd2dc85568d6076aa3cf5af6a4">00263</a> <span class="preprocessor">#define CLNPOVAL_SRCSPEC    0x40    </span><span class="comment">/* source address specific */</span>
<a name="l00264"></a><a class="code" href="clnp_8h.html#a6bf994c62099885d4d4ccd466dae3a55">00264</a> <span class="preprocessor">#define CLNPOVAL_DSTSPEC    0x80    </span><span class="comment">/* destination address specific */</span>
<a name="l00265"></a><a class="code" href="clnp_8h.html#a378fd12916c1965bcfd09b47a50e66a3">00265</a> <span class="preprocessor">#define CLNPOVAL_GLOBAL     0xc0    </span><span class="comment">/* globally unique */</span>
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/* Globally Unique QOS */</span>
<a name="l00268"></a><a class="code" href="clnp_8h.html#ae424f142bd313b7a68a533e17ca28e6c">00268</a> <span class="preprocessor">#define CLNPOVAL_SEQUENCING 0x10    </span><span class="comment">/* sequencing preferred */</span>
<a name="l00269"></a><a class="code" href="clnp_8h.html#a74dcce4ed3c23221c486d57fc54ec423">00269</a> <span class="preprocessor">#define CLNPOVAL_CONGESTED  0x08    </span><span class="comment">/* congestion experienced */</span>
<a name="l00270"></a><a class="code" href="clnp_8h.html#a2dc8f62f4e2f28170156ec8c308d9214">00270</a> <span class="preprocessor">#define CLNPOVAL_LOWDELAY   0x04    </span><span class="comment">/* low transit delay */</span>
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="clnp_8h.html#a7c968e3defec64c4cedb49646fe8e199">00272</a> <span class="preprocessor">#define CLNPOVAL_PARTRT     0x00    </span><span class="comment">/* partial source routing */</span>
<a name="l00273"></a><a class="code" href="clnp_8h.html#aae97d5579927729eb469f7f17377b190">00273</a> <span class="preprocessor">#define CLNPOVAL_COMPRT     0x01    </span><span class="comment">/* complete source routing */</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="comment">/*</span>
<a name="l00276"></a>00276 <span class="comment"> *  Clnp flags used in a control block flags field.</span>
<a name="l00277"></a>00277 <span class="comment"> *  NOTE: these must be out of the range of bits defined in ../net/raw_cb.h</span>
<a name="l00278"></a>00278 <span class="comment"> */</span>
<a name="l00279"></a><a class="code" href="clnp_8h.html#a41c532771aff76ae742db944b547489f">00279</a> <span class="preprocessor">#define CLNP_NO_SEG     0x010   </span><span class="comment">/* segmentation not permitted */</span>
<a name="l00280"></a><a class="code" href="clnp_8h.html#a56357e8bb552213b073d90fef4100e80">00280</a> <span class="preprocessor">#define CLNP_NO_ER      0x020   </span><span class="comment">/* do not generate ERs */</span>
<a name="l00281"></a><a class="code" href="clnp_8h.html#aa1a85d48bbd206b5fb5439ebb1879569">00281</a> <span class="preprocessor">#define CLNP_SEND_RAW       0x080   </span><span class="comment">/* send pkt as RAW DT not TP DT */</span>
<a name="l00282"></a><a class="code" href="clnp_8h.html#a3b73ef871b0aa3420a431fbf64367759">00282</a> <span class="preprocessor">#define CLNP_NO_CKSUM       0x100   </span><span class="comment">/* don&#39;t use clnp checksum */</span>
<a name="l00283"></a><a class="code" href="clnp_8h.html#a55550bb338de433ad80a32ce73271045">00283</a> <span class="preprocessor">#define CLNP_ECHO       0x200   </span><span class="comment">/* send echo request */</span>
<a name="l00284"></a><a class="code" href="clnp_8h.html#accdc1e77669f5c596ed592bc58398c69">00284</a> <span class="preprocessor">#define CLNP_NOCACHE        0x400   </span><span class="comment">/* don&#39;t store cache information */</span>
<a name="l00285"></a><a class="code" href="clnp_8h.html#afdc66e86c29bf4b1cc71dc95dec50118">00285</a> <span class="preprocessor">#define CLNP_ECHOR      0x800   </span><span class="comment">/* send echo reply */</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="comment">/* valid clnp flags */</span>
<a name="l00288"></a><a class="code" href="clnp_8h.html#a8fb65566982ae304d328a8c26ab391fe">00288</a> <span class="preprocessor">#define CLNP_VFLAGS \</span>
<a name="l00289"></a>00289 <span class="preprocessor">    (CLNP_SEND_RAW|CLNP_NO_SEG|CLNP_NO_ER|CLNP_NO_CKSUM|\</span>
<a name="l00290"></a>00290 <span class="preprocessor">     CLNP_ECHO|CLNP_NOCACHE|CLNP_ECHOR)</span>
<a name="l00291"></a>00291 <span class="preprocessor"></span>
<a name="l00292"></a>00292 <span class="comment">/*</span>
<a name="l00293"></a>00293 <span class="comment"> * Constants used by clnp</span>
<a name="l00294"></a>00294 <span class="comment"> */</span>
<a name="l00295"></a><a class="code" href="clnp_8h.html#a5f5a276e8947bc8c95582bf2f7534537">00295</a> <span class="preprocessor">#define CLNP_HDR_MIN    (sizeof (struct clnp_fixed))</span>
<a name="l00296"></a><a class="code" href="clnp_8h.html#a6f70cfbe852959b54f0802f38e254a45">00296</a> <span class="preprocessor"></span><span class="preprocessor">#define CLNP_HDR_MAX    (254)</span>
<a name="l00297"></a><a class="code" href="clnp_8h.html#a10e38c22bc01d7782c82e65070b473cb">00297</a> <span class="preprocessor"></span><span class="preprocessor">#define CLNP_TTL_UNITS  2   </span><span class="comment">/* 500 milliseconds */</span>
<a name="l00298"></a><a class="code" href="clnp_8h.html#a0b1894ca4d319d0481a384af86046a28">00298</a> <span class="preprocessor">#define CLNP_TTL    15*CLNP_TTL_UNITS   </span><span class="comment">/* time to live (seconds) */</span>
<a name="l00299"></a><a class="code" href="clnp_8h.html#ac3c1878b27cd1248f71680beefb15951">00299</a> <span class="preprocessor">#define ISO8473_V1  0x01</span>
<a name="l00300"></a>00300 <span class="preprocessor"></span>
<a name="l00301"></a>00301 <span class="comment">/*</span>
<a name="l00302"></a>00302 <span class="comment"> *  Clnp packet types</span>
<a name="l00303"></a>00303 <span class="comment"> *  In order to test raw clnp and tp/clnp simultaneously, a third type of</span>
<a name="l00304"></a>00304 <span class="comment"> *  packet has been defined: CLNP_RAW. This is done so that the input</span>
<a name="l00305"></a>00305 <span class="comment"> *  routine can switch to the correct input routine (rclnp_input or</span>
<a name="l00306"></a>00306 <span class="comment"> *  tpclnp_input) based on the type field. If clnp had a higher level</span>
<a name="l00307"></a>00307 <span class="comment"> *  protocol field, this would not be necessary.</span>
<a name="l00308"></a>00308 <span class="comment"> */</span>
<a name="l00309"></a><a class="code" href="clnp_8h.html#ab5cf5ab7f9217e82e199e3339431b3c3">00309</a> <span class="preprocessor">#define CLNP_DT         0x1C    </span><span class="comment">/* normal data */</span>
<a name="l00310"></a><a class="code" href="clnp_8h.html#aae5ec5e60b26c3d8c785e28051561b79">00310</a> <span class="preprocessor">#define CLNP_ER         0x01    </span><span class="comment">/* error report */</span>
<a name="l00311"></a><a class="code" href="clnp_8h.html#ae8468f8e8022a265abd67596c2f11a9b">00311</a> <span class="preprocessor">#define CLNP_RAW        0x1D    </span><span class="comment">/* debug only */</span>
<a name="l00312"></a><a class="code" href="clnp_8h.html#ad949332de31dcea4aa1c0dbd35be55ea">00312</a> <span class="preprocessor">#define CLNP_EC         0x1E    </span><span class="comment">/* echo packet */</span>
<a name="l00313"></a><a class="code" href="clnp_8h.html#a3c7e364f37a3a9cee02ae4cfefdcc3e7">00313</a> <span class="preprocessor">#define CLNP_ECR        0x1F    </span><span class="comment">/* echo reply */</span>
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="comment">/*</span>
<a name="l00316"></a>00316 <span class="comment"> *  ER pdu error codes</span>
<a name="l00317"></a>00317 <span class="comment"> */</span>
<a name="l00318"></a><a class="code" href="clnp_8h.html#ac0ec2a6007ab1caca5a05c2e8668b628">00318</a> <span class="preprocessor">#define GEN_NOREAS      0x00    </span><span class="comment">/* reason not specified */</span>
<a name="l00319"></a><a class="code" href="clnp_8h.html#a15df7870d4976f8b82a00dc98dcd4d76">00319</a> <span class="preprocessor">#define GEN_PROTOERR        0x01    </span><span class="comment">/* protocol procedure error */</span>
<a name="l00320"></a><a class="code" href="clnp_8h.html#ab2178849213aa60fd0935e56ce449b63">00320</a> <span class="preprocessor">#define GEN_BADCSUM     0x02    </span><span class="comment">/* incorrect checksum */</span>
<a name="l00321"></a><a class="code" href="clnp_8h.html#a228b069e2c7fa0a9ee65f486722323d8">00321</a> <span class="preprocessor">#define GEN_CONGEST     0x03    </span><span class="comment">/* pdu discarded due to congestion */</span>
<a name="l00322"></a><a class="code" href="clnp_8h.html#ab28a36b5cbe2281d2008f3a925774b5e">00322</a> <span class="preprocessor">#define GEN_HDRSYNTAX       0x04    </span><span class="comment">/* header syntax error */</span>
<a name="l00323"></a><a class="code" href="clnp_8h.html#a9aa8cc731e692dd5afc7773d747dff53">00323</a> <span class="preprocessor">#define GEN_SEGNEEDED       0x05    </span><span class="comment">/* need segmentation but not allowed */</span>
<a name="l00324"></a><a class="code" href="clnp_8h.html#ab74809ed02e3a3dba51407f3a453809b">00324</a> <span class="preprocessor">#define GEN_INCOMPLETE      0x06    </span><span class="comment">/* incomplete pdu received */</span>
<a name="l00325"></a><a class="code" href="clnp_8h.html#a0f26dda6890e1758f6b1fe45231fafae">00325</a> <span class="preprocessor">#define GEN_DUPOPT      0x07    </span><span class="comment">/* duplicate option */</span>
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 <span class="comment">/* address errors */</span>
<a name="l00328"></a><a class="code" href="clnp_8h.html#a8d592b41d9b37d717e5a2400ea825e8f">00328</a> <span class="preprocessor">#define ADDR_DESTUNREACH    0x80    </span><span class="comment">/* destination address unreachable */</span>
<a name="l00329"></a><a class="code" href="clnp_8h.html#a11a5d7ec8cd1c01c0e60955043623f57">00329</a> <span class="preprocessor">#define ADDR_DESTUNKNOWN    0x81    </span><span class="comment">/* destination address unknown */</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="comment">/* source routing */</span>
<a name="l00332"></a><a class="code" href="clnp_8h.html#a90fbded22693e654314e73661178bc99">00332</a> <span class="preprocessor">#define SRCRT_UNSPECERR     0x90    </span><span class="comment">/* unspecified src rt error */</span>
<a name="l00333"></a><a class="code" href="clnp_8h.html#a5d9046e318799291cbb127084b5d3910">00333</a> <span class="preprocessor">#define SRCRT_SYNTAX        0x91    </span><span class="comment">/* syntax error in src rt field */</span>
<a name="l00334"></a><a class="code" href="clnp_8h.html#ae3e5a8bc6b44db2043c96dfb1cae92d3">00334</a> <span class="preprocessor">#define SRCRT_UNKNOWNADDR   0x92    </span><span class="comment">/* unknown addr in src rt field */</span>
<a name="l00335"></a><a class="code" href="clnp_8h.html#af5d0a9d79700b9ab619a633707c8bd0f">00335</a> <span class="preprocessor">#define SRCRT_BADPATH       0x93    </span><span class="comment">/* path not acceptable */</span>
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="comment">/* lifetime */</span>
<a name="l00338"></a><a class="code" href="clnp_8h.html#acc94d029a5b72ff9aee03be8a834d84f">00338</a> <span class="preprocessor">#define TTL_EXPTRANSIT      0xa0    </span><span class="comment">/* lifetime expired during transit */</span>
<a name="l00339"></a><a class="code" href="clnp_8h.html#ada07088193a71f7276c88d907d19ea74">00339</a> <span class="preprocessor">#define TTL_EXPREASS        0xa1    </span><span class="comment">/* lifetime expired during reassembly */</span>
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="comment">/* pdu discarded */</span>
<a name="l00342"></a><a class="code" href="clnp_8h.html#a1dd09e2a8f244c80f6a2cea77f1ce2d0">00342</a> <span class="preprocessor">#define DISC_UNSUPPOPT      0xb0    </span><span class="comment">/* unsupported option not specified? */</span>
<a name="l00343"></a><a class="code" href="clnp_8h.html#a4a614058b412a5aac72ea001d21f7205">00343</a> <span class="preprocessor">#define DISC_UNSUPPVERS     0xb1    </span><span class="comment">/* unsupported protocol version */</span>
<a name="l00344"></a><a class="code" href="clnp_8h.html#a904fcb067c9fdc21f392c792dbf0ac68">00344</a> <span class="preprocessor">#define DISC_UNSUPPSECURE   0xb2    </span><span class="comment">/* unsupported security option */</span>
<a name="l00345"></a><a class="code" href="clnp_8h.html#ab0422e02b03a92c40e372e874c08997b">00345</a> <span class="preprocessor">#define DISC_UNSUPPSRCRT    0xb3    </span><span class="comment">/* unsupported src rt option */</span>
<a name="l00346"></a><a class="code" href="clnp_8h.html#ad4cc61566bd230bfc9fa2ab31f87c1f1">00346</a> <span class="preprocessor">#define DISC_UNSUPPRECRT    0xb4    </span><span class="comment">/* unsupported rec rt option */</span>
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="comment">/* reassembly */</span>
<a name="l00349"></a><a class="code" href="clnp_8h.html#ae1b1fc64a093a92513975bb619605cbb">00349</a> <span class="preprocessor">#define REASS_INTERFERE     0xc0    </span><span class="comment">/* reassembly interference */</span>
<a name="l00350"></a><a class="code" href="clnp_8h.html#af555a644c51ab8a6d9bb12abe582c1d0">00350</a> <span class="preprocessor">#define CLNP_ERRORS     22</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span>
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="preprocessor">#ifdef CLNP_ER_CODES</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span>u_char          clnp_er_codes[<a class="code" href="clnp_8h.html#af555a644c51ab8a6d9bb12abe582c1d0">CLNP_ERRORS</a>] = {
<a name="l00355"></a>00355     <a class="code" href="clnp_8h.html#ac0ec2a6007ab1caca5a05c2e8668b628">GEN_NOREAS</a>, <a class="code" href="clnp_8h.html#a15df7870d4976f8b82a00dc98dcd4d76">GEN_PROTOERR</a>, <a class="code" href="clnp_8h.html#ab2178849213aa60fd0935e56ce449b63">GEN_BADCSUM</a>, <a class="code" href="clnp_8h.html#a228b069e2c7fa0a9ee65f486722323d8">GEN_CONGEST</a>,
<a name="l00356"></a>00356     <a class="code" href="clnp_8h.html#ab28a36b5cbe2281d2008f3a925774b5e">GEN_HDRSYNTAX</a>, <a class="code" href="clnp_8h.html#a9aa8cc731e692dd5afc7773d747dff53">GEN_SEGNEEDED</a>, <a class="code" href="clnp_8h.html#ab74809ed02e3a3dba51407f3a453809b">GEN_INCOMPLETE</a>, <a class="code" href="clnp_8h.html#a0f26dda6890e1758f6b1fe45231fafae">GEN_DUPOPT</a>,
<a name="l00357"></a>00357     <a class="code" href="clnp_8h.html#a8d592b41d9b37d717e5a2400ea825e8f">ADDR_DESTUNREACH</a>, <a class="code" href="clnp_8h.html#a11a5d7ec8cd1c01c0e60955043623f57">ADDR_DESTUNKNOWN</a>,
<a name="l00358"></a>00358     <a class="code" href="clnp_8h.html#a90fbded22693e654314e73661178bc99">SRCRT_UNSPECERR</a>, <a class="code" href="clnp_8h.html#a5d9046e318799291cbb127084b5d3910">SRCRT_SYNTAX</a>, <a class="code" href="clnp_8h.html#ae3e5a8bc6b44db2043c96dfb1cae92d3">SRCRT_UNKNOWNADDR</a>, <a class="code" href="clnp_8h.html#af5d0a9d79700b9ab619a633707c8bd0f">SRCRT_BADPATH</a>,
<a name="l00359"></a>00359     <a class="code" href="clnp_8h.html#acc94d029a5b72ff9aee03be8a834d84f">TTL_EXPTRANSIT</a>, <a class="code" href="clnp_8h.html#ada07088193a71f7276c88d907d19ea74">TTL_EXPREASS</a>,
<a name="l00360"></a>00360     <a class="code" href="clnp_8h.html#a1dd09e2a8f244c80f6a2cea77f1ce2d0">DISC_UNSUPPOPT</a>, <a class="code" href="clnp_8h.html#a4a614058b412a5aac72ea001d21f7205">DISC_UNSUPPVERS</a>, <a class="code" href="clnp_8h.html#a904fcb067c9fdc21f392c792dbf0ac68">DISC_UNSUPPSECURE</a>,
<a name="l00361"></a>00361     <a class="code" href="clnp_8h.html#ab0422e02b03a92c40e372e874c08997b">DISC_UNSUPPSRCRT</a>, <a class="code" href="clnp_8h.html#ad4cc61566bd230bfc9fa2ab31f87c1f1">DISC_UNSUPPRECRT</a>, <a class="code" href="clnp_8h.html#ae1b1fc64a093a92513975bb619605cbb">REASS_INTERFERE</a>
<a name="l00362"></a>00362 };
<a name="l00363"></a>00363 <span class="preprocessor">#endif</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span>
<a name="l00365"></a>00365 <span class="preprocessor">#ifdef  TROLL</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>
<a name="l00367"></a>00367 <span class="preprocessor">#define TR_DUPEND       0x01    </span><span class="comment">/* duplicate end of fragment */</span>
<a name="l00368"></a>00368 <span class="preprocessor">#define TR_DUPPKT       0x02    </span><span class="comment">/* duplicate entire packet */</span>
<a name="l00369"></a>00369 <span class="preprocessor">#define TR_DROPPKT      0x04    </span><span class="comment">/* drop packet on output */</span>
<a name="l00370"></a>00370 <span class="preprocessor">#define TR_TRIM         0x08    </span><span class="comment">/* trim bytes from packet */</span>
<a name="l00371"></a>00371 <span class="preprocessor">#define TR_CHANGE       0x10    </span><span class="comment">/* change bytes in packet */</span>
<a name="l00372"></a>00372 <span class="preprocessor">#define TR_MTU          0x20    </span><span class="comment">/* delta to change device mtu */</span>
<a name="l00373"></a>00373 <span class="preprocessor">#define TR_CHUCK        0x40    </span><span class="comment">/* drop packet in rclnp_input */</span>
<a name="l00374"></a>00374 <span class="preprocessor">#define TR_BLAST        0x80    </span><span class="comment">/* force rclnp_output to blast many</span>
<a name="l00375"></a>00375 <span class="comment">                     * packet */</span>
<a name="l00376"></a>00376 <span class="preprocessor">#define TR_RAWLOOP      0x100   </span><span class="comment">/* make if_loop call clnpintr</span>
<a name="l00377"></a>00377 <span class="comment">                     * directly */</span>
<a name="l00378"></a>00378 <span class="keyword">struct </span>troll {
<a name="l00379"></a>00379     <span class="keywordtype">int</span>             tr_ops; <span class="comment">/* operations to perform */</span>
<a name="l00380"></a>00380     <span class="keywordtype">float</span>           tr_dup_size;    <span class="comment">/* % to duplicate */</span>
<a name="l00381"></a>00381     <span class="keywordtype">float</span>           tr_dup_freq;    <span class="comment">/* frequency to duplicate packets */</span>
<a name="l00382"></a>00382     <span class="keywordtype">float</span>           tr_drop_freq;   <span class="comment">/* frequence to drop packets */</span>
<a name="l00383"></a>00383     <span class="keywordtype">int</span>             tr_mtu_adj; <span class="comment">/* delta to adjust if mtu */</span>
<a name="l00384"></a>00384     <span class="keywordtype">int</span>             tr_blast_cnt;   <span class="comment">/* # of pkts to blast out */</span>
<a name="l00385"></a>00385 };
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="preprocessor">#define SN_OUTPUT(clcp, m)\</span>
<a name="l00388"></a>00388 <span class="preprocessor">    troll_output(clcp-&gt;clc_ifp, m, clcp-&gt;clc_firsthop, clcp-&gt;clc_rt)</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span>
<a name="l00390"></a>00390 <span class="preprocessor">#define SN_MTU(ifp, rt) (((rt &amp;&amp; rt-&gt;rt_rmx.rmx_mtu) ?\</span>
<a name="l00391"></a>00391 <span class="preprocessor">    rt-&gt;rt_rmx.rmx_mtu : clnp_badmtu(ifp, rt, __LINE__, __FILE__))\</span>
<a name="l00392"></a>00392 <span class="preprocessor">        - trollctl.tr_mtu_adj)</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span>
<a name="l00394"></a>00394 <span class="preprocessor">#ifdef _KERNEL</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">float</span>    troll_random;
<a name="l00396"></a>00396 <span class="preprocessor">#endif</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span>
<a name="l00398"></a>00398 <span class="preprocessor">#else               </span><span class="comment">/* NO TROLL */</span>
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="clnp_8h.html#a0f0756b14a82716c5aa8521718ae3f12">00400</a> <span class="preprocessor">#define SN_OUTPUT(clcp, m)\</span>
<a name="l00401"></a>00401 <span class="preprocessor">    (*clcp-&gt;clc_ifp-&gt;if_output)(clcp-&gt;clc_ifp, m, clcp-&gt;clc_firsthop, \</span>
<a name="l00402"></a>00402 <span class="preprocessor">                    clcp-&gt;clc_rt)</span>
<a name="l00403"></a>00403 <span class="preprocessor"></span>
<a name="l00404"></a><a class="code" href="clnp_8h.html#afeefa43945e7980a6dc7a402af8bf48f">00404</a> <span class="preprocessor">#define SN_MTU(ifp, rt) (((rt &amp;&amp; rt-&gt;rt_rmx.rmx_mtu) ?\</span>
<a name="l00405"></a>00405 <span class="preprocessor">    rt-&gt;rt_rmx.rmx_mtu : clnp_badmtu(ifp, rt, __LINE__, __FILE__)))</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span>
<a name="l00407"></a>00407 <span class="preprocessor">#endif              </span><span class="comment">/* TROLL */</span>
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">/*</span>
<a name="l00410"></a>00410 <span class="comment"> *  Macro to remove an address from a clnp header</span>
<a name="l00411"></a>00411 <span class="comment"> */</span>
<a name="l00412"></a><a class="code" href="clnp_8h.html#af3b4ca696d1f6bb06c72702dad7e4f77">00412</a> <span class="preprocessor">#define CLNP_EXTRACT_ADDR(isoa, hoff, hend)\</span>
<a name="l00413"></a>00413 <span class="preprocessor">    {\</span>
<a name="l00414"></a>00414 <span class="preprocessor">        isoa.isoa_len = (u_char)*hoff;\</span>
<a name="l00415"></a>00415 <span class="preprocessor">        if ((((++hoff) + isoa.isoa_len) &gt; hend) ||\</span>
<a name="l00416"></a>00416 <span class="preprocessor">            (isoa.isoa_len &gt; 20) || (isoa.isoa_len == 0)) {\</span>
<a name="l00417"></a>00417 <span class="preprocessor">            hoff = (caddr_t)0;\</span>
<a name="l00418"></a>00418 <span class="preprocessor">        } else {\</span>
<a name="l00419"></a>00419 <span class="preprocessor">            (void) bcopy(hoff, (caddr_t)isoa.isoa_genaddr, \</span>
<a name="l00420"></a>00420 <span class="preprocessor">                     isoa.isoa_len);\</span>
<a name="l00421"></a>00421 <span class="preprocessor">            hoff += isoa.isoa_len;\</span>
<a name="l00422"></a>00422 <span class="preprocessor">        }\</span>
<a name="l00423"></a>00423 <span class="preprocessor">    }</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>
<a name="l00425"></a>00425 <span class="comment">/*</span>
<a name="l00426"></a>00426 <span class="comment"> *  Macro to insert an address into a clnp header</span>
<a name="l00427"></a>00427 <span class="comment"> */</span>
<a name="l00428"></a><a class="code" href="clnp_8h.html#a3153bcc48691fb3f712b17f1e0c7cc98">00428</a> <span class="preprocessor">#define CLNP_INSERT_ADDR(hoff, isoa)\</span>
<a name="l00429"></a>00429 <span class="preprocessor">    *hoff++ = (isoa).isoa_len;\</span>
<a name="l00430"></a>00430 <span class="preprocessor">    (void) bcopy((caddr_t)((isoa).isoa_genaddr), hoff, (isoa).isoa_len);\</span>
<a name="l00431"></a>00431 <span class="preprocessor">    hoff += (isoa).isoa_len;</span>
<a name="l00432"></a>00432 <span class="preprocessor"></span>
<a name="l00433"></a>00433 <span class="comment">/*</span>
<a name="l00434"></a>00434 <span class="comment"> *  Clnp hdr cache. Whenever a clnp packet is sent, a copy of the</span>
<a name="l00435"></a>00435 <span class="comment"> *  header is made and kept in this cache. In addition to a copy of</span>
<a name="l00436"></a>00436 <span class="comment"> *  the cached clnp hdr, the cache contains</span>
<a name="l00437"></a>00437 <span class="comment"> *  information necessary to determine whether the new packet</span>
<a name="l00438"></a>00438 <span class="comment"> *  to send requires a new header to be built.</span>
<a name="l00439"></a>00439 <span class="comment"> */</span>
<a name="l00440"></a><a class="code" href="structclnp__cache.html">00440</a> <span class="keyword">struct </span><a class="code" href="structclnp__cache.html">clnp_cache</a> {
<a name="l00441"></a>00441     <span class="comment">/* these fields are used to check the validity of the cache */</span>
<a name="l00442"></a><a class="code" href="structclnp__cache.html#aee1a358360cf110a7905f0eb317b81f2">00442</a>     <span class="keyword">struct </span><a class="code" href="structiso__addr.html">iso_addr</a> <a class="code" href="structclnp__cache.html#aee1a358360cf110a7905f0eb317b81f2">clc_dst</a>;<span class="comment">/* destination of packet */</span>
<a name="l00443"></a><a class="code" href="structclnp__cache.html#ac07cc78960cc9ac24c75e7f444b415ee">00443</a>     <span class="keyword">struct </span>mbuf    *<a class="code" href="structclnp__cache.html#ac07cc78960cc9ac24c75e7f444b415ee">clc_options</a>;    <span class="comment">/* ptr to options mbuf */</span>
<a name="l00444"></a><a class="code" href="structclnp__cache.html#a31861d0bc75b0b73e1709bded4116406">00444</a>     <span class="keywordtype">int</span>             <a class="code" href="structclnp__cache.html#a31861d0bc75b0b73e1709bded4116406">clc_flags</a>;  <span class="comment">/* flags passed to clnp_output */</span>
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <span class="comment">/* these fields are state that clnp_output requires to finish the pkt */</span>
<a name="l00447"></a><a class="code" href="structclnp__cache.html#a11a96e9ec4f35de4b2a476dd9644074a">00447</a>     <span class="keywordtype">int</span>             <a class="code" href="structclnp__cache.html#a11a96e9ec4f35de4b2a476dd9644074a">clc_segoff</a>; <span class="comment">/* offset of seg part of header */</span>
<a name="l00448"></a><a class="code" href="structclnp__cache.html#a0754804a7cc4562ad1460b99d21f3072">00448</a>     <span class="keyword">struct </span>rtentry *<a class="code" href="structclnp__cache.html#a0754804a7cc4562ad1460b99d21f3072">clc_rt</a>; <span class="comment">/* ptr to rtentry (points into the route</span>
<a name="l00449"></a>00449 <span class="comment">                 * structure) */</span>
<a name="l00450"></a><a class="code" href="structclnp__cache.html#ac30ccfa936de61e3b446ca1d4c8ff40c">00450</a>     <span class="keyword">struct </span>sockaddr *<a class="code" href="structclnp__cache.html#ac30ccfa936de61e3b446ca1d4c8ff40c">clc_firsthop</a>;  <span class="comment">/* first hop of packet */</span>
<a name="l00451"></a><a class="code" href="structclnp__cache.html#a42d2ac3a1f957b791ae73416d3eb0974">00451</a>     <span class="keyword">struct </span>ifnet   *<a class="code" href="structclnp__cache.html#a42d2ac3a1f957b791ae73416d3eb0974">clc_ifp</a>;<span class="comment">/* ptr to interface structure */</span>
<a name="l00452"></a><a class="code" href="structclnp__cache.html#a69e8f9a74a0a82b7680666657e752127">00452</a>     <span class="keyword">struct </span>iso_ifaddr
<a name="l00453"></a>00453                    *<a class="code" href="structclnp__cache.html#a69e8f9a74a0a82b7680666657e752127">clc_ifa</a>;<span class="comment">/* ptr to interface address */</span>
<a name="l00454"></a><a class="code" href="structclnp__cache.html#aea94dbe320996cde81df3f21168c75b4">00454</a>     <span class="keyword">struct </span>mbuf    *<a class="code" href="structclnp__cache.html#aea94dbe320996cde81df3f21168c75b4">clc_hdr</a>;<span class="comment">/* cached pkt hdr (finally)! */</span>
<a name="l00455"></a>00455 };
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="preprocessor">#ifdef  _KERNEL</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structiso__addr.html">iso_addr</a>;
<a name="l00459"></a>00459 <span class="keyword">struct </span><a class="code" href="structsockaddr__iso.html">sockaddr_iso</a>;
<a name="l00460"></a>00460 <span class="keyword">struct </span>mbuf;
<a name="l00461"></a>00461 <span class="keyword">struct </span><a class="code" href="structclnp__segment.html">clnp_segment</a>;
<a name="l00462"></a>00462 <span class="keyword">struct </span>sockaddr;
<a name="l00463"></a>00463 <span class="keyword">struct </span>rt_entry;
<a name="l00464"></a>00464 <span class="keyword">struct </span><a class="code" href="structclnp__fragl.html">clnp_fragl</a>;
<a name="l00465"></a>00465 <span class="keyword">struct </span><a class="code" href="structclnp__optidx.html">clnp_optidx</a>;
<a name="l00466"></a>00466 <span class="keyword">struct </span>isopcb;
<a name="l00467"></a>00467 <span class="keyword">struct </span>snpa_hdr;
<a name="l00468"></a>00468 <span class="keyword">struct </span>iso_ifaddr;
<a name="l00469"></a>00469 <span class="keyword">struct </span>route_iso;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">/* clnp_debug.c */</span>
<a name="l00472"></a>00472 <span class="keywordtype">char</span> *clnp_hexp <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>, <span class="keywordtype">char</span> *));
<a name="l00473"></a>00473 <span class="keywordtype">char</span> *clnp_iso_addrp <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00474"></a>00474 <span class="keywordtype">char</span> *clnp_saddr_isop <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structsockaddr__iso.html">sockaddr_iso</a> *));
<a name="l00475"></a>00475 
<a name="l00476"></a>00476 <span class="comment">/* clnp_er.c */</span>
<a name="l00477"></a>00477 <span class="keywordtype">void</span> clnp_er_input <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *, u_int));
<a name="l00478"></a>00478 <span class="keywordtype">void</span> clnp_discard <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, u_int));
<a name="l00479"></a>00479 <span class="keywordtype">void</span> clnp_emit_er <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, u_int));
<a name="l00480"></a>00480 <span class="keywordtype">int</span> clnp_er_index <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((u_int));
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="keywordtype">int</span> clnp_fragment <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> ifnet *, <span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> sockaddr *,
<a name="l00483"></a>00483                <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">struct</span> rtentry *));
<a name="l00484"></a>00484 <span class="keyword">struct </span>mbuf *clnp_reass <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *,
<a name="l00485"></a>00485                  <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *, <span class="keyword">struct</span> <a class="code" href="structclnp__segment.html">clnp_segment</a> *));
<a name="l00486"></a>00486 <span class="keywordtype">int</span> clnp_newpkt <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *,
<a name="l00487"></a>00487              <span class="keyword">struct</span> <a class="code" href="structclnp__segment.html">clnp_segment</a> *));
<a name="l00488"></a>00488 <span class="keywordtype">void</span> clnp_insert_frag <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structclnp__fragl.html">clnp_fragl</a> *, <span class="keyword">struct</span> mbuf *,
<a name="l00489"></a>00489                <span class="keyword">struct</span> <a class="code" href="structclnp__segment.html">clnp_segment</a> *));
<a name="l00490"></a>00490 <span class="keyword">struct </span>mbuf    *clnp_comp_pdu <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structclnp__fragl.html">clnp_fragl</a> *));
<a name="l00491"></a>00491 <span class="preprocessor">#ifdef TROLL</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span><span class="keywordtype">float</span> troll_random <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00493"></a>00493 <span class="keywordtype">int</span> troll_output <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> ifnet *, <span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> sockaddr *,
<a name="l00494"></a>00494               <span class="keyword">struct</span> rtentry *));
<a name="l00495"></a>00495 <span class="preprocessor">#endif</span>
<a name="l00496"></a>00496 <span class="preprocessor"></span>
<a name="l00497"></a>00497 <span class="comment">/* clnp_input.c */</span>
<a name="l00498"></a>00498 <span class="keywordtype">void</span> clnp_init  <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00499"></a>00499 <span class="keywordtype">void</span> clnlintr    <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00500"></a>00500 <span class="keywordtype">void</span> clnp_input <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, ...));
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="comment">/* clnp_options.c */</span>
<a name="l00503"></a>00503 <span class="keywordtype">void</span> clnp_update_srcrt <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *));
<a name="l00504"></a>00504 <span class="keywordtype">void</span> clnp_dooptions <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *, <span class="keyword">struct</span> ifnet *,
<a name="l00505"></a>00505              <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00506"></a>00506 <span class="keywordtype">int</span> clnp_set_opts <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf **, <span class="keyword">struct</span> mbuf **));
<a name="l00507"></a>00507 <span class="keywordtype">int</span> clnp_opt_sanity <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, caddr_t, <span class="keywordtype">int</span>, <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *));
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="comment">/* clnp_output.c */</span>
<a name="l00510"></a>00510 <span class="keywordtype">int</span> clnp_output <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, ...));
<a name="l00511"></a>00511 <span class="keywordtype">void</span> clnp_ctloutput <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 <span class="comment">/* clnp_raw.c */</span>
<a name="l00514"></a>00514 <span class="keywordtype">void</span> rclnp_input <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, ...));
<a name="l00515"></a>00515 <span class="keywordtype">int</span> rclnp_output <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, ...));
<a name="l00516"></a>00516 <span class="keywordtype">int</span> rclnp_ctloutput <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">int</span>, <span class="keyword">struct</span> socket *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">struct</span> mbuf **));
<a name="l00517"></a>00517 <span class="keywordtype">int</span> clnp_usrreq <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> socket *, <span class="keywordtype">int</span>, <span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> mbuf *,
<a name="l00518"></a>00518              <span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> proc *));
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="comment">/* clnp_subr.c */</span>
<a name="l00521"></a>00521 <span class="keyword">struct </span>mbuf    *clnp_data_ck <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keywordtype">int</span>));
<a name="l00522"></a>00522 caddr_t clnp_extract_addr <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((caddr_t, <span class="keywordtype">int</span>, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *,
<a name="l00523"></a>00523                    <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00524"></a>00524 <span class="keywordtype">int</span> clnp_ours   <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00525"></a>00525 <span class="keywordtype">void</span> clnp_forward <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keywordtype">int</span>, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *,
<a name="l00526"></a>00526                <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *, <span class="keywordtype">int</span>, <span class="keyword">struct</span> snpa_hdr *));
<a name="l00527"></a>00527 caddr_t clnp_insert_addr <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((caddr_t, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *, <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00528"></a>00528 <span class="keywordtype">int</span> clnp_route  <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *, <span class="keyword">struct</span> route_iso *, <span class="keywordtype">int</span>,
<a name="l00529"></a>00529              <span class="keyword">struct</span> sockaddr **, <span class="keyword">struct</span> iso_ifaddr **));
<a name="l00530"></a>00530 <span class="keywordtype">int</span> clnp_srcroute <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *, <span class="keyword">struct</span> route_iso *,
<a name="l00531"></a>00531                <span class="keyword">struct</span> sockaddr **, <span class="keyword">struct</span> iso_ifaddr **,
<a name="l00532"></a>00532                <span class="keyword">struct</span> <a class="code" href="structiso__addr.html">iso_addr</a> *));
<a name="l00533"></a>00533 <span class="keywordtype">int</span> clnp_echoreply <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> mbuf *, <span class="keywordtype">int</span>, <span class="keyword">struct</span> <a class="code" href="structsockaddr__iso.html">sockaddr_iso</a> *,
<a name="l00534"></a>00534                 <span class="keyword">struct</span> <a class="code" href="structsockaddr__iso.html">sockaddr_iso</a> *, <span class="keyword">struct</span> <a class="code" href="structclnp__optidx.html">clnp_optidx</a> *));
<a name="l00535"></a>00535 <span class="keywordtype">int</span> clnp_badmtu <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> ifnet *, <span class="keyword">struct</span> rtentry *, <span class="keywordtype">int</span>, <span class="keywordtype">char</span> *));
<a name="l00536"></a>00536 <span class="keywordtype">void</span> clnp_ypocb  <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((caddr_t, caddr_t, u_int));
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 <span class="comment">/* clnp_timer.c */</span>
<a name="l00539"></a>00539 <span class="keyword">struct </span><a class="code" href="structclnp__fragl.html">clnp_fragl</a> *clnp_freefrags <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keyword">struct</span> <a class="code" href="structclnp__fragl.html">clnp_fragl</a> *));
<a name="l00540"></a>00540 <span class="keywordtype">void</span> clnp_slowtimo <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00541"></a>00541 <span class="keywordtype">void</span> clnp_drain <a class="code" href="iso_8h.html#aa0230ca05e1a25ac35a06e0d7d47cc22">__P</a>((<span class="keywordtype">void</span>));
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="preprocessor">#ifdef  TROLL</span>
<a name="l00544"></a>00544 <span class="preprocessor"></span><span class="keyword">struct </span>troll    trollctl;
<a name="l00545"></a>00545 <span class="preprocessor">#endif </span><span class="comment">/* TROLL */</span>
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="preprocessor">#endif </span><span class="comment">/* _KERNEL */</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="clnp_8h.html">clnp.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:04 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
