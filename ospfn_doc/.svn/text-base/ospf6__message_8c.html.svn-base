<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: ospf6d/ospf6_message.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('ospf6__message_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ospf6d/ospf6_message.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="zebra_8h_source.html">zebra.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="vty_8h_source.html">vty.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="command_8h_source.html">command.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="thread_8h_source.html">thread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linklist_8h_source.html">linklist.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__proto_8h_source.html">ospf6_proto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__lsa_8h_source.html">ospf6_lsa.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__lsdb_8h_source.html">ospf6_lsdb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__network_8h_source.html">ospf6_network.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__message_8h_source.html">ospf6_message.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__top_8h_source.html">ospf6_top.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__area_8h_source.html">ospf6_area.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__neighbor_8h_source.html">ospf6_neighbor.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__interface_8h_source.html">ospf6_interface.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6__flood_8h_source.html">ospf6_flood.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ospf6d_8h_source.html">ospf6d.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ospf6_message.c:</div>
<div class="dyncontent">
<div class="center"><img src="ospf6__message_8c__incl.png" border="0" usemap="#ospf6d_2ospf6__message_8c" alt=""/></div>
<map name="ospf6d_2ospf6__message_8c" id="ospf6d_2ospf6__message_8c">
<area shape="rect" id="node3" href="zebra_8h.html" title="zebra.h" alt="" coords="1404,80,1471,107"/><area shape="rect" id="node61" href="memory_8h.html" title="memory.h" alt="" coords="3095,80,3177,107"/><area shape="rect" id="node65" href="log_8h.html" title="log.h" alt="" coords="2799,229,2851,256"/><area shape="rect" id="node68" href="vty_8h.html" title="vty.h" alt="" coords="2850,155,2901,181"/><area shape="rect" id="node70" href="thread_8h.html" title="thread.h" alt="" coords="2889,229,2961,256"/><area shape="rect" id="node73" href="command_8h.html" title="command.h" alt="" coords="2978,80,3069,107"/><area shape="rect" id="node81" href="linklist_8h.html" title="linklist.h" alt="" coords="3202,80,3272,107"/><area shape="rect" id="node83" href="ospf6__proto_8h.html" title="ospf6_proto.h" alt="" coords="3297,80,3404,107"/><area shape="rect" id="node85" href="ospf6__lsa_8h.html" title="ospf6_lsa.h" alt="" coords="3428,80,3519,107"/><area shape="rect" id="node87" href="ospf6__lsdb_8h.html" title="ospf6_lsdb.h" alt="" coords="3543,80,3643,107"/><area shape="rect" id="node89" href="ospf6__network_8h.html" title="ospf6_network.h" alt="" coords="3668,80,3791,107"/><area shape="rect" id="node91" href="ospf6__message_8h.html" title="ospf6_message.h" alt="" coords="3815,80,3945,107"/><area shape="rect" id="node93" href="ospf6__top_8h.html" title="ospf6_top.h" alt="" coords="3979,155,4073,181"/><area shape="rect" id="node95" href="ospf6__area_8h.html" title="ospf6_area.h" alt="" coords="4021,80,4120,107"/><area shape="rect" id="node98" href="ospf6__neighbor_8h.html" title="ospf6_neighbor.h" alt="" coords="4145,80,4271,107"/><area shape="rect" id="node100" href="ospf6__interface_8h.html" title="ospf6_interface.h" alt="" coords="4295,80,4421,107"/><area shape="rect" id="node102" href="ospf6__flood_8h.html" title="ospf6_flood.h" alt="" coords="4446,80,4551,107"/><area shape="rect" id="node104" href="ospf6d_8h.html" title="ospf6d.h" alt="" coords="4576,80,4651,107"/><area shape="rect" id="node57" href="zassert_8h.html" title="zassert.h" alt="" coords="597,155,675,181"/><area shape="rect" id="node59" href="str_8h.html" title="str.h" alt="" coords="699,155,748,181"/><area shape="rect" id="node63" href="memtypes_8h.html" title="lib/memtypes.h" alt="" coords="3223,155,3337,181"/><area shape="rect" id="node75" href="vector_8h.html" title="vector.h" alt="" coords="3127,155,3199,181"/><area shape="rect" id="node78" href="route__types_8h.html" title="lib/route_types.h" alt="" coords="2978,155,3101,181"/></map>
</div>
</div>
<p><a href="ospf6__message_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>&#160;&#160;&#160;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a3869fecc5c8db19d92902c7200b46498">MSG_NG</a>&#160;&#160;&#160;1</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#adfbd2808619eaf4b4a9f264083b1ae2e">ospf6_hello_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a4c3079cef10f2def25c83cc3cdf0c00f">ospf6_dbdesc_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#ac0a6a0ccb7a4c9ab4e1c5ddef8f64882">ospf6_lsreq_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a2e75752b675b33464d036ca1c53e598e">ospf6_lsupdate_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a1868994aede5b9077bf9c7231f4f458d">ospf6_lsack_print</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a5c0be22f247d1d1d8b030955e4261636">ospf6_hello_recv</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a3cad29367ca6573220adabcba49514bf">ospf6_dbdesc_recv_master</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh, struct <a class="el" href="structospf6__neighbor.html">ospf6_neighbor</a> *on)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a0e6dc40c4e2eb4ac7b9414b02c09a63d">ospf6_dbdesc_recv_slave</a> (struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh, struct <a class="el" href="structospf6__neighbor.html">ospf6_neighbor</a> *on)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#aa40c2de125d4e0b32180d9f9e383f83e">ospf6_dbdesc_recv</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a1b8b158280907094de85c2192c17f6a3">ospf6_lsreq_recv</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a07373ca9b500e004a857c4d3e20551cd">ospf6_lsupdate_recv</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a02c40333d763f545c0e65f76592b3868">ospf6_lsack_recv</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#aaa8179b6bdd70e5cf3addee60df7aa80">ospf6_iobuf_size</a> (unsigned int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a0e2dffe886aebfa4df64eb5ed857cca2">ospf6_receive</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (struct in6_addr *src, struct in6_addr *dst, struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *oi, struct <a class="el" href="structospf6__header.html">ospf6_header</a> *oh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a2e117804a7699187ffbbb2558cf3106a">ospf6_hello_send</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a42f57245d02e4581ca30fd1e5fc9a533">ospf6_dbdesc_send</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a695acafa16585e5fc57cd8c563b54c5e">ospf6_dbdesc_send_newone</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#af83f5687852b02777d049247cc518e8e">ospf6_lsreq_send</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a50608f7c51e0c039c4735781d1f66690">ospf6_lsupdate_send_neighbor</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a06554ad9592dbdbc0986c4de39f0c318">ospf6_lsupdate_send_interface</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#abaeba7b19d1caad52e507bd228656385">ospf6_lsack_send_neighbor</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a785542c289b9e000dac0b01b67630f29">ospf6_lsack_send_interface</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a1d9ee8d13a9c1344514093233f09a8e6">DEFUN</a> (debug_ospf6_message, debug_ospf6_message_cmd,&quot;debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> (<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all)&quot;, DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a561fe58e9f0eba23b452db72dea6d16d">ALIAS</a> (debug_ospf6_message, debug_ospf6_message_sendrecv_cmd,&quot;debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> (<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;, DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only sending <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only receiving <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#ab8516a397e298d14f6bb84ff7a3e4fcc">ALIAS</a> (no_debug_ospf6_message, no_debug_ospf6_message_sendrecv_cmd,&quot;no debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> &quot;&quot;(<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;, NO_STR DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only sending <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only receiving <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a5ca550936dac6d528e96deb2c7ee3037">install_element_ospf6_debug_message</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a421d44952d11523ff61b0dbddd86ce25">conf_debug_ospf6_message</a> [6] = {0x03, 0, 0, 0, 0, 0}</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a64115ee539859d9f278938a96e2ce9b5">ospf6_message_type_str</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static u_char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static u_char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a> = 0</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a3869fecc5c8db19d92902c7200b46498"></a><!-- doxytag: member="ospf6_message.c::MSG_NG" ref="a3869fecc5c8db19d92902c7200b46498" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_NG&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00229">229</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4ff2533d4f42b5b10b6caf648a4619b4"></a><!-- doxytag: member="ospf6_message.c::MSG_OK" ref="a4ff2533d4f42b5b10b6caf648a4619b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_OK&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00228">228</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a561fe58e9f0eba23b452db72dea6d16d"></a><!-- doxytag: member="ospf6_message.c::ALIAS" ref="a561fe58e9f0eba23b452db72dea6d16d" args="(debug_ospf6_message, debug_ospf6_message_sendrecv_cmd,&quot;debug ospf6 message (unknown|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;, DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 message\n&quot;&quot;Debug Unknown message\n&quot;&quot;Debug Hello message\n&quot;&quot;Debug Database Description message\n&quot;&quot;Debug Link State Request message\n&quot;&quot;Debug Link State Update message\n&quot;&quot;Debug Link State Acknowledgement message\n&quot;&quot;Debug All message\n&quot;&quot;Debug only sending message\n&quot;&quot;Debug only receiving message\n&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALIAS </td>
          <td>(</td>
          <td class="paramtype">debug_ospf6_message&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">debug_ospf6_message_sendrecv_cmd&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> (<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only sending <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only receiving <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01967">1967</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> level = 0;
  <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> = 0;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (argc &gt; 0);

  <span class="comment">/* check type */</span>
  <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;u&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;h&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;d&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsr&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsu&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsa&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;a&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#aba04e21c291bce41cba66ddb73661883">OSPF6_MESSAGE_TYPE_ALL</a>;

  <span class="keywordflow">if</span> (argc == 1)
    level = <a class="code" href="ospf6__message_8h.html#aa430a64d5e1493095599749d30cd8cab">OSPF6_DEBUG_MESSAGE_SEND</a> | <a class="code" href="ospf6__message_8h.html#a17ac12fc4c8b0d3634c0813ab0d80975">OSPF6_DEBUG_MESSAGE_RECV</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[1], <span class="stringliteral">&quot;s&quot;</span>, 1))
    level = <a class="code" href="ospf6__message_8h.html#aa430a64d5e1493095599749d30cd8cab">OSPF6_DEBUG_MESSAGE_SEND</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[1], <span class="stringliteral">&quot;r&quot;</span>, 1))
    level = <a class="code" href="ospf6__message_8h.html#a17ac12fc4c8b0d3634c0813ab0d80975">OSPF6_DEBUG_MESSAGE_RECV</a>;

  <span class="keywordflow">if</span> (type == <a class="code" href="ospf6__message_8h.html#aba04e21c291bce41cba66ddb73661883">OSPF6_MESSAGE_TYPE_ALL</a>)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
        <a class="code" href="ospf6__message_8h.html#af9e808b191d6b73f7b894853053b107d">OSPF6_DEBUG_MESSAGE_OFF</a> (i, level);
    }
  <span class="keywordflow">else</span>
    <a class="code" href="ospf6__message_8h.html#af9e808b191d6b73f7b894853053b107d">OSPF6_DEBUG_MESSAGE_OFF</a> (type, level);

  <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab8516a397e298d14f6bb84ff7a3e4fcc"></a><!-- doxytag: member="ospf6_message.c::ALIAS" ref="ab8516a397e298d14f6bb84ff7a3e4fcc" args="(no_debug_ospf6_message, no_debug_ospf6_message_sendrecv_cmd,&quot;no debug ospf6 message &quot;&quot;(unknown|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;, NO_STR DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 message\n&quot;&quot;Debug Unknown message\n&quot;&quot;Debug Hello message\n&quot;&quot;Debug Database Description message\n&quot;&quot;Debug Link State Request message\n&quot;&quot;Debug Link State Update message\n&quot;&quot;Debug Link State Acknowledgement message\n&quot;&quot;Debug All message\n&quot;&quot;Debug only sending message\n&quot;&quot;Debug only receiving message\n&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALIAS </td>
          <td>(</td>
          <td class="paramtype">no_debug_ospf6_message&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">no_debug_ospf6_message_sendrecv_cmd&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;no debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> &quot;&quot;(<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all) (send|recv)&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NO_STR DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only sending <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug only receiving <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l02041">2041</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">char</span> *type_str[] = {<span class="stringliteral">&quot;unknown&quot;</span>, <span class="stringliteral">&quot;hello&quot;</span>, <span class="stringliteral">&quot;dbdesc&quot;</span>,
                      <span class="stringliteral">&quot;lsreq&quot;</span>, <span class="stringliteral">&quot;lsupdate&quot;</span>, <span class="stringliteral">&quot;lsack&quot;</span>};
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a> = 0, r = 0;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        s |= 1 &lt;&lt; <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        r |= 1 &lt;&lt; <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
    }

  <span class="keywordflow">if</span> (s == 0x3f &amp;&amp; r == 0x3f)
    {
      <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message all%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">return</span> 0;
    }

  <span class="keywordflow">if</span> (s == 0x3f &amp;&amp; r == 0)
    {
      <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message all send%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">return</span> 0;
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s == 0 &amp;&amp; r == 0x3f)
    {
      <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message all recv%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* Unknown message is logged by default */</span>
  <span class="keywordflow">if</span> (! <a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>) &amp;&amp;
      ! <a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;no debug ospf6 message unknown%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! <a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;no debug ospf6 message unknown send%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! <a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;no debug ospf6 message unknown recv%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);

  <span class="keywordflow">for</span> (i = 1; i &lt; 6; i++)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>) &amp;&amp;
          <a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message %s%s&quot;</span>, type_str[i], <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message %s send%s&quot;</span>, type_str[i],
                 <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (i, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;debug ospf6 message %s recv%s&quot;</span>, type_str[i],
                 <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1d9ee8d13a9c1344514093233f09a8e6"></a><!-- doxytag: member="ospf6_message.c::DEFUN" ref="a1d9ee8d13a9c1344514093233f09a8e6" args="(debug_ospf6_message, debug_ospf6_message_cmd,&quot;debug ospf6 message (unknown|hello|dbdesc|lsreq|lsupdate|lsack|all)&quot;, DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 message\n&quot;&quot;Debug Unknown message\n&quot;&quot;Debug Hello message\n&quot;&quot;Debug Database Description message\n&quot;&quot;Debug Link State Request message\n&quot;&quot;Debug Link State Update message\n&quot;&quot;Debug Link State Acknowledgement message\n&quot;&quot;Debug All message\n&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFUN </td>
          <td>(</td>
          <td class="paramtype">debug_ospf6_message&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">debug_ospf6_message_cmd&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;debug <a class="el" href="structospf6.html">ospf6</a> <a class="el" href="structmessage.html">message</a> (<a class="el" href="log_8c.html#a788b2612999346d713a3fc7b8b2a3038">unknown</a>|hello|dbdesc|lsreq|lsupdate|lsack|all)&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DEBUG_STR OSPF6_STR&quot;Debug OSPFv3 <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Unknown <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Hello <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Database Description <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Request <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Update <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug Link State Acknowledgement <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&quot;Debug All <a class="el" href="structmessage.html">message</a>\<a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01912">1912</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> level = 0;
  <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> = 0;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (argc &gt; 0);

  <span class="comment">/* check type */</span>
  <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;u&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;h&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;d&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsr&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsu&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;lsa&quot;</span>, 3))
    type = <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[0], <span class="stringliteral">&quot;a&quot;</span>, 1))
    type = <a class="code" href="ospf6__message_8h.html#aba04e21c291bce41cba66ddb73661883">OSPF6_MESSAGE_TYPE_ALL</a>;

  <span class="keywordflow">if</span> (argc == 1)
    level = <a class="code" href="ospf6__message_8h.html#aa430a64d5e1493095599749d30cd8cab">OSPF6_DEBUG_MESSAGE_SEND</a> | <a class="code" href="ospf6__message_8h.html#a17ac12fc4c8b0d3634c0813ab0d80975">OSPF6_DEBUG_MESSAGE_RECV</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[1], <span class="stringliteral">&quot;s&quot;</span>, 1))
    level = <a class="code" href="ospf6__message_8h.html#aa430a64d5e1493095599749d30cd8cab">OSPF6_DEBUG_MESSAGE_SEND</a>;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! strncmp (argv[1], <span class="stringliteral">&quot;r&quot;</span>, 1))
    level = <a class="code" href="ospf6__message_8h.html#a17ac12fc4c8b0d3634c0813ab0d80975">OSPF6_DEBUG_MESSAGE_RECV</a>;

  <span class="keywordflow">if</span> (type == <a class="code" href="ospf6__message_8h.html#aba04e21c291bce41cba66ddb73661883">OSPF6_MESSAGE_TYPE_ALL</a>)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
        <a class="code" href="ospf6__message_8h.html#a144709f2d4f2c2a9231aef33c08b9f3e">OSPF6_DEBUG_MESSAGE_ON</a> (i, level);
    }
  <span class="keywordflow">else</span>
    <a class="code" href="ospf6__message_8h.html#a144709f2d4f2c2a9231aef33c08b9f3e">OSPF6_DEBUG_MESSAGE_ON</a> (type, level);

  <span class="keywordflow">return</span> <a class="code" href="command_8h.html#aa2008c1bc36d9ef42571a6ec52516d02">CMD_SUCCESS</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5ca550936dac6d528e96deb2c7ee3037"></a><!-- doxytag: member="ospf6_message.c::install_element_ospf6_debug_message" ref="a5ca550936dac6d528e96deb2c7ee3037" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void install_element_ospf6_debug_message </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l02119">2119</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;debug_ospf6_message_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;no_debug_ospf6_message_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;debug_ospf6_message_sendrecv_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;no_debug_ospf6_message_sendrecv_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;debug_ospf6_message_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_debug_ospf6_message_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;debug_ospf6_message_sendrecv_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_debug_ospf6_message_sendrecv_cmd);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4c3079cef10f2def25c83cc3cdf0c00f"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_print" ref="a4c3079cef10f2def25c83cc3cdf0c00f" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_dbdesc_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00101">101</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *dbdesc;
  <span class="keywordtype">char</span> <a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>[16];
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <a class="code" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (oh);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>);

  dbdesc = (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <a class="code" href="ospf6__proto_8c.html#a70fba8cd2453bf33405c98ff2ff14a38">ospf6_options_printbuf</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>, options, sizeof (options));

  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    MBZ: %#x Option: %s IfMTU: %hu&quot;</span>,
             dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ae44ba120f5bb73e841410bf9c395eb44">reserved1</a>, options, ntohs (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a354af018af795ae987a64381168e6272">ifmtu</a>));
  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    MBZ: %#x Bits: %s%s%s SeqNum: %#lx&quot;</span>,
             dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a051d6a8be42e57dfbf8119ee7411b27f">reserved2</a>,
             (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>) ? <span class="stringliteral">&quot;I&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>),
             (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>) ? <span class="stringliteral">&quot;M&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>),
             (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>) ? <span class="stringliteral">&quot;m&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>),
             (u_long) ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>));

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) dbdesc + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
    <a class="code" href="ospf6__lsa_8c.html#a2b62fc9a6c54cec82d621993b4c83e82">ospf6_lsa_header_print_raw</a> ((struct <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage exists&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa40c2de125d4e0b32180d9f9e383f83e"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_recv" ref="aa40c2de125d4e0b32180d9f9e383f83e" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_dbdesc_recv </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00814">814</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *dbdesc;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (src, dst, oi, oh) != <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>)
    <span class="keywordflow">return</span>;

  on = <a class="code" href="ospf6__neighbor_8c.html#a4b081b7bf89453a1d197bd4ccd21fb14">ospf6_neighbor_lookup</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
  <span class="keywordflow">if</span> (on == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor not found, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  dbdesc = (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="comment">/* Interface MTU check */</span>
  <span class="keywordflow">if</span> (ntohs (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a354af018af795ae987a64381168e6272">ifmtu</a>) != oi-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;I/F MTU mismatch&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ae44ba120f5bb73e841410bf9c395eb44">reserved1</a> || dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a051d6a8be42e57dfbf8119ee7411b27f">reserved2</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Non-0 reserved field in %s&#39;s DbDesc, correct&quot;</span>,
            on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>);
      dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ae44ba120f5bb73e841410bf9c395eb44">reserved1</a> = 0;
      dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a051d6a8be42e57dfbf8119ee7411b27f">reserved2</a> = 0;
    }

  <span class="keywordflow">if</span> (ntohl (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>) &lt; ntohl (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>))
    <a class="code" href="ospf6__message_8c.html#a3cad29367ca6573220adabcba49514bf">ospf6_dbdesc_recv_master</a> (oh, on);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ntohl (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>) &lt; ntohl (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>))
    <a class="code" href="ospf6__message_8c.html#a0e6dc40c4e2eb4ac7b9414b02c09a63d">ospf6_dbdesc_recv_slave</a> (oh, on);
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Can&#39;t decide which is master, ignore&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3cad29367ca6573220adabcba49514bf"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_recv_master" ref="a3cad29367ca6573220adabcba49514bf" args="(struct ospf6_header *oh, struct ospf6_neighbor *on)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_dbdesc_recv_master </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__neighbor.html">ospf6_neighbor</a> *&#160;</td>
          <td class="paramname"><em>on</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00397">397</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *dbdesc;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  dbdesc = (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#aafc5ff11ba1a9aafe6a27792d1137a7e">OSPF6_NEIGHBOR_INIT</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state less than Init, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">switch</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#afc191d3ebf67c52c9c2a8bb13979f915">OSPF6_NEIGHBOR_TWOWAY</a>:
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state is 2-Way, ignore&quot;</span>);
      <span class="keywordflow">return</span>;

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aafc5ff11ba1a9aafe6a27792d1137a7e">OSPF6_NEIGHBOR_INIT</a>:
      <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a1a46499f13697058c4433ef7e3d12645">twoway_received</a>, on, 0);
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#a127b580f45ab0c59d908b0a07c8b4574">OSPF6_NEIGHBOR_EXSTART</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state is not ExStart, ignore&quot;</span>);
          <span class="keywordflow">return</span>;
        }
      <span class="comment">/* else fall through to ExStart */</span>

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#a127b580f45ab0c59d908b0a07c8b4574">OSPF6_NEIGHBOR_EXSTART</a>:
      <span class="comment">/* if neighbor obeys us as our slave, schedule negotiation_done</span>
<span class="comment">         and process LSA Headers. Otherwise, ignore this message */</span>
      <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>) &amp;&amp;
          ! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>) &amp;&amp;
          ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>) == on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a>)
        {
          <span class="comment">/* execute NegotiationDone */</span>
          <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a919ab367c8cea6cb6ca56decc5dceef1">negotiation_done</a>, on, 0);

          <span class="comment">/* Record neighbor options */</span>
          <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>, dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>, sizeof (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>));
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Negotiation failed&quot;</span>);
          <span class="keywordflow">return</span>;
        }
      <span class="comment">/* fall through to exchange */</span>

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a>:
      <span class="keywordflow">if</span> (! <a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (dbdesc, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>)))
        {
          <span class="comment">/* Duplicated DatabaseDescription is dropped by master */</span>
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Duplicated dbdesc discarded by Master, ignore&quot;</span>);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Master/Slave bit mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Initialize bit mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>, dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>, sizeof (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>)))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Option field mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>) != on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Sequence number mismatch (%#lx expected)&quot;</span>,
                       (u_long) on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a>:
    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aae1490b2e9d8ca36df8b2127dcc289c1">OSPF6_NEIGHBOR_FULL</a>:
      <span class="keywordflow">if</span> (! <a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (dbdesc, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>)))
        {
          <span class="comment">/* Duplicated DatabaseDescription is dropped by master */</span>
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Duplicated dbdesc discarded by Master, ignore&quot;</span>);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Not duplicate dbdesc in state %s&quot;</span>,
            <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
      <span class="keywordflow">return</span>;

    <span class="keywordflow">default</span>:
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (0);
      <span class="keywordflow">break</span>;
    }

  <span class="comment">/* Process LSA headers */</span>
  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) dbdesc + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
    {
      <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *his, *mine;
      <span class="keyword">struct </span><a class="code" href="structospf6__lsdb.html">ospf6_lsdb</a> *lsdb = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

      his = <a class="code" href="ospf6__lsa_8c.html#a8bf58d5701076e46ec5317268c83eea2">ospf6_lsa_create_headeronly</a> ((<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s&quot;</span>, his-&gt;name);

      <span class="keywordflow">switch</span> (<a class="code" href="ospf6__lsa_8h.html#a2d9f0d76bb67a578675e6b78bf69604d">OSPF6_LSA_SCOPE</a> (his-&gt;header-&gt;type))
        {
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#ab41aaca88cc27f951f7dbf46b5a6fb5c">OSPF6_SCOPE_LINKLOCAL</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#ab033cb877fe417705f424d1bd2f411de">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0634f2bb73a043f5782d28e4e3a1ad95">OSPF6_SCOPE_AREA</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a9e658e62c2d59151531bc03b95b600bb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0701d1d9c961cfb8d6da273382ea508a">OSPF6_SCOPE_AS</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0fde4f629d4c21c3cfb402a91e1205a9">OSPF6_SCOPE_RESERVED</a>:
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignoring LSA of reserved scope&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
          <span class="keywordflow">break</span>;
        }

      <span class="keywordflow">if</span> (ntohs (his-&gt;header-&gt;type) == <a class="code" href="ospf6__lsa_8h.html#a4cba002872c9f1e86a8d3fcede9fe4dc">OSPF6_LSTYPE_AS_EXTERNAL</a> &amp;&amp;
          <a class="code" href="ospf6__area_8h.html#af08848f9c3f603caf4af634755a5f3c4">IS_AREA_STUB</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;SeqNumMismatch (E-bit mismatch), discard&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      mine = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (his-&gt;header-&gt;type, his-&gt;header-&gt;id,
                                his-&gt;header-&gt;adv_router, lsdb);
      <span class="keywordflow">if</span> (mine == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Add request (No database copy)&quot;</span>);
          <a class="code" href="ospf6__lsdb_8c.html#a0b328a0b2493e0e549d003f50003a199">ospf6_lsdb_add</a> (his, on-&gt;<a class="code" href="structospf6__neighbor.html#a1e0692790f663381e86374ed0e829f95">request_list</a>);
        }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8c.html#af1665de6eac6dab108363c1bf6320c69">ospf6_lsa_compare</a> (his, mine) &lt; 0)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Add request (Received MoreRecent)&quot;</span>);
          <a class="code" href="ospf6__lsdb_8c.html#a0b328a0b2493e0e549d003f50003a199">ospf6_lsdb_add</a> (his, on-&gt;<a class="code" href="structospf6__neighbor.html#a1e0692790f663381e86374ed0e829f95">request_list</a>);
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Discard (Existing MoreRecent)&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
        }
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }

  <span class="comment">/* Increment sequence number */</span>
  on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> ++;

  <span class="comment">/* schedule send lsreq */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> =
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#af83f5687852b02777d049247cc518e8e">ospf6_lsreq_send</a>, on, 0);

  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a>);

  <span class="comment">/* More bit check */</span>
  <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>) &amp;&amp;
      ! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>))
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a74fd583c4b2b26c3ec3c39b30ab2c54d">exchange_done</a>, on, 0);
  <span class="keywordflow">else</span>
    on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> =
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a695acafa16585e5fc57cd8c563b54c5e">ospf6_dbdesc_send_newone</a>, on, 0);

  <span class="comment">/* save last received dbdesc */</span>
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, dbdesc, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0e6dc40c4e2eb4ac7b9414b02c09a63d"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_recv_slave" ref="a0e6dc40c4e2eb4ac7b9414b02c09a63d" args="(struct ospf6_header *oh, struct ospf6_neighbor *on)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_dbdesc_recv_slave </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__neighbor.html">ospf6_neighbor</a> *&#160;</td>
          <td class="paramname"><em>on</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00608">608</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *dbdesc;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  dbdesc = (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#aafc5ff11ba1a9aafe6a27792d1137a7e">OSPF6_NEIGHBOR_INIT</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state less than Init, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">switch</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#afc191d3ebf67c52c9c2a8bb13979f915">OSPF6_NEIGHBOR_TWOWAY</a>:
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state is 2-Way, ignore&quot;</span>);
      <span class="keywordflow">return</span>;

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aafc5ff11ba1a9aafe6a27792d1137a7e">OSPF6_NEIGHBOR_INIT</a>:
      <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a1a46499f13697058c4433ef7e3d12645">twoway_received</a>, on, 0);
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#a127b580f45ab0c59d908b0a07c8b4574">OSPF6_NEIGHBOR_EXSTART</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state is not ExStart, ignore&quot;</span>);
          <span class="keywordflow">return</span>;
        }
      <span class="comment">/* else fall through to ExStart */</span>

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#a127b580f45ab0c59d908b0a07c8b4574">OSPF6_NEIGHBOR_EXSTART</a>:
      <span class="comment">/* If the neighbor is Master, act as Slave. Schedule negotiation_done</span>
<span class="comment">         and process LSA Headers. Otherwise, ignore this message */</span>
      <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>) &amp;&amp;
          <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>) &amp;&amp;
          <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>) &amp;&amp;
          ntohs (oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a>) == sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>) +
                                <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>))
        {
          <span class="comment">/* set the master/slave bit to slave */</span>
          <a class="code" href="zebra_8h.html#ab1ec1b6701a70280e13876cf1f6ae51d">UNSET_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>);

          <span class="comment">/* set the DD sequence number to one specified by master */</span>
          on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> = ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>);

          <span class="comment">/* schedule NegotiationDone */</span>
          <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a919ab367c8cea6cb6ca56decc5dceef1">negotiation_done</a>, on, 0);

          <span class="comment">/* Record neighbor options */</span>
          <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>, dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>, sizeof (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>));
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Negotiation failed&quot;</span>);
          <span class="keywordflow">return</span>;
        }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a>:
      <span class="keywordflow">if</span> (! <a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (dbdesc, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>)))
        {
          <span class="comment">/* Duplicated DatabaseDescription causes slave to retransmit */</span>
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Duplicated dbdesc causes retransmit&quot;</span>);
          <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a>);
          on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> =
            <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a42f57245d02e4581ca30fd1e5fc9a533">ospf6_dbdesc_send</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Master/Slave bit mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Initialize bit mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>, dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>, sizeof (on-&gt;<a class="code" href="structospf6__neighbor.html#a3992951f3f0c1be6d845e8ad6e732617">options</a>)))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Option field mismatch&quot;</span>);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>) != on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> + 1)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Sequence number mismatch (%#lx expected)&quot;</span>,
            (u_long) on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> + 1);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a>:
    <span class="keywordflow">case</span> <a class="code" href="ospf6__neighbor_8h.html#aae1490b2e9d8ca36df8b2127dcc289c1">OSPF6_NEIGHBOR_FULL</a>:
      <span class="keywordflow">if</span> (! <a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (dbdesc, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>)))
        {
          <span class="comment">/* Duplicated DatabaseDescription causes slave to retransmit */</span>
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Duplicated dbdesc causes retransmit&quot;</span>);
          <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a>);
          on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> =
            <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a42f57245d02e4581ca30fd1e5fc9a533">ospf6_dbdesc_send</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Not duplicate dbdesc in state %s&quot;</span>,
            <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
      <span class="keywordflow">return</span>;

    <span class="keywordflow">default</span>:
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (0);
      <span class="keywordflow">break</span>;
    }

  <span class="comment">/* Process LSA headers */</span>
  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) dbdesc + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
    {
      <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *his, *mine;
      <span class="keyword">struct </span><a class="code" href="structospf6__lsdb.html">ospf6_lsdb</a> *lsdb = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

      his = <a class="code" href="ospf6__lsa_8c.html#a8bf58d5701076e46ec5317268c83eea2">ospf6_lsa_create_headeronly</a> ((<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);

      <span class="keywordflow">switch</span> (<a class="code" href="ospf6__lsa_8h.html#a2d9f0d76bb67a578675e6b78bf69604d">OSPF6_LSA_SCOPE</a> (his-&gt;header-&gt;type))
        {
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#ab41aaca88cc27f951f7dbf46b5a6fb5c">OSPF6_SCOPE_LINKLOCAL</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#ab033cb877fe417705f424d1bd2f411de">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0634f2bb73a043f5782d28e4e3a1ad95">OSPF6_SCOPE_AREA</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a9e658e62c2d59151531bc03b95b600bb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0701d1d9c961cfb8d6da273382ea508a">OSPF6_SCOPE_AS</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0fde4f629d4c21c3cfb402a91e1205a9">OSPF6_SCOPE_RESERVED</a>:
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignoring LSA of reserved scope&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
          <span class="keywordflow">break</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a2d9f0d76bb67a578675e6b78bf69604d">OSPF6_LSA_SCOPE</a> (his-&gt;header-&gt;type) == <a class="code" href="ospf6__lsa_8h.html#a0701d1d9c961cfb8d6da273382ea508a">OSPF6_SCOPE_AS</a> &amp;&amp;
          <a class="code" href="ospf6__area_8h.html#af08848f9c3f603caf4af634755a5f3c4">IS_AREA_STUB</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;E-bit mismatch with LSA Headers&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a8e494687f908a9f68e057d004d988490">seqnumber_mismatch</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      mine = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (his-&gt;header-&gt;type, his-&gt;header-&gt;id,
                                his-&gt;header-&gt;adv_router, lsdb);
      <span class="keywordflow">if</span> (mine == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="ospf6__lsa_8c.html#af1665de6eac6dab108363c1bf6320c69">ospf6_lsa_compare</a> (his, mine) &lt; 0)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Add request-list: %s&quot;</span>, his-&gt;name);
          <a class="code" href="ospf6__lsdb_8c.html#a0b328a0b2493e0e549d003f50003a199">ospf6_lsdb_add</a> (his, on-&gt;<a class="code" href="structospf6__neighbor.html#a1e0692790f663381e86374ed0e829f95">request_list</a>);
        }
      <span class="keywordflow">else</span>
        <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }

  <span class="comment">/* Set sequence number to Master&#39;s */</span>
  on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> = ntohl (dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a>);

  <span class="comment">/* schedule send lsreq */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> =
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#af83f5687852b02777d049247cc518e8e">ospf6_lsreq_send</a>, on, 0);

  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a>);
  on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> =
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a695acafa16585e5fc57cd8c563b54c5e">ospf6_dbdesc_send_newone</a>, on, 0);

  <span class="comment">/* save last received dbdesc */</span>
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>, dbdesc, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a42f57245d02e4581ca30fd1e5fc9a533"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_send" ref="a42f57245d02e4581ca30fd1e5fc9a533" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_dbdesc_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01425">1425</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  <span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *dbdesc;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  on = (<span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#a127b580f45ab0c59d908b0a07c8b4574">OSPF6_NEIGHBOR_EXSTART</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send DbDesc to neighbor %s state %s&quot;</span>,
            on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>, <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* set next thread if master */</span>
  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>))
    on-&gt;<a class="code" href="structospf6__neighbor.html#a1a4c0c39a774eea8cd35f2f4d96f77b6">thread_send_dbdesc</a> =
      <a class="code" href="thread_8h.html#aca77b3bbd166d3573de5ecd9756a590c">thread_add_timer</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a42f57245d02e4581ca30fd1e5fc9a533">ospf6_dbdesc_send</a>, on,
                        on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a85d5e73751611ee20f1ad041a181cbde">rxmt_interval</a>);

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;
  dbdesc = (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a> *)((caddr_t) oh +
                                   <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="comment">/* if this is initial one, initialize sequence number for DbDesc */</span>
  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>))
    {
      <span class="keyword">struct </span>timeval tv;
      <span class="keywordflow">if</span> (<a class="code" href="thread_8c.html#abf5861abe71d6f9a1ddd493be0218de1">quagga_gettime</a> (<a class="code" href="thread_8h.html#a64fff521e88ba8b01645c5bb89085b33a7f92aaa461f13c163b13f96085eb3cd9">QUAGGA_CLK_MONOTONIC</a>, &amp;tv) &lt; 0)
        tv.tv_sec = 1;
      on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a> = tv.tv_sec;
    }

  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>[0] = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[0];
  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>[1] = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[1];
  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#af1290ef8a9bc29c30daa8568df7556e3">options</a>[2] = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[2];
  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a354af018af795ae987a64381168e6272">ifmtu</a> = htons (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>);
  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a> = on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>;
  dbdesc-&gt;<a class="code" href="structospf6__dbdesc.html#ad7bdcd6eb854254824f0932e67834f16">seqnum</a> = htonl (on-&gt;<a class="code" href="structospf6__neighbor.html#ac1d6bfb88eaad876f48cbda9787f617b">dbdesc_seqnum</a>);

  <span class="comment">/* if this is not initial one, set LSA headers in dbdesc */</span>
  p = (u_char *)((caddr_t) dbdesc + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>));
  <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#a1de1fec9c59c8037fa5f6cb5f8bf35cb">OSPF6_DBDESC_IBIT</a>))
    {
      <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a6f48add846713a088741ffa99ad6b1e6">dbdesc_list</a>); lsa;
           lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
        {
          <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);

          <span class="comment">/* MTU check */</span>
          <span class="keywordflow">if</span> (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &gt;
              on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
            {
              <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
              <span class="keywordflow">break</span>;
            }
          <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>));
          p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>);
        }
    }

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a2b28434ae3a26d2a1e10fc30d4384920">linklocal_addr</a>,
              on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>, oh);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a695acafa16585e5fc57cd8c563b54c5e"></a><!-- doxytag: member="ospf6_message.c::ospf6_dbdesc_send_newone" ref="a695acafa16585e5fc57cd8c563b54c5e" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_dbdesc_send_newone </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01501">1501</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = 0;

  on = (<span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  <a class="code" href="ospf6__lsdb_8c.html#afe227d03e9560c745dd0ba9a901875b0">ospf6_lsdb_remove_all</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a6f48add846713a088741ffa99ad6b1e6">dbdesc_list</a>);

  <span class="comment">/* move LSAs from summary_list to dbdesc_list (within neighbor structure)</span>
<span class="comment">     so that ospf6_send_dbdesc () can send those LSAs */</span>
  size = <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) + sizeof (struct <a class="code" href="structospf6__dbdesc.html">ospf6_dbdesc</a>);
  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a10465c504ad56aefb723065acddc0b34">summary_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="keywordflow">if</span> (size + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &gt; on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsdb_8c.html#a0b328a0b2493e0e549d003f50003a199">ospf6_lsdb_add</a> (<a class="code" href="ospf6__lsa_8c.html#a98dc000e578715b010159ca0c5b38a07">ospf6_lsa_copy</a> (lsa), on-&gt;<a class="code" href="structospf6__neighbor.html#a6f48add846713a088741ffa99ad6b1e6">dbdesc_list</a>);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#a10465c504ad56aefb723065acddc0b34">summary_list</a>);
      size += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>);
    }

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a10465c504ad56aefb723065acddc0b34">summary_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    <a class="code" href="zebra_8h.html#ab1ec1b6701a70280e13876cf1f6ae51d">UNSET_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>);

  <span class="comment">/* If slave, More bit check must be done here */</span>
  <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#aca7fe538d9edb962ca47fbeec7e4bf6b">OSPF6_DBDESC_MSBIT</a>) &amp;&amp; <span class="comment">/* Slave */</span>
      ! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a78fd4919e6c9e3d142210f5732696816">dbdesc_last</a>.<a class="code" href="structospf6__dbdesc.html#a873441f016471526c8c3516506de0f60">bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>) &amp;&amp;
      ! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac15b90e0b312bdbd6fe1c95b1008b52a">dbdesc_bits</a>, <a class="code" href="ospf6__message_8h.html#a6b4ff9c565893a42ee04d66d477b0802">OSPF6_DBDESC_MBIT</a>))
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a74fd583c4b2b26c3ec3c39b30ab2c54d">exchange_done</a>, on, 0);

  <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a42f57245d02e4581ca30fd1e5fc9a533">ospf6_dbdesc_send</a>, on, 0);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6993c2708cb37ca3e9d2da08393a68a3"></a><!-- doxytag: member="ospf6_message.c::ospf6_header_examin" ref="a6993c2708cb37ca3e9d2da08393a68a3" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ospf6_header_examin </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00231">231</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  u_char <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
  type = <a class="code" href="ospf6__message_8h.html#a634c01ceae5ec0e2116bae9b19ddfed5">OSPF6_MESSAGE_TYPE_CANONICAL</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>);

  <span class="comment">/* version check */</span>
  <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structospf6__header.html#a71abe555831003b4e41b0a623690ac93">version</a> != <a class="code" href="ospf6__proto_8h.html#ac71efe16d061e39ea5c0d9d74def4fa4">OSPFV3_VERSION</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (type, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Message with unknown version&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a3869fecc5c8db19d92902c7200b46498">MSG_NG</a>;
    }

  <span class="comment">/* Area-ID check */</span>
  <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structospf6__header.html#abc55595860947bb51724aae44da001cc">area_id</a> != oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#aec3bacc0c813ff937b5675595a3aefa6">area_id</a>)
    {
      <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structospf6__header.html#abc55595860947bb51724aae44da001cc">area_id</a> == <a class="code" href="ospf6__area_8h.html#a461d77074eb1f62868ee90de5a168446">BACKBONE_AREA_ID</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (type, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Message may be via Virtual Link: not supported&quot;</span>);
          <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a3869fecc5c8db19d92902c7200b46498">MSG_NG</a>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (type, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Area-ID mismatch&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a3869fecc5c8db19d92902c7200b46498">MSG_NG</a>;
    }

  <span class="comment">/* Instance-ID check */</span>
  <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structospf6__header.html#a098c822a8032afb65b8e7d41339c9dc1">instance_id</a> != oi-&gt;<a class="code" href="structospf6__interface.html#aa29c61e3e5509e7c844bdf19efce0268">instance_id</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (type, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Instance-ID mismatch&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a3869fecc5c8db19d92902c7200b46498">MSG_NG</a>;
    }

  <span class="comment">/* Router-ID check */</span>
  <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a> == oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>)
    <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;Detect duplicate Router-ID&quot;</span>);

  <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5b32ec41cd8e3534ecc2e602fef72589"></a><!-- doxytag: member="ospf6_message.c::ospf6_header_print" ref="a5b32ec41cd8e3534ecc2e602fef72589" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_header_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00052">52</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> router_id[16], area_id[16];
  <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, router_id, sizeof (router_id));
  <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;oh-&gt;<a class="code" href="structospf6__header.html#abc55595860947bb51724aae44da001cc">area_id</a>, area_id, sizeof (area_id));

  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    OSPFv%d Type:%d Len:%hu Router-ID:%s&quot;</span>,
             oh-&gt;<a class="code" href="structospf6__header.html#a71abe555831003b4e41b0a623690ac93">version</a>, oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, ntohs (oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a>), router_id);
  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    Area-ID:%s Cksum:%hx Instance-ID:%d&quot;</span>,
             area_id, ntohs (oh-&gt;<a class="code" href="structospf6__header.html#a399ac69f8f07f9dc898a20039d3ca47b">checksum</a>), oh-&gt;<a class="code" href="structospf6__header.html#a098c822a8032afb65b8e7d41339c9dc1">instance_id</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adfbd2808619eaf4b4a9f264083b1ae2e"></a><!-- doxytag: member="ospf6_message.c::ospf6_hello_print" ref="adfbd2808619eaf4b4a9f264083b1ae2e" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_hello_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00065">65</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *hello;
  <span class="keywordtype">char</span> <a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>[16];
  <span class="keywordtype">char</span> <a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a>[16], <a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a>[16], neighbor[16];
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <a class="code" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (oh);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>);

  hello = (<span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a>, drouter, sizeof (drouter));
  <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a>, bdrouter, sizeof (bdrouter));
  <a class="code" href="ospf6__proto_8c.html#a70fba8cd2453bf33405c98ff2ff14a38">ospf6_options_printbuf</a> (hello-&gt;<a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>, options, sizeof (options));

  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    I/F-Id:%ld Priority:%d Option:%s&quot;</span>,
             (u_long) ntohl (hello-&gt;<a class="code" href="structospf6__hello.html#a2f7c26913d42af645dc312d90b771430">interface_id</a>), hello-&gt;<a class="code" href="structospf6__hello.html#a27d677bd81ca4bb5e3da0adcdc46616c">priority</a>, options);
  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    HelloInterval:%hu DeadInterval:%hu&quot;</span>,
             ntohs (hello-&gt;<a class="code" href="structospf6__hello.html#a061d5f19e3c9307df71c0294807e3ff9">hello_interval</a>), ntohs (hello-&gt;<a class="code" href="structospf6__hello.html#a1429ca752f62050f89d9c61f9052ad6d">dead_interval</a>));
  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    DR:%s BDR:%s&quot;</span>, drouter, bdrouter);

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) hello + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__hello.html">ospf6_hello</a>));
       p + <span class="keyword">sizeof</span> (u_int32_t) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (u_int32_t))
    {
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, (<span class="keywordtype">void</span> *) p, neighbor, <span class="keyword">sizeof</span> (neighbor));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    Neighbor: %s&quot;</span>, neighbor);
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage exists&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5c0be22f247d1d1d8b030955e4261636"></a><!-- doxytag: member="ospf6_message.c::ospf6_hello_recv" ref="a5c0be22f247d1d1d8b030955e4261636" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_hello_recv </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00276">276</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *hello;
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keywordtype">int</span> twoway = 0;
  <span class="keywordtype">int</span> neighborchange = 0;
  <span class="keywordtype">int</span> backupseen = 0;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (src, dst, oi, oh) != <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>)
    <span class="keywordflow">return</span>;

  hello = (<span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="comment">/* HelloInterval check */</span>
  <span class="keywordflow">if</span> (ntohs (hello-&gt;<a class="code" href="structospf6__hello.html#a061d5f19e3c9307df71c0294807e3ff9">hello_interval</a>) != oi-&gt;<a class="code" href="structospf6__interface.html#a361e7c155d93d4b4082a22d43f6da499">hello_interval</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;HelloInterval mismatch&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="comment">/* RouterDeadInterval check */</span>
  <span class="keywordflow">if</span> (ntohs (hello-&gt;<a class="code" href="structospf6__hello.html#a1429ca752f62050f89d9c61f9052ad6d">dead_interval</a>) != oi-&gt;<a class="code" href="structospf6__interface.html#abcdd28a392cf138d80f052c651e9236b">dead_interval</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;RouterDeadInterval mismatch&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="comment">/* E-bit check */</span>
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__proto_8h.html#afe698280bea2b90a4d625d25cb639c6a">OSPF6_OPT_ISSET</a> (hello-&gt;<a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>, <a class="code" href="ospf6__proto_8h.html#af4dc4ae32aacf5b0758f247de720234e">OSPF6_OPT_E</a>) !=
      <a class="code" href="ospf6__proto_8h.html#afe698280bea2b90a4d625d25cb639c6a">OSPF6_OPT_ISSET</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>, <a class="code" href="ospf6__proto_8h.html#af4dc4ae32aacf5b0758f247de720234e">OSPF6_OPT_E</a>))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;E-bit mismatch&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="comment">/* Find neighbor, create if not exist */</span>
  on = <a class="code" href="ospf6__neighbor_8c.html#a4b081b7bf89453a1d197bd4ccd21fb14">ospf6_neighbor_lookup</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
  <span class="keywordflow">if</span> (on == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      on = <a class="code" href="ospf6__neighbor_8c.html#a855919070d304e94e357f2ad349a4d93">ospf6_neighbor_create</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
      on-&gt;<a class="code" href="structospf6__neighbor.html#aa7aa920cd50d36c888eba22cef7741b4">prev_drouter</a> = on-&gt;<a class="code" href="structospf6__neighbor.html#a71a9a7c78bf284d3b6ccf019d5724bc4">drouter</a> = hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a>;
      on-&gt;<a class="code" href="structospf6__neighbor.html#ab63cabfde3bd2bd93c0857d2aa446400">prev_bdrouter</a> = on-&gt;<a class="code" href="structospf6__neighbor.html#a51bfd494bc8b93c40f6645d8e0fb4223">bdrouter</a> = hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a>;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a9035e4443ced9c02caef273c1375c1a7">priority</a> = hello-&gt;<a class="code" href="structospf6__hello.html#a27d677bd81ca4bb5e3da0adcdc46616c">priority</a>;
    }

  <span class="comment">/* always override neighbor&#39;s source address and ifindex */</span>
  on-&gt;<a class="code" href="structospf6__neighbor.html#a730cf0c52d900626513c59975ff6dd0b">ifindex</a> = ntohl (hello-&gt;<a class="code" href="structospf6__hello.html#a2f7c26913d42af645dc312d90b771430">interface_id</a>);
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a2b28434ae3a26d2a1e10fc30d4384920">linklocal_addr</a>, src, sizeof (<span class="keyword">struct</span> in6_addr));

  <span class="comment">/* TwoWay check */</span>
  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) hello + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__hello.html">ospf6_hello</a>));
       p + <span class="keyword">sizeof</span> (u_int32_t) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (u_int32_t))
    {
      u_int32_t *<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a> = (u_int32_t *) p;

      <span class="keywordflow">if</span> (*router_id == oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>)
        twoway++;
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }

  <span class="comment">/* RouterPriority check */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a9035e4443ced9c02caef273c1375c1a7">priority</a> != hello-&gt;<a class="code" href="structospf6__hello.html#a27d677bd81ca4bb5e3da0adcdc46616c">priority</a>)
    {
      on-&gt;<a class="code" href="structospf6__neighbor.html#a9035e4443ced9c02caef273c1375c1a7">priority</a> = hello-&gt;<a class="code" href="structospf6__hello.html#a27d677bd81ca4bb5e3da0adcdc46616c">priority</a>;
      neighborchange++;
    }

  <span class="comment">/* DR check */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a71a9a7c78bf284d3b6ccf019d5724bc4">drouter</a> != hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a>)
    {
      on-&gt;<a class="code" href="structospf6__neighbor.html#aa7aa920cd50d36c888eba22cef7741b4">prev_drouter</a> = on-&gt;<a class="code" href="structospf6__neighbor.html#a71a9a7c78bf284d3b6ccf019d5724bc4">drouter</a>;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a71a9a7c78bf284d3b6ccf019d5724bc4">drouter</a> = hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a>;
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#aa7aa920cd50d36c888eba22cef7741b4">prev_drouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a> || on-&gt;<a class="code" href="structospf6__neighbor.html#a71a9a7c78bf284d3b6ccf019d5724bc4">drouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a>)
        neighborchange++;
    }

  <span class="comment">/* BDR check */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a51bfd494bc8b93c40f6645d8e0fb4223">bdrouter</a> != hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a>)
    {
      on-&gt;<a class="code" href="structospf6__neighbor.html#ab63cabfde3bd2bd93c0857d2aa446400">prev_bdrouter</a> = on-&gt;<a class="code" href="structospf6__neighbor.html#a51bfd494bc8b93c40f6645d8e0fb4223">bdrouter</a>;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a51bfd494bc8b93c40f6645d8e0fb4223">bdrouter</a> = hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a>;
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#ab63cabfde3bd2bd93c0857d2aa446400">prev_bdrouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a> || on-&gt;<a class="code" href="structospf6__neighbor.html#a51bfd494bc8b93c40f6645d8e0fb4223">bdrouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a>)
        neighborchange++;
    }

  <span class="comment">/* BackupSeen check */</span>
  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> == <a class="code" href="ospf6__interface_8h.html#a7af1b8c38ed1a44f1b883d25f8c851e2">OSPF6_INTERFACE_WAITING</a>)
    {
      <span class="keywordflow">if</span> (hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a>)
        backupseen++;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a> == on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a> &amp;&amp; hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a> == htonl (0))
        backupseen++;
    }

  <span class="comment">/* Execute neighbor events */</span>
  <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#ad4c742a29bb4b2eadd7d823c47027941">hello_received</a>, on, 0);
  <span class="keywordflow">if</span> (twoway)
    <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a1a46499f13697058c4433ef7e3d12645">twoway_received</a>, on, 0);
  <span class="keywordflow">else</span>
    <a class="code" href="thread_8h.html#adfc9185c89375a240b90ab50241c497d">thread_execute</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#a1fb6360380d66c19f93eeac4b9486a6b">oneway_received</a>, on, 0);

  <span class="comment">/* Schedule interface events */</span>
  <span class="keywordflow">if</span> (backupseen)
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__interface_8c.html#a3b694ccf3a531f3cf4d582828a0fe4af">backup_seen</a>, oi, 0);
  <span class="keywordflow">if</span> (neighborchange)
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__interface_8c.html#afe0e883750ee5ad5f90ba39754467407">neighbor_change</a>, oi, 0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e117804a7699187ffbbb2558cf3106a"></a><!-- doxytag: member="ospf6_message.c::ospf6_hello_send" ref="a2e117804a7699187ffbbb2558cf3106a" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_hello_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01361">1361</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *oi;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  <span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *hello;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node, *nnode;
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;

  oi = (<span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  oi-&gt;<a class="code" href="structospf6__interface.html#a2166b82112542d46986c60ef49b36ce0">thread_send_hello</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> &lt;= <a class="code" href="ospf6__interface_8h.html#a49b579760cabb266eb7331686381fc51">OSPF6_INTERFACE_DOWN</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Unable to send Hello on down interface %s&quot;</span>,
                   oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* set next thread */</span>
  oi-&gt;<a class="code" href="structospf6__interface.html#a2166b82112542d46986c60ef49b36ce0">thread_send_hello</a> = <a class="code" href="thread_8h.html#aca77b3bbd166d3573de5ecd9756a590c">thread_add_timer</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a2e117804a7699187ffbbb2558cf3106a">ospf6_hello_send</a>,
                                            oi, oi-&gt;<a class="code" href="structospf6__interface.html#a361e7c155d93d4b4082a22d43f6da499">hello_interval</a>);

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;
  hello = (<span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a> *)((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  hello-&gt;<a class="code" href="structospf6__hello.html#a2f7c26913d42af645dc312d90b771430">interface_id</a> = htonl (oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a>);
  hello-&gt;<a class="code" href="structospf6__hello.html#a27d677bd81ca4bb5e3da0adcdc46616c">priority</a> = oi-&gt;<a class="code" href="structospf6__interface.html#a91a541af8d7b9a9b224b2dbb768f4822">priority</a>;
  hello-&gt;<a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>[0] = oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[0];
  hello-&gt;<a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>[1] = oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[1];
  hello-&gt;<a class="code" href="structospf6__hello.html#a565763d170eba38a2152a567aadbbf6f">options</a>[2] = oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a4ddb7d4da05f99266462914a8935c976">options</a>[2];
  hello-&gt;<a class="code" href="structospf6__hello.html#a061d5f19e3c9307df71c0294807e3ff9">hello_interval</a> = htons (oi-&gt;<a class="code" href="structospf6__interface.html#a361e7c155d93d4b4082a22d43f6da499">hello_interval</a>);
  hello-&gt;<a class="code" href="structospf6__hello.html#a1429ca752f62050f89d9c61f9052ad6d">dead_interval</a> = htons (oi-&gt;<a class="code" href="structospf6__interface.html#abcdd28a392cf138d80f052c651e9236b">dead_interval</a>);
  hello-&gt;<a class="code" href="structospf6__hello.html#afb3b0ce9544783eb334693ff084e3e53">drouter</a> = oi-&gt;<a class="code" href="structospf6__interface.html#a5e0184b714337299cd1fa5ae9cc87eb0">drouter</a>;
  hello-&gt;<a class="code" href="structospf6__hello.html#a8f28e7af24bc5ec67f8e93ae10888f4f">bdrouter</a> = oi-&gt;<a class="code" href="structospf6__interface.html#a7b1736cd4740da2f26d27caf31983964">bdrouter</a>;

  p = (u_char *)((caddr_t) hello + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__hello.html">ospf6_hello</a>));

  <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a71512a873b8f0e2b4c84d3c949a9bbaf">ALL_LIST_ELEMENTS</a> (oi-&gt;<a class="code" href="structospf6__interface.html#ada404f0a64a2f3783445fdf2c2dccf6d">neighbor_list</a>, node, nnode, on))
    {
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#aafc5ff11ba1a9aafe6a27792d1137a7e">OSPF6_NEIGHBOR_INIT</a>)
        <span class="keywordflow">continue</span>;

      <span class="keywordflow">if</span> (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + <span class="keyword">sizeof</span> (u_int32_t) &gt; oi-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;sending Hello message: exceeds I/F MTU&quot;</span>);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e3045fcc29c1083d1b638fd64e07e0">router_id</a>, sizeof (u_int32_t));
      p += <span class="keyword">sizeof</span> (u_int32_t);
    }

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;<a class="code" href="ospf6__network_8c.html#a8f18d0317b172f8e2b317e4583a16933">allspfrouters6</a>, oi, oh);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aaa8179b6bdd70e5cf3addee60df7aa80"></a><!-- doxytag: member="ospf6_message.c::ospf6_iobuf_size" ref="aaa8179b6bdd70e5cf3addee60df7aa80" args="(unsigned int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_iobuf_size </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01141">1141</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  u_char *recvnew, *sendnew;

  <span class="keywordflow">if</span> (size &lt;= <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>)
    <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>;

  recvnew = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, size);
  sendnew = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, size);
  <span class="keywordflow">if</span> (recvnew == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || sendnew == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (recvnew)
        <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, recvnew);
      <span class="keywordflow">if</span> (sendnew)
        <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, sendnew);
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Could not allocate I/O buffer of size %d.&quot;</span>, size);
      <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>;
    }

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, <a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a>);
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babff91bcdac097452fdd222cc509ce39c">MTYPE_OSPF6_MESSAGE</a>, <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);
  <a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a> = recvnew;
  <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> = sendnew;
  <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a> = size;

  <span class="keywordflow">return</span> <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1868994aede5b9077bf9c7231f4f458d"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsack_print" ref="a1868994aede5b9077bf9c7231f4f458d" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_lsack_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00211">211</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <a class="code" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (oh);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>);

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
    <a class="code" href="ospf6__lsa_8c.html#a2b62fc9a6c54cec82d621993b4c83e82">ospf6_lsa_header_print_raw</a> ((struct <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage exists&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a02c40333d763f545c0e65f76592b3868"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsack_recv" ref="a02c40333d763f545c0e65f76592b3868" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_lsack_recv </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01029">1029</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *his, *mine;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsdb.html">ospf6_lsdb</a> *lsdb = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>);
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (src, dst, oi, oh) != <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>)
    <span class="keywordflow">return</span>;

  on = <a class="code" href="ospf6__neighbor_8c.html#a4b081b7bf89453a1d197bd4ccd21fb14">ospf6_neighbor_lookup</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
  <span class="keywordflow">if</span> (on == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor not found, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aae1490b2e9d8ca36df8b2127dcc289c1">OSPF6_NEIGHBOR_FULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state less than Exchange, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
    {
      his = <a class="code" href="ospf6__lsa_8c.html#a8bf58d5701076e46ec5317268c83eea2">ospf6_lsa_create_headeronly</a> ((<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);

      <span class="keywordflow">switch</span> (<a class="code" href="ospf6__lsa_8h.html#a2d9f0d76bb67a578675e6b78bf69604d">OSPF6_LSA_SCOPE</a> (his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>))
        {
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#ab41aaca88cc27f951f7dbf46b5a6fb5c">OSPF6_SCOPE_LINKLOCAL</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#ab033cb877fe417705f424d1bd2f411de">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0634f2bb73a043f5782d28e4e3a1ad95">OSPF6_SCOPE_AREA</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a9e658e62c2d59151531bc03b95b600bb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0701d1d9c961cfb8d6da273382ea508a">OSPF6_SCOPE_AS</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0fde4f629d4c21c3cfb402a91e1205a9">OSPF6_SCOPE_RESERVED</a>:
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignoring LSA of reserved scope&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
          <span class="keywordflow">break</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s acknowledged by %s&quot;</span>, his-&gt;<a class="code" href="structospf6__lsa.html#a979d21e1c4d2e1753e7d45641b0819ce">name</a>, on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>);

      <span class="comment">/* Find database copy */</span>
      mine = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>, his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a663d9c2afc1cdc7a124a2c9d1199e394">id</a>,
                                his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>, lsdb);
      <span class="keywordflow">if</span> (mine == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;No database copy&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
        }

      <span class="comment">/* Check if the LSA is on his retrans-list */</span>
      mine = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>, his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a663d9c2afc1cdc7a124a2c9d1199e394">id</a>,
                                his-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>, on-&gt;<a class="code" href="structospf6__neighbor.html#a6e96ad2f82d2741e769bc179d35e583f">retrans_list</a>);
      <span class="keywordflow">if</span> (mine == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Not on %s&#39;s retrans-list&quot;</span>, on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8c.html#af1665de6eac6dab108363c1bf6320c69">ospf6_lsa_compare</a> (his, mine) != 0)
        {
          <span class="comment">/* Log this questionable acknowledgement,</span>
<span class="comment">             and examine the next one. */</span>
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Questionable acknowledgement&quot;</span>);
          <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
          <span class="keywordflow">continue</span>;
        }

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Acknowledged, remove from %s&#39;s retrans-list&quot;</span>,
            on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>);

      <a class="code" href="ospf6__flood_8c.html#a6bee3a2ba460b276a55915e4f96dae62">ospf6_decrement_retrans_count</a> (mine);
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#acde3ad184b10ca14f3eef7b2ab655ce6">OSPF6_LSA_IS_MAXAGE</a> (mine))
        <a class="code" href="ospf6__top_8c.html#a0f863937b01896d48b1756f169fb0e19">ospf6_maxage_remove</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (mine, on-&gt;<a class="code" href="structospf6__neighbor.html#a6e96ad2f82d2741e769bc179d35e583f">retrans_list</a>);
      <a class="code" href="ospf6__lsa_8c.html#ab0741562e3873b904b0a77c2071a690f">ospf6_lsa_delete</a> (his);
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a785542c289b9e000dac0b01b67630f29"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsack_send_interface" ref="a785542c289b9e000dac0b01b67630f29" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_lsack_send_interface </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01841">1841</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *oi;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  oi = (<span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  oi-&gt;<a class="code" href="structospf6__interface.html#ac0eb96a5b6f4d1b1d63aa5c0208a7680">thread_send_lsack</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> &lt;= <a class="code" href="ospf6__interface_8h.html#a7af1b8c38ed1a44f1b883d25f8c851e2">OSPF6_INTERFACE_WAITING</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send LSAck to interface %s state %s&quot;</span>,
            oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>, <a class="code" href="ospf6__interface_8c.html#ae87e59ecae5232da2543307cd88795b8">ospf6_interface_state_str</a>[oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* if we have nothing to send, return */</span>
  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#a3a27876455af04270cf1ff5392f5ced3">lsack_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    <span class="keywordflow">return</span> 0;

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;

  p = (u_char *)((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a3a27876455af04270cf1ff5392f5ced3">lsack_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &gt; oi-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <span class="comment">/* if we run out of packet size/space here,</span>
<span class="comment">             better to try again soon. */</span>
          <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (oi-&gt;<a class="code" href="structospf6__interface.html#ac0eb96a5b6f4d1b1d63aa5c0208a7680">thread_send_lsack</a>);
          oi-&gt;<a class="code" href="structospf6__interface.html#ac0eb96a5b6f4d1b1d63aa5c0208a7680">thread_send_lsack</a> =
            <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a785542c289b9e000dac0b01b67630f29">ospf6_lsack_send_interface</a>, oi, 0);

          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, oi-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>));
      p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>);

      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad5cc6db207dcf7791b2b17f7e3132dc5">lock</a> == 2);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (lsa, oi-&gt;<a class="code" href="structospf6__interface.html#a3a27876455af04270cf1ff5392f5ced3">lsack_list</a>);
    }

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> == <a class="code" href="ospf6__interface_8h.html#ad83f536f4674c165d7f393d28f087843">OSPF6_INTERFACE_DR</a> ||
      oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> == <a class="code" href="ospf6__interface_8h.html#ad0b8da8f1b2db8ec33b43b223b114d51">OSPF6_INTERFACE_BDR</a>)
    <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;<a class="code" href="ospf6__network_8c.html#a8f18d0317b172f8e2b317e4583a16933">allspfrouters6</a>, oi, oh);
  <span class="keywordflow">else</span>
    <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;<a class="code" href="ospf6__network_8c.html#a09927a6bc76695ca91bbd7a8e3e1beae">alldrouters6</a>, oi, oh);

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#ac0eb96a5b6f4d1b1d63aa5c0208a7680">thread_send_lsack</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; oi-&gt;<a class="code" href="structospf6__interface.html#a3a27876455af04270cf1ff5392f5ced3">lsack_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> &gt; 0)
    {
      oi-&gt;<a class="code" href="structospf6__interface.html#ac0eb96a5b6f4d1b1d63aa5c0208a7680">thread_send_lsack</a> =
        <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a785542c289b9e000dac0b01b67630f29">ospf6_lsack_send_interface</a>, oi, 0);
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abaeba7b19d1caad52e507bd228656385"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsack_send_neighbor" ref="abaeba7b19d1caad52e507bd228656385" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_lsack_send_neighbor </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01781">1781</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  on = (<span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  on-&gt;<a class="code" href="structospf6__neighbor.html#a3efe4e76725c8138916061f7fbeccd0b">thread_send_lsack</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send LSAck to neighbor %s state %s&quot;</span>,
            on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>, <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* if we have nothing to send, return */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#ae027726d4952b94fd753b700bd4b7dee">lsack_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    <span class="keywordflow">return</span> 0;

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;

  p = (u_char *)((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ae027726d4952b94fd753b700bd4b7dee">lsack_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>) &gt; on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <span class="comment">/* if we run out of packet size/space here,</span>
<span class="comment">             better to try again soon. */</span>
          <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a3efe4e76725c8138916061f7fbeccd0b">thread_send_lsack</a>);
          on-&gt;<a class="code" href="structospf6__neighbor.html#a3efe4e76725c8138916061f7fbeccd0b">thread_send_lsack</a> =
            <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#abaeba7b19d1caad52e507bd228656385">ospf6_lsack_send_neighbor</a>, on, 0);

          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>));
      p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>);

      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad5cc6db207dcf7791b2b17f7e3132dc5">lock</a> == 2);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#ae027726d4952b94fd753b700bd4b7dee">lsack_list</a>);
    }

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a2b28434ae3a26d2a1e10fc30d4384920">linklocal_addr</a>,
              on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>, oh);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac0a6a0ccb7a4c9ab4e1c5ddef8f64882"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsreq_print" ref="ac0a6a0ccb7a4c9ab4e1c5ddef8f64882" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_lsreq_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00134">134</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> <span class="keywordtype">id</span>[16], <a class="code" href="prefix_8h.html#aa4419784611184c74a36162ffcf0123d">adv_router</a>[16];
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <a class="code" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (oh);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>);

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>))
    {
      <span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *e = (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *) p;
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;e-&gt;adv_router, adv_router, sizeof (adv_router));
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;e-&gt;id, <span class="keywordtype">id</span>, sizeof (<span class="keywordtype">id</span>));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    [%s Id:%s Adv:%s]&quot;</span>,
                 <a class="code" href="ospf6__lsa_8c.html#aef56342b1e39d23bf9977353c1c2deb1">ospf6_lstype_name</a> (e-&gt;type), <span class="keywordtype">id</span>, adv_router);
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage exists&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1b8b158280907094de85c2192c17f6a3"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsreq_recv" ref="a1b8b158280907094de85c2192c17f6a3" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_lsreq_recv </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00863">863</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *e;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsdb.html">ospf6_lsdb</a> *lsdb = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (src, dst, oi, oh) != <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>)
    <span class="keywordflow">return</span>;

  on = <a class="code" href="ospf6__neighbor_8c.html#a4b081b7bf89453a1d197bd4ccd21fb14">ospf6_neighbor_lookup</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
  <span class="keywordflow">if</span> (on == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor not found, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aae1490b2e9d8ca36df8b2127dcc289c1">OSPF6_NEIGHBOR_FULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state less than Exchange, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="comment">/* Process each request */</span>
  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>));
       p + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>))
    {
      e = (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *) p;

      <span class="keywordflow">switch</span> (<a class="code" href="ospf6__lsa_8h.html#a2d9f0d76bb67a578675e6b78bf69604d">OSPF6_LSA_SCOPE</a> (e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a09dbf8da910d21427e70dc809ecdbdee">type</a>))
        {
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#ab41aaca88cc27f951f7dbf46b5a6fb5c">OSPF6_SCOPE_LINKLOCAL</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#ab033cb877fe417705f424d1bd2f411de">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0634f2bb73a043f5782d28e4e3a1ad95">OSPF6_SCOPE_AREA</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a9e658e62c2d59151531bc03b95b600bb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="ospf6__lsa_8h.html#a0701d1d9c961cfb8d6da273382ea508a">OSPF6_SCOPE_AS</a>:
          lsdb = on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignoring LSA of reserved scope&quot;</span>);
          <span class="keywordflow">continue</span>;
          <span class="keywordflow">break</span>;
        }

      <span class="comment">/* Find database copy */</span>
      lsa = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a09dbf8da910d21427e70dc809ecdbdee">type</a>, e-&gt;<a class="code" href="structospf6__lsreq__entry.html#aba0c6eedec677748c8e48ddd6d6e3924">id</a>, e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a61084665841c7716a614d48361de8b4f">adv_router</a>, lsdb);
      <span class="keywordflow">if</span> (lsa == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        {
          <span class="keywordtype">char</span> <span class="keywordtype">id</span>[16], <a class="code" href="structospf6__lsreq__entry.html#a61084665841c7716a614d48361de8b4f">adv_router</a>[16];
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            {
              <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;e-&gt;<a class="code" href="structospf6__lsreq__entry.html#aba0c6eedec677748c8e48ddd6d6e3924">id</a>, <span class="keywordtype">id</span>, sizeof (<span class="keywordtype">id</span>));
              <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a61084665841c7716a614d48361de8b4f">adv_router</a>, adv_router,
                     sizeof (adv_router));
              <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Can&#39;t find requested [%s Id:%s Adv:%s]&quot;</span>,
              <a class="code" href="ospf6__lsa_8c.html#aef56342b1e39d23bf9977353c1c2deb1">ospf6_lstype_name</a> (e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a09dbf8da910d21427e70dc809ecdbdee">type</a>), <span class="keywordtype">id</span>, adv_router);
            }
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#ab25760cef92f7e894cdcf23ecad3833f">bad_lsreq</a>, on, 0);
          <span class="keywordflow">return</span>;
        }

      <a class="code" href="ospf6__lsdb_8c.html#a0b328a0b2493e0e549d003f50003a199">ospf6_lsdb_add</a> (<a class="code" href="ospf6__lsa_8c.html#a98dc000e578715b010159ca0c5b38a07">ospf6_lsa_copy</a> (lsa), on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>);
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }

  <span class="comment">/* schedule send lsupdate */</span>
  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e6540e3ce6bd90bc1603a529648a86">thread_send_lsupdate</a>);
  on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e6540e3ce6bd90bc1603a529648a86">thread_send_lsupdate</a> =
    <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a50608f7c51e0c039c4735781d1f66690">ospf6_lsupdate_send_neighbor</a>, on, 0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="af83f5687852b02777d049247cc518e8e"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsreq_send" ref="af83f5687852b02777d049247cc518e8e" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_lsreq_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01541">1541</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *e;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  on = (<span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* LSReq will be sent only in ExStart or Loading */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send LSReq to neighbor %s state %s&quot;</span>,
            on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>, <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* schedule loading_done if request list is empty */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1e0692790f663381e86374ed0e829f95">request_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    {
      <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__neighbor_8c.html#affe0ecf0ece70b2d797c3efc0cfe62d8">loading_done</a>, on, 0);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* set next thread */</span>
  on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> =
    <a class="code" href="thread_8h.html#aca77b3bbd166d3573de5ecd9756a590c">thread_add_timer</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#af83f5687852b02777d049247cc518e8e">ospf6_lsreq_send</a>, on,
                      on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a85d5e73751611ee20f1ad041a181cbde">rxmt_interval</a>);

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;

  <span class="comment">/* set Request entries in lsreq */</span>
  p = (u_char *)((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));
  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a1e0692790f663381e86374ed0e829f95">request_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>) &gt; on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      e = (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a> *) p;
      e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a09dbf8da910d21427e70dc809ecdbdee">type</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>;
      e-&gt;<a class="code" href="structospf6__lsreq__entry.html#aba0c6eedec677748c8e48ddd6d6e3924">id</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a663d9c2afc1cdc7a124a2c9d1199e394">id</a>;
      e-&gt;<a class="code" href="structospf6__lsreq__entry.html#a61084665841c7716a614d48361de8b4f">adv_router</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>;
      p += <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsreq__entry.html">ospf6_lsreq_entry</a>);
    }

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a2b28434ae3a26d2a1e10fc30d4384920">linklocal_addr</a>,
              on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>, oh);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e75752b675b33464d036ca1c53e598e"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsupdate_print" ref="a2e75752b675b33464d036ca1c53e598e" args="(struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_lsupdate_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00158">158</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *lsupdate;
  u_long <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <a class="code" href="ospf6__message_8c.html#a5b32ec41cd8e3534ecc2e602fef72589">ospf6_header_print</a> (oh);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> == <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>);

  lsupdate = (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  num = ntohl (lsupdate-&gt;<a class="code" href="structospf6__lsupdate.html#ad78c6309d7425390af712e6bba8ce78f">lsa_number</a>);
  <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    Number of LSA: %ld&quot;</span>, num);

  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) lsupdate + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a>));
       p &lt; <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh) &amp;&amp;
       p + <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p))
    {
      <a class="code" href="ospf6__lsa_8c.html#a2b62fc9a6c54cec82d621993b4c83e82">ospf6_lsa_header_print_raw</a> ((<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p) &lt; <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
        {
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    Malformed LSA length, quit printing&quot;</span>);
          <span class="keywordflow">break</span>;
        }
    }

  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordtype">char</span> buf[32];

      <span class="keywordtype">int</span> num = 0;
      memset (buf, 0, <span class="keyword">sizeof</span> (buf));

      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    Trailing garbage exists&quot;</span>);
      <span class="keywordflow">while</span> (p &lt; <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
        {
          <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;%s %2x&quot;</span>, buf, *p++);
          num++;
          <span class="keywordflow">if</span> (num == 8)
            {
              <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    %s&quot;</span>, buf);
              memset (buf, 0, <span class="keyword">sizeof</span> (buf));
              num = 0;
            }
        }
      <span class="keywordflow">if</span> (num)
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    %s&quot;</span>, buf);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a07373ca9b500e004a857c4d3e20551cd"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsupdate_recv" ref="a07373ca9b500e004a857c4d3e20551cd" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_lsupdate_recv </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00950">950</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *lsupdate;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
  <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8c.html#a6993c2708cb37ca3e9d2da08393a68a3">ospf6_header_examin</a> (src, dst, oi, oh) != <a class="code" href="ospf6__message_8c.html#a4ff2533d4f42b5b10b6caf648a4619b4">MSG_OK</a>)
    <span class="keywordflow">return</span>;

  on = <a class="code" href="ospf6__neighbor_8c.html#a4b081b7bf89453a1d197bd4ccd21fb14">ospf6_neighbor_lookup</a> (oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a>, oi);
  <span class="keywordflow">if</span> (on == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor not found, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a> &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> != <a class="code" href="ospf6__neighbor_8h.html#aae1490b2e9d8ca36df8b2127dcc289c1">OSPF6_NEIGHBOR_FULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Neighbor state less than Exchange, ignore&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  lsupdate = (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  num = ntohl (lsupdate-&gt;<a class="code" href="structospf6__lsupdate.html#ad78c6309d7425390af712e6bba8ce78f">lsa_number</a>);

  <span class="comment">/* Process LSAs */</span>
  <span class="keywordflow">for</span> (p = (<span class="keywordtype">char</span> *) ((caddr_t) lsupdate + <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a>));
       p &lt; <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh) &amp;&amp;
       p + <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p) &lt;= <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh);
       p += <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p))
    {
      <span class="keywordflow">if</span> (num == 0)
        <span class="keywordflow">break</span>;
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (p) &lt; <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a>))
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Malformed LSA length, quit processing&quot;</span>);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__flood_8c.html#a79be22d7f281fba1e60f53c49752bcb9">ospf6_receive_lsa</a> (on, (<span class="keyword">struct</span> <a class="code" href="structospf6__lsa__header.html">ospf6_lsa_header</a> *) p);
      num--;
    }

  <span class="keywordflow">if</span> (num != 0)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Malformed LSA number or LSA length&quot;</span>);
    }
  <span class="keywordflow">if</span> (p != <a class="code" href="ospf6__message_8h.html#a9c7f1cee44fb445c00c5549e03b462e4">OSPF6_MESSAGE_END</a> (oh))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Trailing garbage ignored&quot;</span>);
    }

  <span class="comment">/* RFC2328 Section 10.9: When the neighbor responds to these requests</span>
<span class="comment">     with the proper Link State Update packet(s), the Link state request</span>
<span class="comment">     list is truncated and a new Link State Request packet is sent. */</span>
  <span class="comment">/* send new Link State Request packet if this LS Update packet</span>
<span class="comment">     can be recognized as a response to our previous LS Request */</span>
  <span class="keywordflow">if</span> (! IN6_IS_ADDR_MULTICAST (dst) &amp;&amp;
      (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> == <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a> ||
       on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> == <a class="code" href="ospf6__neighbor_8h.html#aa50b6edd6d1268220ae4e13b2fef14e8">OSPF6_NEIGHBOR_LOADING</a>))
    {
      <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a>);
      on-&gt;<a class="code" href="structospf6__neighbor.html#a645f58ca5b6b428ae7ae616bc4781f51">thread_send_lsreq</a> =
        <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#af83f5687852b02777d049247cc518e8e">ospf6_lsreq_send</a>, on, 0);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a06554ad9592dbdbc0986c4de39f0c318"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsupdate_send_interface" ref="a06554ad9592dbdbc0986c4de39f0c318" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_lsupdate_send_interface </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01708">1708</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *oi;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *lsupdate;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  oi = (<span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  oi-&gt;<a class="code" href="structospf6__interface.html#a0f7c7a7f0611d03b12361b0cf0b7cba6">thread_send_lsupdate</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> &lt;= <a class="code" href="ospf6__interface_8h.html#a7af1b8c38ed1a44f1b883d25f8c851e2">OSPF6_INTERFACE_WAITING</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send LSUpdate to interface %s state %s&quot;</span>,
            oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>, <a class="code" href="ospf6__interface_8c.html#ae87e59ecae5232da2543307cd88795b8">ospf6_interface_state_str</a>[oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* if we have nothing to send, return */</span>
  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#a42c393a90f856992c87da5a9d0607f98">lsupdate_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    <span class="keywordflow">return</span> 0;

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;
  lsupdate = (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *)((caddr_t) oh +
                                       <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  p = (u_char *)((caddr_t) lsupdate + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a>));
  num = 0;

  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a42c393a90f856992c87da5a9d0607f98">lsupdate_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> ( (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>)))
          &gt; oi-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, oi-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>));
      p += <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>);
      num++;

      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad5cc6db207dcf7791b2b17f7e3132dc5">lock</a> == 2);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (lsa, oi-&gt;<a class="code" href="structospf6__interface.html#a42c393a90f856992c87da5a9d0607f98">lsupdate_list</a>);
    }

  lsupdate-&gt;<a class="code" href="structospf6__lsupdate.html#ad78c6309d7425390af712e6bba8ce78f">lsa_number</a> = htonl (num);

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> == <a class="code" href="ospf6__interface_8h.html#ad83f536f4674c165d7f393d28f087843">OSPF6_INTERFACE_DR</a> ||
      oi-&gt;<a class="code" href="structospf6__interface.html#aafdfe7c67c1ff540201718b688e0a15b">state</a> == <a class="code" href="ospf6__interface_8h.html#ad0b8da8f1b2db8ec33b43b223b114d51">OSPF6_INTERFACE_BDR</a>)
    <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;<a class="code" href="ospf6__network_8c.html#a8f18d0317b172f8e2b317e4583a16933">allspfrouters6</a>, oi, oh);
  <span class="keywordflow">else</span>
    <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (oi-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;<a class="code" href="ospf6__network_8c.html#a09927a6bc76695ca91bbd7a8e3e1beae">alldrouters6</a>, oi, oh);

  <span class="keywordflow">if</span> (oi-&gt;<a class="code" href="structospf6__interface.html#a42c393a90f856992c87da5a9d0607f98">lsupdate_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> &gt; 0)
    {
      oi-&gt;<a class="code" href="structospf6__interface.html#a0f7c7a7f0611d03b12361b0cf0b7cba6">thread_send_lsupdate</a> =
        <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a06554ad9592dbdbc0986c4de39f0c318">ospf6_lsupdate_send_interface</a>, oi, 0);
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a50608f7c51e0c039c4735781d1f66690"></a><!-- doxytag: member="ospf6_message.c::ospf6_lsupdate_send_neighbor" ref="a50608f7c51e0c039c4735781d1f66690" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_lsupdate_send_neighbor </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01605">1605</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *on;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *lsupdate;
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;

  on = (<span class="keyword">struct </span><a class="code" href="structospf6__neighbor.html">ospf6_neighbor</a> *) <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e6540e3ce6bd90bc1603a529648a86">thread_send_lsupdate</a> = (<span class="keyword">struct </span>thread *) <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;LSUpdate to neighbor %s&quot;</span>, on-&gt;<a class="code" href="structospf6__neighbor.html#aa0ccec2f7b9c56628ce2e4a0bc37d463">name</a>);

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a> &lt; <a class="code" href="ospf6__neighbor_8h.html#afa0419c15460d1d703d2b3cfa7859984">OSPF6_NEIGHBOR_EXCHANGE</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send (neighbor state %s)&quot;</span>,
            <a class="code" href="ospf6__neighbor_8c.html#aee78e9afc46a9acd2c77382df5760c03">ospf6_neighbor_state_str</a>[on-&gt;<a class="code" href="structospf6__neighbor.html#a4c749b4db801c300f6b11b0340a37600">state</a>]);
      <span class="keywordflow">return</span> 0;
    }

  <span class="comment">/* if we have nothing to send, return */</span>
  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0 &amp;&amp;
      on-&gt;<a class="code" href="structospf6__neighbor.html#a6e96ad2f82d2741e769bc179d35e583f">retrans_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> == 0)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Quit to send (nothing to send)&quot;</span>);
      <span class="keywordflow">return</span> 0;
    }

  memset (<a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>;
  lsupdate = (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a> *)
    ((caddr_t) oh + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a>));

  p = (u_char *)((caddr_t) lsupdate + <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structospf6__lsupdate.html">ospf6_lsupdate</a>));
  num = 0;

  <span class="comment">/* lsupdate_list lists those LSA which doesn&#39;t need to be</span>
<span class="comment">     retransmitted. remove those from the list */</span>
  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> ( (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>))
          &gt; on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>));
      p += <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>);
      num++;

      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad5cc6db207dcf7791b2b17f7e3132dc5">lock</a> == 2);
      <a class="code" href="ospf6__lsdb_8c.html#a57848d384aafd619bd84c654fb9ed146">ospf6_lsdb_remove</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>);
    }

  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#ab9d15a52a7be50c379748fe7ba91251f">ospf6_lsdb_head</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#a6e96ad2f82d2741e769bc179d35e583f">retrans_list</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a7fccfd842f6c1849beb8237ccca195d0">ospf6_lsdb_next</a> (lsa))
    {
      <span class="comment">/* MTU check */</span>
      <span class="keywordflow">if</span> ( (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> + (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>))
          &gt; on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a88579a4c38c3458d12425986c1a43893">ifmtu</a>)
        {
          <a class="code" href="ospf6__lsa_8c.html#ae6a337ae60488897392e2ecaa480ea62">ospf6_lsa_unlock</a> (lsa);
          <span class="keywordflow">break</span>;
        }

      <a class="code" href="ospf6__lsa_8c.html#a801d1d70da30cca2f219992a62b0f0bc">ospf6_lsa_age_update_to_send</a> (lsa, on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8332fa0bef3f650b9ce32c772c028437">transdelay</a>);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (p, lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>, <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>));
      p += <a class="code" href="ospf6__lsa_8h.html#af20378c406bcfdfa9dde9213c2ceb684">OSPF6_LSA_SIZE</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>);
      num++;
    }

  lsupdate-&gt;<a class="code" href="structospf6__lsupdate.html#ad78c6309d7425390af712e6bba8ce78f">lsa_number</a> = htonl (num);

  oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a> = <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a> = htons (p - <a class="code" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a>);

  <a class="code" href="ospf6__message_8c.html#a872c5c0ebbeea4de643a1dec4b5c7d54">ospf6_send</a> (on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a8df3591fcba060b5f64e35dfdb338888">linklocal_addr</a>, &amp;on-&gt;<a class="code" href="structospf6__neighbor.html#a2b28434ae3a26d2a1e10fc30d4384920">linklocal_addr</a>,
              on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>, oh);

  <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> != 0 ||
      on-&gt;<a class="code" href="structospf6__neighbor.html#a6e96ad2f82d2741e769bc179d35e583f">retrans_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> != 0)
    {
      <span class="keywordflow">if</span> (on-&gt;<a class="code" href="structospf6__neighbor.html#ac3f142375bf4e9e7c8e54daed55b4ca4">lsupdate_list</a>-&gt;<a class="code" href="structospf6__lsdb.html#aa9c852db97e2303379eacb9f82dfe456">count</a> != 0)
        on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e6540e3ce6bd90bc1603a529648a86">thread_send_lsupdate</a> =
          <a class="code" href="thread_8h.html#a1067157ad59ad46f29bf87158dffc3de">thread_add_event</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a50608f7c51e0c039c4735781d1f66690">ospf6_lsupdate_send_neighbor</a>, on, 0);
      <span class="keywordflow">else</span>
        on-&gt;<a class="code" href="structospf6__neighbor.html#ac7e6540e3ce6bd90bc1603a529648a86">thread_send_lsupdate</a> =
          <a class="code" href="thread_8h.html#aca77b3bbd166d3573de5ecd9756a590c">thread_add_timer</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a50608f7c51e0c039c4735781d1f66690">ospf6_lsupdate_send_neighbor</a>, on,
                            on-&gt;<a class="code" href="structospf6__neighbor.html#af9f1a59e8aba26ea269d4423980af20b">ospf6_if</a>-&gt;<a class="code" href="structospf6__interface.html#a85d5e73751611ee20f1ad041a181cbde">rxmt_interval</a>);
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0e2dffe886aebfa4df64eb5ed857cca2"></a><!-- doxytag: member="ospf6_message.c::ospf6_receive" ref="a0e2dffe886aebfa4df64eb5ed857cca2" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_receive </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01172">1172</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> sockfd;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len;
  <span class="keywordtype">char</span> srcname[64], dstname[64];
  <span class="keyword">struct </span>in6_addr src, dst;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ifindex;
  <span class="keyword">struct </span>iovec iovector[2];
  <span class="keyword">struct </span><a class="code" href="structospf6__interface.html">ospf6_interface</a> *oi;
  <span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *oh;

  <span class="comment">/* add next read thread */</span>
  sockfd = <a class="code" href="thread_8h.html#a89bd56f991717646441f9dffc010d4f5">THREAD_FD</a> (thread);
  <a class="code" href="thread_8h.html#abd1714f11834a150c84b040c0c69b620">thread_add_read</a> (<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="ospf6__message_8c.html#a0e2dffe886aebfa4df64eb5ed857cca2">ospf6_receive</a>, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, sockfd);

  <span class="comment">/* initialize */</span>
  memset (&amp;src, 0, <span class="keyword">sizeof</span> (src));
  memset (&amp;dst, 0, <span class="keyword">sizeof</span> (dst));
  ifindex = 0;
  memset (<a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a>, 0, <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>);
  iovector[0].iov_base = <a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a>;
  iovector[0].iov_len = <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>;
  iovector[1].iov_base = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  iovector[1].iov_len = 0;

  <span class="comment">/* receive message */</span>
  len = <a class="code" href="ospf6__network_8c.html#a357f81a31d3a457d3b841de3d778d089">ospf6_recvmsg</a> (&amp;src, &amp;dst, &amp;ifindex, iovector);
  <span class="keywordflow">if</span> (len &gt; <a class="code" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a>)
    {
      <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a> (<span class="stringliteral">&quot;Excess message read&quot;</span>);
      <span class="keywordflow">return</span> 0;
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__header.html">ospf6_header</a>))
    {
      <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a> (<span class="stringliteral">&quot;Deficient message read&quot;</span>);
      <span class="keywordflow">return</span> 0;
    }

  oi = <a class="code" href="ospf6__interface_8c.html#a10eb67c1323348e19f16ea82827d284f">ospf6_interface_lookup_by_ifindex</a> (ifindex);
  <span class="keywordflow">if</span> (oi == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Message received on disabled interface&quot;</span>);
      <span class="keywordflow">return</span> 0;
    }

  oh = (<span class="keyword">struct </span><a class="code" href="structospf6__header.html">ospf6_header</a> *) <a class="code" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a>;

  <span class="comment">/* Log */</span>
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
    {
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, &amp;src, srcname, <span class="keyword">sizeof</span> (srcname));
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, &amp;dst, dstname, <span class="keyword">sizeof</span> (dstname));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s received on %s&quot;</span>,
                 <a class="code" href="ospf6__message_8h.html#a44665a9343d836ac8be80df1b0bcca14">OSPF6_MESSAGE_TYPE_NAME</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>), oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    src: %s&quot;</span>, srcname);
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    dst: %s&quot;</span>, dstname);
      <span class="keywordflow">if</span> (len != ntohs (oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Message length does not match actually received: %d&quot;</span>, len);

      <span class="keywordflow">switch</span> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>)
        {
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>:
            <a class="code" href="ospf6__message_8c.html#adfbd2808619eaf4b4a9f264083b1ae2e">ospf6_hello_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>:
            <a class="code" href="ospf6__message_8c.html#a4c3079cef10f2def25c83cc3cdf0c00f">ospf6_dbdesc_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>:
            <a class="code" href="ospf6__message_8c.html#ac0a6a0ccb7a4c9ab4e1c5ddef8f64882">ospf6_lsreq_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>:
            <a class="code" href="ospf6__message_8c.html#a2e75752b675b33464d036ca1c53e598e">ospf6_lsupdate_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>:
            <a class="code" href="ospf6__message_8c.html#a1868994aede5b9077bf9c7231f4f458d">ospf6_lsack_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span>:
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Unknown message&quot;</span>);
            <span class="keywordflow">break</span>;
        }
    }

  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (oi-&gt;<a class="code" href="structospf6__interface.html#aa5dbc797ed38482907f57c66458a3e87">flag</a>, <a class="code" href="ospf6__interface_8h.html#aeb4543177500f2d71c28f91a47154e25">OSPF6_INTERFACE_PASSIVE</a>))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignore message on passive interface %s&quot;</span>,
                   oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);
      <span class="keywordflow">return</span> 0;
    }

  <span class="keywordflow">switch</span> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>)
    {
      <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>:
        <a class="code" href="ospf6__message_8c.html#a5c0be22f247d1d1d8b030955e4261636">ospf6_hello_recv</a> (&amp;src, &amp;dst, oi, oh);
        <span class="keywordflow">break</span>;

      <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>:
        <a class="code" href="ospf6__message_8c.html#aa40c2de125d4e0b32180d9f9e383f83e">ospf6_dbdesc_recv</a> (&amp;src, &amp;dst, oi, oh);
        <span class="keywordflow">break</span>;

      <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>:
        <a class="code" href="ospf6__message_8c.html#a1b8b158280907094de85c2192c17f6a3">ospf6_lsreq_recv</a> (&amp;src, &amp;dst, oi, oh);
        <span class="keywordflow">break</span>;

      <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>:
        <a class="code" href="ospf6__message_8c.html#a07373ca9b500e004a857c4d3e20551cd">ospf6_lsupdate_recv</a> (&amp;src, &amp;dst, oi, oh);
        <span class="keywordflow">break</span>;

      <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>:
        <a class="code" href="ospf6__message_8c.html#a02c40333d763f545c0e65f76592b3868">ospf6_lsack_recv</a> (&amp;src, &amp;dst, oi, oh);
        <span class="keywordflow">break</span>;

      <span class="keywordflow">default</span>:
        <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (<a class="code" href="ospf6__message_8h.html#aaec3a97f28d8b7cfcb2e0b6cb7ba06e3">OSPF6_MESSAGE_TYPE_UNKNOWN</a>, <a class="code" href="bgp__debug_8h.html#a5c3976553336476b6fea4108b844ecf2">RECV</a>))
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Unknown message&quot;</span>);
        <span class="keywordflow">break</span>;
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a872c5c0ebbeea4de643a1dec4b5c7d54"></a><!-- doxytag: member="ospf6_message.c::ospf6_send" ref="a872c5c0ebbeea4de643a1dec4b5c7d54" args="(struct in6_addr *src, struct in6_addr *dst, struct ospf6_interface *oi, struct ospf6_header *oh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ospf6_send </td>
          <td>(</td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__interface.html">ospf6_interface</a> *&#160;</td>
          <td class="paramname"><em>oi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structospf6__header.html">ospf6_header</a> *&#160;</td>
          <td class="paramname"><em>oh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01294">1294</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> len;
  <span class="keywordtype">char</span> srcname[64], dstname[64];
  <span class="keyword">struct </span>iovec iovector[2];

  <span class="comment">/* initialize */</span>
  iovector[0].iov_base = (caddr_t) oh;
  iovector[0].iov_len = ntohs (oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a>);
  iovector[1].iov_base = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  iovector[1].iov_len = 0;

  <span class="comment">/* fill OSPF header */</span>
  oh-&gt;<a class="code" href="structospf6__header.html#a71abe555831003b4e41b0a623690ac93">version</a> = <a class="code" href="ospf6__proto_8h.html#ac71efe16d061e39ea5c0d9d74def4fa4">OSPFV3_VERSION</a>;
  <span class="comment">/* message type must be set before */</span>
  <span class="comment">/* message length must be set before */</span>
  oh-&gt;<a class="code" href="structospf6__header.html#a53d5dbfa8cc8c72d2e4681d78258b6a7">router_id</a> = oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#a86562db489ba46500cda50f4fa646c69">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#abc55595860947bb51724aae44da001cc">area_id</a> = oi-&gt;<a class="code" href="structospf6__interface.html#a4f6cfeea2ecb9f163edd02b78f79294d">area</a>-&gt;<a class="code" href="structospf6__area.html#aec3bacc0c813ff937b5675595a3aefa6">area_id</a>;
  <span class="comment">/* checksum is calculated by kernel */</span>
  oh-&gt;<a class="code" href="structospf6__header.html#a098c822a8032afb65b8e7d41339c9dc1">instance_id</a> = oi-&gt;<a class="code" href="structospf6__interface.html#aa29c61e3e5509e7c844bdf19efce0268">instance_id</a>;
  oh-&gt;<a class="code" href="structospf6__header.html#a864b2ddabe0a87b85337c7902c984843">reserved</a> = 0;

  <span class="comment">/* Log */</span>
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__message_8h.html#af19e08ee4af94e2f413943d6c5145154">IS_OSPF6_DEBUG_MESSAGE</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>, <a class="code" href="bgp__debug_8h.html#abc9603445bf79a3793831ee1d0ea8890">SEND</a>))
    {
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, dst, dstname, <span class="keyword">sizeof</span> (dstname));
      <span class="keywordflow">if</span> (src)
        <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, src, srcname, <span class="keyword">sizeof</span> (srcname));
      <span class="keywordflow">else</span>
        memset (srcname, 0, <span class="keyword">sizeof</span> (srcname));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s send on %s&quot;</span>,
                 <a class="code" href="ospf6__message_8h.html#a44665a9343d836ac8be80df1b0bcca14">OSPF6_MESSAGE_TYPE_NAME</a> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>), oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    src: %s&quot;</span>, srcname);
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;    dst: %s&quot;</span>, dstname);

      <span class="keywordflow">switch</span> (oh-&gt;<a class="code" href="structospf6__header.html#a4b423c1b25aafea7dd1e2a5780c57ddb">type</a>)
        {
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bf7c8dd972224d5a8255986e52ea771">OSPF6_MESSAGE_TYPE_HELLO</a>:
            <a class="code" href="ospf6__message_8c.html#adfbd2808619eaf4b4a9f264083b1ae2e">ospf6_hello_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a2bd43bbd6161d38b8361ae6d377b736a">OSPF6_MESSAGE_TYPE_DBDESC</a>:
            <a class="code" href="ospf6__message_8c.html#a4c3079cef10f2def25c83cc3cdf0c00f">ospf6_dbdesc_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a685011318dd28abf2279e718803d4daa">OSPF6_MESSAGE_TYPE_LSREQ</a>:
            <a class="code" href="ospf6__message_8c.html#ac0a6a0ccb7a4c9ab4e1c5ddef8f64882">ospf6_lsreq_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#ac6f61e0ff8bcf71f99c6edc50ab9ca97">OSPF6_MESSAGE_TYPE_LSUPDATE</a>:
            <a class="code" href="ospf6__message_8c.html#a2e75752b675b33464d036ca1c53e598e">ospf6_lsupdate_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="ospf6__message_8h.html#a19fd0641f70b0878b9ce5e7966c7ae73">OSPF6_MESSAGE_TYPE_LSACK</a>:
            <a class="code" href="ospf6__message_8c.html#a1868994aede5b9077bf9c7231f4f458d">ospf6_lsack_print</a> (oh);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span>:
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Unknown message&quot;</span>);
            <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (0);
            <span class="keywordflow">break</span>;
        }
    }

  <span class="comment">/* send message */</span>
  len = <a class="code" href="ospf6__network_8c.html#a72829dd8925ab435fbc2698f8eb63637">ospf6_sendmsg</a> (src, dst, &amp;oi-&gt;<a class="code" href="structospf6__interface.html#ab77617d3c7c82e25b6c035d9e1856c22">interface</a>-&gt;<a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a>, iovector);
  <span class="keywordflow">if</span> (len != ntohs (oh-&gt;<a class="code" href="structospf6__header.html#aef7496dd76d0c2eca889f7a9d01936ff">length</a>))
    <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a> (<span class="stringliteral">&quot;Could not send entire message&quot;</span>);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a421d44952d11523ff61b0dbddd86ce25"></a><!-- doxytag: member="ospf6_message.c::conf_debug_ospf6_message" ref="a421d44952d11523ff61b0dbddd86ce25" args="[6]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="ospf6__message_8h.html#a2248d2fb08366bd1206fa320f5de8c68">conf_debug_ospf6_message</a>[6] = {0x03, 0, 0, 0, 0, 0}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00045">45</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6380f44cc4b2ccf7824f9b60d42e09db"></a><!-- doxytag: member="ospf6_message.c::iobuflen" ref="a6380f44cc4b2ccf7824f9b60d42e09db" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="ospf6__message_8c.html#a6380f44cc4b2ccf7824f9b60d42e09db">iobuflen</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01138">1138</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a64115ee539859d9f278938a96e2ce9b5"></a><!-- doxytag: member="ospf6_message.c::ospf6_message_type_str" ref="a64115ee539859d9f278938a96e2ce9b5" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="ospf6__message_8h.html#a64115ee539859d9f278938a96e2ce9b5">ospf6_message_type_str</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">
  { <span class="stringliteral">&quot;Unknown&quot;</span>, <span class="stringliteral">&quot;Hello&quot;</span>, <span class="stringliteral">&quot;DbDesc&quot;</span>, <span class="stringliteral">&quot;LSReq&quot;</span>, <span class="stringliteral">&quot;LSUpdate&quot;</span>, <span class="stringliteral">&quot;LSAck&quot;</span> }
</pre></div>
<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l00046">46</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab56560205eb1af494b28ca1bfd6af093"></a><!-- doxytag: member="ospf6_message.c::recvbuf" ref="ab56560205eb1af494b28ca1bfd6af093" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_char* <a class="el" href="ospf6__message_8c.html#ab56560205eb1af494b28ca1bfd6af093">recvbuf</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01136">1136</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2e27ffe2dae02f181d73b709cf8fcf9f"></a><!-- doxytag: member="ospf6_message.c::sendbuf" ref="a2e27ffe2dae02f181d73b709cf8fcf9f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_char* <a class="el" href="ospf6__message_8c.html#a2e27ffe2dae02f181d73b709cf8fcf9f">sendbuf</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__message_8c_source.html#l01137">1137</a> of file <a class="el" href="ospf6__message_8c_source.html">ospf6_message.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="ospf6__message_8c.html">ospf6_message.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:26 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
