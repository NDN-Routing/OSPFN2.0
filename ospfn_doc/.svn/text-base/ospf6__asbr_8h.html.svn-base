<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: ospf6d/ospf6_asbr.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('ospf6__asbr_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ospf6d/ospf6_asbr.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ospf6__asbr_8h__dep__incl.png" border="0" usemap="#ospf6d_2ospf6__asbr_8hdep" alt=""/></div>
<map name="ospf6d_2ospf6__asbr_8hdep" id="ospf6d_2ospf6__asbr_8hdep">
<area shape="rect" id="node3" href="ospf6__asbr_8c.html" title="ospf6d/ospf6_asbr.c" alt="" coords="5,80,149,107"/><area shape="rect" id="node5" href="ospf6__intra_8c.html" title="ospf6d/ospf6_intra.c" alt="" coords="174,80,319,107"/><area shape="rect" id="node7" href="ospf6__top_8c.html" title="ospf6d/ospf6_top.c" alt="" coords="343,80,483,107"/><area shape="rect" id="node9" href="ospf6__zebra_8c.html" title="ospf6d/ospf6_zebra.c" alt="" coords="508,80,660,107"/><area shape="rect" id="node11" href="ospf6d_8c.html" title="ospf6d/ospf6d.c" alt="" coords="684,80,804,107"/></map>
</div>
</div>
<p><a href="ospf6__asbr_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structospf6__external__info.html">ospf6_external_info</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structospf6__as__external__lsa.html">ospf6_as_external_lsa</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a918247ebb3094b9c655ec775b35cec38">OSPF6_DEBUG_ASBR_ON</a>()&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a> = 1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#ae12a04fb66e2e07db8878abf9e903aec">OSPF6_DEBUG_ASBR_OFF</a>()&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a> = 0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a80e912b137deb7778ff600ca57702530">OSPF6_ASBR_BIT_T</a>&#160;&#160;&#160;ntohl (0x01000000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a4565c04c4b7223745abd2bfd06188883">OSPF6_ASBR_BIT_F</a>&#160;&#160;&#160;ntohl (0x02000000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a702fab0bf2a17db8966e0c19c7eecba6">OSPF6_ASBR_BIT_E</a>&#160;&#160;&#160;ntohl (0x04000000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a057432ca741931f338fb9713d5142d18">OSPF6_ASBR_METRIC</a>(E)&#160;&#160;&#160;(ntohl ((E)-&gt;bits_metric &amp; htonl (0x00ffffff)))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a81acf6ffa6f10a8d485ba3183336b8a8">OSPF6_ASBR_METRIC_SET</a>(E, C)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#ab2b3fe7537d6dde649e7a0faf0e912e8">ospf6_asbr_lsa_add</a> (struct <a class="el" href="structospf6__lsa.html">ospf6_lsa</a> *lsa)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a38f6316bb47fff653cbbbd0d6e3129f0">ospf6_asbr_lsa_remove</a> (struct <a class="el" href="structospf6__lsa.html">ospf6_lsa</a> *lsa)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#adb3d1ad8b89c9eef8b6f4f3e3cfa5281">ospf6_asbr_lsentry_add</a> (struct <a class="el" href="structospf6__route.html">ospf6_route</a> *asbr_entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a70d2ab867a5914a2822fbb953fc7e2c1">ospf6_asbr_lsentry_remove</a> (struct <a class="el" href="structospf6__route.html">ospf6_route</a> *asbr_entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a2bf469c9d8fc0b2a9d17279cd7ae0938">ospf6_asbr_is_asbr</a> (struct <a class="el" href="structospf6.html">ospf6</a> *o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a28e49591579d5ebab190126fff7762fa">ospf6_asbr_redistribute_add</a> (int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, int ifindex, struct <a class="el" href="structprefix.html">prefix</a> *<a class="el" href="structprefix.html">prefix</a>, u_int nexthop_num, struct in6_addr *<a class="el" href="structnexthop.html">nexthop</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a76af4e8a926eb7373e59626cac4a5fc0">ospf6_asbr_redistribute_remove</a> (int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, int ifindex, struct <a class="el" href="structprefix.html">prefix</a> *<a class="el" href="structprefix.html">prefix</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#aa002be662bf5a69805137bc6eff9c4bd">ospf6_redistribute_config_write</a> (struct <a class="el" href="structvty.html">vty</a> *<a class="el" href="structvty.html">vty</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a2a6bd275a824bcf6cc291f124575c34f">ospf6_asbr_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a2a4f3184aeae69997a96477ee4cb9e11">config_write_ospf6_debug_asbr</a> (struct <a class="el" href="structvty.html">vty</a> *<a class="el" href="structvty.html">vty</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#ac7a2a0fec7a1ed8d4c4fe5fc7acfc8dc">install_element_ospf6_debug_asbr</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ace41597f91e209786354b98dec5a5f5d"></a><!-- doxytag: member="ospf6_asbr.h::IS_OSPF6_DEBUG_ASBR" ref="ace41597f91e209786354b98dec5a5f5d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IS_OSPF6_DEBUG_ASBR&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00031">31</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a702fab0bf2a17db8966e0c19c7eecba6"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_ASBR_BIT_E" ref="a702fab0bf2a17db8966e0c19c7eecba6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_ASBR_BIT_E&#160;&#160;&#160;ntohl (0x04000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00059">59</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4565c04c4b7223745abd2bfd06188883"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_ASBR_BIT_F" ref="a4565c04c4b7223745abd2bfd06188883" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_ASBR_BIT_F&#160;&#160;&#160;ntohl (0x02000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00058">58</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a80e912b137deb7778ff600ca57702530"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_ASBR_BIT_T" ref="a80e912b137deb7778ff600ca57702530" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_ASBR_BIT_T&#160;&#160;&#160;ntohl (0x01000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00057">57</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a057432ca741931f338fb9713d5142d18"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_ASBR_METRIC" ref="a057432ca741931f338fb9713d5142d18" args="(E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_ASBR_METRIC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">E</td><td>)</td>
          <td>&#160;&#160;&#160;(ntohl ((E)-&gt;bits_metric &amp; htonl (0x00ffffff)))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00061">61</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a81acf6ffa6f10a8d485ba3183336b8a8"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_ASBR_METRIC_SET" ref="a81acf6ffa6f10a8d485ba3183336b8a8" args="(E, C)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_ASBR_METRIC_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">E, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">C&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ (E)-&gt;bits_metric &amp;= htonl (0xff000000); \
    (E)-&gt;bits_metric |= htonl (0x00ffffff) &amp; htonl (C); }
</pre></div>
<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00062">62</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae12a04fb66e2e07db8878abf9e903aec"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_DEBUG_ASBR_OFF" ref="ae12a04fb66e2e07db8878abf9e903aec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_DEBUG_ASBR_OFF</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a> = 0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00029">29</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a918247ebb3094b9c655ec775b35cec38"></a><!-- doxytag: member="ospf6_asbr.h::OSPF6_DEBUG_ASBR_ON" ref="a918247ebb3094b9c655ec775b35cec38" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSPF6_DEBUG_ASBR_ON</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a> = 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8h_source.html#l00027">27</a> of file <a class="el" href="ospf6__asbr_8h_source.html">ospf6_asbr.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2a4f3184aeae69997a96477ee4cb9e11"></a><!-- doxytag: member="ospf6_asbr.h::config_write_ospf6_debug_asbr" ref="a2a4f3184aeae69997a96477ee4cb9e11" args="(struct vty *vty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int config_write_ospf6_debug_asbr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"><em>vty</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l01249">1249</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;debug ospf6 asbr%s&quot;</span>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7a2a0fec7a1ed8d4c4fe5fc7acfc8dc"></a><!-- doxytag: member="ospf6_asbr.h::install_element_ospf6_debug_asbr" ref="ac7a2a0fec7a1ed8d4c4fe5fc7acfc8dc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void install_element_ospf6_debug_asbr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l01257">1257</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;debug_ospf6_asbr_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;no_debug_ospf6_asbr_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;debug_ospf6_asbr_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a50754044f565f7421a152eaa411eebcc">CONFIG_NODE</a>, &amp;no_debug_ospf6_asbr_cmd);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a6bd275a824bcf6cc291f124575c34f"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_init" ref="a2a6bd275a824bcf6cc291f124575c34f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l01208">1208</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="ospf6__asbr_8c.html#acea1e25a5d679557d6b5584aca667400">ospf6_routemap_init</a> ();

  <a class="code" href="ospf6__lsa_8c.html#a26b635cec93c3aecb54d331bff6afe8e">ospf6_install_lsa_handler</a> (&amp;<a class="code" href="ospf6__asbr_8c.html#a62ce66c9e6883c17d480fff9d2dba1d8">as_external_handler</a>);

  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682acfdc7d342a9640147533988ace5fac24">VIEW_NODE</a>, &amp;show_ipv6_ospf6_redistribute_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a8eeaebd59fec75e66abd261377c21a2d">ENABLE_NODE</a>, &amp;show_ipv6_ospf6_redistribute_cmd);

  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a3e34f801d98de220164f1a6b7976d3c4">OSPF6_NODE</a>, &amp;ospf6_redistribute_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a3e34f801d98de220164f1a6b7976d3c4">OSPF6_NODE</a>, &amp;ospf6_redistribute_routemap_cmd);
  <a class="code" href="command_8c.html#af8546e314a1538d53ef78e4b02804f40">install_element</a> (<a class="code" href="command_8h.html#a6a276b85e2da28c5f9c3dbce61c55682a3e34f801d98de220164f1a6b7976d3c4">OSPF6_NODE</a>, &amp;no_ospf6_redistribute_cmd);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2bf469c9d8fc0b2a9d17279cd7ae0938"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_is_asbr" ref="a2bf469c9d8fc0b2a9d17279cd7ae0938" args="(struct ospf6 *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_asbr_is_asbr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6.html">ospf6</a> *&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00376">376</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> o-&gt;<a class="code" href="structospf6.html#ab0b53951e38ce1246513c529368a00a3">external_table</a>-&gt;<a class="code" href="structospf6__route__table.html#ac242748e782f2dbbc1f2d69ce7d9a140">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab2b3fe7537d6dde649e7a0faf0e912e8"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_lsa_add" ref="ab2b3fe7537d6dde649e7a0faf0e912e8" args="(struct ospf6_lsa *lsa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_lsa_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__lsa.html">ospf6_lsa</a> *&#160;</td>
          <td class="paramname"><em>lsa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00156">156</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__as__external__lsa.html">ospf6_as_external_lsa</a> *external;
  <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> asbr_id;
  <span class="keyword">struct </span><a class="code" href="structospf6__route.html">ospf6_route</a> *asbr_entry, *route;
  <span class="keywordtype">char</span> buf[64];
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  external = (<span class="keyword">struct </span><a class="code" href="structospf6__as__external__lsa.html">ospf6_as_external_lsa</a> *)
    <a class="code" href="ospf6__lsa_8h.html#ade3057c51a01c081c6c753a03c1ffc3f">OSPF6_LSA_HEADER_END</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>);

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Calculate AS-External route for %s&quot;</span>, lsa-&gt;<a class="code" href="structospf6__lsa.html#a979d21e1c4d2e1753e7d45641b0819ce">name</a>);

  <span class="keywordflow">if</span> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a> == <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignore self-originated AS-External-LSA&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#a057432ca741931f338fb9713d5142d18">OSPF6_ASBR_METRIC</a> (external) == <a class="code" href="ospf6__proto_8h.html#adae502e9fc4510696255aa68d1413fb1">LS_INFINITY</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignore LSA with LSInfinity Metric&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  <a class="code" href="ospf6__route_8c.html#a5190b1a4d8babac390d4504e6119ffde">ospf6_linkstate_prefix</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>, htonl (0), &amp;asbr_id);
  asbr_entry = <a class="code" href="ospf6__route_8c.html#aa7d8f56a2e18e2dc561dfda78a980fb2">ospf6_route_lookup</a> (&amp;asbr_id, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#adb6e884ec587387ef1174da7a6cb426c">brouter_table</a>);
  <span class="keywordflow">if</span> (asbr_entry == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
      ! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (asbr_entry-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ad4c22e82497e95ddac15345fbdf50245">router_bits</a>, <a class="code" href="ospf6__proto_8h.html#a001990a29c38d5f3b4da6bf596ccc2c5">OSPF6_ROUTER_BIT_E</a>))
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        {
          <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (&amp;asbr_id, buf, <span class="keyword">sizeof</span> (buf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;ASBR entry not found: %s&quot;</span>, buf);
        }
      <span class="keywordflow">return</span>;
    }

  route = <a class="code" href="ospf6__route_8c.html#af4307729ed4bcbcb064c0a7363f3084f">ospf6_route_create</a> ();
  route-&gt;<a class="code" href="structospf6__route.html#a74705096f252ccb17294f45fe3945757">type</a> = <a class="code" href="ospf6__route_8h.html#a2f4b4255cc7cd17befa380178d67e819">OSPF6_DEST_TYPE_NETWORK</a>;
  route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>.<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a> = AF_INET6;
  route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>.<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> = external-&gt;<a class="code" href="structospf6__as__external__lsa.html#a0fef0acce116710502c8717342bf3f2c">prefix</a>.<a class="code" href="structospf6__prefix.html#a308c8780392bd7557d20759cb1d93b45">prefix_length</a>;
  <a class="code" href="ospf6__proto_8h.html#a01c336c921d3df5dc60e501439617d7a">ospf6_prefix_in6_addr</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>.u.prefix6, &amp;external-&gt;<a class="code" href="structospf6__as__external__lsa.html#a0fef0acce116710502c8717342bf3f2c">prefix</a>);

  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ad4fc384dbcd343e1ba3e5918e4d25c15">area_id</a> = asbr_entry-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ad4fc384dbcd343e1ba3e5918e4d25c15">area_id</a>;
  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a88f1d08bddf61718681883834fd9990e">type</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>;
  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a5462d6c847d9cddd5e0bace437f2199a">id</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a663d9c2afc1cdc7a124a2c9d1199e394">id</a>;
  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#aad4727f62192e5db63a98474f9845694">adv_router</a> = lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>;

  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#aff47b01abb3043868430317017d8f1c7">prefix_options</a> = external-&gt;<a class="code" href="structospf6__as__external__lsa.html#a0fef0acce116710502c8717342bf3f2c">prefix</a>.<a class="code" href="structospf6__prefix.html#aeac807a42ff5d2e15dfa844203fec5c8">prefix_options</a>;
  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (external-&gt;<a class="code" href="structospf6__as__external__lsa.html#adbc8fb2b4e020ee5ec80d8b35d484868">bits_metric</a>, <a class="code" href="ospf6__asbr_8h.html#a702fab0bf2a17db8966e0c19c7eecba6">OSPF6_ASBR_BIT_E</a>))
    {
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a9cffc83cee981501db820772cab34b7e">type</a> = <a class="code" href="ospf6__route_8h.html#a753677bbce3e5b4d74252300c43e422a">OSPF6_PATH_TYPE_EXTERNAL2</a>;
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a5723668da86dfd4caea4f50e8ad0457f">metric_type</a> = 2;
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a> = asbr_entry-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a>;
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#afbe458c0a581463749e46edf6ae726c3">cost_e2</a> = <a class="code" href="ospf6__asbr_8h.html#a057432ca741931f338fb9713d5142d18">OSPF6_ASBR_METRIC</a> (external);
    }
  <span class="keywordflow">else</span>
    {
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a9cffc83cee981501db820772cab34b7e">type</a> = <a class="code" href="ospf6__route_8h.html#ac93e11c1cfd47244e95e27b3ba4571ae">OSPF6_PATH_TYPE_EXTERNAL1</a>;
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a5723668da86dfd4caea4f50e8ad0457f">metric_type</a> = 1;
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a> = asbr_entry-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a> + <a class="code" href="ospf6__asbr_8h.html#a057432ca741931f338fb9713d5142d18">OSPF6_ASBR_METRIC</a> (external);
      route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#afbe458c0a581463749e46edf6ae726c3">cost_e2</a> = 0;
    }

  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="ospf6__route_8h.html#a722b45cea00290e2da6ebe98934f8749">OSPF6_MULTI_PATH_LIMIT</a>; i++)
    <a class="code" href="ospf6__route_8h.html#a984d5a07fada4d6bb60561677a1f79a1">ospf6_nexthop_copy</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[i], &amp;asbr_entry-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[i]);

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
    {
      <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>, buf, sizeof (buf));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;AS-External route add: %s&quot;</span>, buf);
    }

  <a class="code" href="ospf6__route_8c.html#ab35c4efbc72f9bf772e334f1725da353">ospf6_route_add</a> (route, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a16be66ef6b2fd85cb56f64c8d829f3d3">route_table</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a38f6316bb47fff653cbbbd0d6e3129f0"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_lsa_remove" ref="a38f6316bb47fff653cbbbd0d6e3129f0" args="(struct ospf6_lsa *lsa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_lsa_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__lsa.html">ospf6_lsa</a> *&#160;</td>
          <td class="paramname"><em>lsa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00237">237</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__as__external__lsa.html">ospf6_as_external_lsa</a> *external;
  <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> <a class="code" href="structprefix.html">prefix</a>;
  <span class="keyword">struct </span><a class="code" href="structospf6__route.html">ospf6_route</a> *route;
  <span class="keywordtype">char</span> buf[64];

  external = (<span class="keyword">struct </span><a class="code" href="structospf6__as__external__lsa.html">ospf6_as_external_lsa</a> *)
    <a class="code" href="ospf6__lsa_8h.html#ade3057c51a01c081c6c753a03c1ffc3f">OSPF6_LSA_HEADER_END</a> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>);

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Withdraw AS-External route for %s&quot;</span>, lsa-&gt;<a class="code" href="structospf6__lsa.html#a979d21e1c4d2e1753e7d45641b0819ce">name</a>);

  <span class="keywordflow">if</span> (lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a> == <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Ignore self-originated AS-External-LSA&quot;</span>);
      <span class="keywordflow">return</span>;
    }

  memset (&amp;<a class="code" href="structprefix.html">prefix</a>, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structprefix.html">prefix</a>));
  <a class="code" href="structprefix.html">prefix</a>.<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a> = AF_INET6;
  <a class="code" href="structprefix.html">prefix</a>.<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> = external-&gt;<a class="code" href="structospf6__as__external__lsa.html#a0fef0acce116710502c8717342bf3f2c">prefix</a>.<a class="code" href="structospf6__prefix.html#a308c8780392bd7557d20759cb1d93b45">prefix_length</a>;
  <a class="code" href="ospf6__proto_8h.html#a01c336c921d3df5dc60e501439617d7a">ospf6_prefix_in6_addr</a> (&amp;<a class="code" href="structprefix.html">prefix</a>.u.prefix6, &amp;external-&gt;<a class="code" href="structospf6__as__external__lsa.html#a0fef0acce116710502c8717342bf3f2c">prefix</a>);

  route = <a class="code" href="ospf6__route_8c.html#aa7d8f56a2e18e2dc561dfda78a980fb2">ospf6_route_lookup</a> (&amp;<a class="code" href="structprefix.html">prefix</a>, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a16be66ef6b2fd85cb56f64c8d829f3d3">route_table</a>);
  <span class="keywordflow">if</span> (route == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        {
          <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (&amp;<a class="code" href="structprefix.html">prefix</a>, buf, <span class="keyword">sizeof</span> (buf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;AS-External route %s not found&quot;</span>, buf);
        }
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">for</span> (<a class="code" href="ospf6__route_8c.html#a0ad7c43050f40ca3637220835928c2af">ospf6_route_lock</a> (route);
       route &amp;&amp; <a class="code" href="ospf6__route_8h.html#a0a95fc057a8b281526dc83bdda838baf">ospf6_route_is_prefix</a> (&amp;<a class="code" href="structprefix.html">prefix</a>, route);
       route = <a class="code" href="ospf6__route_8c.html#a4cdecc41a86097a7d0871397f7a80fb8">ospf6_route_next</a> (route))
    {
      <span class="keywordflow">if</span> (route-&gt;<a class="code" href="structospf6__route.html#a74705096f252ccb17294f45fe3945757">type</a> != <a class="code" href="ospf6__route_8h.html#a2f4b4255cc7cd17befa380178d67e819">OSPF6_DEST_TYPE_NETWORK</a>)
        <span class="keywordflow">continue</span>;
      <span class="keywordflow">if</span> (route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a88f1d08bddf61718681883834fd9990e">type</a> != lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#adadc5d3ed71f1b07f56b7692454d2e08">type</a>)
        <span class="keywordflow">continue</span>;
      <span class="keywordflow">if</span> (route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a5462d6c847d9cddd5e0bace437f2199a">id</a> != lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a663d9c2afc1cdc7a124a2c9d1199e394">id</a>)
        <span class="keywordflow">continue</span>;
      <span class="keywordflow">if</span> (route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#aad4727f62192e5db63a98474f9845694">adv_router</a> != lsa-&gt;<a class="code" href="structospf6__lsa.html#ad53bee4fa68445da0f4c82b4b0b81f1c">header</a>-&gt;<a class="code" href="structospf6__lsa__header.html#a756706ceafd6ffab88f8ee481fcc3619">adv_router</a>)
        <span class="keywordflow">continue</span>;

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__lsa_8h.html#a406c0c0d50f887bcff40c875b15499c2">IS_OSPF6_DEBUG_EXAMIN</a> (AS_EXTERNAL))
        {
          <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>, buf, sizeof (buf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;AS-External route remove: %s&quot;</span>, buf);
        }
      <a class="code" href="ospf6__route_8c.html#a89c513ce389875d0c89a20017db2c410">ospf6_route_remove</a> (route, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a16be66ef6b2fd85cb56f64c8d829f3d3">route_table</a>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="adb3d1ad8b89c9eef8b6f4f3e3cfa5281"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_lsentry_add" ref="adb3d1ad8b89c9eef8b6f4f3e3cfa5281" args="(struct ospf6_route *asbr_entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_lsentry_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__route.html">ospf6_route</a> *&#160;</td>
          <td class="paramname"><em>asbr_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00296">296</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;
  u_int16_t <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
  u_int32_t router;

  <span class="keywordflow">if</span> (! <a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (asbr_entry-&gt;<a class="code" href="structospf6__route.html#a6ea0bf028d117b76ebdf829dd1214f86">flag</a>, <a class="code" href="ospf6__route_8h.html#a15a16e004b7ad8a332e55f65fa81bc88">OSPF6_ROUTE_BEST</a>))
    {
      <span class="keywordtype">char</span> buf[16];
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;<a class="code" href="ospf6__route_8h.html#abe7756da14600493b65f298e52850619">ADV_ROUTER_IN_PREFIX</a> (&amp;asbr_entry-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>),
                 buf, sizeof (buf));
       <a class="code" href="log_8h.html#a383184727341e7ad985deb9e4f2156c7">zlog_info</a> (<span class="stringliteral">&quot;ignore non-best path: lsentry %s add&quot;</span>, buf);
      <span class="keywordflow">return</span>;
    }

  type = htons (<a class="code" href="ospf6__lsa_8h.html#a4cba002872c9f1e86a8d3fcede9fe4dc">OSPF6_LSTYPE_AS_EXTERNAL</a>);
  router = <a class="code" href="ospf6__route_8h.html#ab056946ac3b3ce6cc32c6eefa5a2f238">ospf6_linkstate_prefix_adv_router</a> (&amp;asbr_entry-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>);
  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#a05c536e9366e1e70e302176636494ff2">ospf6_lsdb_type_router_head</a> (type, router, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>); lsa;
       lsa = <a class="code" href="ospf6__lsdb_8c.html#a5c4427dd8608615a5a34a772e722eca6">ospf6_lsdb_type_router_next</a> (type, router, lsa))
    {
      <span class="keywordflow">if</span> (! <a class="code" href="ospf6__lsa_8h.html#acde3ad184b10ca14f3eef7b2ab655ce6">OSPF6_LSA_IS_MAXAGE</a> (lsa))
        <a class="code" href="ospf6__asbr_8c.html#ab2b3fe7537d6dde649e7a0faf0e912e8">ospf6_asbr_lsa_add</a> (lsa);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a70d2ab867a5914a2822fbb953fc7e2c1"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_lsentry_remove" ref="a70d2ab867a5914a2822fbb953fc7e2c1" args="(struct ospf6_route *asbr_entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_lsentry_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structospf6__route.html">ospf6_route</a> *&#160;</td>
          <td class="paramname"><em>asbr_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00322">322</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;
  u_int16_t <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
  u_int32_t router;

  type = htons (<a class="code" href="ospf6__lsa_8h.html#a4cba002872c9f1e86a8d3fcede9fe4dc">OSPF6_LSTYPE_AS_EXTERNAL</a>);
  router = <a class="code" href="ospf6__route_8h.html#ab056946ac3b3ce6cc32c6eefa5a2f238">ospf6_linkstate_prefix_adv_router</a> (&amp;asbr_entry-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>);
  <span class="keywordflow">for</span> (lsa = <a class="code" href="ospf6__lsdb_8c.html#a05c536e9366e1e70e302176636494ff2">ospf6_lsdb_type_router_head</a> (type, router, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>);
       lsa; lsa = <a class="code" href="ospf6__lsdb_8c.html#a5c4427dd8608615a5a34a772e722eca6">ospf6_lsdb_type_router_next</a> (type, router, lsa))
    <a class="code" href="ospf6__asbr_8c.html#a38f6316bb47fff653cbbbd0d6e3129f0">ospf6_asbr_lsa_remove</a> (lsa);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a28e49591579d5ebab190126fff7762fa"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_redistribute_add" ref="a28e49591579d5ebab190126fff7762fa" args="(int type, int ifindex, struct prefix *prefix, u_int nexthop_num, struct in6_addr *nexthop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_redistribute_add </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structprefix.html">prefix</a> *&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>nexthop_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in6_addr *&#160;</td>
          <td class="paramname"><em>nexthop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00408">408</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ret;
  <span class="keyword">struct </span><a class="code" href="structospf6__route.html">ospf6_route</a> troute;
  <span class="keyword">struct </span><a class="code" href="structospf6__external__info.html">ospf6_external_info</a> tinfo;
  <span class="keyword">struct </span><a class="code" href="structospf6__route.html">ospf6_route</a> *route, *match;
  <span class="keyword">struct </span><a class="code" href="structospf6__external__info.html">ospf6_external_info</a> *info;
  <span class="keyword">struct </span>prefix prefix_id;
  <span class="keyword">struct </span><a class="code" href="structroute__node.html">route_node</a> *node;
  <span class="keywordtype">char</span> pbuf[64], ibuf[16];
  <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *lnode, *lnnode;
  <span class="keyword">struct </span><a class="code" href="structospf6__area.html">ospf6_area</a> *oa;

  <span class="keywordflow">if</span> (! <a class="code" href="ospf6__zebra_8h.html#a7cb0d31f407c28bf9a2e824265bbf9d2">ospf6_zebra_is_redistribute</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>))
    <span class="keywordflow">return</span>;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
    {
      <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (prefix, pbuf, <span class="keyword">sizeof</span> (pbuf));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Redistribute %s (%s)&quot;</span>, pbuf, <a class="code" href="ospf6__asbr_8c.html#aca90369fe90fa47428574432a83222aa">ZROUTE_NAME</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>));
    }

  <span class="comment">/* if route-map was specified but not found, do not advertise */</span>
  <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#ab64589cf9453a85c25c0690ba248ea5e">name</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        <a class="code" href="ospf6__asbr_8c.html#ab1cc6fe63025e3a7b21cfd5918f7ceb4">ospf6_asbr_routemap_update</a> (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
      <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        {
          <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;route-map \&quot;%s\&quot; not found, suppress redistributing&quot;</span>,
                     <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#ab64589cf9453a85c25c0690ba248ea5e">name</a>);
          <span class="keywordflow">return</span>;
        }
    }

  <span class="comment">/* apply route-map */</span>
  <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a>)
    {
      memset (&amp;troute, 0, <span class="keyword">sizeof</span> (troute));
      memset (&amp;tinfo, 0, <span class="keyword">sizeof</span> (tinfo));
      troute.route_option = &amp;tinfo;

      ret = <a class="code" href="routemap_8c.html#a3372553a024332702cfd603e1f4c08d6">route_map_apply</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a>, prefix,
                             <a class="code" href="routemap_8h.html#ae21439463f873ce0ce1556c9d6fa7370ad6c5d7f8d5732e1ae78dbc856e335950">RMAP_OSPF6</a>, &amp;troute);
      <span class="keywordflow">if</span> (ret == <a class="code" href="routemap_8h.html#afd7345bfd662f1e7c77f0be351cd1516aa0f40f0a91e43bfe7131839fe179ac64">RMAP_DENYMATCH</a>)
        {
          <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
            <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Denied by route-map \&quot;%s\&quot;&quot;</span>, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#ab64589cf9453a85c25c0690ba248ea5e">name</a>);
          <span class="keywordflow">return</span>;
        }
    }

  match = <a class="code" href="ospf6__route_8c.html#aa7d8f56a2e18e2dc561dfda78a980fb2">ospf6_route_lookup</a> (prefix, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ab0b53951e38ce1246513c529368a00a3">external_table</a>);
  <span class="keywordflow">if</span> (match)
    {
      info = match-&gt;<a class="code" href="structospf6__route.html#acca63ef5258eae52686a0ca0f159f069">route_option</a>;

      <span class="comment">/* copy result of route-map */</span>
      <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a>)
        {
          <span class="keywordflow">if</span> (troute.path.metric_type)
            match-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a5723668da86dfd4caea4f50e8ad0457f">metric_type</a> = troute.path.metric_type;
          <span class="keywordflow">if</span> (troute.path.cost)
            match-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a> = troute.path.cost;
          <span class="keywordflow">if</span> (! IN6_IS_ADDR_UNSPECIFIED (&amp;tinfo.forwarding))
            <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;info-&gt;<a class="code" href="structospf6__external__info.html#a87bfba0d24fc9ac366cfc70237a96bc7">forwarding</a>, &amp;tinfo.forwarding,
                    sizeof (<span class="keyword">struct</span> in6_addr));
        }

      info-&gt;<a class="code" href="structospf6__external__info.html#a78790dc80febd2f72d0f35f0b7b7aec2">type</a> = <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
      match-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[0].<a class="code" href="structospf6__nexthop.html#a5809ab035d671ce92e5492ea78d79051">ifindex</a> = ifindex;
      <span class="keywordflow">if</span> (nexthop_num &amp;&amp; <a class="code" href="structnexthop.html">nexthop</a>)
        <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;match-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[0].<a class="code" href="structospf6__nexthop.html#aca0fcfd059411e2638d19d1d95288a10">address</a>, <a class="code" href="structnexthop.html">nexthop</a>, sizeof (<span class="keyword">struct</span> in6_addr));

      <span class="comment">/* create/update binding in external_id_table */</span>
      prefix_id.family = AF_INET;
      prefix_id.prefixlen = 32;
      prefix_id.u.prefix4.s_addr = htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>);
      node = <a class="code" href="table_8c.html#ac91fdff1a0b8dc3d60ebaf152caa0f80">route_node_get</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a6eafe8ffc198a51815a2a6d914eb1826">external_id_table</a>, &amp;prefix_id);
      node-&gt;<a class="code" href="structroute__node.html#a20aabb1a6fbe9de363a1c57fe3124c87">info</a> = match;

      <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
        {
          <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;prefix_id.u.prefix4, ibuf, sizeof (ibuf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Advertise as AS-External Id:%s&quot;</span>, ibuf);
        }

      match-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a5462d6c847d9cddd5e0bace437f2199a">id</a> = htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>);
      <a class="code" href="ospf6__asbr_8c.html#a5993a93bf914de5e343e06ffe55c14e8">ospf6_as_external_lsa_originate</a> (match);
      <span class="keywordflow">return</span>;
    }

  <span class="comment">/* create new entry */</span>
  route = <a class="code" href="ospf6__route_8c.html#af4307729ed4bcbcb064c0a7363f3084f">ospf6_route_create</a> ();
  route-&gt;<a class="code" href="structospf6__route.html#a74705096f252ccb17294f45fe3945757">type</a> = <a class="code" href="ospf6__route_8h.html#a2f4b4255cc7cd17befa380178d67e819">OSPF6_DEST_TYPE_NETWORK</a>;
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#a39f2a986ed391c16d5216ad5797c2eda">prefix</a>, prefix, sizeof (<span class="keyword">struct</span> prefix));

  info = (<span class="keyword">struct </span><a class="code" href="structospf6__external__info.html">ospf6_external_info</a> *)
    <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baa84f8758ca4b45b3d5428900c49f63a9">MTYPE_OSPF6_EXTERNAL_INFO</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structospf6__external__info.html">ospf6_external_info</a>));
  route-&gt;<a class="code" href="structospf6__route.html#acca63ef5258eae52686a0ca0f159f069">route_option</a> = info;
  info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a> = <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a250e36f5987403d3dd0831c0a6d0127e">external_id</a>++;

  <span class="comment">/* copy result of route-map */</span>
  <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>].<a class="code" href="structospf6.html#a301c15c73c2fbf5a5723647a4b6c161e">map</a>)
    {
      <span class="keywordflow">if</span> (troute.path.metric_type)
        route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a5723668da86dfd4caea4f50e8ad0457f">metric_type</a> = troute.path.metric_type;
      <span class="keywordflow">if</span> (troute.path.cost)
        route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#ab33bf3c3ce1f07b918167dbfa4af30e6">cost</a> = troute.path.cost;
      <span class="keywordflow">if</span> (! IN6_IS_ADDR_UNSPECIFIED (&amp;tinfo.forwarding))
        <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;info-&gt;<a class="code" href="structospf6__external__info.html#a87bfba0d24fc9ac366cfc70237a96bc7">forwarding</a>, &amp;tinfo.forwarding,
                sizeof (<span class="keyword">struct</span> in6_addr));
    }

  info-&gt;<a class="code" href="structospf6__external__info.html#a78790dc80febd2f72d0f35f0b7b7aec2">type</a> = <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
  route-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[0].<a class="code" href="structospf6__nexthop.html#a5809ab035d671ce92e5492ea78d79051">ifindex</a> = ifindex;
  <span class="keywordflow">if</span> (nexthop_num &amp;&amp; <a class="code" href="structnexthop.html">nexthop</a>)
    <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;route-&gt;<a class="code" href="structospf6__route.html#aeff840303635790b4975364a57c300a3">nexthop</a>[0].<a class="code" href="structospf6__nexthop.html#aca0fcfd059411e2638d19d1d95288a10">address</a>, <a class="code" href="structnexthop.html">nexthop</a>, sizeof (<span class="keyword">struct</span> in6_addr));

  <span class="comment">/* create/update binding in external_id_table */</span>
  prefix_id.family = AF_INET;
  prefix_id.prefixlen = 32;
  prefix_id.u.prefix4.s_addr = htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>);
  node = <a class="code" href="table_8c.html#ac91fdff1a0b8dc3d60ebaf152caa0f80">route_node_get</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a6eafe8ffc198a51815a2a6d914eb1826">external_id_table</a>, &amp;prefix_id);
  node-&gt;<a class="code" href="structroute__node.html#a20aabb1a6fbe9de363a1c57fe3124c87">info</a> = route;

  route = <a class="code" href="ospf6__route_8c.html#ab35c4efbc72f9bf772e334f1725da353">ospf6_route_add</a> (route, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ab0b53951e38ce1246513c529368a00a3">external_table</a>);
  route-&gt;<a class="code" href="structospf6__route.html#acca63ef5258eae52686a0ca0f159f069">route_option</a> = info;

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
    {
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;prefix_id.u.prefix4, ibuf, sizeof (ibuf));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Advertise as AS-External Id:%s&quot;</span>, ibuf);
    }

  route-&gt;<a class="code" href="structospf6__route.html#a5a6311b685c1d76468b47edb218bf4a5">path</a>.<a class="code" href="structospf6__path.html#a7f174fe7a9fdaded7fc074cb1c51b351">origin</a>.<a class="code" href="structospf6__ls__origin.html#a5462d6c847d9cddd5e0bace437f2199a">id</a> = htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>);
  <a class="code" href="ospf6__asbr_8c.html#a5993a93bf914de5e343e06ffe55c14e8">ospf6_as_external_lsa_originate</a> (route);

  <span class="comment">/* Router-Bit (ASBR Flag) may have to be updated */</span>
  <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a71512a873b8f0e2b4c84d3c949a9bbaf">ALL_LIST_ELEMENTS</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a6a8e756959f407c36b123ffc040fbe96">area_list</a>, lnode, lnnode, oa))
    <a class="code" href="ospf6__intra_8h.html#ab8e4a09ea2a5ce941594dc24d6165519">OSPF6_ROUTER_LSA_SCHEDULE</a> (oa);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a76af4e8a926eb7373e59626cac4a5fc0"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_asbr_redistribute_remove" ref="a76af4e8a926eb7373e59626cac4a5fc0" args="(int type, int ifindex, struct prefix *prefix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ospf6_asbr_redistribute_remove </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structprefix.html">prefix</a> *&#160;</td>
          <td class="paramname"><em>prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00553">553</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structospf6__route.html">ospf6_route</a> *match;
  <span class="keyword">struct </span><a class="code" href="structospf6__external__info.html">ospf6_external_info</a> *info = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structroute__node.html">route_node</a> *node;
  <span class="keyword">struct </span><a class="code" href="structospf6__lsa.html">ospf6_lsa</a> *lsa;
  <span class="keyword">struct </span>prefix prefix_id;
  <span class="keywordtype">char</span> pbuf[64], ibuf[16];
  <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *lnode, *lnnode;
  <span class="keyword">struct </span><a class="code" href="structospf6__area.html">ospf6_area</a> *oa;

  match = <a class="code" href="ospf6__route_8c.html#aa7d8f56a2e18e2dc561dfda78a980fb2">ospf6_route_lookup</a> (prefix, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ab0b53951e38ce1246513c529368a00a3">external_table</a>);
  <span class="keywordflow">if</span> (match == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
        {
          <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (prefix, pbuf, <span class="keyword">sizeof</span> (pbuf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;No such route %s to withdraw&quot;</span>, pbuf);
        }
      <span class="keywordflow">return</span>;
    }

  info = match-&gt;<a class="code" href="structospf6__route.html#acca63ef5258eae52686a0ca0f159f069">route_option</a>;
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (info);

  <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structospf6__external__info.html#a78790dc80febd2f72d0f35f0b7b7aec2">type</a> != <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
        {
          <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (prefix, pbuf, <span class="keyword">sizeof</span> (pbuf));
          <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Original protocol mismatch: %s&quot;</span>, pbuf);
        }
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (<a class="code" href="ospf6__asbr_8h.html#ace41597f91e209786354b98dec5a5f5d">IS_OSPF6_DEBUG_ASBR</a>)
    {
      <a class="code" href="prefix_8c.html#a8b848557695ae5694bd2282eba23e367">prefix2str</a> (prefix, pbuf, <span class="keyword">sizeof</span> (pbuf));
      <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET, &amp;prefix_id.u.prefix4, ibuf, sizeof (ibuf));
      <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Withdraw %s (AS-External Id:%s)&quot;</span>, pbuf, ibuf);
    }

  lsa = <a class="code" href="ospf6__lsdb_8c.html#aa49ea0d4a8edbec90f266bf3a541a421">ospf6_lsdb_lookup</a> (htons (<a class="code" href="ospf6__lsa_8h.html#a4cba002872c9f1e86a8d3fcede9fe4dc">OSPF6_LSTYPE_AS_EXTERNAL</a>),
                           htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>), <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a4dc92a648ae2190f7cf5b383c475d2aa">router_id</a>, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ac8cf84e34e8461f5aea2737fc2bf8fcb">lsdb</a>);
  <span class="keywordflow">if</span> (lsa)
    <a class="code" href="ospf6__flood_8c.html#a249f2b2808a03c8e9998d6bdf209a962">ospf6_lsa_purge</a> (lsa);

  <span class="comment">/* remove binding in external_id_table */</span>
  prefix_id.family = AF_INET;
  prefix_id.prefixlen = 32;
  prefix_id.u.prefix4.s_addr = htonl (info-&gt;<a class="code" href="structospf6__external__info.html#a0e400a8e553de269adef1deae3ca3485">id</a>);
  node = <a class="code" href="table_8c.html#ab99d86b40440c8f18d4f2b31b5b8f1c7">route_node_lookup</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a6eafe8ffc198a51815a2a6d914eb1826">external_id_table</a>, &amp;prefix_id);
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (node);
  node-&gt;<a class="code" href="structroute__node.html#a20aabb1a6fbe9de363a1c57fe3124c87">info</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <a class="code" href="table_8c.html#a849965644708e01ef49c203a2e00afd4">route_unlock_node</a> (node);

  <a class="code" href="ospf6__route_8c.html#a89c513ce389875d0c89a20017db2c410">ospf6_route_remove</a> (match, <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#ab0b53951e38ce1246513c529368a00a3">external_table</a>);
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baa84f8758ca4b45b3d5428900c49f63a9">MTYPE_OSPF6_EXTERNAL_INFO</a>, info);

  <span class="comment">/* Router-Bit (ASBR Flag) may have to be updated */</span>
  <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a71512a873b8f0e2b4c84d3c949a9bbaf">ALL_LIST_ELEMENTS</a> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a6a8e756959f407c36b123ffc040fbe96">area_list</a>, lnode, lnnode, oa))
    <a class="code" href="ospf6__intra_8h.html#ab8e4a09ea2a5ce941594dc24d6165519">OSPF6_ROUTER_LSA_SCHEDULE</a> (oa);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa002be662bf5a69805137bc6eff9c4bd"></a><!-- doxytag: member="ospf6_asbr.h::ospf6_redistribute_config_write" ref="aa002be662bf5a69805137bc6eff9c4bd" args="(struct vty *vty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ospf6_redistribute_config_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"><em>vty</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00711">711</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;

  <span class="keywordflow">for</span> (type = 0; type &lt; <a class="code" href="zebra_8h.html#aec97442680d773fd62f9af5c9426b842">ZEBRA_ROUTE_MAX</a>; type++)
    {
      <span class="keywordflow">if</span> (type == <a class="code" href="zebra_8h.html#ae05c36542e3fb1c5c7fd440ac322331f">ZEBRA_ROUTE_OSPF6</a>)
        <span class="keywordflow">continue</span>;
      <span class="keywordflow">if</span> (! <a class="code" href="ospf6__zebra_8h.html#a7cb0d31f407c28bf9a2e824265bbf9d2">ospf6_zebra_is_redistribute</a> (type))
        <span class="keywordflow">continue</span>;

      <span class="keywordflow">if</span> (<a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[type].<a class="code" href="structospf6.html#ab64589cf9453a85c25c0690ba248ea5e">name</a>)
        <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; redistribute %s route-map %s%s&quot;</span>,
                 <a class="code" href="ospf6__asbr_8c.html#aca90369fe90fa47428574432a83222aa">ZROUTE_NAME</a> (type), <a class="code" href="structospf6.html">ospf6</a>-&gt;<a class="code" href="structospf6.html#a8b9be13bdd14b41d323201e4651ce386">rmap</a>[type].<a class="code" href="structospf6.html#ab64589cf9453a85c25c0690ba248ea5e">name</a>, <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
      <span class="keywordflow">else</span>
        <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot; redistribute %s%s&quot;</span>,
                 <a class="code" href="ospf6__asbr_8c.html#aca90369fe90fa47428574432a83222aa">ZROUTE_NAME</a> (type), <a class="code" href="ospf6d_8h.html#a356c06c82b90b274c7f519f9a405142c">VNL</a>);
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a81a15a09db2567a06559cca44f781117"></a><!-- doxytag: member="ospf6_asbr.h::conf_debug_ospf6_asbr" ref="a81a15a09db2567a06559cca44f781117" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="ospf6__asbr_8h.html#a81a15a09db2567a06559cca44f781117">conf_debug_ospf6_asbr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ospf6__asbr_8c_source.html#l00051">51</a> of file <a class="el" href="ospf6__asbr_8c_source.html">ospf6_asbr.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="ospf6__asbr_8h.html">ospf6_asbr.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:26 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
