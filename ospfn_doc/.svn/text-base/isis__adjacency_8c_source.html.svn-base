<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: isisd/isis_adjacency.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('isis__adjacency_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">isisd/isis_adjacency.c</div>  </div>
</div>
<div class="contents">
<a href="isis__adjacency_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * IS-IS Rout(e)ing protocol - isis_adjacency.c   </span>
<a name="l00003"></a>00003 <span class="comment"> *                             handling of IS-IS adjacencies</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Copyright (C) 2001,2002   Sampo Saaristo</span>
<a name="l00006"></a>00006 <span class="comment"> *                           Tampere University of Technology      </span>
<a name="l00007"></a>00007 <span class="comment"> *                           Institute of Communications Engineering</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is free software; you can redistribute it and/or modify it </span>
<a name="l00010"></a>00010 <span class="comment"> * under the terms of the GNU General Public Licenseas published by the Free </span>
<a name="l00011"></a>00011 <span class="comment"> * Software Foundation; either version 2 of the License, or (at your option) </span>
<a name="l00012"></a>00012 <span class="comment"> * any later version.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * This program is distributed in the hope that it will be useful,but WITHOUT </span>
<a name="l00015"></a>00015 <span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or </span>
<a name="l00016"></a>00016 <span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for </span>
<a name="l00017"></a>00017 <span class="comment"> * more details.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment"> * You should have received a copy of the GNU General Public License along </span>
<a name="l00020"></a>00020 <span class="comment"> * with this program; if not, write to the Free Software Foundation, Inc., </span>
<a name="l00021"></a>00021 <span class="comment"> * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="zebra_8h.html">zebra.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">log.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="memory_8h.html">memory.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="hash_8h.html">hash.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="vty_8h.html">vty.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="linklist_8h.html">linklist.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="thread_8h.html">thread.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="if_8h.html">if.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="stream_8h.html">stream.h</a>&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="dict_8h.html">isisd/dict.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="iso_8h.html">isisd/include-netbsd/iso.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="isis__constants_8h.html">isisd/isis_constants.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="isis__common_8h.html">isisd/isis_common.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="isisd_8h.html">isisd/isisd.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="isis__circuit_8h.html">isisd/isis_circuit.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="isis__adjacency_8h.html">isisd/isis_adjacency.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="isis__misc_8h.html">isisd/isis_misc.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="isis__dr_8h.html">isisd/isis_dr.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="isis__dynhn_8h.html">isisd/isis_dynhn.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="isis__pdu_8h.html">isisd/isis_pdu.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structisis.html">isis</a> *<a class="code" href="isis__adjacency_8c.html#aa8cfdc8f7777fd242bd2c45f3a48b950">isis</a>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *
<a name="l00050"></a><a class="code" href="isis__adjacency_8c.html#a45b2bbde14ec2c56510ce4cf38e87c61">00050</a> <a class="code" href="isis__adjacency_8c.html#a45b2bbde14ec2c56510ce4cf38e87c61">adj_alloc</a> (u_char * <span class="keywordtype">id</span>)
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   adj = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba573c15a700e70c8a655319a64727f856">MTYPE_ISIS_ADJACENCY</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a>));
<a name="l00055"></a>00055   <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>, <span class="keywordtype">id</span>, <a class="code" href="isis__constants_8h.html#aeda8abfdcc24dfb0ab327ea79ce453fc">ISIS_SYS_ID_LEN</a>);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057   <span class="keywordflow">return</span> adj;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *
<a name="l00061"></a><a class="code" href="isis__adjacency_8h.html#a81fa83638827781e0f128c9c01551a95">00061</a> <a class="code" href="isis__adjacency_8c.html#a81fa83638827781e0f128c9c01551a95">isis_new_adj</a> (u_char * <span class="keywordtype">id</span>, u_char * <a class="code" href="isis__misc_8c.html#aa1751dc9ca6ba209edc0f7f8e51e1d11">snpa</a>, <span class="keywordtype">int</span> <a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>,
<a name="l00062"></a>00062           <span class="keyword">struct</span> <a class="code" href="structisis__circuit.html">isis_circuit</a> *<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>)
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00065"></a>00065   <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   adj = <a class="code" href="isis__adjacency_8c.html#a45b2bbde14ec2c56510ce4cf38e87c61">adj_alloc</a> (<span class="keywordtype">id</span>);     <span class="comment">/* P2P kludge */</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (adj == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00070"></a>00070     {
<a name="l00071"></a>00071       <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a> (<span class="stringliteral">&quot;Out of memory!&quot;</span>);
<a name="l00072"></a>00072       <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="keywordflow">if</span> (snpa) {
<a name="l00076"></a>00076   <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>, snpa, 6);
<a name="l00077"></a>00077   } <span class="keywordflow">else</span> {
<a name="l00078"></a>00078       memset (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>, <span class="charliteral">&#39; &#39;</span>, 6);
<a name="l00079"></a>00079   }
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a> = <a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>;
<a name="l00082"></a>00082   adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a> = <a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>;
<a name="l00083"></a>00083   adj-&gt;<a class="code" href="structisis__adjacency.html#a2c4f0b0554631ca94fcc68da72656478">flaps</a> = 0;
<a name="l00084"></a>00084   adj-&gt;<a class="code" href="structisis__adjacency.html#ab62b50ca75a0cd91df327b1b6a3e72b4">last_flap</a> = time (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (circuit-&gt;<a class="code" href="structisis__circuit.html#a569e39bbf7fafd533eae2eeafa671b8c">circ_type</a> == <a class="code" href="isis__circuit_8h.html#a01a94c5f24c88efb64f791a749ae8f95">CIRCUIT_T_BROADCAST</a>)
<a name="l00086"></a>00086     {
<a name="l00087"></a>00087       <a class="code" href="linklist_8c.html#adb2a0478aba995441aaf691d1f6fe5db">listnode_add</a> (circuit-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a921ef29acc454e98615e0269f3bc926e">bc</a>.<a class="code" href="structisis__bcast__info.html#ada9bf2584373a37aed06b2e4c9e796f9">adjdb</a>[level - 1], adj);
<a name="l00088"></a>00088       adj-&gt;<a class="code" href="structisis__adjacency.html#ac4f9613019f220d78cafe905dfed9174">dischanges</a>[level - 1] = 0;
<a name="l00089"></a>00089       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="isis__adjacency_8h.html#abdf07e3225e7dc499ba5a20c42a77eba">DIS_RECORDS</a>; i++) <span class="comment">/* clear N DIS state change records */</span>
<a name="l00090"></a>00090     {
<a name="l00091"></a>00091       adj-&gt;<a class="code" href="structisis__adjacency.html#a76bf3ed808e66f1047d7a2a698683db2">dis_record</a>[(i * <a class="code" href="isis__constants_8h.html#a75b03ae2a0d626c94fe847f7d790f4af">ISIS_LEVELS</a>) + level - 1].dis
<a name="l00092"></a>00092         = <a class="code" href="isis__dr_8h.html#a411da867a1e3279a6ff0d1624b9ab05fa7ff309bc612bced23207d4ee69c9415f">ISIS_UNKNOWN_DIS</a>;
<a name="l00093"></a>00093       adj-&gt;<a class="code" href="structisis__adjacency.html#a76bf3ed808e66f1047d7a2a698683db2">dis_record</a>[(i * <a class="code" href="isis__constants_8h.html#a75b03ae2a0d626c94fe847f7d790f4af">ISIS_LEVELS</a>) + level - 1].last_dis_change
<a name="l00094"></a>00094         = time (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">return</span> adj;
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *
<a name="l00102"></a><a class="code" href="isis__adjacency_8h.html#af928a678a2e0e3296d688be2a4d8e7ac">00102</a> <a class="code" href="isis__adjacency_8c.html#af928a678a2e0e3296d688be2a4d8e7ac">isis_adj_lookup</a> (u_char * <a class="code" href="isis__misc_8c.html#aba11fdf75896b0a0b94c02619b945c97">sysid</a>, <span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00105"></a>00105   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adjdb, node, adj))
<a name="l00108"></a>00108     <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>, sysid, <a class="code" href="isis__constants_8h.html#aeda8abfdcc24dfb0ab327ea79ce453fc">ISIS_SYS_ID_LEN</a>) == 0)
<a name="l00109"></a>00109       <span class="keywordflow">return</span> adj;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *
<a name="l00115"></a><a class="code" href="isis__adjacency_8h.html#ae2500faa623c2fe78fef559c347dc2c7">00115</a> <a class="code" href="isis__adjacency_8c.html#ae2500faa623c2fe78fef559c347dc2c7">isis_adj_lookup_snpa</a> (u_char * ssnpa, <span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00118"></a>00118   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adjdb, node, adj))
<a name="l00121"></a>00121     <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>, ssnpa, <a class="code" href="isis__constants_8h.html#a9822d89774e0d6ddaa06503950130423">ETH_ALEN</a>) == 0)
<a name="l00122"></a>00122       <span class="keywordflow">return</span> adj;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="keywordtype">void</span>
<a name="l00128"></a><a class="code" href="isis__adjacency_8h.html#abc4304e7a881e09caccac3ff85f0471a">00128</a> <a class="code" href="isis__adjacency_8c.html#abc4304e7a881e09caccac3ff85f0471a">isis_delete_adj</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb)
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130   <span class="keywordflow">if</span> (!adj)
<a name="l00131"></a>00131     <span class="keywordflow">return</span>;
<a name="l00132"></a>00132   <span class="comment">/* When we recieve a NULL list, we will know its p2p. */</span>
<a name="l00133"></a>00133   <span class="keywordflow">if</span> (adjdb)
<a name="l00134"></a>00134     <a class="code" href="linklist_8c.html#a8cbdaa18db1ceacaadbc457a0c634e02">listnode_delete</a> (adjdb, adj);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a16900c0c5677510df0a115d145d5ce87">t_expire</a>);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>)
<a name="l00139"></a>00139     <a class="code" href="linklist_8c.html#ab5fdf1a904264be077ce19a432b1b119">list_delete</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>);
<a name="l00140"></a>00140 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (adj-&gt;ipv6_addrs)
<a name="l00142"></a>00142     <a class="code" href="linklist_8c.html#ab5fdf1a904264be077ce19a432b1b119">list_delete</a> (adj-&gt;ipv6_addrs);
<a name="l00143"></a>00143 <span class="preprocessor">#endif</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span>  
<a name="l00145"></a>00145   <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba573c15a700e70c8a655319a64727f856">MTYPE_ISIS_ADJACENCY</a>, adj);
<a name="l00146"></a>00146   <span class="keywordflow">return</span>;
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="keywordtype">void</span>
<a name="l00150"></a><a class="code" href="isis__adjacency_8h.html#a0f8f010e5bafa4fe5497e600c1ac12dd">00150</a> <a class="code" href="isis__adjacency_8c.html#a0f8f010e5bafa4fe5497e600c1ac12dd">isis_adj_state_change</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">enum</span> <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576">isis_adj_state</a> state,
<a name="l00151"></a>00151                <span class="keyword">const</span> <span class="keywordtype">char</span> *reason)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153   <span class="keywordtype">int</span> old_state;
<a name="l00154"></a>00154   <span class="keywordtype">int</span> <a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a> = adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>;
<a name="l00155"></a>00155   <span class="keyword">struct </span><a class="code" href="structisis__circuit.html">isis_circuit</a> *circuit;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   old_state = adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a>;
<a name="l00158"></a>00158   adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a> = <a class="code" href="structisis__circuit.html#a7491f48eafb46ce87d7041bd7959633b">state</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   circuit = adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162   <span class="keywordflow">if</span> (isis-&gt;<a class="code" href="structisis.html#a6e64127e274c1aa6a52cb0f4b541dfaa">debugs</a> &amp; <a class="code" href="isisd_8h.html#a4113d6aad857cfa148450dfc6ed85b5b">DEBUG_ADJ_PACKETS</a>)
<a name="l00163"></a>00163     {
<a name="l00164"></a>00164       <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;ISIS-Adj (%s): Adjacency state change %d-&gt;%d: %s&quot;</span>,
<a name="l00165"></a>00165          circuit-&gt;<a class="code" href="structisis__circuit.html#a4284617c89806a77b3c2314e15ac508b">area</a>-&gt;<a class="code" href="structisis__area.html#aef5ef529e28214a477a6a7c2fe03c350">area_tag</a>,
<a name="l00166"></a>00166          old_state, state, reason ? reason : <span class="stringliteral">&quot;unspecified&quot;</span>);
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <span class="keywordflow">if</span> (circuit-&gt;<a class="code" href="structisis__circuit.html#a569e39bbf7fafd533eae2eeafa671b8c">circ_type</a> == <a class="code" href="isis__circuit_8h.html#a01a94c5f24c88efb64f791a749ae8f95">CIRCUIT_T_BROADCAST</a>)
<a name="l00170"></a>00170     {
<a name="l00171"></a>00171       <span class="keywordflow">if</span> (state == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1762b381ed451feffee948c5f5d0ed86">ISIS_ADJ_UP</a>)
<a name="l00172"></a>00172     circuit-&gt;<a class="code" href="structisis__circuit.html#ad3b84de111be4155660a1ed94e380e2b">upadjcount</a>[level - 1]++;
<a name="l00173"></a>00173       <span class="keywordflow">if</span> (state == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a74fdb396aae235e00736312b60c5d347">ISIS_ADJ_DOWN</a>)
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <a class="code" href="isis__adjacency_8c.html#abc4304e7a881e09caccac3ff85f0471a">isis_delete_adj</a> (adj, adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a921ef29acc454e98615e0269f3bc926e">bc</a>.<a class="code" href="structisis__bcast__info.html#ada9bf2584373a37aed06b2e4c9e796f9">adjdb</a>[level - 1]);
<a name="l00176"></a>00176       circuit-&gt;<a class="code" href="structisis__circuit.html#ad3b84de111be4155660a1ed94e380e2b">upadjcount</a>[level - 1]--;
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179       <a class="code" href="linklist_8c.html#acd6daa4be8ab3f175376e63c9d9c9500">list_delete_all_node</a> (circuit-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a921ef29acc454e98615e0269f3bc926e">bc</a>.<a class="code" href="structisis__bcast__info.html#a1a8b5b8fcf6defb0b21b509d99953742">lan_neighs</a>[level - 1]);
<a name="l00180"></a>00180       <a class="code" href="isis__adjacency_8c.html#aa6290067148c07fb10f67b9e4237585f">isis_adj_build_neigh_list</a> (circuit-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a921ef29acc454e98615e0269f3bc926e">bc</a>.<a class="code" href="structisis__bcast__info.html#ada9bf2584373a37aed06b2e4c9e796f9">adjdb</a>[level - 1],
<a name="l00181"></a>00181                  circuit-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a921ef29acc454e98615e0269f3bc926e">bc</a>.<a class="code" href="structisis__bcast__info.html#a1a8b5b8fcf6defb0b21b509d99953742">lan_neighs</a>[level - 1]);
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1762b381ed451feffee948c5f5d0ed86">ISIS_ADJ_UP</a>)
<a name="l00184"></a>00184     {               <span class="comment">/* p2p interface */</span>
<a name="l00185"></a>00185       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#a187eb9cdad6881ecd2735b38a47e07e3">sys_type</a> == <a class="code" href="isis__adjacency_8h.html#ad310c3cfba255c6c6dda415939268b4da1d20bc4d429708dd9bc81735bd176618">ISIS_SYSTYPE_UNKNOWN</a>)
<a name="l00186"></a>00186     <a class="code" href="isis__pdu_8c.html#ada46fc1940683eac5a47249f80f865b5">send_hello</a> (circuit, 1);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188       <span class="comment">/* update counter &amp; timers for debugging purposes */</span>
<a name="l00189"></a>00189       adj-&gt;<a class="code" href="structisis__adjacency.html#ab62b50ca75a0cd91df327b1b6a3e72b4">last_flap</a> = time (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00190"></a>00190       adj-&gt;<a class="code" href="structisis__adjacency.html#a2c4f0b0554631ca94fcc68da72656478">flaps</a>++;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192       <span class="comment">/* 7.3.17 - going up on P2P -&gt; send CSNP */</span>
<a name="l00193"></a>00193       <span class="comment">/* FIXME: yup, I know its wrong... but i will do it! (for now) */</span>
<a name="l00194"></a>00194       <a class="code" href="isis__pdu_8c.html#ab75f3f062607df2c29d3ba4f4c2341dc">send_csnp</a> (circuit, 1);
<a name="l00195"></a>00195       <a class="code" href="isis__pdu_8c.html#ab75f3f062607df2c29d3ba4f4c2341dc">send_csnp</a> (circuit, 2);
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a74fdb396aae235e00736312b60c5d347">ISIS_ADJ_DOWN</a>)
<a name="l00198"></a>00198     {               <span class="comment">/* p2p interface */</span>
<a name="l00199"></a>00199       adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>-&gt;<a class="code" href="structisis__circuit.html#a054734bc8d5a177c375cd28ab313dfc4">u</a>.<a class="code" href="structisis__circuit.html#a15852a59ea8be80680abac2070659440">p2p</a>.<a class="code" href="structisis__p2p__info.html#a17d32289e6648b9855b93482cd7c45a5">neighbor</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00200"></a>00200       <a class="code" href="isis__adjacency_8c.html#abc4304e7a881e09caccac3ff85f0471a">isis_delete_adj</a> (adj, <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00201"></a>00201     }
<a name="l00202"></a>00202   <span class="keywordflow">return</span>;
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="keywordtype">void</span>
<a name="l00207"></a><a class="code" href="isis__adjacency_8h.html#a7d71e7ce130055cd54e964590d8321e4">00207</a> <a class="code" href="isis__adjacency_8c.html#a7d71e7ce130055cd54e964590d8321e4">isis_adj_print</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj)
<a name="l00208"></a>00208 {
<a name="l00209"></a>00209   <span class="keyword">struct </span><a class="code" href="structisis__dynhn.html">isis_dynhn</a> *dyn;
<a name="l00210"></a>00210   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00211"></a>00211   <span class="keyword">struct </span>in_addr *ipv4_addr;
<a name="l00212"></a>00212 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>  <span class="keyword">struct </span>in6_addr *ipv6_addr;
<a name="l00214"></a>00214   u_char ip6[<a class="code" href="prefix_8h.html#af776b22a727aae7c9f4d869d50df47e8">INET6_ADDRSTRLEN</a>];
<a name="l00215"></a>00215 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   <span class="keywordflow">if</span> (!adj)
<a name="l00218"></a>00218     <span class="keywordflow">return</span>;
<a name="l00219"></a>00219   dyn = <a class="code" href="isis__dynhn_8c.html#af341024c92c783b9493cc98f7f04ec28">dynhn_find_by_id</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>);
<a name="l00220"></a>00220   <span class="keywordflow">if</span> (dyn)
<a name="l00221"></a>00221     <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s&quot;</span>, dyn-&gt;<a class="code" href="structisis__dynhn.html#a96fbe0fb7c4de340a9ed9f191859ac34">name</a>.<a class="code" href="structhostname.html#a0a14b55c4a1b6d672adfaa81b95936f3">name</a>);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;SystemId %20s SNPA %s, level %d\nHolding Time %d&quot;</span>,
<a name="l00224"></a>00224           adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a> ? <a class="code" href="isis__misc_8c.html#aabccf63144f92eecd0eb77f24ee98529">sysid_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>) : <span class="stringliteral">&quot;unknown&quot;</span>,
<a name="l00225"></a>00225           <a class="code" href="isis__misc_8c.html#a9ff6d4a3900eef27814548c4c5357090">snpa_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>), adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>, adj-&gt;<a class="code" href="structisis__adjacency.html#a656446a9be5f9ebf466ffacc8741a909">hold_time</a>);
<a name="l00226"></a>00226   <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a> &amp;&amp; <a class="code" href="linklist_8h.html#a0429e6385b31a314cc64432a906201e5">listcount</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>) &gt; 0)
<a name="l00227"></a>00227     {
<a name="l00228"></a>00228       <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;IPv4 Addresses:&quot;</span>);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>, node, ipv4_addr))
<a name="l00231"></a>00231         <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s&quot;</span>, inet_ntoa (*ipv4_addr));
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (adj-&gt;ipv6_addrs &amp;&amp; <a class="code" href="linklist_8h.html#a0429e6385b31a314cc64432a906201e5">listcount</a> (adj-&gt;ipv6_addrs) &gt; 0)
<a name="l00236"></a>00236     {
<a name="l00237"></a>00237       <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;IPv6 Addresses:&quot;</span>);
<a name="l00238"></a>00238       <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adj-&gt;ipv6_addrs, node, ipv6_addr))
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240       <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, ipv6_addr, (<span class="keywordtype">char</span> *)ip6, <a class="code" href="prefix_8h.html#af776b22a727aae7c9f4d869d50df47e8">INET6_ADDRSTRLEN</a>);
<a name="l00241"></a>00241       <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;%s&quot;</span>, ip6);
<a name="l00242"></a>00242     }
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00245"></a>00245   <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;Speaks: %s&quot;</span>, <a class="code" href="isis__misc_8c.html#a184a29bb871c5cb8615a5b96d4f19935">nlpid2string</a> (&amp;adj-&gt;<a class="code" href="structisis__adjacency.html#a1c8f17ff6b70d8c457e8d2860909312c">nlpids</a>));
<a name="l00246"></a>00246 
<a name="l00247"></a>00247   <span class="keywordflow">return</span>;
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="keywordtype">int</span>
<a name="l00251"></a><a class="code" href="isis__adjacency_8h.html#a089c767d62df53d044fc7ba923219879">00251</a> <a class="code" href="isis__adjacency_8c.html#a089c767d62df53d044fc7ba923219879">isis_adj_expire</a> (<span class="keyword">struct</span> <a class="code" href="structthread.html">thread</a> *<a class="code" href="structthread.html">thread</a>)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00254"></a>00254   <span class="keywordtype">int</span> <a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   <span class="comment">/*</span>
<a name="l00257"></a>00257 <span class="comment">   * Get the adjacency</span>
<a name="l00258"></a>00258 <span class="comment">   */</span>
<a name="l00259"></a>00259   adj = <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
<a name="l00260"></a>00260   <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (adj);
<a name="l00261"></a>00261   level = adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>;
<a name="l00262"></a>00262   adj-&gt;<a class="code" href="structisis__adjacency.html#a16900c0c5677510df0a115d145d5ce87">t_expire</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   <span class="comment">/* trigger the adj expire event */</span>
<a name="l00265"></a>00265   <a class="code" href="isis__adjacency_8c.html#a0f8f010e5bafa4fe5497e600c1ac12dd">isis_adj_state_change</a> (adj, <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a74fdb396aae235e00736312b60c5d347">ISIS_ADJ_DOWN</a>, <span class="stringliteral">&quot;holding time expired&quot;</span>);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   <span class="keywordflow">return</span> 0;
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00271"></a><a class="code" href="isis__adjacency_8c.html#ac281d2d3d2d0b24e4324e07ec9677283">00271</a> <a class="code" href="isis__adjacency_8c.html#ac281d2d3d2d0b24e4324e07ec9677283">adj_state2string</a> (<span class="keywordtype">int</span> state)
<a name="l00272"></a>00272 {
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="keywordflow">switch</span> (state)
<a name="l00275"></a>00275     {
<a name="l00276"></a>00276     <span class="keywordflow">case</span> <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1973db8c983074b9c3e0cc74c23eab47">ISIS_ADJ_INITIALIZING</a>:
<a name="l00277"></a>00277       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Initializing&quot;</span>;
<a name="l00278"></a>00278     <span class="keywordflow">case</span> <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1762b381ed451feffee948c5f5d0ed86">ISIS_ADJ_UP</a>:
<a name="l00279"></a>00279       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Up&quot;</span>;
<a name="l00280"></a>00280     <span class="keywordflow">case</span> <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a74fdb396aae235e00736312b60c5d347">ISIS_ADJ_DOWN</a>:
<a name="l00281"></a>00281       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Down&quot;</span>;
<a name="l00282"></a>00282     <span class="keywordflow">default</span>:
<a name="l00283"></a>00283       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Unknown&quot;</span>;
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286   <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;          <span class="comment">/* not reached */</span>
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">/*</span>
<a name="l00290"></a>00290 <span class="comment"> * show clns/isis neighbor (detail)</span>
<a name="l00291"></a>00291 <span class="comment"> */</span>
<a name="l00292"></a>00292 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00293"></a><a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">00293</a> <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>, <span class="keywordtype">char</span> detail)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00297"></a>00297 <span class="preprocessor"></span>  <span class="keyword">struct </span>in6_addr *ipv6_addr;
<a name="l00298"></a>00298   u_char ip6[<a class="code" href="prefix_8h.html#af776b22a727aae7c9f4d869d50df47e8">INET6_ADDRSTRLEN</a>];
<a name="l00299"></a>00299 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00300"></a>00300   <span class="keyword">struct </span>in_addr *ip_addr;
<a name="l00301"></a>00301   time_t now;
<a name="l00302"></a>00302   <span class="keyword">struct </span><a class="code" href="structisis__dynhn.html">isis_dynhn</a> *dyn;
<a name="l00303"></a>00303   <span class="keywordtype">int</span> <a class="code" href="structisis__dynhn.html#ad9d89075da88bad5910b9f8d9d3a7a26">level</a>;
<a name="l00304"></a>00304   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   dyn = <a class="code" href="isis__dynhn_8c.html#af341024c92c783b9493cc98f7f04ec28">dynhn_find_by_id</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>);
<a name="l00307"></a>00307   <span class="keywordflow">if</span> (dyn)
<a name="l00308"></a>00308     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;  %-20s&quot;</span>, dyn-&gt;<a class="code" href="structisis__dynhn.html#a96fbe0fb7c4de340a9ed9f191859ac34">name</a>.<a class="code" href="structhostname.html#a0a14b55c4a1b6d672adfaa81b95936f3">name</a>);
<a name="l00309"></a>00309   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>)
<a name="l00310"></a>00310     {
<a name="l00311"></a>00311       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;  %-20s&quot;</span>, <a class="code" href="isis__misc_8c.html#aabccf63144f92eecd0eb77f24ee98529">sysid_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7b23942ae5652d5cf59b263f131c2038">sysid</a>));
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313   <span class="keywordflow">else</span>
<a name="l00314"></a>00314     {
<a name="l00315"></a>00315       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;  unknown &quot;</span>);
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (detail == <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea9b67ed2ae41434b0cc2a75d7be8b9576">ISIS_UI_LEVEL_BRIEF</a>)
<a name="l00319"></a>00319     {
<a name="l00320"></a>00320       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>)
<a name="l00321"></a>00321     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%-12s&quot;</span>, adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>-&gt;<a class="code" href="structisis__circuit.html#ab03cac6463284a4ce8c1eb19e49f3b6d">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);
<a name="l00322"></a>00322       <span class="keywordflow">else</span>
<a name="l00323"></a>00323     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;NULL circuit!&quot;</span>);
<a name="l00324"></a>00324       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%-3u&quot;</span>, adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>);    <span class="comment">/* level */</span>
<a name="l00325"></a>00325       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%-13s&quot;</span>, <a class="code" href="isis__adjacency_8c.html#ac281d2d3d2d0b24e4324e07ec9677283">adj_state2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a>));
<a name="l00326"></a>00326       now = time (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00327"></a>00327       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#afd570f7072dac8465cf207cd6df6c567">last_upd</a>)
<a name="l00328"></a>00328     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%-9lu&quot;</span>, adj-&gt;<a class="code" href="structisis__adjacency.html#afd570f7072dac8465cf207cd6df6c567">last_upd</a> + adj-&gt;<a class="code" href="structisis__adjacency.html#a656446a9be5f9ebf466ffacc8741a909">hold_time</a> - now);
<a name="l00329"></a>00329       <span class="keywordflow">else</span>
<a name="l00330"></a>00330     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;-        &quot;</span>);
<a name="l00331"></a>00331       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%-10s&quot;</span>, <a class="code" href="isis__misc_8c.html#a9ff6d4a3900eef27814548c4c5357090">snpa_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>));
<a name="l00332"></a>00332       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00333"></a>00333     }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="keywordflow">if</span> (detail == <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea92418876d4e4e759a009d13598364ae4">ISIS_UI_LEVEL_DETAIL</a>)
<a name="l00336"></a>00336     {
<a name="l00337"></a>00337       level = adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>;
<a name="l00338"></a>00338       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>)
<a name="l00339"></a>00339     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s    Interface: %s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>, adj-&gt;<a class="code" href="structisis__adjacency.html#a29d8beb7bedcecb2c6c2f7112ba5d072">circuit</a>-&gt;<a class="code" href="structisis__circuit.html#ab03cac6463284a4ce8c1eb19e49f3b6d">interface</a>-&gt;<a class="code" href="structinterface.html#a98cadce768ec5aacb4c5fc4ca2c3eaa8">name</a>);   <span class="comment">/* interface name */</span>
<a name="l00340"></a>00340       <span class="keywordflow">else</span>
<a name="l00341"></a>00341     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;NULL circuit!%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00342"></a>00342       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, Level: %u&quot;</span>, adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a>); <span class="comment">/* level */</span>
<a name="l00343"></a>00343       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, State: %s&quot;</span>, <a class="code" href="isis__adjacency_8c.html#ac281d2d3d2d0b24e4324e07ec9677283">adj_state2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a>));
<a name="l00344"></a>00344       now = time (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00345"></a>00345       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#afd570f7072dac8465cf207cd6df6c567">last_upd</a>)
<a name="l00346"></a>00346     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, Expires in %s&quot;</span>,
<a name="l00347"></a>00347          <a class="code" href="isis__misc_8c.html#a047be8e0e80cc74d57f64ab42e0f6510">time2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afd570f7072dac8465cf207cd6df6c567">last_upd</a> + adj-&gt;<a class="code" href="structisis__adjacency.html#a656446a9be5f9ebf466ffacc8741a909">hold_time</a> - now));
<a name="l00348"></a>00348       <span class="keywordflow">else</span>
<a name="l00349"></a>00349     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, Expires in %s&quot;</span>, <a class="code" href="isis__misc_8c.html#a047be8e0e80cc74d57f64ab42e0f6510">time2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a656446a9be5f9ebf466ffacc8741a909">hold_time</a>));
<a name="l00350"></a>00350       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s    Adjacency flaps: %u&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>, adj-&gt;<a class="code" href="structisis__adjacency.html#a2c4f0b0554631ca94fcc68da72656478">flaps</a>);
<a name="l00351"></a>00351       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, Last: %s ago&quot;</span>, <a class="code" href="isis__misc_8c.html#a047be8e0e80cc74d57f64ab42e0f6510">time2string</a> (now - adj-&gt;<a class="code" href="structisis__adjacency.html#ab62b50ca75a0cd91df327b1b6a3e72b4">last_flap</a>));
<a name="l00352"></a>00352       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s    Circuit type: %s&quot;</span>,
<a name="l00353"></a>00353            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>, <a class="code" href="isis__misc_8c.html#a35b15c65a44088982fa8daca9fc7b022">circuit_t2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a94749cb53088c1898166a701f2a3931f">circuit_t</a>));
<a name="l00354"></a>00354       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, Speaks: %s&quot;</span>, <a class="code" href="isis__misc_8c.html#a184a29bb871c5cb8615a5b96d4f19935">nlpid2string</a> (&amp;adj-&gt;<a class="code" href="structisis__adjacency.html#a1c8f17ff6b70d8c457e8d2860909312c">nlpids</a>));
<a name="l00355"></a>00355       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s    SNPA: %s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>, <a class="code" href="isis__misc_8c.html#a9ff6d4a3900eef27814548c4c5357090">snpa_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>));
<a name="l00356"></a>00356       dyn = <a class="code" href="isis__dynhn_8c.html#af341024c92c783b9493cc98f7f04ec28">dynhn_find_by_id</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7d3a80980b6870f382dc48f91035bd6b">lanid</a>);
<a name="l00357"></a>00357       <span class="keywordflow">if</span> (dyn)
<a name="l00358"></a>00358     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, LAN id: %s.%02x&quot;</span>,
<a name="l00359"></a>00359          dyn-&gt;<a class="code" href="structisis__dynhn.html#a96fbe0fb7c4de340a9ed9f191859ac34">name</a>.<a class="code" href="structhostname.html#a0a14b55c4a1b6d672adfaa81b95936f3">name</a>, adj-&gt;<a class="code" href="structisis__adjacency.html#a7d3a80980b6870f382dc48f91035bd6b">lanid</a>[<a class="code" href="isis__constants_8h.html#aeda8abfdcc24dfb0ab327ea79ce453fc">ISIS_SYS_ID_LEN</a>]);
<a name="l00360"></a>00360       <span class="keywordflow">else</span>
<a name="l00361"></a>00361     <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, LAN id: %s.%02x&quot;</span>,
<a name="l00362"></a>00362          <a class="code" href="isis__misc_8c.html#aabccf63144f92eecd0eb77f24ee98529">sysid_print</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a7d3a80980b6870f382dc48f91035bd6b">lanid</a>), adj-&gt;<a class="code" href="structisis__adjacency.html#a7d3a80980b6870f382dc48f91035bd6b">lanid</a>[<a class="code" href="isis__constants_8h.html#aeda8abfdcc24dfb0ab327ea79ce453fc">ISIS_SYS_ID_LEN</a>]);
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s    Priority: %u&quot;</span>,
<a name="l00365"></a>00365            <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>, adj-&gt;<a class="code" href="structisis__adjacency.html#a4eca92e54cf0d683720479515d044d1c">prio</a>[adj-&gt;<a class="code" href="structisis__adjacency.html#abee45e3e4c2c3f246db1c8aa19186cc8">level</a> - 1]);
<a name="l00366"></a>00366 
<a name="l00367"></a>00367       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;, %s, DIS flaps: %u, Last: %s ago%s&quot;</span>,
<a name="l00368"></a>00368            <a class="code" href="isis__dr_8c.html#a51910550260e5b283dae222e0594a388">isis_disflag2string</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#a76bf3ed808e66f1047d7a2a698683db2">dis_record</a>[<a class="code" href="isis__constants_8h.html#a75b03ae2a0d626c94fe847f7d790f4af">ISIS_LEVELS</a> + level - 1].
<a name="l00369"></a>00369                     dis), adj-&gt;<a class="code" href="structisis__adjacency.html#ac4f9613019f220d78cafe905dfed9174">dischanges</a>[level - 1],
<a name="l00370"></a>00370            <a class="code" href="isis__misc_8c.html#a047be8e0e80cc74d57f64ab42e0f6510">time2string</a> (now -
<a name="l00371"></a>00371                 (adj-&gt;<a class="code" href="structisis__adjacency.html#a76bf3ed808e66f1047d7a2a698683db2">dis_record</a>[<a class="code" href="isis__constants_8h.html#a75b03ae2a0d626c94fe847f7d790f4af">ISIS_LEVELS</a> + level - 1].
<a name="l00372"></a>00372                  last_dis_change)), <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a> &amp;&amp; <a class="code" href="linklist_8h.html#a0429e6385b31a314cc64432a906201e5">listcount</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>) &gt; 0)
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;    IPv4 Addresses:%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00377"></a>00377       <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adj-&gt;<a class="code" href="structisis__adjacency.html#ad4c07af99270cae2fdc9f48120cbebcb">ipv4_addrs</a>, node, ip_addr))
<a name="l00378"></a>00378             <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;      %s%s&quot;</span>, inet_ntoa (*ip_addr), <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380 <span class="preprocessor">#ifdef HAVE_IPV6</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (adj-&gt;ipv6_addrs &amp;&amp; <a class="code" href="linklist_8h.html#a0429e6385b31a314cc64432a906201e5">listcount</a> (adj-&gt;ipv6_addrs) &gt; 0)
<a name="l00382"></a>00382     {
<a name="l00383"></a>00383       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;    IPv6 Addresses:%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00384"></a>00384       <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adj-&gt;ipv6_addrs, node, ipv6_addr))
<a name="l00385"></a>00385         {
<a name="l00386"></a>00386           <a class="code" href="sockunion_8c.html#a5bfb767e8fa3f9ff5d2a1e19d71791f4">inet_ntop</a> (AF_INET6, ipv6_addr, (<span class="keywordtype">char</span> *)ip6, <a class="code" href="prefix_8h.html#af776b22a727aae7c9f4d869d50df47e8">INET6_ADDRSTRLEN</a>);
<a name="l00387"></a>00387           <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;      %s%s&quot;</span>, ip6, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IPV6 */</span>
<a name="l00391"></a>00391       <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393   <span class="keywordflow">return</span>;
<a name="l00394"></a>00394 }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="keywordtype">void</span>
<a name="l00397"></a><a class="code" href="isis__adjacency_8h.html#aa77f015c2f5319a88d8c0b9cd3763fa8">00397</a> <a class="code" href="isis__adjacency_8c.html#aa77f015c2f5319a88d8c0b9cd3763fa8">isis_adj_print_vty</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00398"></a>00398 {
<a name="l00399"></a>00399   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea9b67ed2ae41434b0cc2a75d7be8b9576">ISIS_UI_LEVEL_BRIEF</a>);
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="keywordtype">void</span>
<a name="l00403"></a><a class="code" href="isis__adjacency_8h.html#a54d11ba590d429f09c86c8fd0d3569eb">00403</a> <a class="code" href="isis__adjacency_8c.html#a54d11ba590d429f09c86c8fd0d3569eb">isis_adj_print_vty_detail</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00404"></a>00404 {
<a name="l00405"></a>00405   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea92418876d4e4e759a009d13598364ae4">ISIS_UI_LEVEL_DETAIL</a>);
<a name="l00406"></a>00406 }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="keywordtype">void</span>
<a name="l00409"></a><a class="code" href="isis__adjacency_8h.html#a88bb07ffe2d992d72cdce38e36b76402">00409</a> <a class="code" href="isis__adjacency_8c.html#a88bb07ffe2d992d72cdce38e36b76402">isis_adj_print_vty_extensive</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00410"></a>00410 {
<a name="l00411"></a>00411   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea50265521252da3537aeaadd0ad03505f">ISIS_UI_LEVEL_EXTENSIVE</a>);
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="keywordtype">void</span>
<a name="l00415"></a><a class="code" href="isis__adjacency_8h.html#a8d6d729c62dc796e97509818fb907ef9">00415</a> <a class="code" href="isis__adjacency_8c.html#a8d6d729c62dc796e97509818fb907ef9">isis_adj_p2p_print_vty</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea9b67ed2ae41434b0cc2a75d7be8b9576">ISIS_UI_LEVEL_BRIEF</a>);
<a name="l00418"></a>00418 }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="keywordtype">void</span>
<a name="l00421"></a><a class="code" href="isis__adjacency_8h.html#a7228ea1d460f864a07bc51a1e662a432">00421</a> <a class="code" href="isis__adjacency_8c.html#a7228ea1d460f864a07bc51a1e662a432">isis_adj_p2p_print_vty_detail</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00422"></a>00422 {
<a name="l00423"></a>00423   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea92418876d4e4e759a009d13598364ae4">ISIS_UI_LEVEL_DETAIL</a>);
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="keywordtype">void</span>
<a name="l00427"></a><a class="code" href="isis__adjacency_8h.html#aff72631b276fe4d956d23796ef3697fd">00427</a> <a class="code" href="isis__adjacency_8c.html#aff72631b276fe4d956d23796ef3697fd">isis_adj_p2p_print_vty_extensive</a> (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj, <span class="keyword">struct</span> <a class="code" href="structvty.html">vty</a> *<a class="code" href="structvty.html">vty</a>)
<a name="l00428"></a>00428 {
<a name="l00429"></a>00429   <a class="code" href="isis__adjacency_8c.html#a051d4235d20c98964aee171eaec6e9bd">isis_adj_print_vty2</a> (adj, vty, <a class="code" href="isis__misc_8h.html#aaf105ae5beaca1dee30ae54530691fcea50265521252da3537aeaadd0ad03505f">ISIS_UI_LEVEL_EXTENSIVE</a>);
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="keywordtype">void</span>
<a name="l00433"></a><a class="code" href="isis__adjacency_8h.html#a86acf14606b75dad2a7b68940f122a4d">00433</a> <a class="code" href="isis__adjacency_8c.html#a86acf14606b75dad2a7b68940f122a4d">isis_adjdb_iterate</a> (<span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb, <span class="keywordtype">void</span> (*<a class="code" href="bgp__fsm_8c.html#aad6d5d0fbfe60193366eaab88413f7af">func</a>) (<span class="keyword">struct</span> <a class="code" href="structisis__adjacency.html">isis_adjacency</a> *,
<a name="l00434"></a>00434                               <span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *arg)
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node, *nnode;
<a name="l00437"></a>00437   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439   <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a71512a873b8f0e2b4c84d3c949a9bbaf">ALL_LIST_ELEMENTS</a> (adjdb, node, nnode, adj))
<a name="l00440"></a>00440     (*func) (adj, arg);
<a name="l00441"></a>00441 }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="keywordtype">void</span>
<a name="l00444"></a><a class="code" href="isis__adjacency_8h.html#aa6290067148c07fb10f67b9e4237585f">00444</a> <a class="code" href="isis__adjacency_8c.html#aa6290067148c07fb10f67b9e4237585f">isis_adj_build_neigh_list</a> (<span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb, <span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *<a class="code" href="structlist.html">list</a>)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00447"></a>00447   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   <span class="keywordflow">if</span> (!list)
<a name="l00450"></a>00450     {
<a name="l00451"></a>00451       <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;isis_adj_build_neigh_list(): NULL list&quot;</span>);
<a name="l00452"></a>00452       <span class="keywordflow">return</span>;
<a name="l00453"></a>00453     }
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adjdb, node, adj))
<a name="l00456"></a>00456     {
<a name="l00457"></a>00457       <span class="keywordflow">if</span> (!adj)
<a name="l00458"></a>00458     {
<a name="l00459"></a>00459       <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;isis_adj_build_neigh_list(): NULL adj&quot;</span>);
<a name="l00460"></a>00460       <span class="keywordflow">return</span>;
<a name="l00461"></a>00461     }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463       <span class="keywordflow">if</span> ((adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a> == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1762b381ed451feffee948c5f5d0ed86">ISIS_ADJ_UP</a> ||
<a name="l00464"></a>00464        adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a> == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1973db8c983074b9c3e0cc74c23eab47">ISIS_ADJ_INITIALIZING</a>))
<a name="l00465"></a>00465     <a class="code" href="linklist_8c.html#adb2a0478aba995441aaf691d1f6fe5db">listnode_add</a> (list, adj-&gt;<a class="code" href="structisis__adjacency.html#afe4ac3bbff30ac7c5a0da09b05bf9ac0">snpa</a>);
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467   <span class="keywordflow">return</span>;
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="keywordtype">void</span>
<a name="l00471"></a><a class="code" href="isis__adjacency_8h.html#abcdb7608e2eb77b6e5f5bcc273c7c265">00471</a> <a class="code" href="isis__adjacency_8c.html#abcdb7608e2eb77b6e5f5bcc273c7c265">isis_adj_build_up_list</a> (<span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *adjdb, <span class="keyword">struct</span> <a class="code" href="structlist.html">list</a> *<a class="code" href="structlist.html">list</a>)
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473   <span class="keyword">struct </span><a class="code" href="structisis__adjacency.html">isis_adjacency</a> *adj;
<a name="l00474"></a>00474   <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (!list)
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478       <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;isis_adj_build_up_list(): NULL list&quot;</span>);
<a name="l00479"></a>00479       <span class="keywordflow">return</span>;
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a80a3f4035be83abbb709d17412993226">ALL_LIST_ELEMENTS_RO</a> (adjdb, node, adj))
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484       <span class="keywordflow">if</span> (!adj)
<a name="l00485"></a>00485     {
<a name="l00486"></a>00486       <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;isis_adj_build_up_list(): NULL adj&quot;</span>);
<a name="l00487"></a>00487       <span class="keywordflow">return</span>;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490       <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="structisis__adjacency.html#ade48f111121efb755bd2ea13a06a16ae">adj_state</a> == <a class="code" href="isis__adjacency_8h.html#ad407b8d5b86106c7891c353d06af5576a1762b381ed451feffee948c5f5d0ed86">ISIS_ADJ_UP</a>)
<a name="l00491"></a>00491     <a class="code" href="linklist_8c.html#adb2a0478aba995441aaf691d1f6fe5db">listnode_add</a> (list, adj);
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <span class="keywordflow">return</span>;
<a name="l00495"></a>00495 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="isis__adjacency_8c.html">isis_adjacency.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:04 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
