<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: lib/privs.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('privs_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lib/privs.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="privs_8h__dep__incl.png" border="0" usemap="#lib_2privs_8hdep" alt=""/></div>
<map name="lib_2privs_8hdep" id="lib_2privs_8hdep">
<area shape="rect" id="node3" href="bgp__main_8c.html" title="bgpd/bgp_main.c" alt="" coords="5,80,131,107"/><area shape="rect" id="node5" href="bgp__network_8c.html" title="bgpd/bgp_network.c" alt="" coords="155,80,303,107"/><area shape="rect" id="node7" href="isis__bpf_8c.html" title="isisd/isis_bpf.c" alt="" coords="327,80,437,107"/><area shape="rect" id="node9" href="isis__dlpi_8c.html" title="isisd/isis_dlpi.c" alt="" coords="462,80,575,107"/><area shape="rect" id="node11" href="isis__main_8c.html" title="isisd/isis_main.c" alt="" coords="599,80,717,107"/><area shape="rect" id="node13" href="isis__pfpacket_8c.html" title="isisd/isis_pfpacket.c" alt="" coords="743,80,887,107"/><area shape="rect" id="node15" href="privs_8c.html" title="lib/privs.c" alt="" coords="911,80,989,107"/><area shape="rect" id="node17" href="vty_8c.html" title="lib/vty.c" alt="" coords="1015,80,1084,107"/><area shape="rect" id="node19" href="ospf6__main_8c.html" title="ospf6d/ospf6_main.c" alt="" coords="1108,80,1255,107"/><area shape="rect" id="node21" href="ospf6__network_8c.html" title="ospf6d/ospf6_network.c" alt="" coords="1279,80,1447,107"/><area shape="rect" id="node23" href="ospfclient_8c.html" title="ospfclient/ospfclient.c" alt="" coords="1471,80,1627,107"/><area shape="rect" id="node25" href="ospf__main_8c.html" title="ospfd/ospf_main.c" alt="" coords="1652,80,1785,107"/><area shape="rect" id="node27" href="ospf__network_8c.html" title="ospfd/ospf_network.c" alt="" coords="1809,80,1964,107"/><area shape="rect" id="node29" href="ospfn_8c.html" title="OSPFN program designed for dynamic FIB manipulation for CCND." alt="" coords="1988,80,2092,107"/><area shape="rect" id="node31" href="ospfn__opaque__lsa_8c.html" title="Handle opaque lsa&#39;s functionality." alt="" coords="2116,80,2297,107"/><area shape="rect" id="node33" href="rip__interface_8c.html" title="ripd/rip_interface.c" alt="" coords="2322,80,2456,107"/><area shape="rect" id="node35" href="rip__main_8c.html" title="ripd/rip_main.c" alt="" coords="2481,80,2591,107"/><area shape="rect" id="node37" href="ripd_8c.html" title="ripd/ripd.c" alt="" coords="2615,80,2697,107"/><area shape="rect" id="node39" href="ripng__interface_8c.html" title="ripngd/ripng_interface.c" alt="" coords="2722,80,2885,107"/><area shape="rect" id="node41" href="ripng__main_8c.html" title="ripngd/ripng_main.c" alt="" coords="2911,80,3049,107"/><area shape="rect" id="node43" href="ripngd_8c.html" title="ripngd/ripngd.c" alt="" coords="3073,80,3185,107"/><area shape="rect" id="node45" href="aspath__test_8c.html" title="tests/aspath_test.c" alt="" coords="3209,80,3351,107"/><area shape="rect" id="node47" href="bgp__capability__test_8c.html" title="tests/bgp_capability_test.c" alt="" coords="3375,80,3564,107"/><area shape="rect" id="node49" href="bgp__mp__attr__test_8c.html" title="tests/bgp_mp_attr_test.c" alt="" coords="3588,80,3767,107"/><area shape="rect" id="node51" href="ecommunity__test_8c.html" title="tests/ecommunity_test.c" alt="" coords="3791,80,3965,107"/><area shape="rect" id="node53" href="test-privs_8c.html" title="tests/test&#45;privs.c" alt="" coords="3990,80,4116,107"/><area shape="rect" id="node55" href="if__ioctl__solaris_8c.html" title="zebra/if_ioctl_solaris.c" alt="" coords="4141,80,4296,107"/><area shape="rect" id="node57" href="ioctl_8c.html" title="zebra/ioctl.c" alt="" coords="4321,80,4415,107"/><area shape="rect" id="node59" href="ioctl__solaris_8c.html" title="zebra/ioctl_solaris.c" alt="" coords="4440,80,4581,107"/><area shape="rect" id="node61" href="ipforward__proc_8c.html" title="zebra/ipforward_proc.c" alt="" coords="4605,80,4765,107"/><area shape="rect" id="node63" href="ipforward__solaris_8c.html" title="zebra/ipforward_solaris.c" alt="" coords="4790,80,4961,107"/><area shape="rect" id="node65" href="ipforward__sysctl_8c.html" title="zebra/ipforward_sysctl.c" alt="" coords="4986,80,5155,107"/><area shape="rect" id="node67" href="kernel__socket_8c.html" title="zebra/kernel_socket.c" alt="" coords="5179,80,5332,107"/><area shape="rect" id="node69" href="zebra_2main_8c.html" title="zebra/main.c" alt="" coords="5357,80,5453,107"/><area shape="rect" id="node71" href="rt__netlink_8c.html" title="zebra/rt_netlink.c" alt="" coords="5478,80,5601,107"/><area shape="rect" id="node73" href="rt__socket_8c.html" title="zebra/rt_socket.c" alt="" coords="5626,80,5752,107"/><area shape="rect" id="node75" href="rtadv_8c.html" title="zebra/rtadv.c" alt="" coords="5777,80,5876,107"/><area shape="rect" id="node77" href="test__main_8c.html" title="zebra/test_main.c" alt="" coords="5901,80,6029,107"/><area shape="rect" id="node79" href="zserv_8c.html" title="zebra/zserv.c" alt="" coords="6055,80,6156,107"/></map>
</div>
</div>
<p><a href="privs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structzebra__privs__t.html">zebra_privs_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structzprivs__ids__t.html">zprivs_ids_t</a></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058">zebra_capabilities_t</a> { <br/>
&#160;&#160;<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058aa1347f0ba2573754799a8f4eb75b24d9">ZCAP_SETID</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a883e29f00ac9b73d278bfe8d7cdb1ac9">ZCAP_BIND</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab19204d6d995015c1a3383016bfb4b22">ZCAP_NET_ADMIN</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a45151564ee61e29f11ae0d643ce6a0e8">ZCAP_SYS_ADMIN</a>, 
<br/>
&#160;&#160;<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a6cbad9f21b16adad616a294ed5bfc9f9">ZCAP_NET_RAW</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab9885c74ae3b1a4972066a3ca38c34b9">ZCAP_CHROOT</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058aae48f79ef8f59174e2c4fd116c70c0ee">ZCAP_NICE</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a6da50a6e68f1a30a6d88d4c240f4431f">ZCAP_PTRACE</a>, 
<br/>
&#160;&#160;<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a378b69cf384e99df36ab1bad5b901588">ZCAP_DAC_OVERRIDE</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a601485baf76b65a14ec1681b8b0d7dbf">ZCAP_READ_SEARCH</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a427b9301ba92f39c22571b14aaf537ce">ZCAP_FOWNER</a>, 
<a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab5bf3e5741cc69f1a53aa2cf993fe60a">ZCAP_MAX</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177">zebra_privs_current_t</a> { <a class="el" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177a6ea35041269b5c56a6a52c52cd67c731">ZPRIVS_LOWERED</a>, 
<a class="el" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177a9cf73835d075c42d714ce2d97e5a49d1">ZPRIVS_RAISED</a>, 
<a class="el" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177ade03322b5e72d0ab21d00778875d2e2e">ZPRIVS_UNKNOWN</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5">zebra_privs_ops_t</a> { <a class="el" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5a5395269196ee9bd07257f8b2b35c25fa">ZPRIVS_RAISE</a>, 
<a class="el" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5a7da2c6956cf712f8adc04ff2b0f072c5">ZPRIVS_LOWER</a>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#ac6082c5377fb94942a842809eb508682">zprivs_init</a> (struct <a class="el" href="structzebra__privs__t.html">zebra_privs_t</a> *zprivs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#a36b09f13a1019a0650f17e7e97d7f11b">zprivs_terminate</a> (struct <a class="el" href="structzebra__privs__t.html">zebra_privs_t</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privs_8h.html#a5dd3ef8ed3477b5b4c9eaf15e9c05d3b">zprivs_get_ids</a> (struct <a class="el" href="structzprivs__ids__t.html">zprivs_ids_t</a> *)</td></tr>
</table>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058"></a><!-- doxytag: member="privs.h::zebra_capabilities_t" ref="acadb26c3fc89554cf67e4bae79e13058" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058">zebra_capabilities_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058aa1347f0ba2573754799a8f4eb75b24d9"></a><!-- doxytag: member="ZCAP_SETID" ref="acadb26c3fc89554cf67e4bae79e13058aa1347f0ba2573754799a8f4eb75b24d9" args="" -->ZCAP_SETID</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a883e29f00ac9b73d278bfe8d7cdb1ac9"></a><!-- doxytag: member="ZCAP_BIND" ref="acadb26c3fc89554cf67e4bae79e13058a883e29f00ac9b73d278bfe8d7cdb1ac9" args="" -->ZCAP_BIND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058ab19204d6d995015c1a3383016bfb4b22"></a><!-- doxytag: member="ZCAP_NET_ADMIN" ref="acadb26c3fc89554cf67e4bae79e13058ab19204d6d995015c1a3383016bfb4b22" args="" -->ZCAP_NET_ADMIN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a45151564ee61e29f11ae0d643ce6a0e8"></a><!-- doxytag: member="ZCAP_SYS_ADMIN" ref="acadb26c3fc89554cf67e4bae79e13058a45151564ee61e29f11ae0d643ce6a0e8" args="" -->ZCAP_SYS_ADMIN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a6cbad9f21b16adad616a294ed5bfc9f9"></a><!-- doxytag: member="ZCAP_NET_RAW" ref="acadb26c3fc89554cf67e4bae79e13058a6cbad9f21b16adad616a294ed5bfc9f9" args="" -->ZCAP_NET_RAW</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058ab9885c74ae3b1a4972066a3ca38c34b9"></a><!-- doxytag: member="ZCAP_CHROOT" ref="acadb26c3fc89554cf67e4bae79e13058ab9885c74ae3b1a4972066a3ca38c34b9" args="" -->ZCAP_CHROOT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058aae48f79ef8f59174e2c4fd116c70c0ee"></a><!-- doxytag: member="ZCAP_NICE" ref="acadb26c3fc89554cf67e4bae79e13058aae48f79ef8f59174e2c4fd116c70c0ee" args="" -->ZCAP_NICE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a6da50a6e68f1a30a6d88d4c240f4431f"></a><!-- doxytag: member="ZCAP_PTRACE" ref="acadb26c3fc89554cf67e4bae79e13058a6da50a6e68f1a30a6d88d4c240f4431f" args="" -->ZCAP_PTRACE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a378b69cf384e99df36ab1bad5b901588"></a><!-- doxytag: member="ZCAP_DAC_OVERRIDE" ref="acadb26c3fc89554cf67e4bae79e13058a378b69cf384e99df36ab1bad5b901588" args="" -->ZCAP_DAC_OVERRIDE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a601485baf76b65a14ec1681b8b0d7dbf"></a><!-- doxytag: member="ZCAP_READ_SEARCH" ref="acadb26c3fc89554cf67e4bae79e13058a601485baf76b65a14ec1681b8b0d7dbf" args="" -->ZCAP_READ_SEARCH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058a427b9301ba92f39c22571b14aaf537ce"></a><!-- doxytag: member="ZCAP_FOWNER" ref="acadb26c3fc89554cf67e4bae79e13058a427b9301ba92f39c22571b14aaf537ce" args="" -->ZCAP_FOWNER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acadb26c3fc89554cf67e4bae79e13058ab5bf3e5741cc69f1a53aa2cf993fe60a"></a><!-- doxytag: member="ZCAP_MAX" ref="acadb26c3fc89554cf67e4bae79e13058ab5bf3e5741cc69f1a53aa2cf993fe60a" args="" -->ZCAP_MAX</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="privs_8h_source.html#l00028">28</a> of file <a class="el" href="privs_8h_source.html">privs.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058aa1347f0ba2573754799a8f4eb75b24d9">ZCAP_SETID</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a883e29f00ac9b73d278bfe8d7cdb1ac9">ZCAP_BIND</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab19204d6d995015c1a3383016bfb4b22">ZCAP_NET_ADMIN</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a45151564ee61e29f11ae0d643ce6a0e8">ZCAP_SYS_ADMIN</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a6cbad9f21b16adad616a294ed5bfc9f9">ZCAP_NET_RAW</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab9885c74ae3b1a4972066a3ca38c34b9">ZCAP_CHROOT</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058aae48f79ef8f59174e2c4fd116c70c0ee">ZCAP_NICE</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a6da50a6e68f1a30a6d88d4c240f4431f">ZCAP_PTRACE</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a378b69cf384e99df36ab1bad5b901588">ZCAP_DAC_OVERRIDE</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a601485baf76b65a14ec1681b8b0d7dbf">ZCAP_READ_SEARCH</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058a427b9301ba92f39c22571b14aaf537ce">ZCAP_FOWNER</a>,
  <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058ab5bf3e5741cc69f1a53aa2cf993fe60a">ZCAP_MAX</a>
} <a class="code" href="privs_8h.html#acadb26c3fc89554cf67e4bae79e13058">zebra_capabilities_t</a>;
</pre></div>
</div>
</div>
<a class="anchor" id="ad679f4706ab2998d9538148c4412b177"></a><!-- doxytag: member="privs.h::zebra_privs_current_t" ref="ad679f4706ab2998d9538148c4412b177" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177">zebra_privs_current_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad679f4706ab2998d9538148c4412b177a6ea35041269b5c56a6a52c52cd67c731"></a><!-- doxytag: member="ZPRIVS_LOWERED" ref="ad679f4706ab2998d9538148c4412b177a6ea35041269b5c56a6a52c52cd67c731" args="" -->ZPRIVS_LOWERED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad679f4706ab2998d9538148c4412b177a9cf73835d075c42d714ce2d97e5a49d1"></a><!-- doxytag: member="ZPRIVS_RAISED" ref="ad679f4706ab2998d9538148c4412b177a9cf73835d075c42d714ce2d97e5a49d1" args="" -->ZPRIVS_RAISED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad679f4706ab2998d9538148c4412b177ade03322b5e72d0ab21d00778875d2e2e"></a><!-- doxytag: member="ZPRIVS_UNKNOWN" ref="ad679f4706ab2998d9538148c4412b177ade03322b5e72d0ab21d00778875d2e2e" args="" -->ZPRIVS_UNKNOWN</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="privs_8h_source.html#l00044">44</a> of file <a class="el" href="privs_8h_source.html">privs.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177a6ea35041269b5c56a6a52c52cd67c731">ZPRIVS_LOWERED</a>,
  <a class="code" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177a9cf73835d075c42d714ce2d97e5a49d1">ZPRIVS_RAISED</a>,
  <a class="code" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177ade03322b5e72d0ab21d00778875d2e2e">ZPRIVS_UNKNOWN</a>,
} <a class="code" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177">zebra_privs_current_t</a>;
</pre></div>
</div>
</div>
<a class="anchor" id="aae029fe88e2d02bee4d46a2f458bd3e5"></a><!-- doxytag: member="privs.h::zebra_privs_ops_t" ref="aae029fe88e2d02bee4d46a2f458bd3e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5">zebra_privs_ops_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aae029fe88e2d02bee4d46a2f458bd3e5a5395269196ee9bd07257f8b2b35c25fa"></a><!-- doxytag: member="ZPRIVS_RAISE" ref="aae029fe88e2d02bee4d46a2f458bd3e5a5395269196ee9bd07257f8b2b35c25fa" args="" -->ZPRIVS_RAISE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aae029fe88e2d02bee4d46a2f458bd3e5a7da2c6956cf712f8adc04ff2b0f072c5"></a><!-- doxytag: member="ZPRIVS_LOWER" ref="aae029fe88e2d02bee4d46a2f458bd3e5a7da2c6956cf712f8adc04ff2b0f072c5" args="" -->ZPRIVS_LOWER</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="privs_8h_source.html#l00051">51</a> of file <a class="el" href="privs_8h_source.html">privs.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5a5395269196ee9bd07257f8b2b35c25fa">ZPRIVS_RAISE</a>,
  <a class="code" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5a7da2c6956cf712f8adc04ff2b0f072c5">ZPRIVS_LOWER</a>,
} <a class="code" href="privs_8h.html#aae029fe88e2d02bee4d46a2f458bd3e5">zebra_privs_ops_t</a>;
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a5dd3ef8ed3477b5b4c9eaf15e9c05d3b"></a><!-- doxytag: member="privs.h::zprivs_get_ids" ref="a5dd3ef8ed3477b5b4c9eaf15e9c05d3b" args="(struct zprivs_ids_t *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zprivs_get_ids </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzprivs__ids__t.html">zprivs_ids_t</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="privs_8c_source.html#l00725">725</a> of file <a class="el" href="privs_8c_source.html">privs.c</a>.</p>
<div class="fragment"><pre class="fragment">{

   ids-&gt;uid_priv = getuid();
   (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>) ? (ids-&gt;uid_normal = <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>)
                     : (ids-&gt;uid_normal = -1);
   (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#adae43dc05bbac5b9c53ab3dfa93a4eee">zgid</a>) ? (ids-&gt;gid_normal = <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#adae43dc05bbac5b9c53ab3dfa93a4eee">zgid</a>)
                     : (ids-&gt;gid_normal = -1);
   (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a95c04b6ee093a2024ad19316953d701a">vtygrp</a>) ? (ids-&gt;gid_vty = <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a95c04b6ee093a2024ad19316953d701a">vtygrp</a>)
                       : (ids-&gt;gid_vty = -1);
   
   <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac6082c5377fb94942a842809eb508682"></a><!-- doxytag: member="privs.h::zprivs_init" ref="ac6082c5377fb94942a842809eb508682" args="(struct zebra_privs_t *zprivs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zprivs_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzebra__privs__t.html">zebra_privs_t</a> *&#160;</td>
          <td class="paramname"><em>zprivs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="privs_8c_source.html#l00591">591</a> of file <a class="el" href="privs_8c_source.html">privs.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span>passwd *pwentry = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span>group *grentry = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (!zprivs)
    {
      fprintf (stderr, <span class="stringliteral">&quot;zprivs_init: called with NULL arg!\n&quot;</span>);
      <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
    }

  <span class="comment">/* NULL privs */</span>
  <span class="keywordflow">if</span> (! (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a62e6101b1d966f24692ae650a331fb95">user</a> || zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5b11e63c267759ec4dd64022e6046b80">group</a> 
         || zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a8410e950e551f1fc77b3004fdd7655d4">cap_num_p</a> || zprivs-&gt;<a class="code" href="structzebra__privs__t.html#aad6985760cb42951efae67e30eb2c463">cap_num_i</a>) )
    {
      zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a0c59dbc0ec6187b60a824ec421cc34c1">change</a> = <a class="code" href="privs_8c.html#ae9417e5de027e7ac2b71854645ffd5ab">zprivs_change_null</a>;
      zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a87875be16a946ab35489aec62a76b315">current_state</a> = <a class="code" href="privs_8c.html#a46fae5e02d0b0308954dcb8c356d0e15">zprivs_state_null</a>;
      <span class="keywordflow">return</span>;
    }

  <span class="keywordflow">if</span> (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a62e6101b1d966f24692ae650a331fb95">user</a>)
    {
      <span class="keywordflow">if</span> ( (pwentry = getpwnam (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a62e6101b1d966f24692ae650a331fb95">user</a>)) )
        {
          <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a> = pwentry-&gt;pw_uid;
        }
      <span class="keywordflow">else</span>
        {
          <span class="comment">/* cant use log.h here as it depends on vty */</span>
          fprintf (stderr, <span class="stringliteral">&quot;privs_init: could not lookup user %s\n&quot;</span>,
                   zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a62e6101b1d966f24692ae650a331fb95">user</a>);
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
    }

  grentry = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5d73d1b006f1e22ea2c6faea606fd977">vty_group</a>)
    <span class="comment">/* Add the vty_group to the supplementary groups so it can be chowned to */</span>
    {
      <span class="keywordflow">if</span> ( (grentry = getgrnam (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5d73d1b006f1e22ea2c6faea606fd977">vty_group</a>)) )
        {
          <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a95c04b6ee093a2024ad19316953d701a">vtygrp</a> = grentry-&gt;gr_gid;
          <span class="keywordflow">if</span> ( setgroups (1, &amp;<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a95c04b6ee093a2024ad19316953d701a">vtygrp</a>) )
            {
              fprintf (stderr, <span class="stringliteral">&quot;privs_init: could not setgroups, %s\n&quot;</span>,
                         <a class="code" href="log_8c.html#a5292a9aa20fcddbb3998241685e18279">safe_strerror</a> (errno) );
              <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
            }       
        }
      <span class="keywordflow">else</span>
        {
          fprintf (stderr, <span class="stringliteral">&quot;privs_init: could not lookup vty group %s\n&quot;</span>,
                   zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5d73d1b006f1e22ea2c6faea606fd977">vty_group</a>);
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
    }
  
  <span class="keywordflow">if</span> (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5b11e63c267759ec4dd64022e6046b80">group</a>)
    {
      <span class="keywordflow">if</span> ( (grentry = getgrnam (zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5b11e63c267759ec4dd64022e6046b80">group</a>)) )
        {
          <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#adae43dc05bbac5b9c53ab3dfa93a4eee">zgid</a> = grentry-&gt;gr_gid;
        }
      <span class="keywordflow">else</span>
        {
          fprintf (stderr, <span class="stringliteral">&quot;privs_init: could not lookup group %s\n&quot;</span>,
                   zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a5b11e63c267759ec4dd64022e6046b80">group</a>);
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
      <span class="comment">/* change group now, forever. uid we do later */</span>
      <span class="keywordflow">if</span> ( setregid (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#adae43dc05bbac5b9c53ab3dfa93a4eee">zgid</a>, <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#adae43dc05bbac5b9c53ab3dfa93a4eee">zgid</a>) )
        {
          fprintf (stderr, <span class="stringliteral">&quot;zprivs_init: could not setregid, %s\n&quot;</span>,
                    <a class="code" href="log_8c.html#a5292a9aa20fcddbb3998241685e18279">safe_strerror</a> (errno) );
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
    }
  
<span class="preprocessor">#ifdef HAVE_CAPABILITIES</span>
<span class="preprocessor"></span>  zprivs_caps_init (zprivs);
<span class="preprocessor">#else </span><span class="comment">/* !HAVE_CAPABILITIES */</span>
  <span class="comment">/* we dont have caps. we&#39;ll need to maintain rid and saved uid</span>
<span class="comment">   * and change euid back to saved uid (who we presume has all neccessary</span>
<span class="comment">   * privileges) whenever we are asked to raise our privileges.</span>
<span class="comment">   *</span>
<span class="comment">   * This is not worth that much security wise, but all we can do.</span>
<span class="comment">   */</span>
  <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a9a6e4b114c49dc1febd9f08946d7a301">zsuid</a> = geteuid();  
  <span class="keywordflow">if</span> ( <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a> )
    {
      <span class="keywordflow">if</span> ( setreuid (-1, <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>) )
        {
          fprintf (stderr, <span class="stringliteral">&quot;privs_init (uid): could not setreuid, %s\n&quot;</span>, 
                   <a class="code" href="log_8c.html#a5292a9aa20fcddbb3998241685e18279">safe_strerror</a> (errno));
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
    }
  
  zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a0c59dbc0ec6187b60a824ec421cc34c1">change</a> = <a class="code" href="privs_8c.html#ac47d37201065f60c4daa0086756f4530">zprivs_change_uid</a>;
  zprivs-&gt;<a class="code" href="structzebra__privs__t.html#a87875be16a946ab35489aec62a76b315">current_state</a> = <a class="code" href="privs_8c.html#a38d592d604ed1af09fcb8e16317727bc">zprivs_state_uid</a>;
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_CAPABILITIES */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a36b09f13a1019a0650f17e7e97d7f11b"></a><!-- doxytag: member="privs.h::zprivs_terminate" ref="a36b09f13a1019a0650f17e7e97d7f11b" args="(struct zebra_privs_t *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zprivs_terminate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzebra__privs__t.html">zebra_privs_t</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="privs_8c_source.html#l00696">696</a> of file <a class="el" href="privs_8c_source.html">privs.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!zprivs)
    {
      fprintf (stderr, <span class="stringliteral">&quot;%s: no privs struct given, terminating&quot;</span>, __func__);
      <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (0);
    }
  
<span class="preprocessor">#ifdef HAVE_CAPABILITIES</span>
<span class="preprocessor"></span>  zprivs_caps_terminate();
<span class="preprocessor">#else </span><span class="comment">/* !HAVE_CAPABILITIES */</span>
  <span class="keywordflow">if</span> (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>)
    {
      <span class="keywordflow">if</span> ( setreuid (<a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>, <a class="code" href="privs_8c.html#afc62605e76ca349d8f53012268538ecd">zprivs_state</a>.<a class="code" href="struct__zprivs__t.html#a5cc3455f44f87bdbc45539853e62b204">zuid</a>) )
        {
          fprintf (stderr, <span class="stringliteral">&quot;privs_terminate: could not setreuid, %s&quot;</span>, 
                     <a class="code" href="log_8c.html#a5292a9aa20fcddbb3998241685e18279">safe_strerror</a> (errno) );
          <a class="code" href="vtysh_8c.html#afa5f6ba5518772e1487b961507e2a570">exit</a> (1);
        }
     }
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_LCAPS */</span>

  zprivs-&gt;change = <a class="code" href="privs_8c.html#ae9417e5de027e7ac2b71854645ffd5ab">zprivs_change_null</a>;
  zprivs-&gt;current_state = <a class="code" href="privs_8c.html#a46fae5e02d0b0308954dcb8c356d0e15">zprivs_state_null</a>;
  <a class="code" href="privs_8c.html#a3071763e378a708d1669f934abd192e1">zprivs_null_state</a> = <a class="code" href="privs_8h.html#ad679f4706ab2998d9538148c4412b177a6ea35041269b5c56a6a52c52cd67c731">ZPRIVS_LOWERED</a>;
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="privs_8h.html">privs.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:23 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
