<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: lib/workqueue.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('workqueue_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lib/workqueue.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="workqueue_8h__dep__incl.png" border="0" usemap="#lib_2workqueue_8hdep" alt=""/></div>
<map name="lib_2workqueue_8hdep" id="lib_2workqueue_8hdep">
<area shape="rect" id="node3" href="bgp__route_8c.html" title="bgpd/bgp_route.c" alt="" coords="5,80,136,107"/><area shape="rect" id="node5" href="bgpd_8c.html" title="bgpd/bgpd.c" alt="" coords="161,80,260,107"/><area shape="rect" id="node7" href="command_8c.html" title="lib/command.c" alt="" coords="285,80,395,107"/><area shape="rect" id="node9" href="workqueue_8c.html" title="lib/workqueue.c" alt="" coords="419,80,536,107"/><area shape="rect" id="node11" href="heavy-wq_8c.html" title="tests/heavy&#45;wq.c" alt="" coords="560,80,688,107"/><area shape="rect" id="node13" href="zserv_8h.html" title="zebra/zserv.h" alt="" coords="1585,80,1687,107"/><area shape="rect" id="node65" href="zebra__rib_8c.html" title="zebra/zebra_rib.c" alt="" coords="665,229,788,256"/><area shape="rect" id="node15" href="bgp__nexthop_8c.html" title="bgpd/bgp_nexthop.c" alt="" coords="2333,155,2483,181"/><area shape="rect" id="node17" href="connected_8c.html" title="zebra/connected.c" alt="" coords="1011,304,1145,331"/><area shape="rect" id="node19" href="interface_8c.html" title="zebra/interface.c" alt="" coords="1208,379,1331,405"/><area shape="rect" id="node21" href="redistribute_8h.html" title="zebra/redistribute.h" alt="" coords="1071,155,1209,181"/><area shape="rect" id="node39" href="kernel__socket_8c.html" title="zebra/kernel_socket.c" alt="" coords="2379,304,2532,331"/><area shape="rect" id="node43" href="rt__netlink_8c.html" title="zebra/rt_netlink.c" alt="" coords="2231,304,2355,331"/><area shape="rect" id="node45" href="rtadv_8c.html" title="zebra/rtadv.c" alt="" coords="2143,379,2243,405"/><area shape="rect" id="node50" href="zebra_2main_8c.html" title="zebra/main.c" alt="" coords="2497,379,2593,405"/><area shape="rect" id="node54" href="test__main_8c.html" title="zebra/test_main.c" alt="" coords="2557,304,2685,331"/><area shape="rect" id="node56" href="kernel__null_8c.html" title="zebra/kernel_null.c" alt="" coords="915,229,1047,256"/><area shape="rect" id="node58" href="redistribute_8c.html" title="zebra/redistribute.c" alt="" coords="1072,229,1211,256"/><area shape="rect" id="node60" href="redistribute__null_8c.html" title="zebra/redistribute_null.c" alt="" coords="1597,229,1763,256"/><area shape="rect" id="node62" href="router-id_8c.html" title="zebra/router&#45;id.c" alt="" coords="1787,229,1908,256"/><area shape="rect" id="node67" href="zserv_8c.html" title="zebra/zserv.c" alt="" coords="2156,229,2257,256"/><area shape="rect" id="node75" href="rt__ioctl_8c.html" title="zebra/rt_ioctl.c" alt="" coords="1335,155,1445,181"/><area shape="rect" id="node79" href="rtread__getmsg_8c.html" title="zebra/rtread_getmsg.c" alt="" coords="1470,155,1628,181"/><area shape="rect" id="node81" href="rtread__proc_8c.html" title="zebra/rtread_proc.c" alt="" coords="1653,155,1792,181"/><area shape="rect" id="node83" href="rtread__sysctl_8c.html" title="zebra/rtread_sysctl.c" alt="" coords="1817,155,1964,181"/><area shape="rect" id="node87" href="zebra__routemap_8c.html" title="zebra/zebra_routemap.c" alt="" coords="1989,155,2155,181"/><area shape="rect" id="node89" href="zebra__vty_8c.html" title="zebra/zebra_vty.c" alt="" coords="2180,155,2308,181"/><area shape="rect" id="node25" href="interface_8h.html" title="zebra/interface.h" alt="" coords="1399,229,1521,256"/><area shape="rect" id="node28" href="if__ioctl_8c.html" title="zebra/if_ioctl.c" alt="" coords="1608,304,1717,331"/><area shape="rect" id="node30" href="if__ioctl__solaris_8c.html" title="zebra/if_ioctl_solaris.c" alt="" coords="1741,304,1896,331"/><area shape="rect" id="node32" href="if__proc_8c.html" title="zebra/if_proc.c" alt="" coords="1921,304,2031,331"/><area shape="rect" id="node35" href="ioctl_8c.html" title="zebra/ioctl.c" alt="" coords="1222,304,1316,331"/><area shape="rect" id="node37" href="ioctl__solaris_8c.html" title="zebra/ioctl_solaris.c" alt="" coords="1443,304,1584,331"/><area shape="rect" id="node41" href="misc__null_8c.html" title="zebra/misc_null.c" alt="" coords="1669,379,1792,405"/><area shape="rect" id="node47" href="rtadv_8h.html" title="zebra/rtadv.h" alt="" coords="2055,304,2155,331"/></map>
</div>
</div>
<p><a href="workqueue_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwork__queue__item.html">work_queue_item</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwork__queue.html">work_queue</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#aadc610f042b208e17219436f143c8585">WORK_QUEUE_DEFAULT_HOLD</a>&#160;&#160;&#160;50</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#a28aab240a6eaab4d2feb2eb97d2ab671">WQ_UNPLUGGED</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885">wq_item_status</a> { <br/>
&#160;&#160;<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ac62ec0649e33ec9d6e0836fab0dec7fc">WQ_SUCCESS</a> =  0, 
<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ace8991073868a69b568e04c471086776">WQ_ERROR</a>, 
<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea">WQ_RETRY_NOW</a>, 
<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885af21f50d91fa63ac1fcc2038899d3306e">WQ_RETRY_LATER</a>, 
<br/>
&#160;&#160;<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ab06b16439cb8333f720a08a237c36836">WQ_REQUEUE</a>, 
<a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae7b1f6a044bfad1c23d813bb6c35b321">WQ_QUEUE_BLOCKED</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structwork__queue.html">work_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#aa89f0b81669845d585ad6657e8c40d95">work_queue_new</a> (struct <a class="el" href="structthread__master.html">thread_master</a> *, const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#acd2f748ad900a8d1558af56d49a33eb7">work_queue_free</a> (struct <a class="el" href="structwork__queue.html">work_queue</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#ac471621d1aa6fbd3b8073a13deca17af">work_queue_add</a> (struct <a class="el" href="structwork__queue.html">work_queue</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#ae01d17ef2cd86436b8feb75c470c501a">work_queue_plug</a> (struct <a class="el" href="structwork__queue.html">work_queue</a> *wq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#ac421962a00d94a292cb4097a4df7a2c9">work_queue_unplug</a> (struct <a class="el" href="structwork__queue.html">work_queue</a> *wq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#ae0c7b052eaeb1a9d400d4f53358911b7">work_queue_run</a> (struct <a class="el" href="structthread.html">thread</a> *)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcmd__element.html">cmd_element</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="workqueue_8h.html#ab2779e59766ef7735389a1d0edd08a9e">show_work_queues_cmd</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aadc610f042b208e17219436f143c8585"></a><!-- doxytag: member="workqueue.h::WORK_QUEUE_DEFAULT_HOLD" ref="aadc610f042b208e17219436f143c8585" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WORK_QUEUE_DEFAULT_HOLD&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8h_source.html#l00028">28</a> of file <a class="el" href="workqueue_8h_source.html">workqueue.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28aab240a6eaab4d2feb2eb97d2ab671"></a><!-- doxytag: member="workqueue.h::WQ_UNPLUGGED" ref="a28aab240a6eaab4d2feb2eb97d2ab671" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WQ_UNPLUGGED&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8h_source.html#l00050">50</a> of file <a class="el" href="workqueue_8h_source.html">workqueue.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a0e78d42489413cdb20b75485932a3885"></a><!-- doxytag: member="workqueue.h::wq_item_status" ref="a0e78d42489413cdb20b75485932a3885" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885">wq_item_status</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885ac62ec0649e33ec9d6e0836fab0dec7fc"></a><!-- doxytag: member="WQ_SUCCESS" ref="a0e78d42489413cdb20b75485932a3885ac62ec0649e33ec9d6e0836fab0dec7fc" args="" -->WQ_SUCCESS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885ace8991073868a69b568e04c471086776"></a><!-- doxytag: member="WQ_ERROR" ref="a0e78d42489413cdb20b75485932a3885ace8991073868a69b568e04c471086776" args="" -->WQ_ERROR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea"></a><!-- doxytag: member="WQ_RETRY_NOW" ref="a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea" args="" -->WQ_RETRY_NOW</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885af21f50d91fa63ac1fcc2038899d3306e"></a><!-- doxytag: member="WQ_RETRY_LATER" ref="a0e78d42489413cdb20b75485932a3885af21f50d91fa63ac1fcc2038899d3306e" args="" -->WQ_RETRY_LATER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885ab06b16439cb8333f720a08a237c36836"></a><!-- doxytag: member="WQ_REQUEUE" ref="a0e78d42489413cdb20b75485932a3885ab06b16439cb8333f720a08a237c36836" args="" -->WQ_REQUEUE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a0e78d42489413cdb20b75485932a3885ae7b1f6a044bfad1c23d813bb6c35b321"></a><!-- doxytag: member="WQ_QUEUE_BLOCKED" ref="a0e78d42489413cdb20b75485932a3885ae7b1f6a044bfad1c23d813bb6c35b321" args="" -->WQ_QUEUE_BLOCKED</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="workqueue_8h_source.html#l00031">31</a> of file <a class="el" href="workqueue_8h_source.html">workqueue.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ac62ec0649e33ec9d6e0836fab0dec7fc">WQ_SUCCESS</a> = 0,
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ace8991073868a69b568e04c471086776">WQ_ERROR</a>,             <span class="comment">/* Error, run error handler if provided */</span>
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea">WQ_RETRY_NOW</a>,         <span class="comment">/* retry immediately */</span>
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885af21f50d91fa63ac1fcc2038899d3306e">WQ_RETRY_LATER</a>,       <span class="comment">/* retry later, cease processing work queue */</span>
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ab06b16439cb8333f720a08a237c36836">WQ_REQUEUE</a>,       <span class="comment">/* requeue item, continue processing work queue */</span>
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae7b1f6a044bfad1c23d813bb6c35b321">WQ_QUEUE_BLOCKED</a>, <span class="comment">/* Queue cant be processed at this time.</span>
<span class="comment">                         * Similar to WQ_RETRY_LATER, but doesn&#39;t penalise</span>
<span class="comment">                         * the particular item.. */</span>
} <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885">wq_item_status</a>;
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac471621d1aa6fbd3b8073a13deca17af"></a><!-- doxytag: member="workqueue.h::work_queue_add" ref="ac471621d1aa6fbd3b8073a13deca17af" args="(struct work_queue *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void work_queue_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwork__queue.html">work_queue</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00123">123</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structwork__queue__item.html">work_queue_item</a> *item;
  
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (wq);

  <span class="keywordflow">if</span> (!(item = <a class="code" href="workqueue_8c.html#ab3d2e7f11c70d7199c6f647acf19ca9b">work_queue_item_new</a> (wq)))
    {
      <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a> (<span class="stringliteral">&quot;%s: unable to get new queue item&quot;</span>, __func__);
      <span class="keywordflow">return</span>;
    }
  
  item-&gt;<a class="code" href="structwork__queue__item.html#aba6c356bbcf47612f80c690961518aa7">data</a> = <a class="code" href="dict_8c.html#a43a278d13284fb3412e9eee1db1d967e">data</a>;
  <a class="code" href="linklist_8c.html#adb2a0478aba995441aaf691d1f6fe5db">listnode_add</a> (wq-&gt;items, item);
  
  <a class="code" href="workqueue_8c.html#aa732b3b09b4d45c9167eb7e6bb97ac22">work_queue_schedule</a> (wq, wq-&gt;spec.hold);
  
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acd2f748ad900a8d1558af56d49a33eb7"></a><!-- doxytag: member="workqueue.h::work_queue_free" ref="acd2f748ad900a8d1558af56d49a33eb7" args="(struct work_queue *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void work_queue_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwork__queue.html">work_queue</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00092">92</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (wq-&gt;thread != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <a class="code" href="thread_8c.html#aceb89c1157b6a1d8bb3afa5021f1ab6d">thread_cancel</a>(wq-&gt;thread);
  
  <span class="comment">/* list_delete frees items via callback */</span>
  <a class="code" href="linklist_8c.html#ab5fdf1a904264be077ce19a432b1b119">list_delete</a> (wq-&gt;items);
  <a class="code" href="linklist_8c.html#a8cbdaa18db1ceacaadbc457a0c634e02">listnode_delete</a> (&amp;<a class="code" href="workqueue_8c.html#a4d24d005d0b0547df065125f766a7f85">work_queues</a>, wq);
  
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba53693e92d00466f3d482d0fbde3a04d2">MTYPE_WORK_QUEUE_NAME</a>, wq-&gt;name);
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba4afb71edb3d48305829a2dba60f7c353">MTYPE_WORK_QUEUE</a>, wq);
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa89f0b81669845d585ad6657e8c40d95"></a><!-- doxytag: member="workqueue.h::work_queue_new" ref="aa89f0b81669845d585ad6657e8c40d95" args="(struct thread_master *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structwork__queue.html">work_queue</a>* work_queue_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread__master.html">thread_master</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00058">58</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structwork__queue.html">work_queue</a> *<span class="keyword">new</span>;
  
  <span class="keyword">new</span> = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba4afb71edb3d48305829a2dba60f7c353">MTYPE_WORK_QUEUE</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structwork__queue.html">work_queue</a>));

  <span class="keywordflow">if</span> (<span class="keyword">new</span> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> <span class="keyword">new</span>;
  
  <span class="keyword">new</span>-&gt;name = <a class="code" href="memory_8h.html#aa7c561b5824edc16351f22b8df155c0e">XSTRDUP</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba53693e92d00466f3d482d0fbde3a04d2">MTYPE_WORK_QUEUE_NAME</a>, queue_name);
  <span class="keyword">new</span>-&gt;master = <a class="code" href="spgrid_8c.html#a5175b356eac1d83a42608b42a25d00b9">m</a>;
  <a class="code" href="zebra_8h.html#a7c593725d5bbf27a37a922ae84b02333">SET_FLAG</a> (new-&gt;flags, <a class="code" href="workqueue_8h.html#a28aab240a6eaab4d2feb2eb97d2ab671">WQ_UNPLUGGED</a>);
  
  <span class="keywordflow">if</span> ( (new-&gt;items = <a class="code" href="linklist_8c.html#af156f4ae343ef4a625f75b6c38845aef">list_new</a> ()) == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba53693e92d00466f3d482d0fbde3a04d2">MTYPE_WORK_QUEUE_NAME</a>, new-&gt;name);
      <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba4afb71edb3d48305829a2dba60f7c353">MTYPE_WORK_QUEUE</a>, <span class="keyword">new</span>);
      
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
  
  <span class="keyword">new</span>-&gt;items-&gt;del = (void (*)(<span class="keywordtype">void</span> *)) <a class="code" href="workqueue_8c.html#a7bb0b38c0628be0a01058cec1c19c6cc">work_queue_item_free</a>;  
  
  <a class="code" href="linklist_8c.html#adb2a0478aba995441aaf691d1f6fe5db">listnode_add</a> (&amp;<a class="code" href="workqueue_8c.html#a4d24d005d0b0547df065125f766a7f85">work_queues</a>, <span class="keyword">new</span>);
  
  <span class="keyword">new</span>-&gt;cycles.granularity = <a class="code" href="workqueue_8c.html#a70ae9b5a5f4e3a8315a9b8886b1fc3b2">WORK_QUEUE_MIN_GRANULARITY</a>;

  <span class="comment">/* Default values, can be overriden by caller */</span>
  <span class="keyword">new</span>-&gt;spec.hold = <a class="code" href="workqueue_8h.html#aadc610f042b208e17219436f143c8585">WORK_QUEUE_DEFAULT_HOLD</a>;
    
  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae01d17ef2cd86436b8feb75c470c501a"></a><!-- doxytag: member="workqueue.h::work_queue_plug" ref="ae01d17ef2cd86436b8feb75c470c501a" args="(struct work_queue *wq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void work_queue_plug </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwork__queue.html">work_queue</a> *&#160;</td>
          <td class="paramname"><em>wq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00211">211</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (wq-&gt;<a class="code" href="structwork__queue.html#aa7a1097e517f22c4a289a8db9e91005d">thread</a>)
    <a class="code" href="thread_8c.html#aceb89c1157b6a1d8bb3afa5021f1ab6d">thread_cancel</a> (wq-&gt;<a class="code" href="structwork__queue.html#aa7a1097e517f22c4a289a8db9e91005d">thread</a>);
  
  wq-&gt;<a class="code" href="structwork__queue.html#aa7a1097e517f22c4a289a8db9e91005d">thread</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <a class="code" href="zebra_8h.html#ab1ec1b6701a70280e13876cf1f6ae51d">UNSET_FLAG</a> (wq-&gt;<a class="code" href="structwork__queue.html#a35d9311d951ad4ca2d9497482467445f">flags</a>, <a class="code" href="workqueue_8h.html#a28aab240a6eaab4d2feb2eb97d2ab671">WQ_UNPLUGGED</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae0c7b052eaeb1a9d400d4f53358911b7"></a><!-- doxytag: member="workqueue.h::work_queue_run" ref="ae0c7b052eaeb1a9d400d4f53358911b7" args="(struct thread *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int work_queue_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00238">238</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structwork__queue.html">work_queue</a> *wq;
  <span class="keyword">struct </span><a class="code" href="structwork__queue__item.html">work_queue_item</a> *item;
  <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885">wq_item_status</a> ret;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycles = 0;
  <span class="keyword">struct </span><a class="code" href="structlistnode.html">listnode</a> *node, *nnode;
  <span class="keywordtype">char</span> yielded = 0;

  wq = <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (<a class="code" href="structthread.html">thread</a>);
  wq-&gt;<a class="code" href="structwork__queue.html#aa7a1097e517f22c4a289a8db9e91005d">thread</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (wq &amp;&amp; wq-&gt;<a class="code" href="structwork__queue.html#a563ee1f1f6983b2a7a6dfb6624fd4942">items</a>);

  <span class="comment">/* calculate cycle granularity:</span>
<span class="comment">   * list iteration == 1 cycle</span>
<span class="comment">   * granularity == # cycles between checks whether we should yield.</span>
<span class="comment">   *</span>
<span class="comment">   * granularity should be &gt; 0, and can increase slowly after each run to</span>
<span class="comment">   * provide some hysteris, but not past cycles.best or 2*cycles.</span>
<span class="comment">   *</span>
<span class="comment">   * Best: starts low, can only increase</span>
<span class="comment">   *</span>
<span class="comment">   * Granularity: starts at WORK_QUEUE_MIN_GRANULARITY, can be decreased </span>
<span class="comment">   *              if we run to end of time slot, can increase otherwise </span>
<span class="comment">   *              by a small factor.</span>
<span class="comment">   *</span>
<span class="comment">   * We could use just the average and save some work, however we want to be</span>
<span class="comment">   * able to adjust quickly to CPU pressure. Average wont shift much if</span>
<span class="comment">   * daemon has been running a long time.</span>
<span class="comment">   */</span>
   <span class="keywordflow">if</span> (wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> == 0)
     wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> = <a class="code" href="workqueue_8c.html#a70ae9b5a5f4e3a8315a9b8886b1fc3b2">WORK_QUEUE_MIN_GRANULARITY</a>;

  <span class="keywordflow">for</span> (<a class="code" href="linklist_8h.html#a71512a873b8f0e2b4c84d3c949a9bbaf">ALL_LIST_ELEMENTS</a> (wq-&gt;<a class="code" href="structwork__queue.html#a563ee1f1f6983b2a7a6dfb6624fd4942">items</a>, node, nnode, item))
  {
    <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (item &amp;&amp; item-&gt;<a class="code" href="structwork__queue__item.html#aba6c356bbcf47612f80c690961518aa7">data</a>);
    
    <span class="comment">/* dont run items which are past their allowed retries */</span>
    <span class="keywordflow">if</span> (item-&gt;<a class="code" href="structwork__queue__item.html#a2ef387498560aaddedf3846babbbf177">ran</a> &gt; wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a74334af11b2e664ed8cd47fa13a76881">max_retries</a>)
      {
        <span class="comment">/* run error handler, if any */</span>
    <span class="keywordflow">if</span> (wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a4defd4b1c7ea708f3d30881057c26f61">errorfunc</a>)
      wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a4defd4b1c7ea708f3d30881057c26f61">errorfunc</a> (wq, item-&gt;<a class="code" href="structwork__queue__item.html#aba6c356bbcf47612f80c690961518aa7">data</a>);
    <a class="code" href="workqueue_8c.html#abb2634fd42a197c9f214d8543e23980d">work_queue_item_remove</a> (wq, node);
    <span class="keywordflow">continue</span>;
      }

    <span class="comment">/* run and take care of items that want to be retried immediately */</span>
    <span class="keywordflow">do</span>
      {
        ret = wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#aabcb370748f886f6a167ea3b13a6d372">workfunc</a> (wq, item-&gt;<a class="code" href="structwork__queue__item.html#aba6c356bbcf47612f80c690961518aa7">data</a>);
        item-&gt;<a class="code" href="structwork__queue__item.html#a2ef387498560aaddedf3846babbbf177">ran</a>++;
      }
    <span class="keywordflow">while</span> ((ret == <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea">WQ_RETRY_NOW</a>) 
           &amp;&amp; (item-&gt;<a class="code" href="structwork__queue__item.html#a2ef387498560aaddedf3846babbbf177">ran</a> &lt; wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a74334af11b2e664ed8cd47fa13a76881">max_retries</a>));

    <span class="keywordflow">switch</span> (ret)
      {
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae7b1f6a044bfad1c23d813bb6c35b321">WQ_QUEUE_BLOCKED</a>:
        {
          <span class="comment">/* decrement item-&gt;ran again, cause this isn&#39;t an item</span>
<span class="comment">           * specific error, and fall through to WQ_RETRY_LATER</span>
<span class="comment">           */</span>
          item-&gt;<a class="code" href="structwork__queue__item.html#a2ef387498560aaddedf3846babbbf177">ran</a>--;
        }
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885af21f50d91fa63ac1fcc2038899d3306e">WQ_RETRY_LATER</a>:
    {
      <span class="keywordflow">goto</span> stats;
    }
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ab06b16439cb8333f720a08a237c36836">WQ_REQUEUE</a>:
    {
      item-&gt;<a class="code" href="structwork__queue__item.html#a2ef387498560aaddedf3846babbbf177">ran</a>--;
      <a class="code" href="workqueue_8c.html#ad7b4ca345f9604d44b3d487105e18c9a">work_queue_item_requeue</a> (wq, node);
      <span class="keywordflow">break</span>;
    }
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ae4b9584851b2d121edce1a820c9f40ea">WQ_RETRY_NOW</a>:
        <span class="comment">/* a RETRY_NOW that gets here has exceeded max_tries, same as ERROR */</span>
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ace8991073868a69b568e04c471086776">WQ_ERROR</a>:
    {
      <span class="keywordflow">if</span> (wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a4defd4b1c7ea708f3d30881057c26f61">errorfunc</a>)
        wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a4defd4b1c7ea708f3d30881057c26f61">errorfunc</a> (wq, item);
    }
    <span class="comment">/* fall through here is deliberate */</span>
      <span class="keywordflow">case</span> <a class="code" href="workqueue_8h.html#a0e78d42489413cdb20b75485932a3885ac62ec0649e33ec9d6e0836fab0dec7fc">WQ_SUCCESS</a>:
      <span class="keywordflow">default</span>:
    {
      <a class="code" href="workqueue_8c.html#abb2634fd42a197c9f214d8543e23980d">work_queue_item_remove</a> (wq, node);
      <span class="keywordflow">break</span>;
    }
      }

    <span class="comment">/* completed cycle */</span>
    cycles++;

    <span class="comment">/* test if we should yield */</span>
    <span class="keywordflow">if</span> ( !(cycles % wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a>) 
        &amp;&amp; <a class="code" href="thread_8c.html#a88220a6a17cb0a1dc2fda0f9ff9d7b01">thread_should_yield</a> (<a class="code" href="structthread.html">thread</a>))
      {
        yielded = 1;
        <span class="keywordflow">goto</span> stats;
      }
  }

stats:

<span class="preprocessor">#define WQ_HYSTERIS_FACTOR 2</span>
<span class="preprocessor"></span>
  <span class="comment">/* we yielded, check whether granularity should be reduced */</span>
  <span class="keywordflow">if</span> (yielded &amp;&amp; (cycles &lt; wq-&gt;cycles.granularity))
    {
      wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> = ((cycles &gt; 0) ? cycles 
                                             : <a class="code" href="workqueue_8c.html#a70ae9b5a5f4e3a8315a9b8886b1fc3b2">WORK_QUEUE_MIN_GRANULARITY</a>);
    }
  
  <span class="keywordflow">if</span> (cycles &gt;= (wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a>))
    {
      <span class="keywordflow">if</span> (cycles &gt; wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#aba6bd3f6f97fbdecf4ae0835410f43ca">best</a>)
        wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#aba6bd3f6f97fbdecf4ae0835410f43ca">best</a> = cycles;
      
      <span class="comment">/* along with yielded check, provides hysteris for granularity */</span>
      <span class="keywordflow">if</span> (cycles &gt; (wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> * WQ_HYSTERIS_FACTOR * 2))
        wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> *= WQ_HYSTERIS_FACTOR; <span class="comment">/* quick ramp-up */</span>
      <span class="keywordflow">else</span> if (cycles &gt; (wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> * WQ_HYSTERIS_FACTOR))
        wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a> += WQ_HYSTERIS_FACTOR;
    }
<span class="preprocessor">#undef WQ_HYSTERIS_FACTOR</span>
<span class="preprocessor"></span>  
  wq-&gt;<a class="code" href="structwork__queue.html#abc672c3cb4692cbc67fec570e8c94485">runs</a>++;
  wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ae3d83725e098fb7288bf6eb59c7e4668">total</a> += cycles;

<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  printf (<span class="stringliteral">&quot;%s: cycles %d, new: best %d, worst %d\n&quot;</span>,
            __func__, cycles, wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#aba6bd3f6f97fbdecf4ae0835410f43ca">best</a>, wq-&gt;<a class="code" href="structwork__queue.html#a077cdf65a4429efc9d7fa6c51d72e67f">cycles</a>.<a class="code" href="structwork__queue.html#ab01cb6e83c330ca80c63b397a46694fe">granularity</a>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  
  <span class="comment">/* Is the queue done yet? If it is, call the completion callback. */</span>
  <span class="keywordflow">if</span> (<a class="code" href="linklist_8h.html#a0429e6385b31a314cc64432a906201e5">listcount</a> (wq-&gt;<a class="code" href="structwork__queue.html#a563ee1f1f6983b2a7a6dfb6624fd4942">items</a>) &gt; 0)
    <a class="code" href="workqueue_8c.html#aa732b3b09b4d45c9167eb7e6bb97ac22">work_queue_schedule</a> (wq, 0);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a8f91d98335cfc0e547c01194575a9558">completion_func</a>)
    wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a8f91d98335cfc0e547c01194575a9558">completion_func</a> (wq);
  
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac421962a00d94a292cb4097a4df7a2c9"></a><!-- doxytag: member="workqueue.h::work_queue_unplug" ref="ac421962a00d94a292cb4097a4df7a2c9" args="(struct work_queue *wq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void work_queue_unplug </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwork__queue.html">work_queue</a> *&#160;</td>
          <td class="paramname"><em>wq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="workqueue_8c_source.html#l00225">225</a> of file <a class="el" href="workqueue_8c_source.html">workqueue.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="zebra_8h.html#a7c593725d5bbf27a37a922ae84b02333">SET_FLAG</a> (wq-&gt;<a class="code" href="structwork__queue.html#a35d9311d951ad4ca2d9497482467445f">flags</a>, <a class="code" href="workqueue_8h.html#a28aab240a6eaab4d2feb2eb97d2ab671">WQ_UNPLUGGED</a>);

  <span class="comment">/* if thread isnt already waiting, add one */</span>
  <a class="code" href="workqueue_8c.html#aa732b3b09b4d45c9167eb7e6bb97ac22">work_queue_schedule</a> (wq, wq-&gt;<a class="code" href="structwork__queue.html#ae9c11795e9b293839422dd2c6ebfa493">spec</a>.<a class="code" href="structwork__queue.html#a6f998e18d62286e5b77844faf7c3ded2">hold</a>);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab2779e59766ef7735389a1d0edd08a9e"></a><!-- doxytag: member="workqueue.h::show_work_queues_cmd" ref="ab2779e59766ef7735389a1d0edd08a9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcmd__element.html">cmd_element</a> <a class="el" href="workqueue_8h.html#ab2779e59766ef7735389a1d0edd08a9e">show_work_queues_cmd</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="workqueue_8h.html">workqueue.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:25 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
