<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: lib/zclient.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('zclient_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lib/zclient.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="zebra_8h_source.html">zebra.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="prefix_8h_source.html">prefix.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="network_8h_source.html">network.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="if_8h_source.html">if.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="thread_8h_source.html">thread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="zclient_8h_source.html">zclient.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="table_8h_source.html">table.h</a>&quot;</code><br/>
<code>#include &lt;sys/un.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for zclient.c:</div>
<div class="dyncontent">
<div class="center"><img src="zclient_8c__incl.png" border="0" usemap="#lib_2zclient_8c" alt=""/></div>
<map name="lib_2zclient_8c" id="lib_2zclient_8c">
<area shape="rect" id="node3" href="zebra_8h.html" title="zebra.h" alt="" coords="1397,80,1464,107"/><area shape="rect" id="node61" href="prefix_8h.html" title="prefix.h" alt="" coords="2966,155,3033,181"/><area shape="rect" id="node65" href="stream_8h.html" title="stream.h" alt="" coords="3012,80,3087,107"/><area shape="rect" id="node68" href="buffer_8h.html" title="buffer.h" alt="" coords="2813,80,2880,107"/><area shape="rect" id="node70" href="network_8h.html" title="network.h" alt="" coords="2905,80,2988,107"/><area shape="rect" id="node72" href="if_8h.html" title="if.h" alt="" coords="3155,155,3195,181"/><area shape="rect" id="node76" href="log_8h.html" title="log.h" alt="" coords="2685,80,2736,107"/><area shape="rect" id="node79" href="thread_8h.html" title="thread.h" alt="" coords="3161,80,3233,107"/><area shape="rect" id="node81" href="zclient_8h.html" title="zclient.h" alt="" coords="3257,80,3329,107"/><area shape="rect" id="node84" href="memory_8h.html" title="memory.h" alt="" coords="3353,80,3436,107"/><area shape="rect" id="node88" href="table_8h.html" title="table.h" alt="" coords="3460,80,3524,107"/><area shape="rect" id="node57" href="zassert_8h.html" title="zassert.h" alt="" coords="2205,155,2283,181"/><area shape="rect" id="node59" href="str_8h.html" title="str.h" alt="" coords="2307,155,2356,181"/><area shape="rect" id="node63" href="sockunion_8h.html" title="sockunion.h" alt="" coords="2953,229,3047,256"/><area shape="rect" id="node74" href="linklist_8h.html" title="linklist.h" alt="" coords="3139,229,3209,256"/><area shape="rect" id="node86" href="memtypes_8h.html" title="lib/memtypes.h" alt="" coords="3337,155,3452,181"/></map>
</div>
</div>
<p><a href="zclient_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a> { <br/>
&#160;&#160;<a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea8fd18ac65705a12e09a38d18e47d12ec">VTY_SERV</a>, 
<a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea9ed3db9f85ae6bdc30382d62bc01a807">VTY_READ</a>, 
<a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea73e4d70c7cc9c2560723e639332d7f2d">VTY_WRITE</a>, 
<a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9eada5cbc98f077a6a603d7c200d654042c">VTY_TIMEOUT_RESET</a>, 
<br/>
&#160;&#160;<a class="el" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea826c5318cddea911fefb2c166a4bf509">ZCLIENT_SCHEDULE</a>, 
<a class="el" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, 
<a class="el" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb">ZCLIENT_CONNECT</a>, 
<a class="el" href="ospf__apiserver_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaf7d27b451246b7abd5c02d73f722e711">OSPF_APISERVER_ACCEPT</a>, 
<br/>
&#160;&#160;<a class="el" href="ospf__apiserver_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaafc629f281d14052686b777808801956">OSPF_APISERVER_SYNC_READ</a>, 
<a class="el" href="ospf__apiserver_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaf185e2c50bffd89565783bbd9c063ea2">OSPF_APISERVER_SYNC_WRITE</a>, 
<a class="el" href="ospf__apiserver_8h.html#a3b65133bb9997cd1ccf311af0927fc9ea9b30267095ac2c8eb8c87603dea68133">OSPF_APISERVER_ASYNC_WRITE</a>, 
<a class="el" href="zserv_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea798c01376b108480a941e1e6c69a2a21">ZEBRA_SERV</a>, 
<br/>
&#160;&#160;<a class="el" href="zserv_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea8af81c1e6c659f520a29088128058a2b">ZEBRA_READ</a>, 
<a class="el" href="zserv_8c.html#a3b65133bb9997cd1ccf311af0927fc9eac02643d854489b17e1400ff30e76f7f6">ZEBRA_WRITE</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (enum <a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a>, struct <a class="el" href="structzclient.html">zclient</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#aa521f2a71596b1dc50f76fcb57dff30b">zclient_new</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#aa6b9a9327c5b3842f3a91e0464a4af7a">zclient_free</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ac649a246f405850a3ade72de002745e3">zclient_init</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>, int redist_default)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a380163204583292d5924050e26a8989d">zclient_stop</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ad002f3a9a797ab41ed60505ed5007ae7">zclient_reset</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ac937966a23dbff10b311175341da2d57">zclient_socket</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a1a87f3eaa2f08161b64feebfda6bf3fd">zclient_socket_un</a> (const char *path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a8bf52479ef7bde190fbe66a350089b29">zclient_flush_data</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ad395166e549bd33dcc253052ac0bbd7d">zclient_send_message</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a70fa712bf570d588ea3b3c464bc5156f">zclient_create_header</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, uint16_t command)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#adab3e03d8c0c0ecb6a1fa2e4d2068054">zebra_message_send</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>, int command)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a9c8f7389bb01919b00e7f95403a3c112">zclient_start</a> (struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ab9c9eb9a77da6d6a2941954559fde834">zclient_connect</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="test-sig_8c.html#ab4ed0bba3292270af8ad67b45a21280d">t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#ad9a398f43faa79a0bab620c985fb476a">zapi_ipv4_route</a> (u_char cmd, struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>, struct <a class="el" href="structprefix__ipv4.html">prefix_ipv4</a> *<a class="el" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>, struct <a class="el" href="structzapi__ipv4.html">zapi_ipv4</a> *api)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a0ed1704cde688d0575a1394a34f6fc82">zebra_redistribute_send</a> (int command, struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>, int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a6adcd87e46d205582c81673f669067f3">zebra_router_id_update_read</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, struct <a class="el" href="structprefix.html">prefix</a> *rid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structinterface.html">interface</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#af2dbed49848c57eaae1185751ec18648">zebra_interface_add_read</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structinterface.html">interface</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a989f3e044d41b4e18463027a94b846e7">zebra_interface_state_read</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a2366afba487613909591ecadd8985f1a">zebra_interface_if_set_value</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, struct <a class="el" href="structinterface.html">interface</a> *ifp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a743e58b2aba73769d940cbb0f2e95b6f">memconstant</a> (const void *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, int c, size_t <a class="el" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structconnected.html">connected</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a361d54ec3dad267afc3335fe155367a2">zebra_interface_address_read</a> (int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a8b69581b6d74a357de6053a2a26f8372">zclient_read</a> (struct <a class="el" href="structthread.html">thread</a> *<a class="el" href="structthread.html">thread</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a4381afa78256a1211fe7881394d7e666">zclient_redistribute</a> (int command, struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>, int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#a2d2c4a009144e592b06b55055ab9c38e">zclient_redistribute_default</a> (int command, struct <a class="el" href="structzclient.html">zclient</a> *<a class="el" href="structzclient.html">zclient</a>)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structthread__master.html">thread_master</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a> = 0</td></tr>
</table>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9e"></a><!-- doxytag: member="zclient.c::event" ref="a3b65133bb9997cd1ccf311af0927fc9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea8fd18ac65705a12e09a38d18e47d12ec"></a><!-- doxytag: member="VTY_SERV" ref="a3b65133bb9997cd1ccf311af0927fc9ea8fd18ac65705a12e09a38d18e47d12ec" args="" -->VTY_SERV</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea9ed3db9f85ae6bdc30382d62bc01a807"></a><!-- doxytag: member="VTY_READ" ref="a3b65133bb9997cd1ccf311af0927fc9ea9ed3db9f85ae6bdc30382d62bc01a807" args="" -->VTY_READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea73e4d70c7cc9c2560723e639332d7f2d"></a><!-- doxytag: member="VTY_WRITE" ref="a3b65133bb9997cd1ccf311af0927fc9ea73e4d70c7cc9c2560723e639332d7f2d" args="" -->VTY_WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eada5cbc98f077a6a603d7c200d654042c"></a><!-- doxytag: member="VTY_TIMEOUT_RESET" ref="a3b65133bb9997cd1ccf311af0927fc9eada5cbc98f077a6a603d7c200d654042c" args="" -->VTY_TIMEOUT_RESET</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea826c5318cddea911fefb2c166a4bf509"></a><!-- doxytag: member="ZCLIENT_SCHEDULE" ref="a3b65133bb9997cd1ccf311af0927fc9ea826c5318cddea911fefb2c166a4bf509" args="" -->ZCLIENT_SCHEDULE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9"></a><!-- doxytag: member="ZCLIENT_READ" ref="a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9" args="" -->ZCLIENT_READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb"></a><!-- doxytag: member="ZCLIENT_CONNECT" ref="a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb" args="" -->ZCLIENT_CONNECT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eaf7d27b451246b7abd5c02d73f722e711"></a><!-- doxytag: member="OSPF_APISERVER_ACCEPT" ref="a3b65133bb9997cd1ccf311af0927fc9eaf7d27b451246b7abd5c02d73f722e711" args="" -->OSPF_APISERVER_ACCEPT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eaafc629f281d14052686b777808801956"></a><!-- doxytag: member="OSPF_APISERVER_SYNC_READ" ref="a3b65133bb9997cd1ccf311af0927fc9eaafc629f281d14052686b777808801956" args="" -->OSPF_APISERVER_SYNC_READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eaf185e2c50bffd89565783bbd9c063ea2"></a><!-- doxytag: member="OSPF_APISERVER_SYNC_WRITE" ref="a3b65133bb9997cd1ccf311af0927fc9eaf185e2c50bffd89565783bbd9c063ea2" args="" -->OSPF_APISERVER_SYNC_WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea9b30267095ac2c8eb8c87603dea68133"></a><!-- doxytag: member="OSPF_APISERVER_ASYNC_WRITE" ref="a3b65133bb9997cd1ccf311af0927fc9ea9b30267095ac2c8eb8c87603dea68133" args="" -->OSPF_APISERVER_ASYNC_WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea798c01376b108480a941e1e6c69a2a21"></a><!-- doxytag: member="ZEBRA_SERV" ref="a3b65133bb9997cd1ccf311af0927fc9ea798c01376b108480a941e1e6c69a2a21" args="" -->ZEBRA_SERV</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9ea8af81c1e6c659f520a29088128058a2b"></a><!-- doxytag: member="ZEBRA_READ" ref="a3b65133bb9997cd1ccf311af0927fc9ea8af81c1e6c659f520a29088128058a2b" args="" -->ZEBRA_READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3b65133bb9997cd1ccf311af0927fc9eac02643d854489b17e1400ff30e76f7f6"></a><!-- doxytag: member="ZEBRA_WRITE" ref="a3b65133bb9997cd1ccf311af0927fc9eac02643d854489b17e1400ff30e76f7f6" args="" -->ZEBRA_WRITE</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00037">37</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea826c5318cddea911fefb2c166a4bf509">ZCLIENT_SCHEDULE</a>, <a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, <a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb">ZCLIENT_CONNECT</a>};
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a743e58b2aba73769d940cbb0f2e95b6f"></a><!-- doxytag: member="zclient.c::memconstant" ref="a743e58b2aba73769d940cbb0f2e95b6f" args="(const void *s, int c, size_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int memconstant </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00721">721</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a> = <a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>;

  <span class="keywordflow">while</span> (<a class="code" href="spgrid_8c.html#abe63e991a7bf5d666068b15c9064428d">n</a>-- &gt; 0)
    <span class="keywordflow">if</span> (*p++ != c)
      <span class="keywordflow">return</span> 0;
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad9a398f43faa79a0bab620c985fb476a"></a><!-- doxytag: member="zclient.c::zapi_ipv4_route" ref="ad9a398f43faa79a0bab620c985fb476a" args="(u_char cmd, struct zclient *zclient, struct prefix_ipv4 *p, struct zapi_ipv4 *api)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zapi_ipv4_route </td>
          <td>(</td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structprefix__ipv4.html">prefix_ipv4</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzapi__ipv4.html">zapi_ipv4</a> *&#160;</td>
          <td class="paramname"><em>api</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00421">421</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keywordtype">int</span> psize;
  <span class="keyword">struct </span><a class="code" href="structstream.html">stream</a> *<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>;

  <span class="comment">/* Reset stream. */</span>
  s = zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>;
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a> (s);
  
  <a class="code" href="zclient_8c.html#a70fa712bf570d588ea3b3c464bc5156f">zclient_create_header</a> (s, cmd);
  
  <span class="comment">/* Put type and nexthop. */</span>
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#ae4c29fc6652367a6546104010802ac2f">type</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#af27235a3df3f1e86cdbd91bce4e0a2c9">flags</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a5d958982406b8e5c5792fa61d30dad2d">message</a>);

  <span class="comment">/* Put prefix information. */</span>
  psize = <a class="code" href="bgpd_8h.html#a472145011d944606a257487e80cc3ace">PSIZE</a> (p-&gt;<a class="code" href="structprefix__ipv4.html#ab96da4bf1eb37195bd564bcf1126a16a">prefixlen</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, p-&gt;<a class="code" href="structprefix__ipv4.html#ab96da4bf1eb37195bd564bcf1126a16a">prefixlen</a>);
  <a class="code" href="stream_8c.html#a39121b19ef0be09e9a5598a1ea1371c0">stream_write</a> (s, (u_char *) &amp; p-&gt;prefix, psize);

  <span class="comment">/* Nexthop, ifindex, distance and metric information. */</span>
  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (api-&gt;<a class="code" href="structzapi__ipv4.html#a5d958982406b8e5c5792fa61d30dad2d">message</a>, <a class="code" href="zclient_8h.html#a321bbeaddad8bc9bffaf57f7ac6cf8fd">ZAPI_MESSAGE_NEXTHOP</a>))
    {
      <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (api-&gt;<a class="code" href="structzapi__ipv4.html#af27235a3df3f1e86cdbd91bce4e0a2c9">flags</a>, <a class="code" href="zebra_8h.html#ab3b7a4bd090244ae1b882b9003810713">ZEBRA_FLAG_BLACKHOLE</a>))
        {
          <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, 1);
          <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="zebra_8h.html#af00200aec468f2738ec3fabc3103b187">ZEBRA_NEXTHOP_BLACKHOLE</a>);
          <span class="comment">/* XXX assert(api-&gt;nexthop_num == 0); */</span>
          <span class="comment">/* XXX assert(api-&gt;ifindex_num == 0); */</span>
        }
      <span class="keywordflow">else</span>
        <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a7af9e3fe513c80387289b433e33dfd7b">nexthop_num</a> + api-&gt;<a class="code" href="structzapi__ipv4.html#ae831960c79c5bbf79345fe148c202641">ifindex_num</a>);

      <span class="keywordflow">for</span> (i = 0; i &lt; api-&gt;<a class="code" href="structzapi__ipv4.html#a7af9e3fe513c80387289b433e33dfd7b">nexthop_num</a>; i++)
        {
          <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="zebra_8h.html#ae603faed81a38b4507ffd9b6f9586b44">ZEBRA_NEXTHOP_IPV4</a>);
          <a class="code" href="stream_8c.html#a9019a5de70c1b6c2715cf24103109632">stream_put_in_addr</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a3864c7fed7dfc94e19405d9d0fef2f9c">nexthop</a>[i]);
        }
      <span class="keywordflow">for</span> (i = 0; i &lt; api-&gt;<a class="code" href="structzapi__ipv4.html#ae831960c79c5bbf79345fe148c202641">ifindex_num</a>; i++)
        {
          <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="zebra_8h.html#a8b5777b74f2584912603090de989e564">ZEBRA_NEXTHOP_IFINDEX</a>);
          <a class="code" href="stream_8c.html#af366d780a14cb8de53279378a8a4faeb">stream_putl</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a7043b2c08d10a58daa5e6e7800ff8a29">ifindex</a>[i]);
        }
    }

  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (api-&gt;<a class="code" href="structzapi__ipv4.html#a5d958982406b8e5c5792fa61d30dad2d">message</a>, <a class="code" href="zclient_8h.html#abe498bb81bfbda17757173ef23e25179">ZAPI_MESSAGE_DISTANCE</a>))
    <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a78e8151136680e3bd6160864426f4ab3">distance</a>);
  <span class="keywordflow">if</span> (<a class="code" href="zebra_8h.html#a9310812ac92febfb7d1eb10127aea1a8">CHECK_FLAG</a> (api-&gt;<a class="code" href="structzapi__ipv4.html#a5d958982406b8e5c5792fa61d30dad2d">message</a>, <a class="code" href="zclient_8h.html#a4a5d60df1ef02f794476ea1daa6ba024">ZAPI_MESSAGE_METRIC</a>))
    <a class="code" href="stream_8c.html#af366d780a14cb8de53279378a8a4faeb">stream_putl</a> (s, api-&gt;<a class="code" href="structzapi__ipv4.html#a4894d78fb0f8be44470318b265e5a487">metric</a>);

  <span class="comment">/* Put length at the first point of the stream. */</span>
  <a class="code" href="stream_8c.html#a41de70a7383bac6220b787d740c0b261">stream_putw_at</a> (s, 0, <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a> (s));

  <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#ad395166e549bd33dcc253052ac0bbd7d">zclient_send_message</a>(zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9c9eb9a77da6d6a2941954559fde834"></a><!-- doxytag: member="zclient.c::zclient_connect" ref="ab9c9eb9a77da6d6a2941954559fde834" args="(struct thread *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int zclient_connect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00363">363</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structzclient.html">zclient</a> *<a class="code" href="bgp__zebra_8c.html#abe1502972ba9aa40adc080e419c496bf">zclient</a>;

  zclient = <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (t);
  zclient-&gt;<a class="code" href="structzclient.html#acf3591fb899408dc58cfe71cb2035571">t_connect</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient_connect is called&quot;</span>);

  <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a9c8f7389bb01919b00e7f95403a3c112">zclient_start</a> (zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a70fa712bf570d588ea3b3c464bc5156f"></a><!-- doxytag: member="zclient.c::zclient_create_header" ref="a70fa712bf570d588ea3b3c464bc5156f" args="(struct stream *s, uint16_t command)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_create_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00270">270</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">/* length placeholder, caller can update */</span>
  <a class="code" href="stream_8c.html#a03459a9331e0333d2b396636eca3c2e4">stream_putw</a> (s, <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="zebra_8h.html#a95ca8e88db92c66ea0c8bbb62cea622d">ZEBRA_HEADER_MARKER</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="zclient_8h.html#a353879f7a2fe9365a57041c8870e8dec">ZSERV_VERSION</a>);
  <a class="code" href="stream_8c.html#a03459a9331e0333d2b396636eca3c2e4">stream_putw</a> (s, command);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adbcb93080813637b933076a14b5760aa"></a><!-- doxytag: member="zclient.c::zclient_event" ref="adbcb93080813637b933076a14b5760aa" args="(enum event, struct zclient *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void zclient_event </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a> <a class="el" href="vty_8c.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a68e4ea2cd32d468ce2523653f95a7688"></a><!-- doxytag: member="zclient.c::zclient_failed" ref="a68e4ea2cd32d468ce2523653f95a7688" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int zclient_failed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00212">212</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  zclient-&gt;<a class="code" href="structzclient.html#af497cf3a311b3ffc692e874564d99f20">fail</a>++;
  <a class="code" href="zclient_8c.html#a380163204583292d5924050e26a8989d">zclient_stop</a>(zclient);
  <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a>(<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb">ZCLIENT_CONNECT</a>, zclient);
  <span class="keywordflow">return</span> -1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8bf52479ef7bde190fbe66a350089b29"></a><!-- doxytag: member="zclient.c::zclient_flush_data" ref="a8bf52479ef7bde190fbe66a350089b29" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int zclient_flush_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00221">221</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structzclient.html">zclient</a> *<a class="code" href="structzclient.html">zclient</a> = <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a>(thread);

  zclient-&gt;<a class="code" href="structzclient.html#aeac07252bd304a7b2e557fb2d84d7b53">t_write</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &lt; 0)
    <span class="keywordflow">return</span> -1;
  <span class="keywordflow">switch</span> (<a class="code" href="buffer_8c.html#a3df3e577fcbeec460e3ddab6bc6f59ec">buffer_flush_available</a>(zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>))
    {
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a6185688e62ce527910fd779f2093c6f1">BUFFER_ERROR</a>:
      <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a>(<span class="stringliteral">&quot;%s: buffer_flush_available failed on zclient fd %d, closing&quot;</span>,
            __func__, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a6a5c775497aad93877d86b6a334de110">BUFFER_PENDING</a>:
      zclient-&gt;<a class="code" href="structzclient.html#aeac07252bd304a7b2e557fb2d84d7b53">t_write</a> = <a class="code" href="thread_8h.html#a8a2f048ba94722b1e88f08254fbd4444">thread_add_write</a>(<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, <a class="code" href="zclient_8c.html#a8bf52479ef7bde190fbe66a350089b29">zclient_flush_data</a>,
                      zclient, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a78d7168c875c46a0fbb5835cd160e2ba">BUFFER_EMPTY</a>:
      <span class="keywordflow">break</span>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa6b9a9327c5b3842f3a91e0464a4af7a"></a><!-- doxytag: member="zclient.c::zclient_free" ref="aa6b9a9327c5b3842f3a91e0464a4af7a" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00067">67</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>)
    <a class="code" href="stream_8c.html#ac25ca0f9b32a76b4ea34ecb3c9d62481">stream_free</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>)
    <a class="code" href="stream_8c.html#ac25ca0f9b32a76b4ea34ecb3c9d62481">stream_free</a>(zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>);
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a>)
    <a class="code" href="buffer_8c.html#a33630b21db5f9cda080c24c3175bde5a">buffer_free</a>(zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a>);

  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba59512f8d99cdb9b137bc09d8c5b84e2e">MTYPE_ZCLIENT</a>, zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac649a246f405850a3ade72de002745e3"></a><!-- doxytag: member="zclient.c::zclient_init" ref="ac649a246f405850a3ade72de002745e3" args="(struct zclient *zclient, int redist_default)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>redist_default</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00082">82</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  
  <span class="comment">/* Enable zebra client connection by default. */</span>
  zclient-&gt;<a class="code" href="structzclient.html#a7867dfbcd3b504d2edd22f70ef4277b6">enable</a> = 1;

  <span class="comment">/* Set -1 to the default socket value. */</span>
  zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> = -1;

  <span class="comment">/* Clear redistribution flags. */</span>
  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="zebra_8h.html#aec97442680d773fd62f9af5c9426b842">ZEBRA_ROUTE_MAX</a>; i++)
    zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[i] = 0;

  <span class="comment">/* Set unwanted redistribute route.  bgpd does not need BGP route</span>
<span class="comment">     redistribution. */</span>
  zclient-&gt;<a class="code" href="structzclient.html#a7c2ac97dd71c8f3a0db036c6c0216208">redist_default</a> = <a class="code" href="structzclient.html#a7c2ac97dd71c8f3a0db036c6c0216208">redist_default</a>;
  zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[<a class="code" href="structzclient.html#a7c2ac97dd71c8f3a0db036c6c0216208">redist_default</a>] = 1;

  <span class="comment">/* Set default-information redistribute to zero. */</span>
  zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a> = 0;

  <span class="comment">/* Schedule first zclient connection. */</span>
  if (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient start scheduled&quot;</span>);

  <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea826c5318cddea911fefb2c166a4bf509">ZCLIENT_SCHEDULE</a>, zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa521f2a71596b1dc50f76fcb57dff30b"></a><!-- doxytag: member="zclient.c::zclient_new" ref="aa521f2a71596b1dc50f76fcb57dff30b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structzclient.html">zclient</a>* zclient_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00049">49</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structzclient.html">zclient</a> *<a class="code" href="bgp__zebra_8c.html#abe1502972ba9aa40adc080e419c496bf">zclient</a>;
  zclient = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba59512f8d99cdb9b137bc09d8c5b84e2e">MTYPE_ZCLIENT</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> zclient));

  zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a> = <a class="code" href="stream_8c.html#a7117cdad9fa5e5ae633e0cf08d047459">stream_new</a> (<a class="code" href="zclient_8h.html#aeebd7bc37965845d7accd7ce370febf9">ZEBRA_MAX_PACKET_SIZ</a>);
  zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a> = <a class="code" href="stream_8c.html#a7117cdad9fa5e5ae633e0cf08d047459">stream_new</a> (<a class="code" href="zclient_8h.html#aeebd7bc37965845d7accd7ce370febf9">ZEBRA_MAX_PACKET_SIZ</a>);
  zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a> = <a class="code" href="buffer_8c.html#a277b94d1c81d4e5ac2e5c59ede1abed9">buffer_new</a>(0);

  <span class="keywordflow">return</span> <a class="code" href="bgp__zebra_8c.html#abe1502972ba9aa40adc080e419c496bf">zclient</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8b69581b6d74a357de6053a2a26f8372"></a><!-- doxytag: member="zclient.c::zclient_read" ref="a8b69581b6d74a357de6053a2a26f8372" args="(struct thread *thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int zclient_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthread.html">thread</a> *&#160;</td>
          <td class="paramname"><em>thread</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00797">797</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ret;
  <span class="keywordtype">size_t</span> already;
  uint16_t <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>, command;
  uint8_t marker, <a class="code" href="isis__pdu_8h.html#ac477ee30f0ed8c0b09a6f3387287191f">version</a>;
  <span class="keyword">struct </span><a class="code" href="structzclient.html">zclient</a> *<a class="code" href="bgp__zebra_8c.html#abe1502972ba9aa40adc080e419c496bf">zclient</a>;

  <span class="comment">/* Get socket to zebra. */</span>
  zclient = <a class="code" href="thread_8h.html#a78f2ae47a7a334f7f74bfed7fda48e5a">THREAD_ARG</a> (thread);
  zclient-&gt;<a class="code" href="structzclient.html#a50e437ba261d04154d21f0411bad12b0">t_read</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* Read zebra header (if we don&#39;t have it already). */</span>
  <span class="keywordflow">if</span> ((already = <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>)) &lt; <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>)
    {
      ssize_t nbyte;
      <span class="keywordflow">if</span> (((nbyte = <a class="code" href="stream_8c.html#a9505861c61983da4470a3689cfb994dd">stream_read_try</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>,
                     <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>-already)) == 0) ||
      (nbyte == -1))
    {
      <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
       <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient connection closed socket [%d].&quot;</span>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
    }
      <span class="keywordflow">if</span> (nbyte != (ssize_t)(<a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>-already))
    {
      <span class="comment">/* Try again later. */</span>
      <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, zclient);
      <span class="keywordflow">return</span> 0;
    }
      already = <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>;
    }

  <span class="comment">/* Reset to read from the beginning of the incoming packet. */</span>
  <a class="code" href="stream_8c.html#a5506a87bd79df66accb6ad8fbbd5857c">stream_set_getp</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>, 0);

  <span class="comment">/* Fetch header values. */</span>
  length = <a class="code" href="stream_8c.html#a66155fa63acd1f377a5b9e98aba7b888">stream_getw</a> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  marker = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  version = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  command = <a class="code" href="stream_8c.html#a66155fa63acd1f377a5b9e98aba7b888">stream_getw</a> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  
  <span class="keywordflow">if</span> (marker != <a class="code" href="zebra_8h.html#a95ca8e88db92c66ea0c8bbb62cea622d">ZEBRA_HEADER_MARKER</a> || version != <a class="code" href="zclient_8h.html#a353879f7a2fe9365a57041c8870e8dec">ZSERV_VERSION</a>)
    {
      <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a>(<span class="stringliteral">&quot;%s: socket %d version mismatch, marker %d, version %d&quot;</span>,
               __func__, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>, marker, version);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
    }
  
  <span class="keywordflow">if</span> (length &lt; <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>) 
    {
      <a class="code" href="log_8h.html#aaf50b52a949696adb9e77153b08545ad">zlog_err</a>(<span class="stringliteral">&quot;%s: socket %d message length %u is less than %d &quot;</span>,
           __func__, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>, length, <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
    }

  <span class="comment">/* Length check. */</span>
  <span class="keywordflow">if</span> (length &gt; <a class="code" href="stream_8h.html#a6e3b6e25ed5cfa2faea8485414a0c1a4">STREAM_SIZE</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>))
    {
      <span class="keyword">struct </span><a class="code" href="structstream.html">stream</a> *ns;
      <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a>(<span class="stringliteral">&quot;%s: message size %u exceeds buffer size %lu, expanding...&quot;</span>,
            __func__, length, (u_long)<a class="code" href="stream_8h.html#a6e3b6e25ed5cfa2faea8485414a0c1a4">STREAM_SIZE</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>));
      ns = <a class="code" href="stream_8c.html#a7117cdad9fa5e5ae633e0cf08d047459">stream_new</a>(length);
      <a class="code" href="stream_8c.html#a53dd7429b44228c374706fdc5e35c6ae">stream_copy</a>(ns, zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
      <a class="code" href="stream_8c.html#ac25ca0f9b32a76b4ea34ecb3c9d62481">stream_free</a> (zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
      zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a> = ns;
    }

  <span class="comment">/* Read rest of zebra packet. */</span>
  <span class="keywordflow">if</span> (already &lt; length)
    {
      ssize_t nbyte;
      <span class="keywordflow">if</span> (((nbyte = <a class="code" href="stream_8c.html#a9505861c61983da4470a3689cfb994dd">stream_read_try</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>,
                     length-already)) == 0) ||
      (nbyte == -1))
    {
      <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
        <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a>(<span class="stringliteral">&quot;zclient connection closed socket [%d].&quot;</span>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
    }
      <span class="keywordflow">if</span> (nbyte != (ssize_t)(length-already))
    {
      <span class="comment">/* Try again later. */</span>
      <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, zclient);
      <span class="keywordflow">return</span> 0;
    }
    }

  length -= <a class="code" href="zclient_8h.html#a31ddba642897aac3d80c91cdfdb5deb1">ZEBRA_HEADER_SIZE</a>;

  <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a>(<span class="stringliteral">&quot;zclient 0x%p command 0x%x \n&quot;</span>, zclient, command);

  <span class="keywordflow">switch</span> (command)
    {
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#ab336e7f6f414c6b3fa62531d2912af48">ZEBRA_ROUTER_ID_UPDATE</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a91ae88d0aa9ff087af5b7567334197f6">router_id_update</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a91ae88d0aa9ff087af5b7567334197f6">router_id_update</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#af23bf4b28d6d856ed43995d31c253119">ZEBRA_INTERFACE_ADD</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a42e63c358fc87552ca16a1eea8b69c4f">interface_add</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a42e63c358fc87552ca16a1eea8b69c4f">interface_add</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#aa7ee6fa3df5b16d052e27ff18ae4ac39">ZEBRA_INTERFACE_DELETE</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a59d608db28363c236285c6323d5697ab">interface_delete</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a59d608db28363c236285c6323d5697ab">interface_delete</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#aea532f1b7734390e98af1be9c18b0964">ZEBRA_INTERFACE_ADDRESS_ADD</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a75ee908bb229653f271356b982fa76e7">interface_address_add</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a75ee908bb229653f271356b982fa76e7">interface_address_add</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#a8965100a302cd587b7afa842473c8be2">ZEBRA_INTERFACE_ADDRESS_DELETE</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a3494b722f85fe14ff8c99ddae54bad94">interface_address_delete</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a3494b722f85fe14ff8c99ddae54bad94">interface_address_delete</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#a4eeb48b035d0448e843e5a8370439081">ZEBRA_INTERFACE_UP</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a45465702e655472187e9efc3c1734daa">interface_up</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a45465702e655472187e9efc3c1734daa">interface_up</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#a5c5043b21f4e172630cde3f025734a66">ZEBRA_INTERFACE_DOWN</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a426b5e0ec3b5ad8843eb42deaa4fe335">interface_down</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a426b5e0ec3b5ad8843eb42deaa4fe335">interface_down</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#aa2913a6b1e5fbc598479aa282343a5e1">ZEBRA_IPV4_ROUTE_ADD</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#ac2fe2ea5a7f820e1ac572f7629be997f">ipv4_route_add</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#ac2fe2ea5a7f820e1ac572f7629be997f">ipv4_route_add</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#a0c9efcc3f61219a6697f5da18d8de992">ZEBRA_IPV4_ROUTE_DELETE</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a2fa1fdde8885665490f46edc8c102d4a">ipv4_route_delete</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a2fa1fdde8885665490f46edc8c102d4a">ipv4_route_delete</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#a2d0f19502bde040501c7ad64bc955739">ZEBRA_IPV6_ROUTE_ADD</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a9d185464cca684ac3d024ec4be7b9881">ipv6_route_add</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a9d185464cca684ac3d024ec4be7b9881">ipv6_route_add</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="zebra_8h.html#ad98414d027f7107e91cb040a329ad48a">ZEBRA_IPV6_ROUTE_DELETE</a>:
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a86d1ece8718111eee4bdd79ca320e8ea">ipv6_route_delete</a>)
    ret = (*zclient-&gt;<a class="code" href="structzclient.html#a86d1ece8718111eee4bdd79ca320e8ea">ipv6_route_delete</a>) (command, zclient, length);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">default</span>:
      <span class="keywordflow">break</span>;
    }

  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &lt; 0)
    <span class="comment">/* Connection was closed during packet processing. */</span>
    <span class="keywordflow">return</span> -1;

  <span class="comment">/* Register read thread. */</span>
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, zclient);

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4381afa78256a1211fe7881394d7e666"></a><!-- doxytag: member="zclient.c::zclient_redistribute" ref="a4381afa78256a1211fe7881394d7e666" args="(int command, struct zclient *zclient, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_redistribute </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00952">952</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> (command == <a class="code" href="zebra_8h.html#aaf00306d6060095dd258463ee7cb0cc1">ZEBRA_REDISTRIBUTE_ADD</a>) 
    {
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>])
         <span class="keywordflow">return</span>;
      zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>] = 1;
    }
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">if</span> (!zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>])
         <span class="keywordflow">return</span>;
      zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>] = 0;
    }

  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &gt; 0)
    <a class="code" href="zclient_8c.html#a0ed1704cde688d0575a1394a34f6fc82">zebra_redistribute_send</a> (command, zclient, <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2d2c4a009144e592b06b55055ab9c38e"></a><!-- doxytag: member="zclient.c::zclient_redistribute_default" ref="a2d2c4a009144e592b06b55055ab9c38e" args="(int command, struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_redistribute_default </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00974">974</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> (command == <a class="code" href="zebra_8h.html#a6a54e4c8e5f637b9edb208de808a2ac6">ZEBRA_REDISTRIBUTE_DEFAULT_ADD</a>)
    {
      <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a>)
        <span class="keywordflow">return</span>;
      zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a> = 1;
    }
  <span class="keywordflow">else</span> 
    {
      <span class="keywordflow">if</span> (!zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a>)
        <span class="keywordflow">return</span>;
      zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a> = 0;
    }

  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &gt; 0)
    <a class="code" href="zclient_8c.html#adab3e03d8c0c0ecb6a1fa2e4d2068054">zebra_message_send</a> (zclient, command);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad002f3a9a797ab41ed60505ed5007ae7"></a><!-- doxytag: member="zclient.c::zclient_reset" ref="ad002f3a9a797ab41ed60505ed5007ae7" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00140">140</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="zclient_8c.html#a380163204583292d5924050e26a8989d">zclient_stop</a> (zclient);
  <a class="code" href="zclient_8c.html#ac649a246f405850a3ade72de002745e3">zclient_init</a> (zclient, zclient-&gt;<a class="code" href="structzclient.html#a7c2ac97dd71c8f3a0db036c6c0216208">redist_default</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad395166e549bd33dcc253052ac0bbd7d"></a><!-- doxytag: member="zclient.c::zclient_send_message" ref="ad395166e549bd33dcc253052ac0bbd7d" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zclient_send_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00246">246</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &lt; 0)
    <span class="keywordflow">return</span> -1;
  <span class="keywordflow">switch</span> (<a class="code" href="buffer_8c.html#a426b697edda52bb07fdf222e8b982e9d">buffer_write</a>(zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>, <a class="code" href="stream_8h.html#afde5f5db208a43da6faf7b830f26d7fc">STREAM_DATA</a>(zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>),
               <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a>(zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>)))
    {
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a6185688e62ce527910fd779f2093c6f1">BUFFER_ERROR</a>:
      <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a>(<span class="stringliteral">&quot;%s: buffer_write failed to zclient fd %d, closing&quot;</span>,
             __func__, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#a68e4ea2cd32d468ce2523653f95a7688">zclient_failed</a>(zclient);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a78d7168c875c46a0fbb5835cd160e2ba">BUFFER_EMPTY</a>:
      <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a>(zclient-&gt;<a class="code" href="structzclient.html#aeac07252bd304a7b2e557fb2d84d7b53">t_write</a>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="buffer_8h.html#a11b72623a9601834584c5ecf08dd6e27a6a5c775497aad93877d86b6a334de110">BUFFER_PENDING</a>:
      <a class="code" href="thread_8h.html#ad563eafaebb935e4371f38e37ca33b00">THREAD_WRITE_ON</a>(<a class="code" href="bgp__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a>, zclient-&gt;<a class="code" href="structzclient.html#aeac07252bd304a7b2e557fb2d84d7b53">t_write</a>,
              <a class="code" href="zclient_8c.html#a8bf52479ef7bde190fbe66a350089b29">zclient_flush_data</a>, zclient, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      <span class="keywordflow">break</span>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac937966a23dbff10b311175341da2d57"></a><!-- doxytag: member="zclient.c::zclient_socket" ref="ac937966a23dbff10b311175341da2d57" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zclient_socket </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00148">148</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> sock;
  <span class="keywordtype">int</span> ret;
  <span class="keyword">struct </span>sockaddr_in serv;

  <span class="comment">/* We should think about IPv6 connection. */</span>
  sock = socket (AF_INET, SOCK_STREAM, 0);
  <span class="keywordflow">if</span> (sock &lt; 0)
    <span class="keywordflow">return</span> -1;
  
  <span class="comment">/* Make server socket. */</span> 
  memset (&amp;serv, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_in));
  serv.sin_family = AF_INET;
  serv.sin_port = htons (<a class="code" href="zebra_8h.html#afa19cc8f215eef54b36bea13a690cafe">ZEBRA_PORT</a>);
<span class="preprocessor">#ifdef HAVE_STRUCT_SOCKADDR_IN_SIN_LEN</span>
<span class="preprocessor"></span>  serv.sin_len = <span class="keyword">sizeof</span> (<span class="keyword">struct </span>sockaddr_in);
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_STRUCT_SOCKADDR_IN_SIN_LEN */</span>
  serv.sin_addr.s_addr = htonl (<a class="code" href="zebra_8h.html#ae1ac25d7797666cff6d01d6c795c2378">INADDR_LOOPBACK</a>);

  <span class="comment">/* Connect to zebra. */</span>
  ret = connect (sock, (<span class="keyword">struct</span> sockaddr *) &amp;serv, <span class="keyword">sizeof</span> (serv));
  <span class="keywordflow">if</span> (ret &lt; 0)
    {
      close (sock);
      <span class="keywordflow">return</span> -1;
    }
  <span class="keywordflow">return</span> sock;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1a87f3eaa2f08161b64feebfda6bf3fd"></a><!-- doxytag: member="zclient.c::zclient_socket_un" ref="a1a87f3eaa2f08161b64feebfda6bf3fd" args="(const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zclient_socket_un </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00182">182</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ret;
  <span class="keywordtype">int</span> sock, len;
  <span class="keyword">struct </span>sockaddr_un addr;

  sock = socket (AF_UNIX, SOCK_STREAM, 0);
  <span class="keywordflow">if</span> (sock &lt; 0)
    <span class="keywordflow">return</span> -1;
  
  <span class="comment">/* Make server socket. */</span> 
  memset (&amp;addr, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr_un));
  addr.sun_family = AF_UNIX;
  strncpy (addr.sun_path, path, strlen (path));
<span class="preprocessor">#ifdef HAVE_STRUCT_SOCKADDR_UN_SUN_LEN</span>
<span class="preprocessor"></span>  len = addr.sun_len = SUN_LEN(&amp;addr);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  len = <span class="keyword">sizeof</span> (addr.sun_family) + strlen (addr.sun_path);
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_STRUCT_SOCKADDR_UN_SUN_LEN */</span>

  ret = connect (sock, (<span class="keyword">struct</span> sockaddr *) &amp;addr, len);
  <span class="keywordflow">if</span> (ret &lt; 0)
    {
      close (sock);
      <span class="keywordflow">return</span> -1;
    }
  <span class="keywordflow">return</span> sock;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9c8f7389bb01919b00e7f95403a3c112"></a><!-- doxytag: member="zclient.c::zclient_start" ref="a9c8f7389bb01919b00e7f95403a3c112" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zclient_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00297">297</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient_start is called&quot;</span>);

  <span class="comment">/* zclient is disabled. */</span>
  <span class="keywordflow">if</span> (! zclient-&gt;<a class="code" href="structzclient.html#a7867dfbcd3b504d2edd22f70ef4277b6">enable</a>)
    <span class="keywordflow">return</span> 0;

  <span class="comment">/* If already connected to the zebra. */</span>
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &gt;= 0)
    <span class="keywordflow">return</span> 0;

  <span class="comment">/* Check connect thread. */</span>
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#acf3591fb899408dc58cfe71cb2035571">t_connect</a>)
    <span class="keywordflow">return</span> 0;

  <span class="comment">/* Make socket. */</span>
<span class="preprocessor">#ifdef HAVE_TCP_ZEBRA</span>
<span class="preprocessor"></span>  zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> = <a class="code" href="zclient_8c.html#ac937966a23dbff10b311175341da2d57">zclient_socket</a> ();
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> = <a class="code" href="zclient_8c.html#a1a87f3eaa2f08161b64feebfda6bf3fd">zclient_socket_un</a> (ZEBRA_SERV_PATH);
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_TCP_ZEBRA */</span>
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &lt; 0)
    {
      <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient connection fail&quot;</span>);
      zclient-&gt;<a class="code" href="structzclient.html#af497cf3a311b3ffc692e874564d99f20">fail</a>++;
      <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9ea82cf139bec91c753aa00f8861f9d7dcb">ZCLIENT_CONNECT</a>, zclient);
      <span class="keywordflow">return</span> -1;
    }

  <span class="keywordflow">if</span> (<a class="code" href="network_8c.html#a450a9be7be692d8ac42f64acddbdaadd">set_nonblocking</a>(zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>) &lt; 0)
    <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a>(<span class="stringliteral">&quot;%s: set_nonblocking(%d) failed&quot;</span>, __func__, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);

  <span class="comment">/* Clear fail count. */</span>
  zclient-&gt;<a class="code" href="structzclient.html#af497cf3a311b3ffc692e874564d99f20">fail</a> = 0;
  <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient connect success with socket [%d]&quot;</span>, zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      
  <span class="comment">/* Create read thread. */</span>
  <a class="code" href="zclient_8c.html#adbcb93080813637b933076a14b5760aa">zclient_event</a> (<a class="code" href="zclient_8c.html#a3b65133bb9997cd1ccf311af0927fc9eab19700a6d070e3835e08add96a1cb3b9">ZCLIENT_READ</a>, zclient);

  <span class="comment">/* We need interface information. */</span>
  <a class="code" href="zclient_8c.html#adab3e03d8c0c0ecb6a1fa2e4d2068054">zebra_message_send</a> (zclient, <a class="code" href="zebra_8h.html#af23bf4b28d6d856ed43995d31c253119">ZEBRA_INTERFACE_ADD</a>);

  <span class="comment">/* We need router-id information. */</span>
  <a class="code" href="zclient_8c.html#adab3e03d8c0c0ecb6a1fa2e4d2068054">zebra_message_send</a> (zclient, <a class="code" href="zebra_8h.html#a7fe5b4bfc1b5074695d98c043a521a16">ZEBRA_ROUTER_ID_ADD</a>);

  <span class="comment">/* Flush all redistribute request. */</span>
  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="zebra_8h.html#aec97442680d773fd62f9af5c9426b842">ZEBRA_ROUTE_MAX</a>; i++)
    <span class="keywordflow">if</span> (i != zclient-&gt;<a class="code" href="structzclient.html#a7c2ac97dd71c8f3a0db036c6c0216208">redist_default</a> &amp;&amp; zclient-&gt;<a class="code" href="structzclient.html#a7c76c66fcb4fee1303f834ea9fea0fc5">redist</a>[i])
      <a class="code" href="zclient_8c.html#a0ed1704cde688d0575a1394a34f6fc82">zebra_redistribute_send</a> (<a class="code" href="zebra_8h.html#aaf00306d6060095dd258463ee7cb0cc1">ZEBRA_REDISTRIBUTE_ADD</a>, zclient, i);

  <span class="comment">/* If default information is needed. */</span>
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a9d77c71b907f0f130f467edaefed93e9">default_information</a>)
    <a class="code" href="zclient_8c.html#adab3e03d8c0c0ecb6a1fa2e4d2068054">zebra_message_send</a> (zclient, <a class="code" href="zebra_8h.html#a6a54e4c8e5f637b9edb208de808a2ac6">ZEBRA_REDISTRIBUTE_DEFAULT_ADD</a>);

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a380163204583292d5924050e26a8989d"></a><!-- doxytag: member="zclient.c::zclient_stop" ref="a380163204583292d5924050e26a8989d" args="(struct zclient *zclient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zclient_stop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00113">113</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a>)
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;zclient stopped&quot;</span>);

  <span class="comment">/* Stop threads. */</span>
  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a>(zclient-&gt;<a class="code" href="structzclient.html#a50e437ba261d04154d21f0411bad12b0">t_read</a>);
  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a>(zclient-&gt;<a class="code" href="structzclient.html#acf3591fb899408dc58cfe71cb2035571">t_connect</a>);
  <a class="code" href="thread_8h.html#a7e1de4fc338e4feae498978461742dbb">THREAD_OFF</a>(zclient-&gt;<a class="code" href="structzclient.html#aeac07252bd304a7b2e557fb2d84d7b53">t_write</a>);

  <span class="comment">/* Reset streams. */</span>
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a>(zclient-&gt;<a class="code" href="structzclient.html#a1b9d2a1e869c1008c2bc70d14ce2bf49">ibuf</a>);
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a>(zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>);

  <span class="comment">/* Empty the write buffer. */</span>
  <a class="code" href="buffer_8c.html#a91ad0ff694ccef1876a3e8d8a3b05ffa">buffer_reset</a>(zclient-&gt;<a class="code" href="structzclient.html#a7d80b83ca9d6306e93880e228c53e99f">wb</a>);

  <span class="comment">/* Close socket. */</span>
  <span class="keywordflow">if</span> (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> &gt;= 0)
    {
      close (zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a>);
      zclient-&gt;<a class="code" href="structzclient.html#a53dfb4d4cfc1331edf8a62d04d99f08f">sock</a> = -1;
    }
  zclient-&gt;<a class="code" href="structzclient.html#af497cf3a311b3ffc692e874564d99f20">fail</a> = 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af2dbed49848c57eaae1185751ec18648"></a><!-- doxytag: member="zclient.c::zebra_interface_add_read" ref="af2dbed49848c57eaae1185751ec18648" args="(struct stream *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structinterface.html">interface</a>* zebra_interface_add_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00603">603</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structinterface.html">interface</a> *ifp;
  <span class="keywordtype">char</span> ifname_tmp[<a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>];

  <span class="comment">/* Read interface name. */</span>
  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (ifname_tmp, s, <a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>);

  <span class="comment">/* Lookup/create interface by name. */</span>
  ifp = <a class="code" href="if_8c.html#a18fa51c3b90a3afa1f564e85a2f4c62b">if_get_by_name_len</a> (ifname_tmp, <a class="code" href="str_8c.html#afc92d2231e45d19988c7894aa2a07f0c">strnlen</a>(ifname_tmp, <a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>));

  <span class="comment">/* Read interface&#39;s index. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);

  <span class="comment">/* Read interface&#39;s value. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#ae145c01f63b3abaca8e3805f9e396c4a">status</a> = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a09ed96b900f31d769a76a32b67217c8f">flags</a> = <a class="code" href="stream_8c.html#ac5102255e13d4a706f4136b82609987d">stream_getq</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#adbb7ad89b817a388e9442e85f1e72cc8">metric</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#aadd24df2d261a3bfcbdfe4797e639afb">mtu</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a75a892a4df0f60191a13ca07b6625cb1">mtu6</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a324b6a80459775b1e5e254369649e075">bandwidth</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
<span class="preprocessor">#ifdef HAVE_STRUCT_SOCKADDR_DL</span>
<span class="preprocessor"></span>  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (&amp;ifp-&gt;sdl, s, sizeof (ifp-&gt;sdl));
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  ifp-&gt;<a class="code" href="structinterface.html#a6521c9be15367445abca01bbba9c2cb4">hw_addr_len</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  <span class="keywordflow">if</span> (ifp-&gt;<a class="code" href="structinterface.html#a6521c9be15367445abca01bbba9c2cb4">hw_addr_len</a>)
    <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (ifp-&gt;<a class="code" href="structinterface.html#a6fe2f3c7e5be26c4e376b514d86f5c22">hw_addr</a>, s, ifp-&gt;<a class="code" href="structinterface.html#a6521c9be15367445abca01bbba9c2cb4">hw_addr_len</a>);
<span class="preprocessor">#endif </span><span class="comment">/* HAVE_STRUCT_SOCKADDR_DL */</span>
  
  <span class="keywordflow">return</span> ifp;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a361d54ec3dad267afc3335fe155367a2"></a><!-- doxytag: member="zclient.c::zebra_interface_address_read" ref="a361d54ec3dad267afc3335fe155367a2" args="(int type, struct stream *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structconnected.html">connected</a>* zebra_interface_address_read </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00732">732</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a>;
  <span class="keyword">struct </span><a class="code" href="structinterface.html">interface</a> *ifp;
  <span class="keyword">struct </span><a class="code" href="structconnected.html">connected</a> *ifc;
  <span class="keyword">struct </span><a class="code" href="structprefix.html">prefix</a> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>, d;
  <span class="keywordtype">int</span> <a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a>;
  <span class="keywordtype">int</span> plen;
  u_char ifc_flags;

  memset (&amp;<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>));
  memset (&amp;d, 0, <span class="keyword">sizeof</span>(d));

  <span class="comment">/* Get interface index. */</span>
  ifindex = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);

  <span class="comment">/* Lookup index. */</span>
  ifp = <a class="code" href="if_8c.html#a424dd1e971aee548383cca2b770e2859">if_lookup_by_index</a> (ifindex);
  <span class="keywordflow">if</span> (ifp == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;zebra_interface_address_read(%s): &quot;</span>
                 <span class="stringliteral">&quot;Can&#39;t find interface by ifindex: %d &quot;</span>,
                 (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> == <a class="code" href="zebra_8h.html#aea532f1b7734390e98af1be9c18b0964">ZEBRA_INTERFACE_ADDRESS_ADD</a>? <span class="stringliteral">&quot;ADD&quot;</span> : <span class="stringliteral">&quot;DELETE&quot;</span>),
                 ifindex);
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }

  <span class="comment">/* Fetch flag. */</span>
  ifc_flags = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);

  <span class="comment">/* Fetch interface address. */</span>
  family = <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>.family = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);

  plen = <a class="code" href="prefix_8c.html#ad076653f7c139acd0fdedb511542e915">prefix_blen</a> (&amp;<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>);
  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (&amp;<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>.u.prefix, s, plen);
  <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>.prefixlen = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);

  <span class="comment">/* Fetch destination address. */</span>
  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (&amp;d.u.prefix, s, plen);
  d.family = <a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a>;

  <span class="keywordflow">if</span> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> == <a class="code" href="zebra_8h.html#aea532f1b7734390e98af1be9c18b0964">ZEBRA_INTERFACE_ADDRESS_ADD</a>) 
    {
       <span class="comment">/* N.B. NULL destination pointers are encoded as all zeroes */</span>
       ifc = <a class="code" href="if_8c.html#ae243c0b66d0c529a2ad22d1442457c2e">connected_add_by_prefix</a>(ifp, &amp;<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>,(<a class="code" href="zclient_8c.html#a743e58b2aba73769d940cbb0f2e95b6f">memconstant</a>(&amp;d.u.prefix,0,plen) ?
                          <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> : &amp;d));
       <span class="keywordflow">if</span> (ifc != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
     {
       ifc-&gt;<a class="code" href="structconnected.html#a5928e0378e95d422553fdd37c3d66519">flags</a> = ifc_flags;
       <span class="keywordflow">if</span> (ifc-&gt;<a class="code" href="structconnected.html#ad13a382a19c45aaa4e5670e1422245ff">destination</a>)
         ifc-&gt;<a class="code" href="structconnected.html#ad13a382a19c45aaa4e5670e1422245ff">destination</a>-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> = ifc-&gt;<a class="code" href="structconnected.html#a288d9248b21b8e3999e03ceaa9bb70db">address</a>-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a>;
     }
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> == <a class="code" href="zebra_8h.html#a8965100a302cd587b7afa842473c8be2">ZEBRA_INTERFACE_ADDRESS_DELETE</a>);
      ifc = <a class="code" href="if_8c.html#a05a2b59bad209d6a820026d73c29de8e">connected_delete_by_prefix</a>(ifp, &amp;<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>);
    }

  <span class="keywordflow">return</span> ifc;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2366afba487613909591ecadd8985f1a"></a><!-- doxytag: member="zclient.c::zebra_interface_if_set_value" ref="a2366afba487613909591ecadd8985f1a" args="(struct stream *s, struct interface *ifp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zebra_interface_if_set_value </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structinterface.html">interface</a> *&#160;</td>
          <td class="paramname"><em>ifp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00706">706</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">/* Read interface&#39;s index. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#ae145c01f63b3abaca8e3805f9e396c4a">status</a> = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);

  <span class="comment">/* Read interface&#39;s value. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#a09ed96b900f31d769a76a32b67217c8f">flags</a> = <a class="code" href="stream_8c.html#ac5102255e13d4a706f4136b82609987d">stream_getq</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#adbb7ad89b817a388e9442e85f1e72cc8">metric</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#aadd24df2d261a3bfcbdfe4797e639afb">mtu</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a75a892a4df0f60191a13ca07b6625cb1">mtu6</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a324b6a80459775b1e5e254369649e075">bandwidth</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a989f3e044d41b4e18463027a94b846e7"></a><!-- doxytag: member="zclient.c::zebra_interface_state_read" ref="a989f3e044d41b4e18463027a94b846e7" args="(struct stream *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structinterface.html">interface</a>* zebra_interface_state_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00643">643</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structinterface.html">interface</a> *ifp;
  <span class="keywordtype">char</span> ifname_tmp[<a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>];

  <span class="comment">/* Read interface name. */</span>
  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (ifname_tmp, s, <a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>);

  <span class="comment">/* Lookup this by interface index. */</span>
  ifp = <a class="code" href="if_8c.html#a8ae0929167c87a44b1933994a0254d29">if_lookup_by_name_len</a> (ifname_tmp,
                   <a class="code" href="str_8c.html#afc92d2231e45d19988c7894aa2a07f0c">strnlen</a>(ifname_tmp, <a class="code" href="if_8h.html#ab819b6f1f4d393be3e866af97297b9cb">INTERFACE_NAMSIZ</a>));

  <span class="comment">/* If such interface does not exist, indicate an error */</span>
  <span class="keywordflow">if</span> (! ifp)
     <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* Read interface&#39;s index. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#ae4c4a0eca6642e37e29e1177a39872ea">ifindex</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);

  <span class="comment">/* Read interface&#39;s value. */</span>
  ifp-&gt;<a class="code" href="structinterface.html#ae145c01f63b3abaca8e3805f9e396c4a">status</a> = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a09ed96b900f31d769a76a32b67217c8f">flags</a> = <a class="code" href="stream_8c.html#ac5102255e13d4a706f4136b82609987d">stream_getq</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#adbb7ad89b817a388e9442e85f1e72cc8">metric</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#aadd24df2d261a3bfcbdfe4797e639afb">mtu</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a75a892a4df0f60191a13ca07b6625cb1">mtu6</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);
  ifp-&gt;<a class="code" href="structinterface.html#a324b6a80459775b1e5e254369649e075">bandwidth</a> = <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s);

  <span class="keywordflow">return</span> ifp;
}
</pre></div>
</div>
</div>
<a class="anchor" id="adab3e03d8c0c0ecb6a1fa2e4d2068054"></a><!-- doxytag: member="zclient.c::zebra_message_send" ref="adab3e03d8c0c0ecb6a1fa2e4d2068054" args="(struct zclient *zclient, int command)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int zebra_message_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00281">281</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structstream.html">stream</a> *<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>;

  <span class="comment">/* Get zclient output buffer. */</span>
  s = zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>;
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a> (s);

  <span class="comment">/* Send very simple command only Zebra message. */</span>
  <a class="code" href="zclient_8c.html#a70fa712bf570d588ea3b3c464bc5156f">zclient_create_header</a> (s, command);
  
  <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#ad395166e549bd33dcc253052ac0bbd7d">zclient_send_message</a>(zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0ed1704cde688d0575a1394a34f6fc82"></a><!-- doxytag: member="zclient.c::zebra_redistribute_send" ref="a0ed1704cde688d0575a1394a34f6fc82" args="(int command, struct zclient *zclient, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zebra_redistribute_send </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structzclient.html">zclient</a> *&#160;</td>
          <td class="paramname"><em>zclient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00541">541</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structstream.html">stream</a> *<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>;

  s = zclient-&gt;<a class="code" href="structzclient.html#a6ad60dd1b329d25af807f1517634b71f">obuf</a>;
  <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a>(s);
  
  <a class="code" href="zclient_8c.html#a70fa712bf570d588ea3b3c464bc5156f">zclient_create_header</a> (s, command);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>);
  
  <a class="code" href="stream_8c.html#a41de70a7383bac6220b787d740c0b261">stream_putw_at</a> (s, 0, <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a> (s));
  
  <span class="keywordflow">return</span> <a class="code" href="zclient_8c.html#ad395166e549bd33dcc253052ac0bbd7d">zclient_send_message</a>(zclient);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6adcd87e46d205582c81673f669067f3"></a><!-- doxytag: member="zclient.c::zebra_router_id_update_read" ref="a6adcd87e46d205582c81673f669067f3" args="(struct stream *s, struct prefix *rid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zebra_router_id_update_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structprefix.html">prefix</a> *&#160;</td>
          <td class="paramname"><em>rid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00558">558</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> plen;

  <span class="comment">/* Fetch interface address. */</span>
  rid-&gt;<a class="code" href="structprefix.html#a3848d44348192dc4de7ac89e317399bd">family</a> = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);

  plen = <a class="code" href="prefix_8c.html#ad076653f7c139acd0fdedb511542e915">prefix_blen</a> (rid);
  <a class="code" href="stream_8c.html#ab7101e57ef0d9dc1a33e7f7e30c91b9a">stream_get</a> (&amp;rid-&gt;u.<a class="code" href="structprefix.html#af508982a05429729278c96708bd9e337">prefix</a>, s, plen);
  rid-&gt;<a class="code" href="structprefix.html#aae8dafba4797d25cf1d141780d87ff02">prefixlen</a> = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af7f9077bc08df049beb65a1c09cde5fa"></a><!-- doxytag: member="zclient.c::master" ref="af7f9077bc08df049beb65a1c09cde5fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structthread__master.html">thread_master</a>* <a class="el" href="test__main_8c.html#af7f9077bc08df049beb65a1c09cde5fa">master</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__main_8c_source.html#l00105">105</a> of file <a class="el" href="bgp__main_8c_source.html">bgp_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="adee5d865f1f9404997069b6bda13bda8"></a><!-- doxytag: member="zclient.c::zclient_debug" ref="adee5d865f1f9404997069b6bda13bda8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="zclient_8c.html#adee5d865f1f9404997069b6bda13bda8">zclient_debug</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="zclient_8c_source.html#l00045">45</a> of file <a class="el" href="zclient_8c_source.html">zclient.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="zclient_8c.html">zclient.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:25 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
