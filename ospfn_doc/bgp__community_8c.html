<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: bgpd/bgp_community.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('bgp__community_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bgpd/bgp_community.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="zebra_8h_source.html">zebra.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="hash_8h_source.html">hash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bgp__community_8h_source.html">bgpd/bgp_community.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bgp_community.c:</div>
<div class="dyncontent">
<div class="center"><img src="bgp__community_8c__incl.png" border="0" usemap="#bgpd_2bgp__community_8c" alt=""/></div>
<map name="bgpd_2bgp__community_8c" id="bgpd_2bgp__community_8c">
<area shape="rect" id="node3" href="zebra_8h.html" title="zebra.h" alt="" coords="1345,80,1412,107"/><area shape="rect" id="node61" href="hash_8h.html" title="hash.h" alt="" coords="2105,80,2167,107"/><area shape="rect" id="node63" href="memory_8h.html" title="memory.h" alt="" coords="2191,80,2273,107"/><area shape="rect" id="node67" href="bgp__community_8h.html" title="bgpd/bgp_community.h" alt="" coords="2297,80,2463,107"/><area shape="rect" id="node57" href="zassert_8h.html" title="zassert.h" alt="" coords="2669,155,2747,181"/><area shape="rect" id="node59" href="str_8h.html" title="str.h" alt="" coords="2771,155,2820,181"/><area shape="rect" id="node65" href="memtypes_8h.html" title="lib/memtypes.h" alt="" coords="2845,155,2960,181"/></map>
</div>
</div>
<p><a href="bgp__community_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6">community_token</a> { <br/>
&#160;&#160;<a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876">community_token_val</a>, 
<a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f">community_token_no_export</a>, 
<a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d">community_token_no_advertise</a>, 
<a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338">community_token_local_as</a>, 
<br/>
&#160;&#160;<a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#af4553289199b5f1c2089e4d95c570148">community_new</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a890bdfd2f7517c0fe7f30687d1d4d825">community_free</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a9c66d86ece1bd928c16238f25fab62ec">community_add_val</a> (struct <a class="el" href="structcommunity.html">community</a> *com, u_int32_t <a class="el" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#acca441f8b245fa4d9f981db44782e3ee">community_del_val</a> (struct <a class="el" href="structcommunity.html">community</a> *com, u_int32_t *<a class="el" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a610875add342ca4a766a41301272ca8d">community_delete</a> (struct <a class="el" href="structcommunity.html">community</a> *com1, struct <a class="el" href="structcommunity.html">community</a> *com2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a65fc140b4680cbf69c768238db4c242e">community_compare</a> (const void *a1, const void *a2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a0191e40f098590ab68b99a24c2a2e931">community_include</a> (struct <a class="el" href="structcommunity.html">community</a> *com, u_int32_t <a class="el" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a82eb1e83d4b715c33bacdc9574ef4389">community_val_get</a> (struct <a class="el" href="structcommunity.html">community</a> *com, int <a class="el" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a7bab71e747c1164320fd14c061956516">community_uniq_sort</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a830b613212ba0ebdf6a229f35621a703">community_com2str</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a13f3f19052ddd0201e67b155a5d55657">community_intern</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#add62474cd8c7fed6877c64537b6c78a2">community_unintern</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#aa550dd7b846e8e409cece29583b6f7b5">community_parse</a> (u_int32_t *pnt, u_short <a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#ad93ae545ec0b6971e4cc5b1eb2fbd5eb">community_dup</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a46ddc4b676977762237ba3c27f9ff98e">community_str</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#ad929d0c5734e5a2df900d29ab3c59921">community_hash_make</a> (struct <a class="el" href="structcommunity.html">community</a> *com)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a7f39155b89b53a2e34d555ad2912692e">community_match</a> (const struct <a class="el" href="structcommunity.html">community</a> *com1, const struct <a class="el" href="structcommunity.html">community</a> *com2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#ab78dd69e6f3b202f3ab726654ea54193">community_cmp</a> (const struct <a class="el" href="structcommunity.html">community</a> *com1, const struct <a class="el" href="structcommunity.html">community</a> *com2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a973ecafb48d259e461d935a0a6a94ea4">community_merge</a> (struct <a class="el" href="structcommunity.html">community</a> *com1, struct <a class="el" href="structcommunity.html">community</a> *com2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a982ac0fb80448e336156b3aeb09f8a78">community_gettoken</a> (const char *buf, enum <a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6">community_token</a> *token, u_int32_t *<a class="el" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#ae6b14a28bd7622ffb1b9f5b20897e648">community_str2com</a> (const char *<a class="el" href="ripng__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a934a23fba97b07c3074615743a5a36f4">community_count</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structhash.html">hash</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a2ad08ece0d19f7c8a7c05f360e60a344">community_hash</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a24d2ec91020660700696ad24408b4768">community_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#a29420c210e4ff289843eb117aed4350a">community_finish</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structhash.html">hash</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a></td></tr>
</table>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6"></a><!-- doxytag: member="bgp_community.c::community_token" ref="aef7a1650b1624d9d0e7392103cebe7e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6">community_token</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876"></a><!-- doxytag: member="community_token_val" ref="aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876" args="" -->community_token_val</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f"></a><!-- doxytag: member="community_token_no_export" ref="aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f" args="" -->community_token_no_export</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d"></a><!-- doxytag: member="community_token_no_advertise" ref="aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d" args="" -->community_token_no_advertise</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338"></a><!-- doxytag: member="community_token_local_as" ref="aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338" args="" -->community_token_local_as</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272"></a><!-- doxytag: member="community_token_unknown" ref="aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272" args="" -->community_token_unknown</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00471">471</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876">community_token_val</a>,
  <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f">community_token_no_export</a>,
  <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d">community_token_no_advertise</a>,
  <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338">community_token_local_as</a>,
  <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>
};
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9c66d86ece1bd928c16238f25fab62ec"></a><!-- doxytag: member="bgp_community.c::community_add_val" ref="a9c66d86ece1bd928c16238f25fab62ec" args="(struct community *com, u_int32_t val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void community_add_val </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00052">52</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>++;
  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>)
    com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, <a class="code" href="bgp__community_8h.html#abe4fac602a39f27f2c0cc4d54cd4bc59">com_length</a> (com));
  <span class="keywordflow">else</span>
    com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, <a class="code" href="bgp__community_8h.html#abe4fac602a39f27f2c0cc4d54cd4bc59">com_length</a> (com));

  <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = htonl (<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>);
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (<a class="code" href="bgp__community_8h.html#a4e74eab3b93846015a2b974e33537aba">com_lastval</a> (com), &amp;<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>, <span class="keyword">sizeof</span> (u_int32_t));
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab78dd69e6f3b202f3ab726654ea54193"></a><!-- doxytag: member="bgp_community.c::community_cmp" ref="ab78dd69e6f3b202f3ab726654ea54193" args="(const struct community *com1, const struct community *com2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int community_cmp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00441">441</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (com1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; com2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> 1;
  <span class="keywordflow">if</span> (com1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || com2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> 0;

  <span class="keywordflow">if</span> (com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> == com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>)
    <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, com2-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> * 4) == 0)
      <span class="keywordflow">return</span> 1;
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a830b613212ba0ebdf6a229f35621a703"></a><!-- doxytag: member="bgp_community.c::community_com2str" ref="a830b613212ba0ebdf6a229f35621a703" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* community_com2str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00198">198</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keywordtype">char</span> *<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;
  <span class="keywordtype">char</span> *pnt;
  <span class="keywordtype">int</span> len;
  <span class="keywordtype">int</span> first;
  u_int32_t comval;
  u_int16_t as;
  u_int16_t <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>;

  <span class="keywordflow">if</span> (!com)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="comment">/* When communities attribute is empty.  */</span>
  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> == 0)
    {
      str = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba3ab59fdf5f4673b09edb9121a05c83cb">MTYPE_COMMUNITY_STR</a>, 1);
      str[0] = <span class="charliteral">&#39;\0&#39;</span>;
      <span class="keywordflow">return</span> <a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;
    }

  <span class="comment">/* Memory allocation is time consuming work.  So we calculate</span>
<span class="comment">     required string length first.  */</span>
  len = 0;

  <span class="keywordflow">for</span> (i = 0; i &lt; com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>; i++)
    {
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;comval, <a class="code" href="bgp__community_8h.html#af94a7f226b0984e690c90fe23355d71b">com_nthval</a> (com, i), <span class="keyword">sizeof</span> (u_int32_t));
      comval = ntohl (comval);

      <span class="keywordflow">switch</span> (comval) 
    {
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#a963dbe34b652eddc5e57390c16fe5063">COMMUNITY_INTERNET</a>:
      len += strlen (<span class="stringliteral">&quot; internet&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#a219dabc199faf8a9c3d75d8cccd2aa04">COMMUNITY_NO_EXPORT</a>:
      len += strlen (<span class="stringliteral">&quot; no-export&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#ad48733d7ee618f0eb7371ca7300af9fc">COMMUNITY_NO_ADVERTISE</a>:
      len += strlen (<span class="stringliteral">&quot; no-advertise&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#acacc3f9ae32baf1130b9cd46f1c7bf90">COMMUNITY_LOCAL_AS</a>:
      len += strlen (<span class="stringliteral">&quot; local-AS&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">default</span>:
      len += strlen (<span class="stringliteral">&quot; 65536:65535&quot;</span>);
      <span class="keywordflow">break</span>;
    }
    }

  <span class="comment">/* Allocate memory.  */</span>
  str = pnt = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba3ab59fdf5f4673b09edb9121a05c83cb">MTYPE_COMMUNITY_STR</a>, len);
  first = 1;

  <span class="comment">/* Fill in string.  */</span>
  <span class="keywordflow">for</span> (i = 0; i &lt; com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>; i++)
    {
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;comval, <a class="code" href="bgp__community_8h.html#af94a7f226b0984e690c90fe23355d71b">com_nthval</a> (com, i), <span class="keyword">sizeof</span> (u_int32_t));
      comval = ntohl (comval);

      <span class="keywordflow">if</span> (first)
    first = 0;
      <span class="keywordflow">else</span>
    *pnt++ = <span class="charliteral">&#39; &#39;</span>;

      <span class="keywordflow">switch</span> (comval) 
    {
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#a963dbe34b652eddc5e57390c16fe5063">COMMUNITY_INTERNET</a>:
      strcpy (pnt, <span class="stringliteral">&quot;internet&quot;</span>);
      pnt += strlen (<span class="stringliteral">&quot;internet&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#a219dabc199faf8a9c3d75d8cccd2aa04">COMMUNITY_NO_EXPORT</a>:
      strcpy (pnt, <span class="stringliteral">&quot;no-export&quot;</span>);
      pnt += strlen (<span class="stringliteral">&quot;no-export&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#ad48733d7ee618f0eb7371ca7300af9fc">COMMUNITY_NO_ADVERTISE</a>:
      strcpy (pnt, <span class="stringliteral">&quot;no-advertise&quot;</span>);
      pnt += strlen (<span class="stringliteral">&quot;no-advertise&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8h.html#acacc3f9ae32baf1130b9cd46f1c7bf90">COMMUNITY_LOCAL_AS</a>:
      strcpy (pnt, <span class="stringliteral">&quot;local-AS&quot;</span>);
      pnt += strlen (<span class="stringliteral">&quot;local-AS&quot;</span>);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">default</span>:
      as = (comval &gt;&gt; 16) &amp; 0xFFFF;
      val = comval &amp; 0xFFFF;
      sprintf (pnt, <span class="stringliteral">&quot;%u:%d&quot;</span>, as, val);
      pnt += strlen (pnt);
      <span class="keywordflow">break</span>;
    }
    }
  *pnt = <span class="charliteral">&#39;\0&#39;</span>;

  <span class="keywordflow">return</span> <a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a65fc140b4680cbf69c768238db4c242e"></a><!-- doxytag: member="bgp_community.c::community_compare" ref="a65fc140b4680cbf69c768238db4c242e" args="(const void *a1, const void *a2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int community_compare </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00116">116</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  u_int32_t v1;
  u_int32_t v2;

  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;v1, a1, <span class="keyword">sizeof</span> (u_int32_t));
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;v2, a2, <span class="keyword">sizeof</span> (u_int32_t));
  v1 = ntohl (v1);
  v2 = ntohl (v2);

  <span class="keywordflow">if</span> (v1 &lt; v2)
    <span class="keywordflow">return</span> -1;
  <span class="keywordflow">if</span> (v1 &gt; v2)
    <span class="keywordflow">return</span> 1;
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a934a23fba97b07c3074615743a5a36f4"></a><!-- doxytag: member="bgp_community.c::community_count" ref="a934a23fba97b07c3074615743a5a36f4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long community_count </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00620">620</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a>-&gt;<a class="code" href="structhash.html#a4d82055a4a52d99ee887d24004fd91d3">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acca441f8b245fa4d9f981db44782e3ee"></a><!-- doxytag: member="bgp_community.c::community_del_val" ref="acca441f8b245fa4d9f981db44782e3ee" args="(struct community *com, u_int32_t *val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void community_del_val </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00066">66</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a> = 0;
  <span class="keywordtype">int</span> c = 0;

  <span class="keywordflow">if</span> (! com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>)
    <span class="keywordflow">return</span>;

  <span class="keywordflow">while</span> (i &lt; com-&gt;<a class="code" href="structecommunity.html#a4477c6c01052cb83ed9b4682302ebf5f">size</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + i, <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>, sizeof (u_int32_t)) == 0)
    {
      c = com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> -i -1;

      <span class="keywordflow">if</span> (c &gt; 0)
        <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + i, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + (i + 1), c * sizeof (*<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>));

      com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>--;

      <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> &gt; 0)
        com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>,
                 <a class="code" href="bgp__community_8h.html#abe4fac602a39f27f2c0cc4d54cd4bc59">com_length</a> (com));
      <span class="keywordflow">else</span>
        {
          <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>);
          com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }
      <span class="keywordflow">return</span>;
    }
      i++;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a610875add342ca4a766a41301272ca8d"></a><!-- doxytag: member="bgp_community.c::community_delete" ref="a610875add342ca4a766a41301272ca8d" args="(struct community *com1, struct community *com2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_delete </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00101">101</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a> = 0;

  <span class="keywordflow">while</span>(i &lt; com2-&gt;<a class="code" href="structecommunity.html#a4477c6c01052cb83ed9b4682302ebf5f">size</a>)
    {
      <a class="code" href="bgp__community_8c.html#acca441f8b245fa4d9f981db44782e3ee">community_del_val</a> (com1, com2-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + i);
      i++;
    }

  <span class="keywordflow">return</span> com1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad93ae545ec0b6971e4cc5b1eb2fbd5eb"></a><!-- doxytag: member="bgp_community.c::community_dup" ref="ad93ae545ec0b6971e4cc5b1eb2fbd5eb" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_dup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00363">363</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *<span class="keyword">new</span>;

  <span class="keyword">new</span> = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba010f020f9da1ea285c55a553451b3572">MTYPE_COMMUNITY</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structcommunity.html">community</a>));
  <span class="keyword">new</span>-&gt;size = com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>;
  <span class="keywordflow">if</span> (new-&gt;size)
    {
      <span class="keyword">new</span>-&gt;val = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> * 4);
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (new-&gt;val, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> * 4);
    }
  <span class="keywordflow">else</span>
    <span class="keyword">new</span>-&gt;val = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a29420c210e4ff289843eb117aed4350a"></a><!-- doxytag: member="bgp_community.c::community_finish" ref="a29420c210e4ff289843eb117aed4350a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void community_finish </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00641">641</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="hash_8c.html#ad0d6074e4b7475f7c249212bb8e67de5">hash_free</a> (<a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a>);
  <a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a890bdfd2f7517c0fe7f30687d1d4d825"></a><!-- doxytag: member="bgp_community.c::community_free" ref="a890bdfd2f7517c0fe7f30687d1d4d825" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void community_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00041">41</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>);
  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba3ab59fdf5f4673b09edb9121a05c83cb">MTYPE_COMMUNITY_STR</a>, com-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a>);
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba010f020f9da1ea285c55a553451b3572">MTYPE_COMMUNITY</a>, com);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a982ac0fb80448e336156b3aeb09f8a78"></a><!-- doxytag: member="bgp_community.c::community_gettoken" ref="a982ac0fb80448e336156b3aeb09f8a78" args="(const char *buf, enum community_token *token, u_int32_t *val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* community_gettoken </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6">community_token</a> *&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00482">482</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a> = buf;

  <span class="comment">/* Skip white space. */</span>
  <span class="keywordflow">while</span> (isspace ((<span class="keywordtype">int</span>) *p))
    p++;

  <span class="comment">/* Check the end of the line. */</span>
  <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;\0&#39;</span>)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* Well known community string check. */</span>
  <span class="keywordflow">if</span> (isalpha ((<span class="keywordtype">int</span>) *p)) 
    {
      <span class="keywordflow">if</span> (strncmp (p, <span class="stringliteral">&quot;internet&quot;</span>, strlen (<span class="stringliteral">&quot;internet&quot;</span>)) == 0)
    {
      *<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = <a class="code" href="bgp__community_8h.html#a963dbe34b652eddc5e57390c16fe5063">COMMUNITY_INTERNET</a>;
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f">community_token_no_export</a>;
      p += strlen (<span class="stringliteral">&quot;internet&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }
      <span class="keywordflow">if</span> (strncmp (p, <span class="stringliteral">&quot;no-export&quot;</span>, strlen (<span class="stringliteral">&quot;no-export&quot;</span>)) == 0)
    {
      *<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = <a class="code" href="bgp__community_8h.html#a219dabc199faf8a9c3d75d8cccd2aa04">COMMUNITY_NO_EXPORT</a>;
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f">community_token_no_export</a>;
      p += strlen (<span class="stringliteral">&quot;no-export&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }
      <span class="keywordflow">if</span> (strncmp (p, <span class="stringliteral">&quot;no-advertise&quot;</span>, strlen (<span class="stringliteral">&quot;no-advertise&quot;</span>)) == 0)
    {
      *<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = <a class="code" href="bgp__community_8h.html#ad48733d7ee618f0eb7371ca7300af9fc">COMMUNITY_NO_ADVERTISE</a>;
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d">community_token_no_advertise</a>;
      p += strlen (<span class="stringliteral">&quot;no-advertise&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }
      <span class="keywordflow">if</span> (strncmp (p, <span class="stringliteral">&quot;local-AS&quot;</span>, strlen (<span class="stringliteral">&quot;local-AS&quot;</span>)) == 0)
    {
      *<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = <a class="code" href="bgp__community_8h.html#acacc3f9ae32baf1130b9cd46f1c7bf90">COMMUNITY_LOCAL_AS</a>;
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338">community_token_local_as</a>;
      p += strlen (<span class="stringliteral">&quot;local-AS&quot;</span>);
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }

      <span class="comment">/* Unknown string. */</span>
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>;
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }

  <span class="comment">/* Community value. */</span>
  <span class="keywordflow">if</span> (isdigit ((<span class="keywordtype">int</span>) *p)) 
    {
      <span class="keywordtype">int</span> separator = 0;
      <span class="keywordtype">int</span> digit = 0;
      u_int32_t community_low = 0;
      u_int32_t community_high = 0;

      <span class="keywordflow">while</span> (isdigit ((<span class="keywordtype">int</span>) *p) || *p == <span class="charliteral">&#39;:&#39;</span>) 
    {
      <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;:&#39;</span>) 
        {
          <span class="keywordflow">if</span> (separator)
        {
          *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>;
          <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }
          <span class="keywordflow">else</span>
        {
          separator = 1;
          digit = 0;
          community_high = community_low &lt;&lt; 16;
          community_low = 0;
        }
        }
      <span class="keywordflow">else</span> 
        {
          digit = 1;
          community_low *= 10;
          community_low += (*p - <span class="charliteral">&#39;0&#39;</span>);
        }
      p++;
    }
      <span class="keywordflow">if</span> (! digit)
    {
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>;
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
      *<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = community_high + community_low;
      *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876">community_token_val</a>;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }
  *token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>;
  <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2ad08ece0d19f7c8a7c05f360e60a344"></a><!-- doxytag: member="bgp_community.c::community_hash" ref="a2ad08ece0d19f7c8a7c05f360e60a344" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structhash.html">hash</a>* community_hash </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00627">627</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad929d0c5734e5a2df900d29ab3c59921"></a><!-- doxytag: member="bgp_community.c::community_hash_make" ref="ad929d0c5734e5a2df900d29ab3c59921" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int community_hash_make </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00394">394</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> c;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="zebra__rib_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pnt;

  key = 0;
  pnt = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>;
  
  <span class="keywordflow">for</span>(c = 0; c &lt; com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> * 4; c++)
    key += pnt[c];
      
  <span class="keywordflow">return</span> <a class="code" href="zebra__rib_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0191e40f098590ab68b99a24c2a2e931"></a><!-- doxytag: member="bgp_community.c::community_include" ref="a0191e40f098590ab68b99a24c2a2e931" args="(struct community *com, u_int32_t val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int community_include </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00134">134</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = htonl (<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>);

  <span class="keywordflow">for</span> (i = 0; i &lt; com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>; i++)
    <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (&amp;<a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>, <a class="code" href="bgp__community_8h.html#af94a7f226b0984e690c90fe23355d71b">com_nthval</a> (com, i), <span class="keyword">sizeof</span> (u_int32_t)) == 0)
      <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a24d2ec91020660700696ad24408b4768"></a><!-- doxytag: member="bgp_community.c::community_init" ref="a24d2ec91020660700696ad24408b4768" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void community_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00634">634</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a> = <a class="code" href="hash_8c.html#af8af448ae70e3d3b1fe45295b5e8fb78">hash_create</a> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> (*) (<span class="keywordtype">void</span> *))<a class="code" href="bgp__community_8c.html#ad929d0c5734e5a2df900d29ab3c59921">community_hash_make</a>,
             (<span class="keywordtype">int</span> (*) (<span class="keyword">const</span> <span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">void</span> *))<a class="code" href="bgp__community_8c.html#ab78dd69e6f3b202f3ab726654ea54193">community_cmp</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a13f3f19052ddd0201e67b155a5d55657"></a><!-- doxytag: member="bgp_community.c::community_intern" ref="a13f3f19052ddd0201e67b155a5d55657" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_intern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00297">297</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *find;

  <span class="comment">/* Assert this community structure is not interned. */</span>
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (com-&gt;<a class="code" href="structcommunity.html#a52dd7a5a975af9d21ad9f93a91deb739">refcnt</a> == 0);

  <span class="comment">/* Lookup community hash. */</span>
  find = (<span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *) <a class="code" href="hash_8c.html#ab0bb31bd6c883d6563930341dccedd22">hash_get</a> (<a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a>, com, <a class="code" href="hash_8c.html#ac2705f6d220cf4d8049201e369ff6d62">hash_alloc_intern</a>);

  <span class="comment">/* Arguemnt com is allocated temporary.  So when it is not used in</span>
<span class="comment">     hash, it should be freed.  */</span>
  <span class="keywordflow">if</span> (find != com)
    <a class="code" href="bgp__community_8c.html#a890bdfd2f7517c0fe7f30687d1d4d825">community_free</a> (com);

  <span class="comment">/* Increment refrence counter.  */</span>
  find-&gt;<a class="code" href="structcommunity.html#a52dd7a5a975af9d21ad9f93a91deb739">refcnt</a>++;

  <span class="comment">/* Make string.  */</span>
  <span class="keywordflow">if</span> (! find-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a>)
    find-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a> = <a class="code" href="bgp__community_8c.html#a830b613212ba0ebdf6a229f35621a703">community_com2str</a> (find);

  <span class="keywordflow">return</span> find;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f39155b89b53a2e34d555ad2912692e"></a><!-- doxytag: member="bgp_community.c::community_match" ref="a7f39155b89b53a2e34d555ad2912692e" args="(const struct community *com1, const struct community *com2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int community_match </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00410">410</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a> = 0;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a7113d77fc628f14d4e7d1262969c613e">j</a> = 0;

  <span class="keywordflow">if</span> (com1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; com2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">if</span> (com1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || com2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> 0;

  <span class="keywordflow">if</span> (com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> &lt; com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>)
    <span class="keywordflow">return</span> 0;

  <span class="comment">/* Every community on com2 needs to be on com1 for this to match */</span>
  <span class="keywordflow">while</span> (i &lt; com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> &amp;&amp; j &lt; com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>)
    {
      <span class="keywordflow">if</span> (<a class="code" href="regex_8c.html#a98d0dff0c7366f08562d8e8583df9bb9">memcmp</a> (com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + i, com2-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + j, sizeof (u_int32_t)) == 0)
    j++;
      i++;
    }

  <span class="keywordflow">if</span> (j == com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>)
    <span class="keywordflow">return</span> 1;
  <span class="keywordflow">else</span>
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a973ecafb48d259e461d935a0a6a94ea4"></a><!-- doxytag: member="bgp_community.c::community_merge" ref="a973ecafb48d259e461d935a0a6a94ea4" args="(struct community *com1, struct community *com2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_merge </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00456">456</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>)
    com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, 
              (com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> + com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>) * 4);
  <span class="keywordflow">else</span>
    com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba88d525f9622740f3095d16c525973859">MTYPE_COMMUNITY_VAL</a>, (com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> + com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>) * 4);

  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (com1-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a> + com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>, com2-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>, com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> * 4);
  com1-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a> += com2-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>;

  <span class="keywordflow">return</span> com1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af4553289199b5f1c2089e4d95c570148"></a><!-- doxytag: member="bgp_community.c::community_new" ref="af4553289199b5f1c2089e4d95c570148" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structcommunity.html">community</a>* community_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00033">33</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structcommunity.html">community</a> *) <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167ba010f020f9da1ea285c55a553451b3572">MTYPE_COMMUNITY</a>,
                       <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structcommunity.html">community</a>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa550dd7b846e8e409cece29583b6f7b5"></a><!-- doxytag: member="bgp_community.c::community_parse" ref="aa550dd7b846e8e409cece29583b6f7b5" args="(u_int32_t *pnt, u_short length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_parse </td>
          <td>(</td>
          <td class="paramtype">u_int32_t *&#160;</td>
          <td class="paramname"><em>pnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_short&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00344">344</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> tmp;
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *<span class="keyword">new</span>;

  <span class="comment">/* If length is malformed return NULL. */</span>
  <span class="keywordflow">if</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> % 4)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* Make temporary community for hash look up. */</span>
  tmp.size = <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> / 4;
  tmp.val = pnt;

  <span class="keyword">new</span> = <a class="code" href="bgp__community_8c.html#a7bab71e747c1164320fd14c061956516">community_uniq_sort</a> (&amp;tmp);

  <span class="keywordflow">return</span> <a class="code" href="bgp__community_8c.html#a13f3f19052ddd0201e67b155a5d55657">community_intern</a> (<span class="keyword">new</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a46ddc4b676977762237ba3c27f9ff98e"></a><!-- doxytag: member="bgp_community.c::community_str" ref="a46ddc4b676977762237ba3c27f9ff98e" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* community_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00381">381</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!com)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="keywordflow">if</span> (! com-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a>)
    com-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a> = <a class="code" href="bgp__community_8c.html#a830b613212ba0ebdf6a229f35621a703">community_com2str</a> (com);
  <span class="keywordflow">return</span> com-&gt;<a class="code" href="structcommunity.html#ab723f1eb3237360a86acf75893985ce8">str</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae6b14a28bd7622ffb1b9f5b20897e648"></a><!-- doxytag: member="bgp_community.c::community_str2com" ref="ae6b14a28bd7622ffb1b9f5b20897e648" args="(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_str2com </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00580">580</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *com = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *com_sort = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  u_int32_t <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a> = 0;
  <span class="keyword">enum</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6">community_token</a> token = <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>;

  <span class="keywordflow">do</span> 
    {
      <a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="bgp__community_8c.html#a982ac0fb80448e336156b3aeb09f8a78">community_gettoken</a> (<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, &amp;token, &amp;val);
      
      <span class="keywordflow">switch</span> (token)
    {
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a750fe18892ebfdab2f50190451e4e876">community_token_val</a>:
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6ad36c89bcdf7f763d0d8c63ca24f7a90f">community_token_no_export</a>:
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a39f9702b8994890ec7f5e7a439903c1d">community_token_no_advertise</a>:
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a4ac4dc0109da1b57830d75af9862c338">community_token_local_as</a>:
      <span class="keywordflow">if</span> (com == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        com = <a class="code" href="bgp__community_8c.html#af4553289199b5f1c2089e4d95c570148">community_new</a>();
      <a class="code" href="bgp__community_8c.html#a9c66d86ece1bd928c16238f25fab62ec">community_add_val</a> (com, val);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__community_8c.html#aef7a1650b1624d9d0e7392103cebe7e6a153577a8fb13ad658a926a2d59749272">community_token_unknown</a>:
    <span class="keywordflow">default</span>:
      <span class="keywordflow">if</span> (com)
        <a class="code" href="bgp__community_8c.html#a890bdfd2f7517c0fe7f30687d1d4d825">community_free</a> (com);
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
    } <span class="keywordflow">while</span> (<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
  
  <span class="keywordflow">if</span> (! com)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  com_sort = <a class="code" href="bgp__community_8c.html#a7bab71e747c1164320fd14c061956516">community_uniq_sort</a> (com);
  <a class="code" href="bgp__community_8c.html#a890bdfd2f7517c0fe7f30687d1d4d825">community_free</a> (com);

  <span class="keywordflow">return</span> com_sort;
}
</pre></div>
</div>
</div>
<a class="anchor" id="add62474cd8c7fed6877c64537b6c78a2"></a><!-- doxytag: member="bgp_community.c::community_unintern" ref="add62474cd8c7fed6877c64537b6c78a2" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void community_unintern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00324">324</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *ret;

  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#a52dd7a5a975af9d21ad9f93a91deb739">refcnt</a>)
    com-&gt;<a class="code" href="structcommunity.html#a52dd7a5a975af9d21ad9f93a91deb739">refcnt</a>--;

  <span class="comment">/* Pull off from hash.  */</span>
  <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structcommunity.html#a52dd7a5a975af9d21ad9f93a91deb739">refcnt</a> == 0)
    {
      <span class="comment">/* Community value com must exist in hash. */</span>
      ret = (<span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *) <a class="code" href="hash_8c.html#a67f4f46ccd66f0b0c2a047eeb130c19e">hash_release</a> (<a class="code" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a>, com);
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (ret != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);

      <a class="code" href="bgp__community_8c.html#a890bdfd2f7517c0fe7f30687d1d4d825">community_free</a> (com);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7bab71e747c1164320fd14c061956516"></a><!-- doxytag: member="bgp_community.c::community_uniq_sort" ref="a7bab71e747c1164320fd14c061956516" args="(struct community *com)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcommunity.html">community</a>* community_uniq_sort </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00163">163</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keyword">struct </span><a class="code" href="structcommunity.html">community</a> *<span class="keyword">new</span>;
  u_int32_t <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>;

  <span class="keywordflow">if</span> (! com)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="keyword">new</span> = <a class="code" href="bgp__community_8c.html#af4553289199b5f1c2089e4d95c570148">community_new</a> ();;
  
  <span class="keywordflow">for</span> (i = 0; i &lt; com-&gt;<a class="code" href="structcommunity.html#ad54bd9c20e0cf4fa4674f5b76703d192">size</a>; i++)
    {
      val = <a class="code" href="bgp__community_8c.html#a82eb1e83d4b715c33bacdc9574ef4389">community_val_get</a> (com, i);

      <span class="keywordflow">if</span> (! <a class="code" href="bgp__community_8c.html#a0191e40f098590ab68b99a24c2a2e931">community_include</a> (<span class="keyword">new</span>, val))
    <a class="code" href="bgp__community_8c.html#a9c66d86ece1bd928c16238f25fab62ec">community_add_val</a> (<span class="keyword">new</span>, val);
    }

  qsort (new-&gt;val, new-&gt;size, sizeof (u_int32_t), <a class="code" href="bgp__community_8c.html#a65fc140b4680cbf69c768238db4c242e">community_compare</a>);

  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a82eb1e83d4b715c33bacdc9574ef4389"></a><!-- doxytag: member="bgp_community.c::community_val_get" ref="a82eb1e83d4b715c33bacdc9574ef4389" args="(struct community *com, int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static u_int32_t community_val_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcommunity.html">community</a> *&#160;</td>
          <td class="paramname"><em>com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00148">148</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  u_char *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  u_int32_t <a class="code" href="prefix_8h.html#a43e03366be2dd9176e91229d76541ce9">val</a>;

  p = (u_char *) com-&gt;<a class="code" href="structcommunity.html#ae5a21d3a57a63600e7450c21b17dff42">val</a>;
  p += (<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a> * 4);

  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (&amp;val, p, <span class="keyword">sizeof</span> (u_int32_t));

  <span class="keywordflow">return</span> ntohl (val);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ac193534d60b78ef4c2e98afff7edbff7"></a><!-- doxytag: member="bgp_community.c::comhash" ref="ac193534d60b78ef4c2e98afff7edbff7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structhash.html">hash</a>* <a class="el" href="bgp__community_8c.html#ac193534d60b78ef4c2e98afff7edbff7">comhash</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__community_8c_source.html#l00029">29</a> of file <a class="el" href="bgp__community_8c_source.html">bgp_community.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="bgp__community_8c.html">bgp_community.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:11 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
