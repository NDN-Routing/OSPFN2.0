<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: bgpd/bgp_aspath.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('bgp__aspath_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bgpd/bgp_aspath.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="zebra_8h_source.html">zebra.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="hash_8h_source.html">hash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="vector_8h_source.html">vector.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="vty_8h_source.html">vty.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="str_8h_source.html">str.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="jhash_8h_source.html">jhash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bgpd_8h_source.html">bgpd/bgpd.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bgp__aspath_8h_source.html">bgpd/bgp_aspath.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bgp__debug_8h_source.html">bgpd/bgp_debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bgp__attr_8h_source.html">bgpd/bgp_attr.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bgp_aspath.c:</div>
<div class="dyncontent">
<div class="center"><img src="bgp__aspath_8c__incl.png" border="0" usemap="#bgpd_2bgp__aspath_8c" alt=""/></div>
<map name="bgpd_2bgp__aspath_8c" id="bgpd_2bgp__aspath_8c">
<area shape="rect" id="node3" href="zebra_8h.html" title="zebra.h" alt="" coords="1345,80,1412,107"/><area shape="rect" id="node59" href="str_8h.html" title="str.h" alt="" coords="2725,155,2773,181"/><area shape="rect" id="node61" href="hash_8h.html" title="hash.h" alt="" coords="2716,80,2777,107"/><area shape="rect" id="node63" href="memory_8h.html" title="memory.h" alt="" coords="2801,80,2884,107"/><area shape="rect" id="node67" href="vector_8h.html" title="vector.h" alt="" coords="2908,80,2980,107"/><area shape="rect" id="node69" href="vty_8h.html" title="vty.h" alt="" coords="3005,80,3056,107"/><area shape="rect" id="node73" href="log_8h.html" title="log.h" alt="" coords="3058,155,3109,181"/><area shape="rect" id="node78" href="stream_8h.html" title="stream.h" alt="" coords="3132,80,3207,107"/><area shape="rect" id="node84" href="jhash_8h.html" title="jhash.h" alt="" coords="3231,80,3296,107"/><area shape="rect" id="node86" href="bgpd_8h.html" title="bgpd/bgpd.h" alt="" coords="3321,80,3420,107"/><area shape="rect" id="node89" href="bgp__aspath_8h.html" title="bgpd/bgp_aspath.h" alt="" coords="3445,80,3584,107"/><area shape="rect" id="node91" href="bgp__debug_8h.html" title="bgpd/bgp_debug.h" alt="" coords="3609,80,3748,107"/><area shape="rect" id="node93" href="bgp__attr_8h.html" title="bgp_attr.h" alt="" coords="3689,155,3775,181"/><area shape="rect" id="node57" href="zassert_8h.html" title="zassert.h" alt="" coords="2623,155,2700,181"/><area shape="rect" id="node65" href="memtypes_8h.html" title="lib/memtypes.h" alt="" coords="2799,155,2913,181"/><area shape="rect" id="node71" href="thread_8h.html" title="thread.h" alt="" coords="2961,155,3033,181"/><area shape="rect" id="node80" href="prefix_8h.html" title="prefix.h" alt="" coords="3146,155,3213,181"/><area shape="rect" id="node82" href="sockunion_8h.html" title="sockunion.h" alt="" coords="3223,229,3316,256"/></map>
</div>
</div>
<p><a href="bgp__aspath_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structassegment__header.html">assegment_header</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a6d74ba14656e58bcdf3594007a51d3d1">AS_HEADER_SIZE</a>&#160;&#160;&#160;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#abb85cf2f703f185eb334ac8cfaac7377">AS_VALUE_SIZE</a>&#160;&#160;&#160;sizeof (<a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a996e3b468c598f0a63bec036c579fa08">AS16_VALUE_SIZE</a>&#160;&#160;&#160;sizeof (<a class="el" href="bgpd_8h.html#a23b117e73bd743b0f7bf76cfa4b4af5b">as16_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>&#160;&#160;&#160;255</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a>(N, S)&#160;&#160;&#160;((N) * ( (S) ? AS_VALUE_SIZE : AS16_VALUE_SIZE) )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a>(N, S)&#160;&#160;&#160;(AS_HEADER_SIZE + ASSEGMENT_DATA_SIZE (N,S))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a1a25eeaf309e943daf8145bba6a6aa38">ASSEGMENT_LEN</a>(<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, S)&#160;&#160;&#160;ASSEGMENT_SIZE((<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>,S)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ae6ac821935732ebcf15e61b99f57cdae">ASSEGMENT_TYPES_PACKABLE</a>(<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, <a class="el" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a38166e509b9394c13cbcc3521d38e5f8">ASSEGMENTS_PACKABLE</a>(<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, <a class="el" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a7bd5b354f56c8bdfc2cc29584086d216">AS_SEG_START</a>&#160;&#160;&#160;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a1040fc437c617bbaa7ae208d1066ea9d">AS_SEG_END</a>&#160;&#160;&#160;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a8a75b24434bb9ce642e343e8a9984596">ASN_STR_LEN</a>&#160;&#160;&#160;(10 + 1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aca0dc8de905427979b6f78bdd74ca02c">SEGMENT_STR_LEN</a>(<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)&#160;&#160;&#160;(((<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> * ASN_STR_LEN) + 2 + 1 + 1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#abf1461b6506e68c224e958ffb30655cd">SNMP_PATHSEG_MAX</a>&#160;&#160;&#160;1024</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(A, B)&#160;&#160;&#160;((A) &lt; (B) ? (A) : (B))</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a> { <br/>
&#160;&#160;<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed">as_token_asval</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf">as_token_set_start</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3">as_token_set_end</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3">as_token_confed_seq_start</a>, 
<br/>
&#160;&#160;<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d">as_token_confed_seq_end</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007">as_token_confed_set_start</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef">as_token_confed_set_end</a>, 
<a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a51bdba15ec8455ecaa9e51cb62ebe0aa">assegment_data_new</a> (int <a class="el" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a5228cb0e163140378ebc9c1cbdb6d698">assegment_data_free</a> (<a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *asdata)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (u_char <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, u_short <a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a1331c118704af46f8f329b7d99ba64ff">assegment_dup</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a63f8c7d652204435400c4309a5200fe8">assegment_prepend_asns</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asnum, int <a class="el" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *asnos, int <a class="el" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#acd27f543410fe3814d2b490cf58284ed">int_cmp</a> (const void *p1, const void *p2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (struct <a class="el" href="structassegment.html">assegment</a> *head)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a414aa289179196886d9f059bdd41e81c">aspath_unintern</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a47dde6392c8d26a1f440fc061afed4fc">aspath_delimiter_char</a> (u_char <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, u_char which)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ae315d7679de163b78c9fc6cb9db21e31">assegment_count_asns</a> (struct <a class="el" href="structassegment.html">assegment</a> *seg, int from)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a8638c553cd3d2c87161aa489ea0a45d7">aspath_count_confeds</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a20eefbd15a5076d10ad6e1e37d800bf2">aspath_size</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ab1c68ac1741167dd6e631f6eb6d12705">aspath_highest</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a594fc069e213e63fc1a15af40d93b3d4">aspath_has_as4</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (struct <a class="el" href="structaspath.html">aspath</a> *as)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (struct <a class="el" href="structaspath.html">aspath</a> *as)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a344d7cb1b52c926464681624421bc9c1">aspath_intern</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a4a0316093e4bcf2062f6e0ab12106cd1">aspath_hash_alloc</a> (void *arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a7b78a035d0b8f3e4d0ecb3bf2279701a">assegments_parse</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, size_t <a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>, int use32bit, int as4_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ac9e8aff45338b803e560318286e3f2af">aspath_parse</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, size_t <a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>, int use32bit, int as4_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *as, int <a class="el" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>, int use32bit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aa38970ca2d675babd8620c170f08da37">assegment_header_put</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, u_char <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>, int <a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a716059e44a39a56b3e05020bec13872e">aspath_put</a> (struct <a class="el" href="structstream.html">stream</a> *<a class="el" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, struct <a class="el" href="structaspath.html">aspath</a> *as, int use32bit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u_char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a46008828118eb829c4f5b010175de9ab">aspath_snmp_pathseg</a> (struct <a class="el" href="structaspath.html">aspath</a> *as, size_t *varlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a0c0adc19aecf830681ee9ef1e7357c09">aspath_aggregate_as_set_add</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, struct <a class="el" href="structassegment.html">assegment</a> *asset, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> as)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a615342ae906f2fd579780ce7eda4ff6a">aspath_aggregate</a> (struct <a class="el" href="structaspath.html">aspath</a> *as1, struct <a class="el" href="structaspath.html">aspath</a> *as2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a9ed7eb61027a6f70bb24f3ffc5cc399f">aspath_firstas_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a09c83e4313915a5191a19439186f2280">aspath_loop_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a808020dd81343ccfb8f4cf5f50f5f11c">aspath_private_as_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ab2915d467a13796ada52e009773a5776">aspath_confed_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a2ea3a3f15468d013b12a0ee4558026b5">aspath_left_confed_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (struct <a class="el" href="structaspath.html">aspath</a> *as1, struct <a class="el" href="structaspath.html">aspath</a> *as2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a042b5a8463ffb3adedffa05e69640726">aspath_prepend</a> (struct <a class="el" href="structaspath.html">aspath</a> *as1, struct <a class="el" href="structaspath.html">aspath</a> *as2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ac7f9ae7aa66eb067701e37c65edd2e78">aspath_filter_exclude</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="spgrid_8c.html#acef278b54e17ed729da5acd28bda6daf">source</a>, struct <a class="el" href="structaspath.html">aspath</a> *exclude_list)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aebb4c4aacec379d3b92d67dfbf74b897">aspath_add_one_as</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno, u_char <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a8e5a3fc38d9717bcdcc75ba861459dd6">aspath_add_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a5f979a1ff3bc3908684e4592e5c383eb">aspath_cmp_left</a> (const struct <a class="el" href="structaspath.html">aspath</a> *aspath1, const struct <a class="el" href="structaspath.html">aspath</a> *aspath2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a1a485a8779fb5fcf0ac2efeb2bdc204d">aspath_reconcile_as4</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, struct <a class="el" href="structaspath.html">aspath</a> *as4path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ace7eb37e6ea088fb0ea82c9ae4c58375">aspath_cmp_left_confed</a> (const struct <a class="el" href="structaspath.html">aspath</a> *aspath1, const struct <a class="el" href="structaspath.html">aspath</a> *aspath2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a3a932cff645a730d2e5d9aeec874e127">aspath_delete_confed_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a601c9ef2ba7a75d8757e04d3f8585886">aspath_add_confed_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *<a class="el" href="structaspath.html">aspath</a>, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a6b8a24127d224a6311da7230e4067f89">aspath_as_add</a> (struct <a class="el" href="structaspath.html">aspath</a> *as, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (struct <a class="el" href="structaspath.html">aspath</a> *as, int <a class="el" href="ripng__zebra_8c.html#ac765329451135abec74c45e1897abf26">type</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aadc92a26e3c657307be1c2057b187cda">aspath_empty</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aa737121f7df6f3e64869fc9a6c330b2f">aspath_empty_get</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ad62e86fb815f7395ccd758f5fe5bf2cb">aspath_count</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#adb39eb9be1d3d958aab2de3e0a3e884f">aspath_gettoken</a> (const char *buf, enum <a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a> *token, u_long *asno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aa2514807244e353a19d3f48316cc7885">aspath_str2aspath</a> (const char *<a class="el" href="ripng__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a0ff2c762b3aea1084db8500839a8d314">aspath_key_make</a> (void *<a class="el" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aa7075e8c0246a68a9ed4d56780f9dc7a">aspath_cmp</a> (const void *arg1, const void *arg2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a34b9f56e53531a0e4ceedcb31d59e027">aspath_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ad12467085616732b130bd1edac9277fb">aspath_finish</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#ac20fd0ca4085890de5bd9ea6a6d41e8e">aspath_print</a> (struct <a class="el" href="structaspath.html">aspath</a> *as)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a32814b0bab0791ca1b85145a1b1a0f3f">aspath_print_vty</a> (struct <a class="el" href="structvty.html">vty</a> *<a class="el" href="structvty.html">vty</a>, const char *format, struct <a class="el" href="structaspath.html">aspath</a> *as, const char *suffix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#aa1ede5a9090ad2d9e44753c3ad5c1dfb">aspath_show_all_iterator</a> (struct <a class="el" href="structhash__backet.html">hash_backet</a> *backet, struct <a class="el" href="structvty.html">vty</a> *<a class="el" href="structvty.html">vty</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a0b7af257d32ea864993dd2b3494fa0f0">aspath_print_all_vty</a> (struct <a class="el" href="structvty.html">vty</a> *<a class="el" href="structvty.html">vty</a>)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structhash.html">hash</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structstream.html">stream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a996e3b468c598f0a63bec036c579fa08"></a><!-- doxytag: member="bgp_aspath.c::AS16_VALUE_SIZE" ref="a996e3b468c598f0a63bec036c579fa08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS16_VALUE_SIZE&#160;&#160;&#160;sizeof (<a class="el" href="bgpd_8h.html#a23b117e73bd743b0f7bf76cfa4b4af5b">as16_t</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00044">44</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6d74ba14656e58bcdf3594007a51d3d1"></a><!-- doxytag: member="bgp_aspath.c::AS_HEADER_SIZE" ref="a6d74ba14656e58bcdf3594007a51d3d1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_HEADER_SIZE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00039">39</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1040fc437c617bbaa7ae208d1066ea9d"></a><!-- doxytag: member="bgp_aspath.c::AS_SEG_END" ref="a1040fc437c617bbaa7ae208d1066ea9d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_SEG_END&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00361">361</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7bd5b354f56c8bdfc2cc29584086d216"></a><!-- doxytag: member="bgp_aspath.c::AS_SEG_START" ref="a7bd5b354f56c8bdfc2cc29584086d216" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_SEG_START&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00360">360</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac42ca08b92d62553458e61ec97212221"></a><!-- doxytag: member="bgp_aspath.c::AS_SEGMENT_MAX" ref="ac42ca08b92d62553458e61ec97212221" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_SEGMENT_MAX&#160;&#160;&#160;255</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00047">47</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="abb85cf2f703f185eb334ac8cfaac7377"></a><!-- doxytag: member="bgp_aspath.c::AS_VALUE_SIZE" ref="abb85cf2f703f185eb334ac8cfaac7377" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_VALUE_SIZE&#160;&#160;&#160;sizeof (<a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00042">42</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8a75b24434bb9ce642e343e8a9984596"></a><!-- doxytag: member="bgp_aspath.c::ASN_STR_LEN" ref="a8a75b24434bb9ce642e343e8a9984596" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASN_STR_LEN&#160;&#160;&#160;(10 + 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a72dc51f57ed02bf714c43cda0161d409"></a><!-- doxytag: member="bgp_aspath.c::ASSEGMENT_DATA_SIZE" ref="a72dc51f57ed02bf714c43cda0161d409" args="(N, S)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSEGMENT_DATA_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">S&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((N) * ( (S) ? AS_VALUE_SIZE : AS16_VALUE_SIZE) )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00060">60</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1a25eeaf309e943daf8145bba6a6aa38"></a><!-- doxytag: member="bgp_aspath.c::ASSEGMENT_LEN" ref="a1a25eeaf309e943daf8145bba6a6aa38" args="(X, S)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSEGMENT_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">S&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;ASSEGMENT_SIZE((<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>,S)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00067">67</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a08094b79031fca12e069561eee0f03dc"></a><!-- doxytag: member="bgp_aspath.c::ASSEGMENT_SIZE" ref="a08094b79031fca12e069561eee0f03dc" args="(N, S)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSEGMENT_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">S&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(AS_HEADER_SIZE + ASSEGMENT_DATA_SIZE (N,S))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00064">64</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae6ac821935732ebcf15e61b99f57cdae"></a><!-- doxytag: member="bgp_aspath.c::ASSEGMENT_TYPES_PACKABLE" ref="ae6ac821935732ebcf15e61b99f57cdae" args="(X, Y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSEGMENT_TYPES_PACKABLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">( ((<a class="code" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> == (<a class="code" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>)-&gt;type) \
   &amp;&amp; ((<a class="code" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;type == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>))
</pre></div>
<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00071">71</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a38166e509b9394c13cbcc3521d38e5f8"></a><!-- doxytag: member="bgp_aspath.c::ASSEGMENTS_PACKABLE" ref="a38166e509b9394c13cbcc3521d38e5f8" args="(X, Y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSEGMENTS_PACKABLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">( <a class="code" href="bgp__aspath_8c.html#ae6ac821935732ebcf15e61b99f57cdae">ASSEGMENT_TYPES_PACKABLE</a>( (<a class="code" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>), (<a class="code" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>)) \
   &amp;&amp; ( ((<a class="code" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> + (<a class="code" href="spgrid_8c.html#a4e06f4d7a98454d7306e4aa3119acd13">Y</a>)-&gt;length) &lt;= <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a> ) )
</pre></div>
<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00075">75</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2d017cd3beb218080a7988e2deed2a11"></a><!-- doxytag: member="bgp_aspath.c::min" ref="a2d017cd3beb218080a7988e2deed2a11" args="(A, B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define min</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((A) &lt; (B) ? (A) : (B))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00944">944</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="aca0dc8de905427979b6f78bdd74ca02c"></a><!-- doxytag: member="bgp_aspath.c::SEGMENT_STR_LEN" ref="aca0dc8de905427979b6f78bdd74ca02c" args="(X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEGMENT_STR_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a></td><td>)</td>
          <td>&#160;&#160;&#160;(((<a class="el" href="spgrid_8c.html#a90fd6c5f495a36ebf73ab5d2f1c21b47">X</a>)-&gt;<a class="el" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> * ASN_STR_LEN) + 2 + 1 + 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abf1461b6506e68c224e958ffb30655cd"></a><!-- doxytag: member="bgp_aspath.c::SNMP_PATHSEG_MAX" ref="abf1461b6506e68c224e958ffb30655cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNMP_PATHSEG_MAX&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454"></a><!-- doxytag: member="bgp_aspath.c::as_token" ref="ad682fed782c16fc7fcd42a7da3924454" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed"></a><!-- doxytag: member="as_token_asval" ref="ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed" args="" -->as_token_asval</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf"></a><!-- doxytag: member="as_token_set_start" ref="ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf" args="" -->as_token_set_start</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3"></a><!-- doxytag: member="as_token_set_end" ref="ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3" args="" -->as_token_set_end</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3"></a><!-- doxytag: member="as_token_confed_seq_start" ref="ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3" args="" -->as_token_confed_seq_start</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d"></a><!-- doxytag: member="as_token_confed_seq_end" ref="ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d" args="" -->as_token_confed_seq_end</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007"></a><!-- doxytag: member="as_token_confed_set_start" ref="ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007" args="" -->as_token_confed_set_start</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef"></a><!-- doxytag: member="as_token_confed_set_end" ref="ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef" args="" -->as_token_confed_set_end</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56"></a><!-- doxytag: member="as_token_unknown" ref="ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56" args="" -->as_token_unknown</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01663">1663</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed">as_token_asval</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf">as_token_set_start</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3">as_token_set_end</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3">as_token_confed_seq_start</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d">as_token_confed_seq_end</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007">as_token_confed_set_start</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef">as_token_confed_set_end</a>,
  <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>
};
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a601c9ef2ba7a75d8757e04d3f8585886"></a><!-- doxytag: member="bgp_aspath.c::aspath_add_confed_seq" ref="a601c9ef2ba7a75d8757e04d3f8585886" args="(struct aspath *aspath, as_t asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_add_confed_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01593">1593</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#aebb4c4aacec379d3b92d67dfbf74b897">aspath_add_one_as</a> (aspath, asno, <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aebb4c4aacec379d3b92d67dfbf74b897"></a><!-- doxytag: member="bgp_aspath.c::aspath_add_one_as" ref="aebb4c4aacec379d3b92d67dfbf74b897" args="(struct aspath *aspath, as_t asno, u_char type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structaspath.html">aspath</a>* aspath_add_one_as </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01357">1357</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<a class="code" href="structassegment.html">assegment</a> = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="comment">/* In case of empty aspath. */</span>
  <span class="keywordflow">if</span> (assegment == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || assegment-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> == 0)
    {
      aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>, 1);
      aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] = asno;
      
      <span class="keywordflow">if</span> (assegment)
    <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (assegment);

      <span class="keywordflow">return</span> aspath;
    }

  <span class="keywordflow">if</span> (assegment-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>)
    aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <a class="code" href="bgp__aspath_8c.html#a63f8c7d652204435400c4309a5200fe8">assegment_prepend_asns</a> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>, asno, 1);
  <span class="keywordflow">else</span> 
    {
      <span class="comment">/* create new segment</span>
<span class="comment">       * push it onto head of aspath&#39;s segment chain </span>
<span class="comment">       */</span>
      <span class="keyword">struct </span>assegment *newsegment;
      
      newsegment = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>, 1);
      newsegment-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] = asno;
      
      newsegment-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = assegment;
      aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = newsegment;
    }

  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8e5a3fc38d9717bcdcc75ba861459dd6"></a><!-- doxytag: member="bgp_aspath.c::aspath_add_seq" ref="a8e5a3fc38d9717bcdcc75ba861459dd6" args="(struct aspath *aspath, as_t asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_add_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01394">1394</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#aebb4c4aacec379d3b92d67dfbf74b897">aspath_add_one_as</a> (aspath, asno, <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a615342ae906f2fd579780ce7eda4ff6a"></a><!-- doxytag: member="bgp_aspath.c::aspath_aggregate" ref="a615342ae906f2fd579780ce7eda4ff6a" args="(struct aspath *as1, struct aspath *as2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_aggregate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00988">988</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keywordtype">int</span> minlen;
  <span class="keywordtype">int</span> match;
  <span class="keywordtype">int</span> from;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1 = as1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2 = as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *asset;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *prevseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  match = 0;
  minlen = 0;
  aspath = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  asset = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* First of all check common leading sequence. */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; seg2)
    {      
      <span class="comment">/* Check segment type. */</span>
      <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
    <span class="keywordflow">break</span>;

      <span class="comment">/* Minimum segment length. */</span>
      minlen = <a class="code" href="bgp__aspath_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a> (seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);

      <span class="keywordflow">for</span> (match = 0; match &lt; minlen; match++)
    <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[match] != seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[match])
      <span class="keywordflow">break</span>;

      <span class="keywordflow">if</span> (match)
    {
      <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, 0);
      
      seg = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (seg, seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, match);

      <span class="keywordflow">if</span> (! aspath)
        {
          aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
          aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = seg;
         }
      <span class="keywordflow">else</span>
        prevseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg;
      
      prevseg = seg;
    }

      <span class="keywordflow">if</span> (match != minlen || match != seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> 
      || seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> != seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>)
    <span class="keywordflow">break</span>;
      
      seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }

  <span class="keywordflow">if</span> (! aspath)
    aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a>();

  <span class="comment">/* Make as-set using rest of all information. */</span>
  from = match;
  <span class="keywordflow">while</span> (seg1)
    {
      <span class="keywordflow">for</span> (i = from; i &lt; seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    asset = <a class="code" href="bgp__aspath_8c.html#a0c0adc19aecf830681ee9ef1e7357c09">aspath_aggregate_as_set_add</a> (aspath, asset, seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i]);
      
      from = 0;
      seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }

  from = match;
  <span class="keywordflow">while</span> (seg2)
    {
      <span class="keywordflow">for</span> (i = from; i &lt; seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    asset = <a class="code" href="bgp__aspath_8c.html#a0c0adc19aecf830681ee9ef1e7357c09">aspath_aggregate_as_set_add</a> (aspath, asset, seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i]);

      from = 0;
      seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  
  <a class="code" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (aspath);
  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0c0adc19aecf830681ee9ef1e7357c09"></a><!-- doxytag: member="bgp_aspath.c::aspath_aggregate_as_set_add" ref="a0c0adc19aecf830681ee9ef1e7357c09" args="(struct aspath *aspath, struct assegment *asset, as_t as)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* aspath_aggregate_as_set_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>asset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>as</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00947">947</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;

  <span class="comment">/* If this is first AS set member, create new as-set segment. */</span>
  <span class="keywordflow">if</span> (asset == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      asset = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (<a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>, 1);
      <span class="keywordflow">if</span> (! aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = asset;
      <span class="keywordflow">else</span>
        {
          <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
          <span class="keywordflow">while</span> (seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
            seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = asset;
        }
      asset-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> = <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>;
      asset-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> = 1;
      asset-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] = <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>;
    }
  <span class="keywordflow">else</span>
    {
      <span class="comment">/* Check this AS value already exists or not. */</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; asset-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    <span class="keywordflow">if</span> (asset-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>)
      <span class="keywordflow">return</span> asset;
      
      asset-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>++;
      asset-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>, asset-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, 
                            asset-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> * <a class="code" href="bgp__aspath_8c.html#abb85cf2f703f185eb334ac8cfaac7377">AS_VALUE_SIZE</a>);
      asset-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[asset-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - 1] = <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>;
    }
  

  <span class="keywordflow">return</span> asset;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6b8a24127d224a6311da7230e4067f89"></a><!-- doxytag: member="bgp_aspath.c::aspath_as_add" ref="a6b8a24127d224a6311da7230e4067f89" args="(struct aspath *as, as_t asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void aspath_as_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01600">1600</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="keywordflow">if</span> (!seg)
    <span class="keywordflow">return</span>;
  
  <span class="comment">/* Last segment search procedure. */</span>
  <span class="keywordflow">while</span> (seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
    seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (seg, &amp;asno, 1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa7075e8c0246a68a9ed4d56780f9dc7a"></a><!-- doxytag: member="bgp_aspath.c::aspath_cmp" ref="aa7075e8c0246a68a9ed4d56780f9dc7a" args="(const void *arg1, const void *arg2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int aspath_cmp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>arg2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01824">1824</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1 = ((<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *)arg1)-&gt;segments;
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2 = ((<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *)arg2)-&gt;segments;
  
  <span class="keywordflow">while</span> (seg1 || seg2)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      <span class="keywordflow">if</span> ((!seg1 &amp;&amp; seg2) || (seg1 &amp;&amp; !seg2))
    <span class="keywordflow">return</span> 0;
      <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
        <span class="keywordflow">return</span> 0;      
      <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> != seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>)
        <span class="keywordflow">return</span> 0;
      <span class="keywordflow">for</span> (i = 0; i &lt; seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] != seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i])
          <span class="keywordflow">return</span> 0;
      seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5f979a1ff3bc3908684e4592e5c383eb"></a><!-- doxytag: member="bgp_aspath.c::aspath_cmp_left" ref="a5f979a1ff3bc3908684e4592e5c383eb" args="(const struct aspath *aspath1, const struct aspath *aspath2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_cmp_left </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01402">1402</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1 = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2 = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (!(aspath1 &amp;&amp; aspath2))
    <span class="keywordflow">return</span> 0;

  seg1 = aspath1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  seg2 = aspath2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="comment">/* find first non-confed segments for each */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; ((seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
          || (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)))
    seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="keywordflow">while</span> (seg2 &amp;&amp; ((seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
          || (seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)))
    seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="comment">/* Check as1&#39;s */</span>
  <span class="keywordflow">if</span> (!(seg1 &amp;&amp; seg2
    &amp;&amp; (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>) &amp;&amp; (seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)))
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] == seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0])
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ace7eb37e6ea088fb0ea82c9ae4c58375"></a><!-- doxytag: member="bgp_aspath.c::aspath_cmp_left_confed" ref="ace7eb37e6ea088fb0ea82c9ae4c58375" args="(const struct aspath *aspath1, const struct aspath *aspath2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_cmp_left_confed </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01539">1539</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (! (aspath1 &amp;&amp; aspath2) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> ( !(aspath1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> &amp;&amp; aspath2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> ( (aspath1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      || (aspath2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (aspath1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] == aspath2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0])
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab2915d467a13796ada52e009773a5776"></a><!-- doxytag: member="bgp_aspath.c::aspath_confed_check" ref="ab2915d467a13796ada52e009773a5776" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_confed_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01143">1143</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;

  <span class="keywordflow">if</span> ( !(aspath &amp;&amp; aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;

  seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a> || seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      <span class="keywordflow">return</span> 1;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad62e86fb815f7395ccd758f5fe5bf2cb"></a><!-- doxytag: member="bgp_aspath.c::aspath_count" ref="ad62e86fb815f7395ccd758f5fe5bf2cb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long aspath_count </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01648">1648</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>-&gt;<a class="code" href="structhash.html#a4d82055a4a52d99ee887d24004fd91d3">count</a>;
}     
</pre></div>
</div>
</div>
<a class="anchor" id="a8638c553cd3d2c87161aa489ea0a45d7"></a><!-- doxytag: member="bgp_aspath.c::aspath_count_confeds" ref="a8638c553cd3d2c87161aa489ea0a45d7" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_count_confeds </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00412">412</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
        count += seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)
        count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae0142a952a7219bbe0244f266ab0f0f5"></a><!-- doxytag: member="bgp_aspath.c::aspath_count_hops" ref="ae0142a952a7219bbe0244f266ab0f0f5" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_count_hops </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00430">430</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
        count += seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>)
        count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3a932cff645a730d2e5d9aeec874e127"></a><!-- doxytag: member="bgp_aspath.c::aspath_delete_confed_seq" ref="a3a932cff645a730d2e5d9aeec874e127" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_delete_confed_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01560">1560</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;

  <span class="keywordflow">if</span> (!(aspath &amp;&amp; aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>))
    <span class="keywordflow">return</span> aspath;

  seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* &quot;if the first path segment of the AS_PATH is </span>
<span class="comment">   *  of type AS_CONFED_SEQUENCE,&quot;</span>
<span class="comment">   */</span>
  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
    <span class="keywordflow">return</span> aspath;

  <span class="comment">/* &quot;... that segment and any immediately following segments </span>
<span class="comment">   *  of the type AS_CONFED_SET or AS_CONFED_SEQUENCE are removed </span>
<span class="comment">   *  from the AS_PATH attribute,&quot;</span>
<span class="comment">   */</span>
  <span class="keywordflow">while</span> (seg &amp;&amp; 
         (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a> || seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>))
    {
      aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (seg);
      seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
    }
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (aspath);
  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a47dde6392c8d26a1f440fc061afed4fc"></a><!-- doxytag: member="bgp_aspath.c::aspath_delimiter_char" ref="a47dde6392c8d26a1f440fc061afed4fc" args="(u_char type, u_char which)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char aspath_delimiter_char </td>
          <td>(</td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>which</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00363">363</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keyword">struct</span>
  {
    <span class="keywordtype">int</span> <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
    <span class="keywordtype">char</span> start;
    <span class="keywordtype">char</span> end;
  } aspath_delim_char [] =
    {
      { <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>,             <span class="charliteral">&#39;{&#39;</span>, <span class="charliteral">&#39;}&#39;</span> },
      { <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>,      <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;]&#39;</span> },
      { <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>, <span class="charliteral">&#39;(&#39;</span>, <span class="charliteral">&#39;)&#39;</span> },
      { 0 }
    };

  <span class="keywordflow">for</span> (i = 0; aspath_delim_char[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>].type != 0; i++)
    {
      <span class="keywordflow">if</span> (aspath_delim_char[i].<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a> == <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>)
    {
      <span class="keywordflow">if</span> (which == <a class="code" href="bgp__aspath_8c.html#a7bd5b354f56c8bdfc2cc29584086d216">AS_SEG_START</a>)
        <span class="keywordflow">return</span> aspath_delim_char[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>].start;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == <a class="code" href="bgp__aspath_8c.html#a1040fc437c617bbaa7ae208d1066ea9d">AS_SEG_END</a>)
        <span class="keywordflow">return</span> aspath_delim_char[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>].end;
    }
    }
  <span class="keywordflow">return</span> <span class="charliteral">&#39; &#39;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2de7834df2eead0bfa5a117ce265e6ca"></a><!-- doxytag: member="bgp_aspath.c::aspath_dup" ref="a2de7834df2eead0bfa5a117ce265e6ca" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_dup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00640">640</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span>aspath *<span class="keyword">new</span>;

  <span class="keyword">new</span> = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bac824bd651670a9b4987f59bc2f25b70d">MTYPE_AS_PATH</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> aspath));

  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    <span class="keyword">new</span>-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <span class="keywordflow">else</span>
    <span class="keyword">new</span>-&gt;segments = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keyword">new</span>-&gt;str = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (aspath);

  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aadc92a26e3c657307be1c2057b187cda"></a><!-- doxytag: member="bgp_aspath.c::aspath_empty" ref="aadc92a26e3c657307be1c2057b187cda" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_empty </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01632">1632</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#ac9e8aff45338b803e560318286e3f2af">aspath_parse</a> (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1, 0); <span class="comment">/* 32Bit ;-) not AS4_PATH */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa737121f7df6f3e64869fc9a6c330b2f"></a><!-- doxytag: member="bgp_aspath.c::aspath_empty_get" ref="aa737121f7df6f3e64869fc9a6c330b2f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_empty_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01638">1638</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a>;

  aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
  aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (aspath);
  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7f9ae7aa66eb067701e37c65edd2e78"></a><!-- doxytag: member="bgp_aspath.c::aspath_filter_exclude" ref="ac7f9ae7aa66eb067701e37c65edd2e78" args="(struct aspath *source, struct aspath *exclude_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_filter_exclude </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>exclude_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01287">1287</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> * srcseg, * exclseg, * lastseg;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> * newpath;

  newpath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a>();
  lastseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">for</span> (srcseg = source-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>; srcseg; srcseg = srcseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
  {
    <span class="keywordtype">unsigned</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>, <a class="code" href="spgrid_8c.html#a04ee6b20e6d3476ab1f51397993cfeef">y</a>, newlen = 0, done = 0, skip_as;
    <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> * newseg;

    <span class="comment">/* Find out, how much ASns are we going to pick from this segment.</span>
<span class="comment">     * We can&#39;t perform filtering right inline, because the size of</span>
<span class="comment">     * the new segment isn&#39;t known at the moment yet.</span>
<span class="comment">     */</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; srcseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      skip_as = 0;
      <span class="keywordflow">for</span> (exclseg = exclude_list-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>; exclseg &amp;&amp; !skip_as; exclseg = exclseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        <span class="keywordflow">for</span> (y = 0; y &lt; exclseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; y++)
          <span class="keywordflow">if</span> (srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == exclseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[y])
          {
            skip_as = 1;
            <span class="comment">// There&#39;s no sense in testing the rest of exclusion list, bail out.</span>
            <span class="keywordflow">break</span>;
          }
      <span class="keywordflow">if</span> (!skip_as)
        newlen++;
    }
    <span class="comment">/* newlen is now the number of ASns to copy */</span>
    <span class="keywordflow">if</span> (!newlen)
      <span class="keywordflow">continue</span>;

    <span class="comment">/* Actual copying. Allocate memory and iterate once more, performing filtering. */</span>
    newseg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (srcseg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, newlen);
    <span class="keywordflow">for</span> (i = 0; i &lt; srcseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      skip_as = 0;
      <span class="keywordflow">for</span> (exclseg = exclude_list-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>; exclseg &amp;&amp; !skip_as; exclseg = exclseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        <span class="keywordflow">for</span> (y = 0; y &lt; exclseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; y++)
          <span class="keywordflow">if</span> (srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == exclseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[y])
          {
            skip_as = 1;
            <span class="keywordflow">break</span>;
          }
      <span class="keywordflow">if</span> (skip_as)
        <span class="keywordflow">continue</span>;
      newseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[done++] = srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>];
    }
    <span class="comment">/* At his point newlen must be equal to done, and both must be positive. Append</span>
<span class="comment">     * the filtered segment to the gross result. */</span>
    <span class="keywordflow">if</span> (!lastseg)
      newpath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = newseg;
    <span class="keywordflow">else</span>
      lastseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = newseg;
    lastseg = newseg;
  }
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (newpath);
  <span class="comment">/* We are happy returning even an empty AS_PATH, because the administrator</span>
<span class="comment">   * might expect this very behaviour. There&#39;s a mean to avoid this, if necessary,</span>
<span class="comment">   * by having a match rule against certain AS_PATH regexps in the route-map index.</span>
<span class="comment">   */</span>
  <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (source);
  <span class="keywordflow">return</span> newpath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad12467085616732b130bd1edac9277fb"></a><!-- doxytag: member="bgp_aspath.c::aspath_finish" ref="ad12467085616732b130bd1edac9277fb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_finish </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01855">1855</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="hash_8c.html#ad0d6074e4b7475f7c249212bb8e67de5">hash_free</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>);
  <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="keywordflow">if</span> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>)
    <a class="code" href="stream_8c.html#ac25ca0f9b32a76b4ea34ecb3c9d62481">stream_free</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9ed7eb61027a6f70bb24f3ffc5cc399f"></a><!-- doxytag: member="bgp_aspath.c::aspath_firstas_check" ref="a9ed7eb61027a6f70bb24f3ffc5cc399f" args="(struct aspath *aspath, as_t asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_firstas_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01077">1077</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> ( (aspath == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>
      &amp;&amp; (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
      &amp;&amp; (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] == asno ))
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af8db79f3e25ae5a01dfec9070557c21a"></a><!-- doxytag: member="bgp_aspath.c::aspath_free" ref="af8db79f3e25ae5a01dfec9070557c21a" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00330">330</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!aspath)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>);
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bac824bd651670a9b4987f59bc2f25b70d">MTYPE_AS_PATH</a>, aspath);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adb39eb9be1d3d958aab2de3e0a3e884f"></a><!-- doxytag: member="bgp_aspath.c::aspath_gettoken" ref="adb39eb9be1d3d958aab2de3e0a3e884f" args="(const char *buf, enum as_token *token, u_long *asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* aspath_gettoken </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a> *&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_long *&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01677">1677</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a> = buf;

  <span class="comment">/* Skip seperators (space for sequences, &#39;,&#39; for sets). */</span>
  <span class="keywordflow">while</span> (isspace ((<span class="keywordtype">int</span>) *p) || *p == <span class="charliteral">&#39;,&#39;</span>)
    p++;

  <span class="comment">/* Check the end of the string and type specify characters</span>
<span class="comment">     (e.g. {}()). */</span>
  <span class="keywordflow">switch</span> (*p)
    {
    <span class="keywordflow">case</span> <span class="charliteral">&#39;\0&#39;</span>:
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;{&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf">as_token_set_start</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;}&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3">as_token_set_end</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;(&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3">as_token_confed_seq_start</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;)&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d">as_token_confed_seq_end</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;[&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007">as_token_confed_set_start</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    <span class="keywordflow">case</span> <span class="charliteral">&#39;]&#39;</span>:
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef">as_token_confed_set_end</a>;
      p++;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }

  <span class="comment">/* Check actual AS value. */</span>
  <span class="keywordflow">if</span> (isdigit ((<span class="keywordtype">int</span>) *p)) 
    {
      <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> asval;
      
      *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed">as_token_asval</a>;
      asval = (*p - <span class="charliteral">&#39;0&#39;</span>);
      p++;
      
      <span class="keywordflow">while</span> (isdigit ((<span class="keywordtype">int</span>) *p)) 
        {
          asval *= 10;
          asval += (*p - <span class="charliteral">&#39;0&#39;</span>);
          p++;
        }
      *asno = asval;
      <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
    }
  
  <span class="comment">/* There is no match then return unknown token. */</span>
  *token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>;
  <span class="keywordflow">return</span>  p++;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a594fc069e213e63fc1a15af40d93b3d4"></a><!-- doxytag: member="bgp_aspath.c::aspath_has_as4" ref="a594fc069e213e63fc1a15af40d93b3d4" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_has_as4 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00489">489</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5a3365c8e7924ca85bd9675dc6597908">BGP_AS_MAX</a>)
      <span class="keywordflow">return</span> 1;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4a0316093e4bcf2062f6e0ab12106cd1"></a><!-- doxytag: member="bgp_aspath.c::aspath_hash_alloc" ref="a4a0316093e4bcf2062f6e0ab12106cd1" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* aspath_hash_alloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00657">657</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a>;

  <span class="comment">/* New aspath structure is needed. */</span>
  aspath = <a class="code" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a> (arg);
  
  <span class="comment">/* Malformed AS path value. */</span>
  <span class="keywordflow">if</span> (! aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    {
      <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (aspath);
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }

  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab1c68ac1741167dd6e631f6eb6d12705"></a><!-- doxytag: member="bgp_aspath.c::aspath_highest" ref="ab1c68ac1741167dd6e631f6eb6d12705" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> aspath_highest </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00469">469</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> highest = 0;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; highest
            &amp;&amp; (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &lt; <a class="code" href="bgp__aspath_8h.html#ac7d780d83cdd277414ca9ba2785ff152">BGP_PRIVATE_AS_MIN</a>
                || seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5eab303011de75bf71ee2d346bed9927">BGP_PRIVATE_AS_MAX</a>))
      highest = seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>];
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> highest;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a34b9f56e53531a0e4ceedcb31d59e027"></a><!-- doxytag: member="bgp_aspath.c::aspath_init" ref="a34b9f56e53531a0e4ceedcb31d59e027" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01849">1849</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a> = <a class="code" href="hash_8c.html#a5a114f3e041a28afaf1acfa760728c24">hash_create_size</a> (32767, <a class="code" href="bgp__aspath_8c.html#a0ff2c762b3aea1084db8500839a8d314">aspath_key_make</a>, <a class="code" href="bgp__aspath_8c.html#aa7075e8c0246a68a9ed4d56780f9dc7a">aspath_cmp</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a344d7cb1b52c926464681624421bc9c1"></a><!-- doxytag: member="bgp_aspath.c::aspath_intern" ref="a344d7cb1b52c926464681624421bc9c1" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_intern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00616">616</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span>aspath *find;
  
  <span class="comment">/* Assert this AS path structure is not interned. */</span>
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (aspath-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a> == 0);

  <span class="comment">/* Check AS path hash. */</span>
  find = <a class="code" href="hash_8c.html#ab0bb31bd6c883d6563930341dccedd22">hash_get</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, aspath, <a class="code" href="hash_8c.html#ac2705f6d220cf4d8049201e369ff6d62">hash_alloc_intern</a>);

  <span class="keywordflow">if</span> (find != aspath)
    <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (aspath);

  find-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>++;

  <span class="keywordflow">if</span> (! find-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    find-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (find);

  <span class="keywordflow">return</span> find;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0ff2c762b3aea1084db8500839a8d314"></a><!-- doxytag: member="bgp_aspath.c::aspath_key_make" ref="a0ff2c762b3aea1084db8500839a8d314" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_key_make </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01809">1809</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> * <a class="code" href="structaspath.html">aspath</a> = (<span class="keyword">struct </span>aspath *) <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structkey.html">key</a> = 0;

  <span class="keywordflow">if</span> (!aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (aspath);
  
  key = <a class="code" href="jhash_8c.html#acbd0055c1aca2b1ec110501e32191835">jhash</a> (aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>, strlen(aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>), 2334325);

  <span class="keywordflow">return</span> <a class="code" href="zebra__rib_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2ea3a3f15468d013b12a0ee4558026b5"></a><!-- doxytag: member="bgp_aspath.c::aspath_left_confed_check" ref="a2ea3a3f15468d013b12a0ee4558026b5" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_left_confed_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01164">1164</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> ( !(aspath &amp;&amp; aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;

  <span class="keywordflow">if</span> ( (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      || (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>) )
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a09c83e4313915a5191a19439186f2280"></a><!-- doxytag: member="bgp_aspath.c::aspath_loop_check" ref="a09c83e4313915a5191a19439186f2280" args="(struct aspath *aspath, as_t asno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_loop_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01092">1092</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;

  <span class="keywordflow">if</span> ( (aspath == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) )
    <span class="keywordflow">return</span> 0;
  
  seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == asno)
      count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a861816ed3372dd09cee8ad97610e23f8"></a><!-- doxytag: member="bgp_aspath.c::aspath_make_str_count" ref="a861816ed3372dd09cee8ad97610e23f8" args="(struct aspath *as)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* aspath_make_str_count </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00506">506</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;
  <span class="keywordtype">int</span> str_size;
  <span class="keywordtype">int</span> len = 0;
  <span class="keywordtype">char</span> *str_buf;

  <span class="comment">/* Empty aspath. */</span>
  <span class="keywordflow">if</span> (!as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    {
      str_buf = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, 1);
      str_buf[0] = <span class="charliteral">&#39;\0&#39;</span>;
      <span class="keywordflow">return</span> str_buf;
    }
  
  seg = as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* ASN takes 5 to 10 chars plus seperator, see below.</span>
<span class="comment">   * If there is one differing segment type, we need an additional</span>
<span class="comment">   * 2 chars for segment delimiters, and the final &#39;\0&#39;.</span>
<span class="comment">   * Hopefully this is large enough to avoid hitting the realloc</span>
<span class="comment">   * code below for most common sequences.</span>
<span class="comment">   *</span>
<span class="comment">   * This was changed to 10 after the well-known BGP assertion, which</span>
<span class="comment">   * had hit some parts of the Internet in May of 2009.</span>
<span class="comment">   */</span>
<span class="preprocessor">#define ASN_STR_LEN (10 + 1)</span>
<span class="preprocessor"></span>  str_size = <a class="code" href="regex_8c.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a> (<a class="code" href="bgp__aspath_8c.html#ae315d7679de163b78c9fc6cb9db21e31">assegment_count_asns</a> (seg, 0) * ASN_STR_LEN + 2 + 1,
                  <a class="code" href="bgp__aspath_8h.html#ae342c8082d45828fbdf91149aec573c9">ASPATH_STR_DEFAULT_LEN</a>);
  str_buf = <a class="code" href="memory_8h.html#a6491adf46c1d769b529a8f2f7d75f2fe">XMALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, str_size);

  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      <span class="keywordtype">char</span> seperator;
      
      <span class="comment">/* Check AS type validity. Set seperator for segment */</span>
      <span class="keywordflow">switch</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
        {
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>:
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>:
            seperator = <span class="charliteral">&#39;,&#39;</span>;
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>:
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>:
            seperator = <span class="charliteral">&#39; &#39;</span>;
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span>:
            <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, str_buf);
            <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }
      
      <span class="comment">/* We might need to increase str_buf, particularly if path has</span>
<span class="comment">       * differing segments types, our initial guesstimate above will</span>
<span class="comment">       * have been wrong. Need 10 chars for ASN, a seperator each and</span>
<span class="comment">       * potentially two segment delimiters, plus a space between each</span>
<span class="comment">       * segment and trailing zero.</span>
<span class="comment">       *</span>
<span class="comment">       * This definitely didn&#39;t work with the value of 5 bytes and</span>
<span class="comment">       * 32-bit ASNs.</span>
<span class="comment">       */</span>
<span class="preprocessor">#define SEGMENT_STR_LEN(X) (((X)-&gt;length * ASN_STR_LEN) + 2 + 1 + 1)</span>
<span class="preprocessor"></span>      <span class="keywordflow">if</span> ( (len + <a class="code" href="bgp__aspath_8c.html#aca0dc8de905427979b6f78bdd74ca02c">SEGMENT_STR_LEN</a>(seg)) &gt; str_size)
        {
          str_size = len + <a class="code" href="bgp__aspath_8c.html#aca0dc8de905427979b6f78bdd74ca02c">SEGMENT_STR_LEN</a>(seg);
          str_buf = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, str_buf, str_size);
        }
<span class="preprocessor">#undef ASN_STR_LEN</span>
<span class="preprocessor"></span><span class="preprocessor">#undef SEGMENT_STR_LEN</span>
<span class="preprocessor"></span>      
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
        len += <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (str_buf + len, str_size - len, 
             <span class="stringliteral">&quot;%c&quot;</span>, 
                         <a class="code" href="bgp__aspath_8c.html#a47dde6392c8d26a1f440fc061afed4fc">aspath_delimiter_char</a> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, <a class="code" href="bgp__aspath_8c.html#a7bd5b354f56c8bdfc2cc29584086d216">AS_SEG_START</a>));
      
      <span class="comment">/* write out the ASNs, with their seperators, bar the last one*/</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        {
          len += <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (str_buf + len, str_size - len, <span class="stringliteral">&quot;%u&quot;</span>, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i]);
          
          <span class="keywordflow">if</span> (i &lt; (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - 1))
            len += <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (str_buf + len, str_size - len, <span class="stringliteral">&quot;%c&quot;</span>, seperator);
        }
      
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
        len += <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (str_buf + len, str_size - len, <span class="stringliteral">&quot;%c&quot;</span>, 
                        <a class="code" href="bgp__aspath_8c.html#a47dde6392c8d26a1f440fc061afed4fc">aspath_delimiter_char</a> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, <a class="code" href="bgp__aspath_8c.html#a1040fc437c617bbaa7ae208d1066ea9d">AS_SEG_END</a>));
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        len += <a class="code" href="str_8c.html#ad76145a6edfc98981ded8815a760e0cd">snprintf</a> (str_buf + len, str_size - len, <span class="stringliteral">&quot; &quot;</span>);
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (len &lt; str_size);
  
  str_buf[len] = <span class="charliteral">&#39;\0&#39;</span>;

  <span class="keywordflow">return</span> str_buf;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a231a40736f808388d679edb3e82b8238"></a><!-- doxytag: member="bgp_aspath.c::aspath_merge" ref="a231a40736f808388d679edb3e82b8238" args="(struct aspath *as1, struct aspath *as2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structaspath.html">aspath</a>* aspath_merge </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01179">1179</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *last, *<span class="keyword">new</span>;

  <span class="keywordflow">if</span> (! as1 || ! as2)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  last = <span class="keyword">new</span> = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (as1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  
  <span class="comment">/* find the last valid segment */</span>
  <span class="keywordflow">while</span> (last &amp;&amp; last-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
    last = last-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
  
  last-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <span class="keyword">new</span>;
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (as2);
  <span class="keywordflow">return</span> as2;
}
</pre></div>
</div>
</div>
<a class="anchor" id="adb40e0a61d4ff6a44b740cbc322945d8"></a><!-- doxytag: member="bgp_aspath.c::aspath_new" ref="adb40e0a61d4ff6a44b740cbc322945d8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structaspath.html">aspath</a>* aspath_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00323">323</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bac824bd651670a9b4987f59bc2f25b70d">MTYPE_AS_PATH</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structaspath.html">aspath</a>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac9e8aff45338b803e560318286e3f2af"></a><!-- doxytag: member="bgp_aspath.c::aspath_parse" ref="ac9e8aff45338b803e560318286e3f2af" args="(struct stream *s, size_t length, int use32bit, int as4_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_parse </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use32bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>as4_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00784">784</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> as;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *find;

  <span class="comment">/* Parse each segment and construct normalised list of struct assegment */</span>
  memset (&amp;as, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structaspath.html">aspath</a>));
  <span class="keywordflow">if</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> != 0)
    {
      as.segments = <a class="code" href="bgp__aspath_8c.html#a7b78a035d0b8f3e4d0ecb3bf2279701a">assegments_parse</a> (s, <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>, use32bit, as4_path);

      <span class="keywordflow">if</span> (as.segments == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ;   <span class="comment">/* Invalid AS_PATH or AS4_PATH  */</span>
    } ;
  
  <span class="comment">/* If already same aspath exist then return it. */</span>
  find = <a class="code" href="hash_8c.html#ab0bb31bd6c883d6563930341dccedd22">hash_get</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, &amp;as, <a class="code" href="bgp__aspath_8c.html#a4a0316093e4bcf2062f6e0ab12106cd1">aspath_hash_alloc</a>);
  
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a>(find) ;        <span class="comment">/* valid aspath, so must find or create */</span>
  
  <span class="comment">/* aspath_hash_alloc dupes segments too. that probably could be</span>
<span class="comment">   * optimised out.</span>
<span class="comment">   */</span>
  <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (as.segments);
  <span class="keywordflow">if</span> (as.str)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, as.str);
  
  find-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>++;

  <span class="keywordflow">return</span> find;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a042b5a8463ffb3adedffa05e69640726"></a><!-- doxytag: member="bgp_aspath.c::aspath_prepend" ref="a042b5a8463ffb3adedffa05e69640726" args="(struct aspath *as1, struct aspath *as2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01200">1200</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2;

  <span class="keywordflow">if</span> (! as1 || ! as2)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  seg1 = as1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  seg2 = as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* If as2 is empty, only need to dupe as1&#39;s chain onto as2 */</span>
  <span class="keywordflow">if</span> (seg2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (as1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
      <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (as2);
      <span class="keywordflow">return</span> as2;
    }
  
  <span class="comment">/* If as1 is empty AS, no prepending to do. */</span>
  <span class="keywordflow">if</span> (seg1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> as2;
  
  <span class="comment">/* find the tail as1&#39;s segment chain. */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
    seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="comment">/* Delete any AS_CONFED_SEQUENCE segment from as2. */</span>
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a> &amp;&amp; seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
    as2 = <a class="code" href="bgp__aspath_8c.html#a3a932cff645a730d2e5d9aeec874e127">aspath_delete_confed_seq</a> (as2);

  <span class="comment">/* Compare last segment type of as1 and first segment type of as2. */</span>
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
    <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (as1, as2);

  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
    {
      <span class="comment">/* We have two chains of segments, as1-&gt;segments and seg2, </span>
<span class="comment">       * and we have to attach them together, merging the attaching</span>
<span class="comment">       * segments together into one.</span>
<span class="comment">       * </span>
<span class="comment">       * 1. dupe as1-&gt;segments onto head of as2</span>
<span class="comment">       * 2. merge seg2&#39;s asns onto last segment of this new chain</span>
<span class="comment">       * 3. attach chain after seg2</span>
<span class="comment">       */</span>
      
      <span class="comment">/* dupe as1 onto as2&#39;s head */</span>
      seg1 = as2-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (as1-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
      
      <span class="comment">/* refind the tail of as2, reusing seg1 */</span>
      <span class="keywordflow">while</span> (seg1 &amp;&amp; seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      
      <span class="comment">/* merge the old head, seg2, into tail, seg1 */</span>
      seg1 = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (seg1, seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
      
      <span class="comment">/* bypass the merged seg2, and attach any chain after it to</span>
<span class="comment">       * chain descending from as2&#39;s head</span>
<span class="comment">       */</span>
      seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      
      <span class="comment">/* seg2 is now referenceless and useless*/</span>
      <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (seg2);
      
      <span class="comment">/* we&#39;ve now prepended as1&#39;s segment chain to as2, merging</span>
<span class="comment">       * the inbetween AS_SEQUENCE of seg2 in the process </span>
<span class="comment">       */</span>
      <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (as2);
      <span class="keywordflow">return</span> as2;
    }
  <span class="keywordflow">else</span>
    {
      <span class="comment">/* AS_SET merge code is needed at here. */</span>
      <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (as1, as2);
    }
  <span class="comment">/* XXX: Ermmm, what if as1 has multiple segments?? */</span>
  
  <span class="comment">/* Not reached */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac20fd0ca4085890de5bd9ea6a6d41e8e"></a><!-- doxytag: member="bgp_aspath.c::aspath_print" ref="ac20fd0ca4085890de5bd9ea6a6d41e8e" args="(struct aspath *as)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* aspath_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01866">1866</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> (as ? as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> : <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0b7af257d32ea864993dd2b3494fa0f0"></a><!-- doxytag: member="bgp_aspath.c::aspath_print_all_vty" ref="a0b7af257d32ea864993dd2b3494fa0f0" args="(struct vty *vty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_print_all_vty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"><em>vty</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01898">1898</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="hash_8c.html#a69eb0b2447b78899dac4da27895b41e7">hash_iterate</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, 
        (<span class="keywordtype">void</span> (*) (<span class="keyword">struct</span> <a class="code" href="structhash__backet.html">hash_backet</a> *, <span class="keywordtype">void</span> *))
        <a class="code" href="bgp__aspath_8c.html#aa1ede5a9090ad2d9e44753c3ad5c1dfb">aspath_show_all_iterator</a>,
        vty);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a32814b0bab0791ca1b85145a1b1a0f3f"></a><!-- doxytag: member="bgp_aspath.c::aspath_print_vty" ref="a32814b0bab0791ca1b85145a1b1a0f3f" args="(struct vty *vty, const char *format, struct aspath *as, const char *suffix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_print_vty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"><em>vty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>suffix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01876">1876</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (format);
  <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, format, as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>);
  <span class="keywordflow">if</span> (strlen (as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>) &amp;&amp; strlen (suffix))
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s&quot;</span>, suffix);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a808020dd81343ccfb8f4cf5f50f5f11c"></a><!-- doxytag: member="bgp_aspath.c::aspath_private_as_check" ref="a808020dd81343ccfb8f4cf5f50f5f11c" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_private_as_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01117">1117</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;
  
  <span class="keywordflow">if</span> ( !(aspath &amp;&amp; aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;
    
  seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      <span class="keywordflow">if</span> ( (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &lt; <a class="code" href="bgp__aspath_8h.html#ac7d780d83cdd277414ca9ba2785ff152">BGP_PRIVATE_AS_MIN</a>)
          || (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5eab303011de75bf71ee2d346bed9927">BGP_PRIVATE_AS_MAX</a>) )
        <span class="keywordflow">return</span> 0;
    }
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a716059e44a39a56b3e05020bec13872e"></a><!-- doxytag: member="bgp_aspath.c::aspath_put" ref="a716059e44a39a56b3e05020bec13872e" args="(struct stream *s, struct aspath *as, int use32bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t aspath_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use32bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00847">847</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keywordtype">size_t</span> bytes = 0;
  
  <span class="keywordflow">if</span> (!seg || seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> == 0)
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (seg)
    {
      <span class="comment">/*</span>
<span class="comment">       * Hey, what do we do when we have &gt; STREAM_WRITABLE(s) here?</span>
<span class="comment">       * At the moment, we would write out a partial aspath, and our peer</span>
<span class="comment">       * will complain and drop the session :-/</span>
<span class="comment">       *</span>
<span class="comment">       * The general assumption here is that many things tested will</span>
<span class="comment">       * never happen.  And, in real live, up to now, they have not.</span>
<span class="comment">       */</span>
      <span class="keywordflow">while</span> (seg &amp;&amp; (<a class="code" href="bgp__aspath_8c.html#a1a25eeaf309e943daf8145bba6a6aa38">ASSEGMENT_LEN</a>(seg, use32bit) &lt;= <a class="code" href="stream_8h.html#a9e7170eddfbd82389e4fcbbb0185f70f">STREAM_WRITEABLE</a>(s)))
        {
          <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          <span class="keywordtype">int</span> written = 0;
          <span class="keywordtype">int</span> asns_packed = 0;
          <span class="keywordtype">size_t</span> lenp;
          
          <span class="comment">/* Overlength segments have to be split up */</span>
          <span class="keywordflow">while</span> ( (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written) &gt; <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>)
            {
              <a class="code" href="bgp__aspath_8c.html#aa38970ca2d675babd8620c170f08da37">assegment_header_put</a> (s, seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>);
              <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (s, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>, use32bit);
              written += <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>;
              bytes += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a> (written, use32bit);
            }
          
          <span class="comment">/* write the final segment, probably is also the first */</span>
          lenp = <a class="code" href="bgp__aspath_8c.html#aa38970ca2d675babd8620c170f08da37">assegment_header_put</a> (s, seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written);
          <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (s, (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> + written), seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written, 
                              use32bit);
          
          <span class="comment">/* Sequence-type segments can be &#39;packed&#39; together</span>
<span class="comment">           * Case of a segment which was overlength and split up</span>
<span class="comment">           * will be missed here, but that doesn&#39;t matter.</span>
<span class="comment">           */</span>
          <span class="keywordflow">while</span> (next &amp;&amp; <a class="code" href="bgp__aspath_8c.html#a38166e509b9394c13cbcc3521d38e5f8">ASSEGMENTS_PACKABLE</a> (seg, next))
            {
              <span class="comment">/* NB: We should never normally get here given we</span>
<span class="comment">               * normalise aspath data when parse them. However, better</span>
<span class="comment">               * safe than sorry. We potentially could call</span>
<span class="comment">               * assegment_normalise here instead, but it&#39;s cheaper and</span>
<span class="comment">               * easier to do it on the fly here rather than go through</span>
<span class="comment">               * the segment list twice every time we write out</span>
<span class="comment">               * aspath&#39;s.</span>
<span class="comment">               */</span>
              
              <span class="comment">/* Next segment&#39;s data can fit in this one */</span>
              <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (s, next-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, use32bit);
              
              <span class="comment">/* update the length of the segment header */</span>
          <a class="code" href="stream_8c.html#a69c37c3d7be1f834141625b2dc450891">stream_putc_at</a> (s, lenp, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written + next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
              asns_packed += next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
               
          next = next-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
        }
          
          bytes += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written + asns_packed, 
                   use32bit);
          seg = <a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
        }
    }
  <span class="keywordflow">return</span> bytes;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1a485a8779fb5fcf0ac2efeb2bdc204d"></a><!-- doxytag: member="bgp_aspath.c::aspath_reconcile_as4" ref="a1a485a8779fb5fcf0ac2efeb2bdc204d" args="(struct aspath *aspath, struct aspath *as4path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_reconcile_as4 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as4path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01440">1440</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg, *newseg, *prevseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span>aspath *newpath = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *mergedpath;
  <span class="keywordtype">int</span> hops, cpasns = 0;
  
  <span class="keywordflow">if</span> (!aspath)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* CONFEDs should get reconciled too.. */</span>
  hops = (<a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (aspath) + <a class="code" href="bgp__aspath_8c.html#a8638c553cd3d2c87161aa489ea0a45d7">aspath_count_confeds</a> (aspath))
         - <a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (as4path);
  
  <span class="keywordflow">if</span> (hops &lt; 0)
    {
      <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4))
        <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;[AS4] Fewer hops in AS_PATH than NEW_AS_PATH&quot;</span>);
      <span class="comment">/* Something&#39;s gone wrong. The RFC says we should now ignore AS4_PATH,</span>
<span class="comment">       * which is daft behaviour - it contains vital loop-detection</span>
<span class="comment">       * information which must have been removed from AS_PATH.</span>
<span class="comment">       */</span>
       hops = <a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (aspath);
    }
  
  <span class="keywordflow">if</span> (!hops)
   <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a> (as4path);
  
  <span class="keywordflow">if</span> ( <a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a>(as4, AS4))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a>(<span class="stringliteral">&quot;[AS4] got AS_PATH %s and AS4_PATH %s synthesizing now&quot;</span>,
               aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>, as4path-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>);

  <span class="keywordflow">while</span> (seg &amp;&amp; hops &gt; 0)
    {
      <span class="keywordflow">switch</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
        {
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>:
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>:
            hops--;
            cpasns = seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>:
        <span class="comment">/* Should never split a confed-sequence, if hop-count</span>
<span class="comment">         * suggests we must then something&#39;s gone wrong somewhere.</span>
<span class="comment">         *</span>
<span class="comment">         * Most important goal is to preserve AS_PATHs prime function</span>
<span class="comment">         * as loop-detector, so we fudge the numbers so that the entire</span>
<span class="comment">         * confed-sequence is merged in.</span>
<span class="comment">         */</span>
        <span class="keywordflow">if</span> (hops &lt; seg-&gt;<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)
          {
            <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4))
              <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4] AS4PATHmangle: AS_CONFED_SEQUENCE falls&quot;</span>
                          <span class="stringliteral">&quot; across 2/4 ASN boundary somewhere, broken..&quot;</span>);
            hops = seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
          }
      <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>:
        cpasns = <a class="code" href="regex_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, hops);
        hops -= seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
    }
      
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (cpasns &lt;= seg-&gt;length);
      
      newseg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, 0);
      newseg = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (newseg, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, cpasns);

      <span class="keywordflow">if</span> (!newpath)
        {
          newpath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
          newpath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = newseg;
        }
      <span class="keywordflow">else</span>
        prevseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = newseg;

      prevseg = newseg;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
    
  <span class="comment">/* We may be able to join some segments here, and we must</span>
<span class="comment">   * do this because... we want normalised aspaths in out hash</span>
<span class="comment">   * and we do not want to stumble in aspath_put.</span>
<span class="comment">   */</span>
  mergedpath = <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (newpath, <a class="code" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a>(as4path));
  <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (newpath);
  mergedpath-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (mergedpath-&gt;segments);
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (mergedpath);
  
  <span class="keywordflow">if</span> ( <a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a>(as4, AS4))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4] result of synthesizing is %s&quot;</span>,
                mergedpath-&gt;str);
  
  <span class="keywordflow">return</span> mergedpath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5feeb93c75798109dd5d38e8ffa91ec2"></a><!-- doxytag: member="bgp_aspath.c::aspath_segment_add" ref="a5feeb93c75798109dd5d38e8ffa91ec2" args="(struct aspath *as, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void aspath_segment_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01616">1616</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<span class="keyword">new</span> = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (<a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>, 0);

  <span class="keywordflow">if</span> (seg)
    {
      <span class="keywordflow">while</span> (seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
    seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = <span class="keyword">new</span>;
    }
  <span class="keywordflow">else</span>
    as-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa1ede5a9090ad2d9e44753c3ad5c1dfb"></a><!-- doxytag: member="bgp_aspath.c::aspath_show_all_iterator" ref="aa1ede5a9090ad2d9e44753c3ad5c1dfb" args="(struct hash_backet *backet, struct vty *vty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void aspath_show_all_iterator </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structhash__backet.html">hash_backet</a> *&#160;</td>
          <td class="paramname"><em>backet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"><em>vty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01885">1885</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *as;

  as = (<span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *) backet-&gt;<a class="code" href="structhash__backet.html#a5bc766458545b915943873cbac480749">data</a>;

  <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;[%p:%u] (%ld) &quot;</span>, backet, backet-&gt;<a class="code" href="structhash__backet.html#a54f1c03a2c3a4bba2c37aaa617a907bf">key</a>, as-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>);
  <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (vty, <span class="stringliteral">&quot;%s%s&quot;</span>, as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>, <a class="code" href="vty_8h.html#a3be8ca867e2953936a95c68dc64824b6">VTY_NEWLINE</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a20eefbd15a5076d10ad6e1e37d800bf2"></a><!-- doxytag: member="bgp_aspath.c::aspath_size" ref="a20eefbd15a5076d10ad6e1e37d800bf2" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00454">454</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      size += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a>(seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, 1);
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> size;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a46008828118eb829c4f5b010175de9ab"></a><!-- doxytag: member="bgp_aspath.c::aspath_snmp_pathseg" ref="a46008828118eb829c4f5b010175de9ab" args="(struct aspath *as, size_t *varlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_char* aspath_snmp_pathseg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>varlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00924">924</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define SNMP_PATHSEG_MAX 1024</span>
<span class="preprocessor"></span>
  <span class="keywordflow">if</span> (!<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>)
    <a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a> = <a class="code" href="stream_8c.html#a7117cdad9fa5e5ae633e0cf08d047459">stream_new</a> (SNMP_PATHSEG_MAX);
  <span class="keywordflow">else</span>
    <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
  
  <span class="keywordflow">if</span> (!as)
    {
      *varlen = 0;
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
  <a class="code" href="bgp__aspath_8c.html#a716059e44a39a56b3e05020bec13872e">aspath_put</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>, as, 0); <span class="comment">/* use 16 bit for now here */</span>
  
  *varlen = <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
  <span class="keywordflow">return</span> <a class="code" href="stream_8c.html#ad176a69ba2571f53673903a3429da3b6">stream_pnt</a>(<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa2514807244e353a19d3f48316cc7885"></a><!-- doxytag: member="bgp_aspath.c::aspath_str2aspath" ref="aa2514807244e353a19d3f48316cc7885" args="(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_str2aspath </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01742">1742</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">enum</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a> token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>;
  u_short as_type;
  u_long asno = 0;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a>;
  <span class="keywordtype">int</span> needtype;

  aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();

  <span class="comment">/* We start default type as AS_SEQUENCE. */</span>
  as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
  needtype = 1;

  <span class="keywordflow">while</span> ((<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="bgp__aspath_8c.html#adb39eb9be1d3d958aab2de3e0a3e884f">aspath_gettoken</a> (<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, &amp;token, &amp;asno)) != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">switch</span> (token)
    {
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed">as_token_asval</a>:
      <span class="keywordflow">if</span> (needtype)
        {
          <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
          needtype = 0;
        }
      <a class="code" href="bgp__aspath_8c.html#a6b8a24127d224a6311da7230e4067f89">aspath_as_add</a> (aspath, asno);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf">as_token_set_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3">as_token_set_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3">as_token_confed_seq_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d">as_token_confed_seq_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007">as_token_confed_set_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef">as_token_confed_set_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>:
    <span class="keywordflow">default</span>:
      <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (aspath);
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
    }

  aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (aspath);

  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af73204203de189155558d50f795e1d69"></a><!-- doxytag: member="bgp_aspath.c::aspath_str_update" ref="af73204203de189155558d50f795e1d69" args="(struct aspath *as)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void aspath_str_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>as</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00607">607</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>);
  as-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (as);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a414aa289179196886d9f059bdd41e81c"></a><!-- doxytag: member="bgp_aspath.c::aspath_unintern" ref="a414aa289179196886d9f059bdd41e81c" args="(struct aspath *aspath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_unintern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"><em>aspath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00343">343</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span>aspath *ret;

  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>)
    aspath-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>--;

  <span class="keywordflow">if</span> (aspath-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a> == 0)
    {
      <span class="comment">/* This aspath must exist in aspath hash table. */</span>
      ret = <a class="code" href="hash_8c.html#a67f4f46ccd66f0b0c2a047eeb130c19e">hash_release</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, aspath);
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (ret != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
      <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (aspath);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a751c1ab911632a8a6889554fb98ef29c"></a><!-- doxytag: member="bgp_aspath.c::assegment_append_asns" ref="a751c1ab911632a8a6889554fb98ef29c" args="(struct assegment *seg, as_t *asnos, int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_append_asns </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *&#160;</td>
          <td class="paramname"><em>asnos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00222">222</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *newas;
  
  newas = <a class="code" href="memory_8h.html#ad9ab7c99da79ca966328c35e9185cc57">XREALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>,
              <a class="code" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> + <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>, 1));

  <span class="keywordflow">if</span> (newas)
    {
      seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> = newas;
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> + seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, asnos, <a class="code" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a>(<a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>, 1));
      seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> += <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
      <span class="keywordflow">return</span> seg;
    }

  <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (seg);
  <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae315d7679de163b78c9fc6cb9db21e31"></a><!-- doxytag: member="bgp_aspath.c::assegment_count_asns" ref="ae315d7679de163b78c9fc6cb9db21e31" args="(struct assegment *seg, int from)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int assegment_count_asns </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00394">394</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (!from)
        count += seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
      <span class="keywordflow">else</span>
        {
          count += (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - from);
          from = 0;
        }
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5228cb0e163140378ebc9c1cbdb6d698"></a><!-- doxytag: member="bgp_aspath.c::assegment_data_free" ref="a5228cb0e163140378ebc9c1cbdb6d698" args="(as_t *asdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void assegment_data_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *&#160;</td>
          <td class="paramname"><em>asdata</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00101">101</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>,asdata);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a51bdba15ec8455ecaa9e51cb62ebe0aa"></a><!-- doxytag: member="bgp_aspath.c::assegment_data_new" ref="a51bdba15ec8455ecaa9e51cb62ebe0aa" args="(int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>* assegment_data_new </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00095">95</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> (<a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>, <a class="code" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a> (<a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>, 1)));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1dc09c3542753933f3bc84927813fafb"></a><!-- doxytag: member="bgp_aspath.c::assegment_data_put" ref="a1dc09c3542753933f3bc84927813fafb" args="(struct stream *s, as_t *as, int num, int use32bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void assegment_data_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use32bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00817">817</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (<a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a> &lt;= <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>);
  
  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>; i++)
    <span class="keywordflow">if</span> ( use32bit )
      <a class="code" href="stream_8c.html#af366d780a14cb8de53279378a8a4faeb">stream_putl</a> (s, as[i]);
    <span class="keywordflow">else</span>
      {
        <span class="keywordflow">if</span> ( as[i] &lt;= <a class="code" href="bgp__aspath_8h.html#a5a3365c8e7924ca85bd9675dc6597908">BGP_AS_MAX</a> )
      <a class="code" href="stream_8c.html#a03459a9331e0333d2b396636eca3c2e4">stream_putw</a>(s, as[i]);
    <span class="keywordflow">else</span>
      <a class="code" href="stream_8c.html#a03459a9331e0333d2b396636eca3c2e4">stream_putw</a>(s, <a class="code" href="bgp__aspath_8h.html#a9fab3268cc31ac1c5faeff01f7518ba6">BGP_AS_TRANS</a>);
      }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1331c118704af46f8f329b7d99ba64ff"></a><!-- doxytag: member="bgp_aspath.c::assegment_dup" ref="a1331c118704af46f8f329b7d99ba64ff" args="(struct assegment *seg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_dup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00157">157</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<span class="keyword">new</span>;
  
  <span class="keyword">new</span> = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
  <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (new-&gt;as, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, <a class="code" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a> (new-&gt;length, 1) );
    
  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a40b35553ff5d1b887d34aef88f578ee5"></a><!-- doxytag: member="bgp_aspath.c::assegment_dup_all" ref="a40b35553ff5d1b887d34aef88f578ee5" args="(struct assegment *seg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_dup_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00169">169</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<span class="keyword">new</span> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *head = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (head)
        {
          <span class="keyword">new</span>-&gt;next = <a class="code" href="bgp__aspath_8c.html#a1331c118704af46f8f329b7d99ba64ff">assegment_dup</a> (seg);
          <span class="keyword">new</span> = <span class="keyword">new</span>-&gt;next;
        }
      <span class="keywordflow">else</span>
        head = <span class="keyword">new</span> = <a class="code" href="bgp__aspath_8c.html#a1331c118704af46f8f329b7d99ba64ff">assegment_dup</a> (seg);
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> head;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a31cfc6254b5a4ac766d5a3f0ab84d0ec"></a><!-- doxytag: member="bgp_aspath.c::assegment_free" ref="a31cfc6254b5a4ac766d5a3f0ab84d0ec" args="(struct assegment *seg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void assegment_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00128">128</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!seg)
    <span class="keywordflow">return</span>;
  
  <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>);
  memset (seg, 0xfe, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structassegment.html">assegment</a>));
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babc59c27a1acac0bdc72aa39122d08ec2">MTYPE_AS_SEG</a>, seg);
  
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0ad9a25cc8c773de7c13e51896d5c8d4"></a><!-- doxytag: member="bgp_aspath.c::assegment_free_all" ref="a0ad9a25cc8c773de7c13e51896d5c8d4" args="(struct assegment *seg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void assegment_free_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00143">143</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *prev;
  
  <span class="keywordflow">while</span> (seg)
    {
      prev = seg;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (prev);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa38970ca2d675babd8620c170f08da37"></a><!-- doxytag: member="bgp_aspath.c::assegment_header_put" ref="aa38970ca2d675babd8620c170f08da37" args="(struct stream *s, u_char type, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t assegment_header_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00835">835</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">size_t</span> lenp;
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> &lt;= <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>);
  lenp = <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a> (s);
  <a class="code" href="stream_8c.html#a8a00e56e71aed4753ee4a21f8dd2aa65">stream_putc</a> (s, <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>);
  <span class="keywordflow">return</span> lenp;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad05b3089c057292649a2788723cdde9e"></a><!-- doxytag: member="bgp_aspath.c::assegment_new" ref="ad05b3089c057292649a2788723cdde9e" args="(u_char type, u_short length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_new </td>
          <td>(</td>
          <td class="paramtype">u_char&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_short&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00112">112</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<span class="keyword">new</span>;
  
  <span class="keyword">new</span> = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167babc59c27a1acac0bdc72aa39122d08ec2">MTYPE_AS_SEG</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structassegment.html">assegment</a>));
  
  <span class="keywordflow">if</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)
    <span class="keyword">new</span>-&gt;as = <a class="code" href="bgp__aspath_8c.html#a51bdba15ec8455ecaa9e51cb62ebe0aa">assegment_data_new</a> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>);
  
  <span class="keyword">new</span>-&gt;length = <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>;
  <span class="keyword">new</span>-&gt;type = <a class="code" href="bgp__open_8h.html#abbb4c0b967acba158c34c110d81b3ab4">type</a>;
  
  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8eb975d4bfbfbec4d3d79bafcd2a37b1"></a><!-- doxytag: member="bgp_aspath.c::assegment_normalise" ref="a8eb975d4bfbfbec4d3d79bafcd2a37b1" args="(struct assegment *head)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_normalise </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>head</em></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00258">258</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = head, *pin;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *tmp;
  
  <span class="keywordflow">if</span> (!head)
    <span class="keywordflow">return</span> head;
  
  <span class="keywordflow">while</span> (seg)
    {
      pin = seg;
      
      <span class="comment">/* Sort values SET segments, for determinism in paths to aid</span>
<span class="comment">       * creation of hash values / path comparisons</span>
<span class="comment">       * and because it helps other lesser implementations ;)</span>
<span class="comment">       */</span>
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a> || seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)
        {
      <span class="keywordtype">int</span> tail = 0;
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      
      qsort (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, <span class="keyword">sizeof</span>(<a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>), <a class="code" href="bgp__aspath_8c.html#acd27f543410fe3814d2b490cf58284ed">int_cmp</a>);
      
      <span class="comment">/* weed out dupes */</span>
      <span class="keywordflow">for</span> (i=1; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        {
          <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[tail] == seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i])
            <span class="keywordflow">continue</span>;
          
          tail++;
          <span class="keywordflow">if</span> (tail &lt; i)
            seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[tail] = seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>];
        }
      <span class="comment">/* seg-&gt;length can be 0.. */</span>
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>)
        seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> = tail + 1;
    }

      <span class="comment">/* read ahead from the current, pinned segment while the segments</span>
<span class="comment">       * are packable/mergeable. Append all following packable segments</span>
<span class="comment">       * to the segment we have pinned and remove these appended</span>
<span class="comment">       * segments.</span>
<span class="comment">       */</span>      
      <span class="keywordflow">while</span> (pin-&gt;next &amp;&amp; <a class="code" href="bgp__aspath_8c.html#ae6ac821935732ebcf15e61b99f57cdae">ASSEGMENT_TYPES_PACKABLE</a>(pin, pin-&gt;next))
        {
          tmp = pin-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          seg = pin-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          
          <span class="comment">/* append the next sequence to the pinned sequence */</span>
          pin = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (pin, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
          
          <span class="comment">/* bypass the next sequence */</span>
          pin-&gt;next = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          
          <span class="comment">/* get rid of the now referenceless segment */</span>
          <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (tmp);
          
        }

      seg = pin-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> head;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a63f8c7d652204435400c4309a5200fe8"></a><!-- doxytag: member="bgp_aspath.c::assegment_prepend_asns" ref="a63f8c7d652204435400c4309a5200fe8" args="(struct assegment *seg, as_t asnum, int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegment_prepend_asns </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structassegment.html">assegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname"><em>asnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00191">191</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *newas;
  
  <span class="keywordflow">if</span> (!<a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>)
    <span class="keywordflow">return</span> seg;
  
  <span class="keywordflow">if</span> (<a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a> &gt;= <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>)
    <span class="keywordflow">return</span> seg; <span class="comment">/* we don&#39;t do huge prepends */</span>
  
  newas = <a class="code" href="bgp__aspath_8c.html#a51bdba15ec8455ecaa9e51cb62ebe0aa">assegment_data_new</a> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> + <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>);
  
  <span class="keywordflow">if</span> (newas)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>; i++)
        newas[i] = asnum;
      
      <a class="code" href="regex_8c.html#aed653b4838032a2c5ce8960421c8cfd7">memcpy</a> (newas + num, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, <a class="code" href="bgp__aspath_8c.html#a72dc51f57ed02bf714c43cda0161d409">ASSEGMENT_DATA_SIZE</a> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, 1));
      <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167baf20d7e1746192b37d34f796388d847cd">MTYPE_AS_SEG_DATA</a>, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>);
      seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> = newas; 
      seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> += <a class="code" href="bgp__open_8h.html#ab4570498c4316aa5f7b4852c778b3320">num</a>;
      <span class="keywordflow">return</span> seg;
    }

  <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (seg);
  <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7b78a035d0b8f3e4d0ecb3bf2279701a"></a><!-- doxytag: member="bgp_aspath.c::assegments_parse" ref="a7b78a035d0b8f3e4d0ecb3bf2279701a" args="(struct stream *s, size_t length, int use32bit, int as4_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structassegment.html">assegment</a>* assegments_parse </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use32bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>as4_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00679">679</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment__header.html">assegment_header</a> segh;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg, *prev = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *head = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> &gt; 0);  <span class="comment">/* does not expect empty AS_PATH or AS4_PATH    */</span>
  
  <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4_SEGMENT))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4SEG] Parse aspath segment: got total byte length %lu&quot;</span>,
        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>);

  <span class="comment">/* double check that length does not exceed stream    */</span>
  <span class="keywordflow">if</span> (<a class="code" href="stream_8h.html#a2ee10df7505e651c986579a9a1fb3d91">STREAM_READABLE</a>(s) &lt; <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="comment">/* deal with each segment in turn                             */</span>
  <span class="keywordflow">while</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> &gt; 0)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      <span class="keywordtype">size_t</span> seg_size;
      
      <span class="comment">/* softly softly, get the header first on its own */</span>
      <span class="keywordflow">if</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> &gt;= <a class="code" href="bgp__aspath_8c.html#a6d74ba14656e58bcdf3594007a51d3d1">AS_HEADER_SIZE</a>)
        {
      segh.type = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);
      segh.length = <a class="code" href="stream_8c.html#a7902a86d9a749707c535840654ded3f6">stream_getc</a> (s);
      
      seg_size = <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a>(segh.length, use32bit);
                                      <span class="comment">/* includes the header bytes */</span>

      <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4_SEGMENT))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4SEG] Parse aspath segment: got type %d, length %d&quot;</span>,
                    segh.type, segh.length);
      
          <span class="keywordflow">switch</span> (segh.type)
          {
            <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>:
            <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>:
              break ;

            <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>:
            <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>:
              <span class="keywordflow">if</span> (!as4_path)
                break ;
              <span class="comment">/* RFC4893 3: &quot;invalid for the AS4_PATH attribute&quot;            */</span>
              <span class="comment">/* fall through */</span>

            <span class="keywordflow">default</span>:    <span class="comment">/* reject unknown or invalid AS_PATH segment types  */</span>
              seg_size = 0 ;
          } ;
        }
      <span class="keywordflow">else</span>
        seg_size = 0 ;

     <span class="comment">/* Stop now if segment is not valid (discarding anything collected to date)</span>
<span class="comment">      *</span>
<span class="comment">      * RFC4271 4.3, Path Attributes, b) AS_PATH:</span>
<span class="comment">      *</span>
<span class="comment">      *   &quot;path segment value field contains one or more AS numbers&quot;</span>
<span class="comment">           */</span>
      <span class="keywordflow">if</span> ((seg_size == 0) || (seg_size &gt; <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>) || (segh.length == 0))
        {
            <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (head);
          <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }
      
      <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> -= seg_size ;
      
      <span class="comment">/* now its safe to trust lengths */</span>
      seg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (segh.type, segh.length);
      
      <span class="keywordflow">if</span> (head)
        prev-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg;
      <span class="keywordflow">else</span> <span class="comment">/* it&#39;s the first segment */</span>
        head = prev = seg;
      
      <span class="keywordflow">for</span> (i = 0; i &lt; segh.length; i++)
    seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] = (use32bit) ? <a class="code" href="stream_8c.html#af857bfab0cbe7d5681e9108b58f939f2">stream_getl</a> (s) : <a class="code" href="stream_8c.html#a66155fa63acd1f377a5b9e98aba7b888">stream_getw</a> (s);

      <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4_SEGMENT))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4SEG] Parse aspath segment: length left: %lu&quot;</span>,
                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>);
      
      prev = seg;
    }
 
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (head);
}
</pre></div>
</div>
</div>
<a class="anchor" id="acd27f543410fe3814d2b490cf58284ed"></a><!-- doxytag: member="bgp_aspath.c::int_cmp" ref="acd27f543410fe3814d2b490cf58284ed" args="(const void *p1, const void *p2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int int_cmp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00242">242</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *as1 = p1;
  <span class="keyword">const</span> <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> *as2 = p2;
  
  <span class="keywordflow">return</span> (*as1 == *as2) 
          ? 0 : ( (*as1 &gt; *as2) ? 1 : -1);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a29bbe33c6a92e2888235591f1e3664cc"></a><!-- doxytag: member="bgp_aspath.c::ashash" ref="a29bbe33c6a92e2888235591f1e3664cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structhash.html">hash</a>* <a class="el" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00089">89</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
<a class="anchor" id="a855b6de5c0388baa3ae70dc8e0aec8ee"></a><!-- doxytag: member="bgp_aspath.c::snmp_stream" ref="a855b6de5c0388baa3ae70dc8e0aec8ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structstream.html">stream</a>* <a class="el" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00092">92</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="bgp__aspath_8c.html">bgp_aspath.c</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:10 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
