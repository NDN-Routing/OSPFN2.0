<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OSPFN: bgpd/bgp_aspath.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OSPFN
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('bgp__aspath_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bgpd/bgp_aspath.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="bgp__aspath_8h__dep__incl.png" border="0" usemap="#bgpd_2bgp__aspath_8hdep" alt=""/></div>
<map name="bgpd_2bgp__aspath_8hdep" id="bgpd_2bgp__aspath_8hdep">
<area shape="rect" id="node3" href="bgp__advertise_8c.html" title="bgpd/bgp_advertise.c" alt="" coords="5,80,160,107"/><area shape="rect" id="node5" href="bgp__aspath_8c.html" title="bgpd/bgp_aspath.c" alt="" coords="185,80,324,107"/><area shape="rect" id="node7" href="bgp__attr_8c.html" title="bgpd/bgp_attr.c" alt="" coords="349,80,469,107"/><area shape="rect" id="node9" href="bgp__clist_8c.html" title="bgpd/bgp_clist.c" alt="" coords="494,80,617,107"/><area shape="rect" id="node11" href="bgp__debug_8c.html" title="bgpd/bgp_debug.c" alt="" coords="643,80,781,107"/><area shape="rect" id="node13" href="bgp__ecommunity_8c.html" title="bgpd/bgp_ecommunity.c" alt="" coords="805,80,979,107"/><area shape="rect" id="node15" href="bgp__filter_8c.html" title="bgpd/bgp_filter.c" alt="" coords="1003,80,1129,107"/><area shape="rect" id="node17" href="bgp__main_8c.html" title="bgpd/bgp_main.c" alt="" coords="1154,80,1280,107"/><area shape="rect" id="node19" href="bgp__open_8c.html" title="bgpd/bgp_open.c" alt="" coords="1305,80,1436,107"/><area shape="rect" id="node21" href="bgp__packet_8c.html" title="bgpd/bgp_packet.c" alt="" coords="1461,80,1600,107"/><area shape="rect" id="node23" href="bgp__regex_8c.html" title="bgpd/bgp_regex.c" alt="" coords="1625,80,1759,107"/><area shape="rect" id="node25" href="bgp__route_8c.html" title="bgpd/bgp_route.c" alt="" coords="1784,80,1915,107"/><area shape="rect" id="node27" href="bgp__routemap_8c.html" title="bgpd/bgp_routemap.c" alt="" coords="1939,80,2096,107"/><area shape="rect" id="node29" href="bgp__vty_8c.html" title="bgpd/bgp_vty.c" alt="" coords="2121,80,2239,107"/><area shape="rect" id="node31" href="bgpd_8c.html" title="bgpd/bgpd.c" alt="" coords="2263,80,2363,107"/><area shape="rect" id="node33" href="aspath__test_8c.html" title="tests/aspath_test.c" alt="" coords="2388,80,2529,107"/></map>
</div>
</div>
<p><a href="bgp__aspath_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structassegment.html">assegment</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaspath.html">aspath</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>&#160;&#160;&#160;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>&#160;&#160;&#160;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>&#160;&#160;&#160;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>&#160;&#160;&#160;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ac7d780d83cdd277414ca9ba2785ff152">BGP_PRIVATE_AS_MIN</a>&#160;&#160;&#160;64512U</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a5eab303011de75bf71ee2d346bed9927">BGP_PRIVATE_AS_MAX</a>&#160;&#160;&#160;65535U</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a5a3365c8e7924ca85bd9675dc6597908">BGP_AS_MAX</a>&#160;&#160;&#160;65535U</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#acd90833d0f197c0d00067713d06777e5">BGP_AS4_MAX</a>&#160;&#160;&#160;4294967295U</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a9fab3268cc31ac1c5faeff01f7518ba6">BGP_AS_TRANS</a>&#160;&#160;&#160;23456U</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ae342c8082d45828fbdf91149aec573c9">ASPATH_STR_DEFAULT_LEN</a>&#160;&#160;&#160;32</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a34b9f56e53531a0e4ceedcb31d59e027">aspath_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ad12467085616732b130bd1edac9277fb">aspath_finish</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a1042bb717ef5bb67133748eb1bbe5d07">aspath_parse</a> (struct <a class="el" href="structstream.html">stream</a> *, size_t, int, int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a3b2ecc53954c134c0d279ea7033d73c0">aspath_dup</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a89ba4819070f54f8a439073480d8602f">aspath_aggregate</a> (struct <a class="el" href="structaspath.html">aspath</a> *, struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a736712266271340eb304398d0eb07454">aspath_prepend</a> (struct <a class="el" href="structaspath.html">aspath</a> *, struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ab97a5288ddbac117d036077f96a95a7b">aspath_filter_exclude</a> (struct <a class="el" href="structaspath.html">aspath</a> *, struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aae15eab59b199b40f6200c1665f84b29">aspath_add_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#adc80ec3bee7def1d23a8ecdde5c1b400">aspath_add_confed_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a6a6804ad3d73adb0fe63f698adf8b621">aspath_cmp_left</a> (const struct <a class="el" href="structaspath.html">aspath</a> *, const struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a3b9969c009d895547046d29a5806a6d2">aspath_cmp_left_confed</a> (const struct <a class="el" href="structaspath.html">aspath</a> *, const struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a58a01d71b11220f13c71fb276cde7a20">aspath_delete_confed_seq</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aadc92a26e3c657307be1c2057b187cda">aspath_empty</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aa737121f7df6f3e64869fc9a6c330b2f">aspath_empty_get</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a502ab6af823cbe7ff9fc00ae2b5bfdf1">aspath_str2aspath</a> (const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a5ab3825f718bf23136f4df0b82c342dc">aspath_free</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a07224b28f93dd756abe35b21db6dac15">aspath_intern</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ae41cec22d609259da25c9aaea981d34f">aspath_unintern</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a026b2800f5cf9df185fe30251aba1d21">aspath_print</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a827afbfa14c76a59e1af6b86b07bce26">aspath_print_vty</a> (struct <a class="el" href="structvty.html">vty</a> *, const char *, struct <a class="el" href="structaspath.html">aspath</a> *, const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a7c64be54667f4373e50ff17957c9d776">aspath_print_all_vty</a> (struct <a class="el" href="structvty.html">vty</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#aa96ed8976f2ba256f6a9f65c5be9efed">aspath_key_make</a> (void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a90d6978e56fade294a34365c55261d71">aspath_loop_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ac5bf5d085034cb65dbe9e890be189750">aspath_private_as_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a469735db8d2ffd5cf8ab4c113f1cdb11">aspath_firstas_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *, <a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a906ba436860d630cf5fccd2bc6a79295">aspath_confed_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a8f0f2f1154cde3584b4bb9d40a46e910">aspath_left_confed_check</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ad62e86fb815f7395ccd758f5fe5bf2cb">aspath_count</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a54c281ff9d513c0b11279a97a0fae259">aspath_count_hops</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a25f95f8d2fdb2376830455c580ebf5a1">aspath_count_confeds</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a38b915479f5b9c24402eeaf34c8b2c86">aspath_size</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a15a4d2846e20ad5eec7caf928aee13f5">aspath_highest</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a4ce081c2cd95222eec802d4b10d44ec8">aspath_put</a> (struct <a class="el" href="structstream.html">stream</a> *, struct <a class="el" href="structaspath.html">aspath</a> *, int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a4c969d5acff0755cd062182132e029f1">aspath_reconcile_as4</a> (struct <a class="el" href="structaspath.html">aspath</a> *, struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#a8534629746c765265160964049da9c0f">aspath_has_as4</a> (struct <a class="el" href="structaspath.html">aspath</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u_char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bgp__aspath_8h.html#ab2959871f74058a541278f5cad66a183">aspath_snmp_pathseg</a> (struct <a class="el" href="structaspath.html">aspath</a> *, size_t *)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="afe93e17cd54ee102e446b5c1b75d3565"></a><!-- doxytag: member="bgp_aspath.h::AS_CONFED_SEQUENCE" ref="afe93e17cd54ee102e446b5c1b75d3565" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_CONFED_SEQUENCE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00027">27</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa6f089de2dcdcd2b9f3270f80119225e"></a><!-- doxytag: member="bgp_aspath.h::AS_CONFED_SET" ref="aa6f089de2dcdcd2b9f3270f80119225e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_CONFED_SET&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00028">28</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa05819c99e42b36fb343621486ab9839"></a><!-- doxytag: member="bgp_aspath.h::AS_SEQUENCE" ref="aa05819c99e42b36fb343621486ab9839" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_SEQUENCE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00026">26</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e73037a31a479546ff6883e75dda9ea"></a><!-- doxytag: member="bgp_aspath.h::AS_SET" ref="a9e73037a31a479546ff6883e75dda9ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS_SET&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00025">25</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae342c8082d45828fbdf91149aec573c9"></a><!-- doxytag: member="bgp_aspath.h::ASPATH_STR_DEFAULT_LEN" ref="ae342c8082d45828fbdf91149aec573c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASPATH_STR_DEFAULT_LEN&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00063">63</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="acd90833d0f197c0d00067713d06777e5"></a><!-- doxytag: member="bgp_aspath.h::BGP_AS4_MAX" ref="acd90833d0f197c0d00067713d06777e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BGP_AS4_MAX&#160;&#160;&#160;4294967295U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00036">36</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a3365c8e7924ca85bd9675dc6597908"></a><!-- doxytag: member="bgp_aspath.h::BGP_AS_MAX" ref="a5a3365c8e7924ca85bd9675dc6597908" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BGP_AS_MAX&#160;&#160;&#160;65535U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00035">35</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9fab3268cc31ac1c5faeff01f7518ba6"></a><!-- doxytag: member="bgp_aspath.h::BGP_AS_TRANS" ref="a9fab3268cc31ac1c5faeff01f7518ba6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BGP_AS_TRANS&#160;&#160;&#160;23456U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00038">38</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5eab303011de75bf71ee2d346bed9927"></a><!-- doxytag: member="bgp_aspath.h::BGP_PRIVATE_AS_MAX" ref="a5eab303011de75bf71ee2d346bed9927" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BGP_PRIVATE_AS_MAX&#160;&#160;&#160;65535U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00032">32</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac7d780d83cdd277414ca9ba2785ff152"></a><!-- doxytag: member="bgp_aspath.h::BGP_PRIVATE_AS_MIN" ref="ac7d780d83cdd277414ca9ba2785ff152" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BGP_PRIVATE_AS_MIN&#160;&#160;&#160;64512U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8h_source.html#l00031">31</a> of file <a class="el" href="bgp__aspath_8h_source.html">bgp_aspath.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="adc80ec3bee7def1d23a8ecdde5c1b400"></a><!-- doxytag: member="bgp_aspath.h::aspath_add_confed_seq" ref="adc80ec3bee7def1d23a8ecdde5c1b400" args="(struct aspath *, as_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_add_confed_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01593">1593</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#aebb4c4aacec379d3b92d67dfbf74b897">aspath_add_one_as</a> (<a class="code" href="structaspath.html">aspath</a>, asno, <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aae15eab59b199b40f6200c1665f84b29"></a><!-- doxytag: member="bgp_aspath.h::aspath_add_seq" ref="aae15eab59b199b40f6200c1665f84b29" args="(struct aspath *, as_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_add_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01394">1394</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#aebb4c4aacec379d3b92d67dfbf74b897">aspath_add_one_as</a> (<a class="code" href="structaspath.html">aspath</a>, asno, <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a89ba4819070f54f8a439073480d8602f"></a><!-- doxytag: member="bgp_aspath.h::aspath_aggregate" ref="a89ba4819070f54f8a439073480d8602f" args="(struct aspath *, struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_aggregate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00988">988</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  <span class="keywordtype">int</span> minlen;
  <span class="keywordtype">int</span> match;
  <span class="keywordtype">int</span> from;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1 = as1-&gt;segments;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2 = as2-&gt;segments;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *asset;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *prevseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  match = 0;
  minlen = 0;
  aspath = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  asset = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* First of all check common leading sequence. */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; seg2)
    {      
      <span class="comment">/* Check segment type. */</span>
      <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
    <span class="keywordflow">break</span>;

      <span class="comment">/* Minimum segment length. */</span>
      minlen = <a class="code" href="bgp__aspath_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a> (seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);

      <span class="keywordflow">for</span> (match = 0; match &lt; minlen; match++)
    <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[match] != seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[match])
      <span class="keywordflow">break</span>;

      <span class="keywordflow">if</span> (match)
    {
      <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, 0);
      
      seg = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (seg, seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, match);

      <span class="keywordflow">if</span> (! aspath)
        {
          aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
          aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = seg;
         }
      <span class="keywordflow">else</span>
        prevseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg;
      
      prevseg = seg;
    }

      <span class="keywordflow">if</span> (match != minlen || match != seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> 
      || seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> != seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>)
    <span class="keywordflow">break</span>;
      
      seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }

  <span class="keywordflow">if</span> (! aspath)
    aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a>();

  <span class="comment">/* Make as-set using rest of all information. */</span>
  from = match;
  <span class="keywordflow">while</span> (seg1)
    {
      <span class="keywordflow">for</span> (i = from; i &lt; seg1-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    asset = <a class="code" href="bgp__aspath_8c.html#a0c0adc19aecf830681ee9ef1e7357c09">aspath_aggregate_as_set_add</a> (aspath, asset, seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i]);
      
      from = 0;
      seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }

  from = match;
  <span class="keywordflow">while</span> (seg2)
    {
      <span class="keywordflow">for</span> (i = from; i &lt; seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    asset = <a class="code" href="bgp__aspath_8c.html#a0c0adc19aecf830681ee9ef1e7357c09">aspath_aggregate_as_set_add</a> (aspath, asset, seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i]);

      from = 0;
      seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  
  <a class="code" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (aspath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (aspath);
  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6a6804ad3d73adb0fe63f698adf8b621"></a><!-- doxytag: member="bgp_aspath.h::aspath_cmp_left" ref="a6a6804ad3d73adb0fe63f698adf8b621" args="(const struct aspath *, const struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_cmp_left </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01402">1402</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1 = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2 = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">if</span> (!(aspath1 &amp;&amp; aspath2))
    <span class="keywordflow">return</span> 0;

  seg1 = aspath1-&gt;segments;
  seg2 = aspath2-&gt;segments;

  <span class="comment">/* find first non-confed segments for each */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; ((seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
          || (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)))
    seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="keywordflow">while</span> (seg2 &amp;&amp; ((seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
          || (seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)))
    seg2 = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="comment">/* Check as1&#39;s */</span>
  <span class="keywordflow">if</span> (!(seg1 &amp;&amp; seg2
    &amp;&amp; (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>) &amp;&amp; (seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)))
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] == seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0])
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3b9969c009d895547046d29a5806a6d2"></a><!-- doxytag: member="bgp_aspath.h::aspath_cmp_left_confed" ref="a3b9969c009d895547046d29a5806a6d2" args="(const struct aspath *, const struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_cmp_left_confed </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01539">1539</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (! (aspath1 &amp;&amp; aspath2) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> ( !(aspath1-&gt;segments &amp;&amp; aspath2-&gt;segments) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> ( (aspath1-&gt;segments-&gt;type != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      || (aspath2-&gt;segments-&gt;type != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (aspath1-&gt;segments-&gt;as[0] == aspath2-&gt;segments-&gt;as[0])
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a906ba436860d630cf5fccd2bc6a79295"></a><!-- doxytag: member="bgp_aspath.h::aspath_confed_check" ref="a906ba436860d630cf5fccd2bc6a79295" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_confed_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01143">1143</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;

  <span class="keywordflow">if</span> ( !(<a class="code" href="structaspath.html">aspath</a> &amp;&amp; <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;

  seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a> || seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      <span class="keywordflow">return</span> 1;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad62e86fb815f7395ccd758f5fe5bf2cb"></a><!-- doxytag: member="bgp_aspath.h::aspath_count" ref="ad62e86fb815f7395ccd758f5fe5bf2cb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long aspath_count </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01648">1648</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>-&gt;<a class="code" href="structhash.html#a4d82055a4a52d99ee887d24004fd91d3">count</a>;
}     
</pre></div>
</div>
</div>
<a class="anchor" id="a25f95f8d2fdb2376830455c580ebf5a1"></a><!-- doxytag: member="bgp_aspath.h::aspath_count_confeds" ref="a25f95f8d2fdb2376830455c580ebf5a1" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_count_confeds </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00412">412</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
        count += seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>)
        count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a54c281ff9d513c0b11279a97a0fae259"></a><!-- doxytag: member="bgp_aspath.h::aspath_count_hops" ref="a54c281ff9d513c0b11279a97a0fae259" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_count_hops </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00430">430</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
        count += seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>)
        count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a58a01d71b11220f13c71fb276cde7a20"></a><!-- doxytag: member="bgp_aspath.h::aspath_delete_confed_seq" ref="a58a01d71b11220f13c71fb276cde7a20" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_delete_confed_seq </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01560">1560</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;

  <span class="keywordflow">if</span> (!(<a class="code" href="structaspath.html">aspath</a> &amp;&amp; <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>))
    <span class="keywordflow">return</span> <a class="code" href="structaspath.html">aspath</a>;

  seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* &quot;if the first path segment of the AS_PATH is </span>
<span class="comment">   *  of type AS_CONFED_SEQUENCE,&quot;</span>
<span class="comment">   */</span>
  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
    <span class="keywordflow">return</span> <a class="code" href="structaspath.html">aspath</a>;

  <span class="comment">/* &quot;... that segment and any immediately following segments </span>
<span class="comment">   *  of the type AS_CONFED_SET or AS_CONFED_SEQUENCE are removed </span>
<span class="comment">   *  from the AS_PATH attribute,&quot;</span>
<span class="comment">   */</span>
  <span class="keywordflow">while</span> (seg &amp;&amp; 
         (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a> || seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>))
    {
      <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (seg);
      seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
    }
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (<a class="code" href="structaspath.html">aspath</a>);
  <span class="keywordflow">return</span> <a class="code" href="structaspath.html">aspath</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3b2ecc53954c134c0d279ea7033d73c0"></a><!-- doxytag: member="bgp_aspath.h::aspath_dup" ref="a3b2ecc53954c134c0d279ea7033d73c0" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_dup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00640">640</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<span class="keyword">new</span>;

  <span class="keyword">new</span> = <a class="code" href="memory_8h.html#a7826e4ed1d152cad0666dcf43f11f663">XCALLOC</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bac824bd651670a9b4987f59bc2f25b70d">MTYPE_AS_PATH</a>, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structaspath.html">aspath</a>));

  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    <span class="keyword">new</span>-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <span class="keywordflow">else</span>
    <span class="keyword">new</span>-&gt;segments = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keyword">new</span>-&gt;str = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (<a class="code" href="structaspath.html">aspath</a>);

  <span class="keywordflow">return</span> <span class="keyword">new</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aadc92a26e3c657307be1c2057b187cda"></a><!-- doxytag: member="bgp_aspath.h::aspath_empty" ref="aadc92a26e3c657307be1c2057b187cda" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_empty </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01632">1632</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#ac9e8aff45338b803e560318286e3f2af">aspath_parse</a> (<a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1, 0); <span class="comment">/* 32Bit ;-) not AS4_PATH */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa737121f7df6f3e64869fc9a6c330b2f"></a><!-- doxytag: member="bgp_aspath.h::aspath_empty_get" ref="aa737121f7df6f3e64869fc9a6c330b2f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_empty_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01638">1638</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a>;

  aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
  aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (aspath);
  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab97a5288ddbac117d036077f96a95a7b"></a><!-- doxytag: member="bgp_aspath.h::aspath_filter_exclude" ref="ab97a5288ddbac117d036077f96a95a7b" args="(struct aspath *, struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_filter_exclude </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01287">1287</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> * srcseg, * exclseg, * lastseg;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> * newpath;

  newpath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a>();
  lastseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="keywordflow">for</span> (srcseg = <a class="code" href="spgrid_8c.html#acef278b54e17ed729da5acd28bda6daf">source</a>-&gt;segments; srcseg; srcseg = srcseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
  {
    <span class="keywordtype">unsigned</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>, <a class="code" href="spgrid_8c.html#a04ee6b20e6d3476ab1f51397993cfeef">y</a>, newlen = 0, done = 0, skip_as;
    <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> * newseg;

    <span class="comment">/* Find out, how much ASns are we going to pick from this segment.</span>
<span class="comment">     * We can&#39;t perform filtering right inline, because the size of</span>
<span class="comment">     * the new segment isn&#39;t known at the moment yet.</span>
<span class="comment">     */</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; srcseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      skip_as = 0;
      <span class="keywordflow">for</span> (exclseg = exclude_list-&gt;segments; exclseg &amp;&amp; !skip_as; exclseg = exclseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        <span class="keywordflow">for</span> (y = 0; y &lt; exclseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; y++)
          <span class="keywordflow">if</span> (srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == exclseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[y])
          {
            skip_as = 1;
            <span class="comment">// There&#39;s no sense in testing the rest of exclusion list, bail out.</span>
            <span class="keywordflow">break</span>;
          }
      <span class="keywordflow">if</span> (!skip_as)
        newlen++;
    }
    <span class="comment">/* newlen is now the number of ASns to copy */</span>
    <span class="keywordflow">if</span> (!newlen)
      <span class="keywordflow">continue</span>;

    <span class="comment">/* Actual copying. Allocate memory and iterate once more, performing filtering. */</span>
    newseg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (srcseg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, newlen);
    <span class="keywordflow">for</span> (i = 0; i &lt; srcseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      skip_as = 0;
      <span class="keywordflow">for</span> (exclseg = exclude_list-&gt;segments; exclseg &amp;&amp; !skip_as; exclseg = exclseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        <span class="keywordflow">for</span> (y = 0; y &lt; exclseg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; y++)
          <span class="keywordflow">if</span> (srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == exclseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[y])
          {
            skip_as = 1;
            <span class="keywordflow">break</span>;
          }
      <span class="keywordflow">if</span> (skip_as)
        <span class="keywordflow">continue</span>;
      newseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[done++] = srcseg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>];
    }
    <span class="comment">/* At his point newlen must be equal to done, and both must be positive. Append</span>
<span class="comment">     * the filtered segment to the gross result. */</span>
    <span class="keywordflow">if</span> (!lastseg)
      newpath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = newseg;
    <span class="keywordflow">else</span>
      lastseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = newseg;
    lastseg = newseg;
  }
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (newpath);
  <span class="comment">/* We are happy returning even an empty AS_PATH, because the administrator</span>
<span class="comment">   * might expect this very behaviour. There&#39;s a mean to avoid this, if necessary,</span>
<span class="comment">   * by having a match rule against certain AS_PATH regexps in the route-map index.</span>
<span class="comment">   */</span>
  <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (<a class="code" href="spgrid_8c.html#acef278b54e17ed729da5acd28bda6daf">source</a>);
  <span class="keywordflow">return</span> newpath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad12467085616732b130bd1edac9277fb"></a><!-- doxytag: member="bgp_aspath.h::aspath_finish" ref="ad12467085616732b130bd1edac9277fb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_finish </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01855">1855</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="hash_8c.html#ad0d6074e4b7475f7c249212bb8e67de5">hash_free</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>);
  <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a> = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  <span class="keywordflow">if</span> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>)
    <a class="code" href="stream_8c.html#ac25ca0f9b32a76b4ea34ecb3c9d62481">stream_free</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a469735db8d2ffd5cf8ab4c113f1cdb11"></a><!-- doxytag: member="bgp_aspath.h::aspath_firstas_check" ref="a469735db8d2ffd5cf8ab4c113f1cdb11" args="(struct aspath *, as_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_firstas_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01077">1077</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> ( (<a class="code" href="structaspath.html">aspath</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) )
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>
      &amp;&amp; (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
      &amp;&amp; (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[0] == asno ))
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5ab3825f718bf23136f4df0b82c342dc"></a><!-- doxytag: member="bgp_aspath.h::aspath_free" ref="a5ab3825f718bf23136f4df0b82c342dc" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00330">330</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!<a class="code" href="structaspath.html">aspath</a>)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>)
    <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>);
  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>);
  <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bac824bd651670a9b4987f59bc2f25b70d">MTYPE_AS_PATH</a>, <a class="code" href="structaspath.html">aspath</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8534629746c765265160964049da9c0f"></a><!-- doxytag: member="bgp_aspath.h::aspath_has_as4" ref="a8534629746c765265160964049da9c0f" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_has_as4 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00489">489</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5a3365c8e7924ca85bd9675dc6597908">BGP_AS_MAX</a>)
      <span class="keywordflow">return</span> 1;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a15a4d2846e20ad5eec7caf928aee13f5"></a><!-- doxytag: member="bgp_aspath.h::aspath_highest" ref="a15a4d2846e20ad5eec7caf928aee13f5" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> aspath_highest </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00469">469</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  <a class="code" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a> highest = 0;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
        <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; highest
            &amp;&amp; (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &lt; <a class="code" href="bgp__aspath_8h.html#ac7d780d83cdd277414ca9ba2785ff152">BGP_PRIVATE_AS_MIN</a>
                || seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5eab303011de75bf71ee2d346bed9927">BGP_PRIVATE_AS_MAX</a>))
      highest = seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[<a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>];
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> highest;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a34b9f56e53531a0e4ceedcb31d59e027"></a><!-- doxytag: member="bgp_aspath.h::aspath_init" ref="a34b9f56e53531a0e4ceedcb31d59e027" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01849">1849</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a> = <a class="code" href="hash_8c.html#a5a114f3e041a28afaf1acfa760728c24">hash_create_size</a> (32767, <a class="code" href="bgp__aspath_8c.html#a0ff2c762b3aea1084db8500839a8d314">aspath_key_make</a>, <a class="code" href="bgp__aspath_8c.html#aa7075e8c0246a68a9ed4d56780f9dc7a">aspath_cmp</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a07224b28f93dd756abe35b21db6dac15"></a><!-- doxytag: member="bgp_aspath.h::aspath_intern" ref="a07224b28f93dd756abe35b21db6dac15" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_intern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00616">616</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *find;
  
  <span class="comment">/* Assert this AS path structure is not interned. */</span>
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a> == 0);

  <span class="comment">/* Check AS path hash. */</span>
  find = <a class="code" href="hash_8c.html#ab0bb31bd6c883d6563930341dccedd22">hash_get</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, <a class="code" href="structaspath.html">aspath</a>, <a class="code" href="hash_8c.html#ac2705f6d220cf4d8049201e369ff6d62">hash_alloc_intern</a>);

  <span class="keywordflow">if</span> (find != <a class="code" href="structaspath.html">aspath</a>)
    <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (<a class="code" href="structaspath.html">aspath</a>);

  find-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>++;

  <span class="keywordflow">if</span> (! find-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    find-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (find);

  <span class="keywordflow">return</span> find;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa96ed8976f2ba256f6a9f65c5be9efed"></a><!-- doxytag: member="bgp_aspath.h::aspath_key_make" ref="aa96ed8976f2ba256f6a9f65c5be9efed" args="(void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_key_make </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01809">1809</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> * <a class="code" href="structaspath.html">aspath</a> = (<span class="keyword">struct </span>aspath *) <a class="code" href="spgrid_8c.html#a931bc2aa940ac2a4d1601cf842336926">p</a>;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structkey.html">key</a> = 0;

  <span class="keywordflow">if</span> (!aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>)
    <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (aspath);
  
  key = <a class="code" href="jhash_8c.html#acbd0055c1aca2b1ec110501e32191835">jhash</a> (aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>, strlen(aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>), 2334325);

  <span class="keywordflow">return</span> <a class="code" href="zebra__rib_8c.html#a35af0be900467fedbb610bd6ea65ed78">key</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8f0f2f1154cde3584b4bb9d40a46e910"></a><!-- doxytag: member="bgp_aspath.h::aspath_left_confed_check" ref="a8f0f2f1154cde3584b4bb9d40a46e910" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_left_confed_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01164">1164</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> ( !(<a class="code" href="structaspath.html">aspath</a> &amp;&amp; <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;

  <span class="keywordflow">if</span> ( (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
      || (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>) )
    <span class="keywordflow">return</span> 1;

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a90d6978e56fade294a34365c55261d71"></a><!-- doxytag: member="bgp_aspath.h::aspath_loop_check" ref="a90d6978e56fade294a34365c55261d71" args="(struct aspath *, as_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_loop_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bgpd_8h.html#ae54756b75cc699532543e4e2214c1c57">as_t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01092">1092</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;
  <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a> = 0;

  <span class="keywordflow">if</span> ( (<a class="code" href="structaspath.html">aspath</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) )
    <span class="keywordflow">return</span> 0;
  
  seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    <span class="keywordflow">if</span> (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] == asno)
      count++;
      
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> <a class="code" href="spgrid_8c.html#a66e3fedede6aa372e5196e55e5e8d5c1">count</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1042bb717ef5bb67133748eb1bbe5d07"></a><!-- doxytag: member="bgp_aspath.h::aspath_parse" ref="a1042bb717ef5bb67133748eb1bbe5d07" args="(struct stream *, size_t, int, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_parse </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00784">784</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> as;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *find;

  <span class="comment">/* Parse each segment and construct normalised list of struct assegment */</span>
  memset (&amp;as, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structaspath.html">aspath</a>));
  <span class="keywordflow">if</span> (<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a> != 0)
    {
      as.segments = <a class="code" href="bgp__aspath_8c.html#a7b78a035d0b8f3e4d0ecb3bf2279701a">assegments_parse</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, <a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>, use32bit, as4_path);

      <span class="keywordflow">if</span> (as.segments == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
        <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ;   <span class="comment">/* Invalid AS_PATH or AS4_PATH  */</span>
    } ;
  
  <span class="comment">/* If already same aspath exist then return it. */</span>
  find = <a class="code" href="hash_8c.html#ab0bb31bd6c883d6563930341dccedd22">hash_get</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, &amp;as, <a class="code" href="bgp__aspath_8c.html#a4a0316093e4bcf2062f6e0ab12106cd1">aspath_hash_alloc</a>);
  
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a>(find) ;        <span class="comment">/* valid aspath, so must find or create */</span>
  
  <span class="comment">/* aspath_hash_alloc dupes segments too. that probably could be</span>
<span class="comment">   * optimised out.</span>
<span class="comment">   */</span>
  <a class="code" href="bgp__aspath_8c.html#a0ad9a25cc8c773de7c13e51896d5c8d4">assegment_free_all</a> (as.segments);
  <span class="keywordflow">if</span> (as.str)
    <a class="code" href="memory_8h.html#a29f1ce2c850a3163cd6b1b0bd460705d">XFREE</a> (<a class="code" href="memtypes_8h.html#a7ff5f2dff38e7639981794c43dc9167bae9619cbcd2efc7232388e93e1b8bfa9f">MTYPE_AS_STR</a>, as.str);
  
  find-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>++;

  <span class="keywordflow">return</span> find;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a736712266271340eb304398d0eb07454"></a><!-- doxytag: member="bgp_aspath.h::aspath_prepend" ref="a736712266271340eb304398d0eb07454" args="(struct aspath *, struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01200">1200</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg1;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg2;

  <span class="keywordflow">if</span> (! as1 || ! as2)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  seg1 = as1-&gt;segments;
  seg2 = as2-&gt;segments;
  
  <span class="comment">/* If as2 is empty, only need to dupe as1&#39;s chain onto as2 */</span>
  <span class="keywordflow">if</span> (seg2 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      as2-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (as1-&gt;segments);
      <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (as2);
      <span class="keywordflow">return</span> as2;
    }
  
  <span class="comment">/* If as1 is empty AS, no prepending to do. */</span>
  <span class="keywordflow">if</span> (seg1 == <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    <span class="keywordflow">return</span> as2;
  
  <span class="comment">/* find the tail as1&#39;s segment chain. */</span>
  <span class="keywordflow">while</span> (seg1 &amp;&amp; seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
    seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;

  <span class="comment">/* Delete any AS_CONFED_SEQUENCE segment from as2. */</span>
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a> &amp;&amp; seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>)
    as2 = <a class="code" href="bgp__aspath_8c.html#a3a932cff645a730d2e5d9aeec874e127">aspath_delete_confed_seq</a> (as2);

  <span class="comment">/* Compare last segment type of as1 and first segment type of as2. */</span>
  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> != seg2-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
    <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (as1, as2);

  <span class="keywordflow">if</span> (seg1-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a> == <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>)
    {
      <span class="comment">/* We have two chains of segments, as1-&gt;segments and seg2, </span>
<span class="comment">       * and we have to attach them together, merging the attaching</span>
<span class="comment">       * segments together into one.</span>
<span class="comment">       * </span>
<span class="comment">       * 1. dupe as1-&gt;segments onto head of as2</span>
<span class="comment">       * 2. merge seg2&#39;s asns onto last segment of this new chain</span>
<span class="comment">       * 3. attach chain after seg2</span>
<span class="comment">       */</span>
      
      <span class="comment">/* dupe as1 onto as2&#39;s head */</span>
      seg1 = as2-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a40b35553ff5d1b887d34aef88f578ee5">assegment_dup_all</a> (as1-&gt;segments);
      
      <span class="comment">/* refind the tail of as2, reusing seg1 */</span>
      <span class="keywordflow">while</span> (seg1 &amp;&amp; seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>)
        seg1 = seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      
      <span class="comment">/* merge the old head, seg2, into tail, seg1 */</span>
      seg1 = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (seg1, seg2-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, seg2-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
      
      <span class="comment">/* bypass the merged seg2, and attach any chain after it to</span>
<span class="comment">       * chain descending from as2&#39;s head</span>
<span class="comment">       */</span>
      seg1-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg2-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
      
      <span class="comment">/* seg2 is now referenceless and useless*/</span>
      <a class="code" href="bgp__aspath_8c.html#a31cfc6254b5a4ac766d5a3f0ab84d0ec">assegment_free</a> (seg2);
      
      <span class="comment">/* we&#39;ve now prepended as1&#39;s segment chain to as2, merging</span>
<span class="comment">       * the inbetween AS_SEQUENCE of seg2 in the process </span>
<span class="comment">       */</span>
      <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (as2);
      <span class="keywordflow">return</span> as2;
    }
  <span class="keywordflow">else</span>
    {
      <span class="comment">/* AS_SET merge code is needed at here. */</span>
      <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (as1, as2);
    }
  <span class="comment">/* XXX: Ermmm, what if as1 has multiple segments?? */</span>
  
  <span class="comment">/* Not reached */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a026b2800f5cf9df185fe30251aba1d21"></a><!-- doxytag: member="bgp_aspath.h::aspath_print" ref="a026b2800f5cf9df185fe30251aba1d21" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* aspath_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01866">1866</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> (<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> ? <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>-&gt;str : <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7c64be54667f4373e50ff17957c9d776"></a><!-- doxytag: member="bgp_aspath.h::aspath_print_all_vty" ref="a7c64be54667f4373e50ff17957c9d776" args="(struct vty *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_print_all_vty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01898">1898</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="hash_8c.html#a69eb0b2447b78899dac4da27895b41e7">hash_iterate</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, 
        (<span class="keywordtype">void</span> (*) (<span class="keyword">struct</span> <a class="code" href="structhash__backet.html">hash_backet</a> *, <span class="keywordtype">void</span> *))
        <a class="code" href="bgp__aspath_8c.html#aa1ede5a9090ad2d9e44753c3ad5c1dfb">aspath_show_all_iterator</a>,
        <a class="code" href="structvty.html">vty</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a827afbfa14c76a59e1af6b86b07bce26"></a><!-- doxytag: member="bgp_aspath.h::aspath_print_vty" ref="a827afbfa14c76a59e1af6b86b07bce26" args="(struct vty *, const char *, struct aspath *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_print_vty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvty.html">vty</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01876">1876</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (format);
  <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, format, <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>-&gt;str);
  <span class="keywordflow">if</span> (strlen (<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>-&gt;str) &amp;&amp; strlen (suffix))
    <a class="code" href="vty_8c.html#a3725db0ec6ad3ffdd31f68abc807ee34">vty_out</a> (<a class="code" href="structvty.html">vty</a>, <span class="stringliteral">&quot;%s&quot;</span>, suffix);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac5bf5d085034cb65dbe9e890be189750"></a><!-- doxytag: member="bgp_aspath.h::aspath_private_as_check" ref="ac5bf5d085034cb65dbe9e890be189750" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aspath_private_as_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01117">1117</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg;
  
  <span class="keywordflow">if</span> ( !(<a class="code" href="structaspath.html">aspath</a> &amp;&amp; <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>) )
    <span class="keywordflow">return</span> 0;
    
  seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;

  <span class="keywordflow">while</span> (seg)
    {
      <span class="keywordtype">int</span> <a class="code" href="spgrid_8c.html#a139066bd9e344a8daae82c5ca919fffe">i</a>;
      
      <span class="keywordflow">for</span> (i = 0; i &lt; seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>; i++)
    {
      <span class="keywordflow">if</span> ( (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &lt; <a class="code" href="bgp__aspath_8h.html#ac7d780d83cdd277414ca9ba2785ff152">BGP_PRIVATE_AS_MIN</a>)
          || (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>[i] &gt; <a class="code" href="bgp__aspath_8h.html#a5eab303011de75bf71ee2d346bed9927">BGP_PRIVATE_AS_MAX</a>) )
        <span class="keywordflow">return</span> 0;
    }
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4ce081c2cd95222eec802d4b10d44ec8"></a><!-- doxytag: member="bgp_aspath.h::aspath_put" ref="a4ce081c2cd95222eec802d4b10d44ec8" args="(struct stream *, struct aspath *, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t aspath_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstream.html">stream</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00847">847</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>-&gt;segments;
  <span class="keywordtype">size_t</span> bytes = 0;
  
  <span class="keywordflow">if</span> (!seg || seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> == 0)
    <span class="keywordflow">return</span> 0;
  
  <span class="keywordflow">if</span> (seg)
    {
      <span class="comment">/*</span>
<span class="comment">       * Hey, what do we do when we have &gt; STREAM_WRITABLE(s) here?</span>
<span class="comment">       * At the moment, we would write out a partial aspath, and our peer</span>
<span class="comment">       * will complain and drop the session :-/</span>
<span class="comment">       *</span>
<span class="comment">       * The general assumption here is that many things tested will</span>
<span class="comment">       * never happen.  And, in real live, up to now, they have not.</span>
<span class="comment">       */</span>
      <span class="keywordflow">while</span> (seg &amp;&amp; (<a class="code" href="bgp__aspath_8c.html#a1a25eeaf309e943daf8145bba6a6aa38">ASSEGMENT_LEN</a>(seg, use32bit) &lt;= <a class="code" href="stream_8h.html#a9e7170eddfbd82389e4fcbbb0185f70f">STREAM_WRITEABLE</a>(<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>)))
        {
          <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
          <span class="keywordtype">int</span> written = 0;
          <span class="keywordtype">int</span> asns_packed = 0;
          <span class="keywordtype">size_t</span> lenp;
          
          <span class="comment">/* Overlength segments have to be split up */</span>
          <span class="keywordflow">while</span> ( (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written) &gt; <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>)
            {
              <a class="code" href="bgp__aspath_8c.html#aa38970ca2d675babd8620c170f08da37">assegment_header_put</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>);
              <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>, use32bit);
              written += <a class="code" href="bgp__aspath_8c.html#ac42ca08b92d62553458e61ec97212221">AS_SEGMENT_MAX</a>;
              bytes += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a> (written, use32bit);
            }
          
          <span class="comment">/* write the final segment, probably is also the first */</span>
          lenp = <a class="code" href="bgp__aspath_8c.html#aa38970ca2d675babd8620c170f08da37">assegment_header_put</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written);
          <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, (seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a> + written), seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written, 
                              use32bit);
          
          <span class="comment">/* Sequence-type segments can be &#39;packed&#39; together</span>
<span class="comment">           * Case of a segment which was overlength and split up</span>
<span class="comment">           * will be missed here, but that doesn&#39;t matter.</span>
<span class="comment">           */</span>
          <span class="keywordflow">while</span> (next &amp;&amp; <a class="code" href="bgp__aspath_8c.html#a38166e509b9394c13cbcc3521d38e5f8">ASSEGMENTS_PACKABLE</a> (seg, next))
            {
              <span class="comment">/* NB: We should never normally get here given we</span>
<span class="comment">               * normalise aspath data when parse them. However, better</span>
<span class="comment">               * safe than sorry. We potentially could call</span>
<span class="comment">               * assegment_normalise here instead, but it&#39;s cheaper and</span>
<span class="comment">               * easier to do it on the fly here rather than go through</span>
<span class="comment">               * the segment list twice every time we write out</span>
<span class="comment">               * aspath&#39;s.</span>
<span class="comment">               */</span>
              
              <span class="comment">/* Next segment&#39;s data can fit in this one */</span>
              <a class="code" href="bgp__aspath_8c.html#a1dc09c3542753933f3bc84927813fafb">assegment_data_put</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, next-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, use32bit);
              
              <span class="comment">/* update the length of the segment header */</span>
          <a class="code" href="stream_8c.html#a69c37c3d7be1f834141625b2dc450891">stream_putc_at</a> (<a class="code" href="spgrid_8c.html#a5d97d3b42a0d6c9ec9a3e56f2616a6a5">s</a>, lenp, seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written + next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>);
              asns_packed += next-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
               
          next = next-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
        }
          
          bytes += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a> (seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a> - written + asns_packed, 
                   use32bit);
          seg = <a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
        }
    }
  <span class="keywordflow">return</span> bytes;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4c969d5acff0755cd062182132e029f1"></a><!-- doxytag: member="bgp_aspath.h::aspath_reconcile_as4" ref="a4c969d5acff0755cd062182132e029f1" args="(struct aspath *, struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_reconcile_as4 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01440">1440</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg, *newseg, *prevseg = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *newpath = <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *mergedpath;
  <span class="keywordtype">int</span> hops, cpasns = 0;
  
  <span class="keywordflow">if</span> (!<a class="code" href="structaspath.html">aspath</a>)
    <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  
  seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="comment">/* CONFEDs should get reconciled too.. */</span>
  hops = (<a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (<a class="code" href="structaspath.html">aspath</a>) + <a class="code" href="bgp__aspath_8c.html#a8638c553cd3d2c87161aa489ea0a45d7">aspath_count_confeds</a> (<a class="code" href="structaspath.html">aspath</a>))
         - <a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (as4path);
  
  <span class="keywordflow">if</span> (hops &lt; 0)
    {
      <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4))
        <a class="code" href="log_8h.html#a4a2ed409bf1559d9ea3c664f70420df7">zlog_warn</a> (<span class="stringliteral">&quot;[AS4] Fewer hops in AS_PATH than NEW_AS_PATH&quot;</span>);
      <span class="comment">/* Something&#39;s gone wrong. The RFC says we should now ignore AS4_PATH,</span>
<span class="comment">       * which is daft behaviour - it contains vital loop-detection</span>
<span class="comment">       * information which must have been removed from AS_PATH.</span>
<span class="comment">       */</span>
       hops = <a class="code" href="bgp__aspath_8c.html#ae0142a952a7219bbe0244f266ab0f0f5">aspath_count_hops</a> (<a class="code" href="structaspath.html">aspath</a>);
    }
  
  <span class="keywordflow">if</span> (!hops)
   <span class="keywordflow">return</span> <a class="code" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a> (as4path);
  
  <span class="keywordflow">if</span> ( <a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a>(as4, AS4))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a>(<span class="stringliteral">&quot;[AS4] got AS_PATH %s and AS4_PATH %s synthesizing now&quot;</span>,
               <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a>, as4path-&gt;str);

  <span class="keywordflow">while</span> (seg &amp;&amp; hops &gt; 0)
    {
      <span class="keywordflow">switch</span> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>)
        {
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>:
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>:
            hops--;
            cpasns = seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>:
        <span class="comment">/* Should never split a confed-sequence, if hop-count</span>
<span class="comment">         * suggests we must then something&#39;s gone wrong somewhere.</span>
<span class="comment">         *</span>
<span class="comment">         * Most important goal is to preserve AS_PATHs prime function</span>
<span class="comment">         * as loop-detector, so we fudge the numbers so that the entire</span>
<span class="comment">         * confed-sequence is merged in.</span>
<span class="comment">         */</span>
        <span class="keywordflow">if</span> (hops &lt; seg-&gt;<a class="code" href="isis__pdu_8h.html#a64ed70bbcb4536e2af22a1aaf5209d18">length</a>)
          {
            <span class="keywordflow">if</span> (<a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a> (as4, AS4))
              <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4] AS4PATHmangle: AS_CONFED_SEQUENCE falls&quot;</span>
                          <span class="stringliteral">&quot; across 2/4 ASN boundary somewhere, broken..&quot;</span>);
            hops = seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
          }
      <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>:
        cpasns = <a class="code" href="regex_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, hops);
        hops -= seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>;
    }
      
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (cpasns &lt;= seg-&gt;length);
      
      newseg = <a class="code" href="bgp__aspath_8c.html#ad05b3089c057292649a2788723cdde9e">assegment_new</a> (seg-&gt;<a class="code" href="structassegment.html#a60054a202d483d916c9cf7b3a5e58b10">type</a>, 0);
      newseg = <a class="code" href="bgp__aspath_8c.html#a751c1ab911632a8a6889554fb98ef29c">assegment_append_asns</a> (newseg, seg-&gt;<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, cpasns);

      <span class="keywordflow">if</span> (!newpath)
        {
          newpath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();
          newpath-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a> = newseg;
        }
      <span class="keywordflow">else</span>
        prevseg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a> = newseg;

      prevseg = newseg;
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
    
  <span class="comment">/* We may be able to join some segments here, and we must</span>
<span class="comment">   * do this because... we want normalised aspaths in out hash</span>
<span class="comment">   * and we do not want to stumble in aspath_put.</span>
<span class="comment">   */</span>
  mergedpath = <a class="code" href="bgp__aspath_8c.html#a231a40736f808388d679edb3e82b8238">aspath_merge</a> (newpath, <a class="code" href="bgp__aspath_8c.html#a2de7834df2eead0bfa5a117ce265e6ca">aspath_dup</a>(as4path));
  <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (newpath);
  mergedpath-&gt;segments = <a class="code" href="bgp__aspath_8c.html#a8eb975d4bfbfbec4d3d79bafcd2a37b1">assegment_normalise</a> (mergedpath-&gt;segments);
  <a class="code" href="bgp__aspath_8c.html#af73204203de189155558d50f795e1d69">aspath_str_update</a> (mergedpath);
  
  <span class="keywordflow">if</span> ( <a class="code" href="bgp__debug_8h.html#a3652951eb4451c498ae4be9890d4b7a4">BGP_DEBUG</a>(as4, AS4))
    <a class="code" href="log_8h.html#af1f70c8ab8e089840180553abf361296">zlog_debug</a> (<span class="stringliteral">&quot;[AS4] result of synthesizing is %s&quot;</span>,
                mergedpath-&gt;str);
  
  <span class="keywordflow">return</span> mergedpath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a38b915479f5b9c24402eeaf34c8b2c86"></a><!-- doxytag: member="bgp_aspath.h::aspath_size" ref="a38b915479f5b9c24402eeaf34c8b2c86" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int aspath_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00454">454</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size = 0;
  <span class="keyword">struct </span><a class="code" href="structassegment.html">assegment</a> *seg = <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#a142f9a26d6c89fa4f01050cec21aa4d4">segments</a>;
  
  <span class="keywordflow">while</span> (seg)
    {
      size += <a class="code" href="bgp__aspath_8c.html#a08094b79031fca12e069561eee0f03dc">ASSEGMENT_SIZE</a>(seg-&gt;<a class="code" href="structassegment.html#a163a6c3fc55bb0e8997b82d2d1b0805a">length</a>, 1);
      seg = seg-&gt;<a class="code" href="structassegment.html#a1d82e85502fabec483dd0dbfab23a7fd">next</a>;
    }
  <span class="keywordflow">return</span> size;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab2959871f74058a541278f5cad66a183"></a><!-- doxytag: member="bgp_aspath.h::aspath_snmp_pathseg" ref="ab2959871f74058a541278f5cad66a183" args="(struct aspath *, size_t *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_char* aspath_snmp_pathseg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00924">924</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define SNMP_PATHSEG_MAX 1024</span>
<span class="preprocessor"></span>
  <span class="keywordflow">if</span> (!<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>)
    <a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a> = <a class="code" href="stream_8c.html#a7117cdad9fa5e5ae633e0cf08d047459">stream_new</a> (SNMP_PATHSEG_MAX);
  <span class="keywordflow">else</span>
    <a class="code" href="stream_8c.html#aee8fd31485ebc2f0a556a6a5d5c2d1e6">stream_reset</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
  
  <span class="keywordflow">if</span> (!<a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>)
    {
      *varlen = 0;
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
  <a class="code" href="bgp__aspath_8c.html#a716059e44a39a56b3e05020bec13872e">aspath_put</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>, <a class="code" href="structassegment.html#a9b1986dd4ffe1221efbdd261cac68ade">as</a>, 0); <span class="comment">/* use 16 bit for now here */</span>
  
  *varlen = <a class="code" href="stream_8c.html#ac1d2c72755840ea194301a5447ff721a">stream_get_endp</a> (<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
  <span class="keywordflow">return</span> <a class="code" href="stream_8c.html#ad176a69ba2571f53673903a3429da3b6">stream_pnt</a>(<a class="code" href="bgp__aspath_8c.html#a855b6de5c0388baa3ae70dc8e0aec8ee">snmp_stream</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a502ab6af823cbe7ff9fc00ae2b5bfdf1"></a><!-- doxytag: member="bgp_aspath.h::aspath_str2aspath" ref="a502ab6af823cbe7ff9fc00ae2b5bfdf1" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaspath.html">aspath</a>* aspath_str2aspath </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l01742">1742</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">enum</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454">as_token</a> token = <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>;
  u_short as_type;
  u_long asno = 0;
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *<a class="code" href="structaspath.html">aspath</a>;
  <span class="keywordtype">int</span> needtype;

  aspath = <a class="code" href="bgp__aspath_8c.html#adb40e0a61d4ff6a44b740cbc322945d8">aspath_new</a> ();

  <span class="comment">/* We start default type as AS_SEQUENCE. */</span>
  as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
  needtype = 1;

  <span class="keywordflow">while</span> ((<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="bgp__aspath_8c.html#adb39eb9be1d3d958aab2de3e0a3e884f">aspath_gettoken</a> (<a class="code" href="rip__zebra_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, &amp;token, &amp;asno)) != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
    {
      <span class="keywordflow">switch</span> (token)
    {
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a5c3a3713d2629c033c79fe25c1318aed">as_token_asval</a>:
      <span class="keywordflow">if</span> (needtype)
        {
          <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
          needtype = 0;
        }
      <a class="code" href="bgp__aspath_8c.html#a6b8a24127d224a6311da7230e4067f89">aspath_as_add</a> (aspath, asno);
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a8759a3deef6dc2b761423fb44f127caf">as_token_set_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#a9e73037a31a479546ff6883e75dda9ea">AS_SET</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a9dd008aadab0ac11ad984dd8d27bfcb3">as_token_set_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454afdf742a970d9b4a872ba94f6e21cf0b3">as_token_confed_seq_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#afe93e17cd54ee102e446b5c1b75d3565">AS_CONFED_SEQUENCE</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a0297542cfae9aadf8d9124de6aa3719d">as_token_confed_seq_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ade3b7d3281de71180f810778b82d9007">as_token_confed_set_start</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa6f089de2dcdcd2b9f3270f80119225e">AS_CONFED_SET</a>;
      <a class="code" href="bgp__aspath_8c.html#a5feeb93c75798109dd5d38e8ffa91ec2">aspath_segment_add</a> (aspath, as_type);
      needtype = 0;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454ab69daa37d8d32e12533543a1c34520ef">as_token_confed_set_end</a>:
      as_type = <a class="code" href="bgp__aspath_8h.html#aa05819c99e42b36fb343621486ab9839">AS_SEQUENCE</a>;
      needtype = 1;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="bgp__aspath_8c.html#ad682fed782c16fc7fcd42a7da3924454a93fbf7a2ba0ce1a69c5167e025b93c56">as_token_unknown</a>:
    <span class="keywordflow">default</span>:
      <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (aspath);
      <span class="keywordflow">return</span> <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
    }

  aspath-&gt;<a class="code" href="structaspath.html#a3e9ddee46af67cdf22d10cfead37bdc5">str</a> = <a class="code" href="bgp__aspath_8c.html#a861816ed3372dd09cee8ad97610e23f8">aspath_make_str_count</a> (aspath);

  <span class="keywordflow">return</span> aspath;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae41cec22d609259da25c9aaea981d34f"></a><!-- doxytag: member="bgp_aspath.h::aspath_unintern" ref="ae41cec22d609259da25c9aaea981d34f" args="(struct aspath *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aspath_unintern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaspath.html">aspath</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="bgp__aspath_8c_source.html#l00343">343</a> of file <a class="el" href="bgp__aspath_8c_source.html">bgp_aspath.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">struct </span><a class="code" href="structaspath.html">aspath</a> *ret;

  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>)
    <a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a>--;

  <span class="keywordflow">if</span> (<a class="code" href="structaspath.html">aspath</a>-&gt;<a class="code" href="structaspath.html#ad4ebb184cbb394e06b78340af8cbb336">refcnt</a> == 0)
    {
      <span class="comment">/* This aspath must exist in aspath hash table. */</span>
      ret = <a class="code" href="hash_8c.html#a67f4f46ccd66f0b0c2a047eeb130c19e">hash_release</a> (<a class="code" href="bgp__aspath_8c.html#a29bbe33c6a92e2888235591f1e3664cc">ashash</a>, <a class="code" href="structaspath.html">aspath</a>);
      <a class="code" href="regex_8c.html#ad6d5aaa966ca7424f7cb9bd01f2c838b">assert</a> (ret != <a class="code" href="getopt1_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
      <a class="code" href="bgp__aspath_8c.html#af8db79f3e25ae5a01dfec9070557c21a">aspath_free</a> (<a class="code" href="structaspath.html">aspath</a>);
    }
}
</pre></div>
</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="bgp__aspath_8h.html">bgp_aspath.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 10:41:10 for OSPFN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
